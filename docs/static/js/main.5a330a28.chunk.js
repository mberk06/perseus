/*! For license information please see main.5a330a28.chunk.js.LICENSE.txt */
(this.webpackJsonpopenperseus=this.webpackJsonpopenperseus||[]).push([[0],{132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},169:function(e,t){!function(){var e;function t(){if(t.is(arguments[0],M)){for(var e=arguments[0],n=qe[u](t,e.splice(0,3+t.is(e[0],_))),s=n.set(),r=0,o=e[x];r<o;r++){var l=e[r]||{};i[a](l.type)&&s[I](n[l.type]().attr(l))}return s}return qe[u](t,arguments)}e="".trim?function(e,t,n){e.setAttribute(t,String(n).trim())}:function(e,t,n){e.setAttribute(t,String(n))},t.version="1.5.2";var n,s=/[, ]+/,i={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},r=/\{(\d+)\}/g,o="prototype",a="hasOwnProperty",l=document,c=window,h={was:Object[o][a].call(c,"Raphael"),is:c.Raphael},p=function(){this.customAttributes={}},u="apply",d="createTouch"in l,g="",f=" ",m=String,b="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend".split(f),v={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},x="length",y=m[o].toLowerCase,j=Math,w=j.max,O=j.min,C=j.abs,S=j.pow,k=j.PI,_="number",T="string",M="array",N="fill",P=Object[o].toString,I="push",E=/^url\(['"]?([^\)]+?)['"]?\)$/i,A=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,R={NaN:1,Infinity:1,"-Infinity":1},D=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,F=j.round,L=parseFloat,z=parseInt,q=" progid:DXImageTransform.Microsoft",W=m[o].toUpperCase,B={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},V={along:"along",blur:_,"clip-rect":"csv",cx:_,cy:_,fill:"colour","fill-opacity":_,"font-size":_,height:_,opacity:_,path:"path",r:_,rotation:"csv",rx:_,ry:_,scale:"csv",stroke:"colour","stroke-opacity":_,"stroke-width":_,translation:"csv",width:_,x:_,y:_},H="replace",U=/^(from|to|\d+%?)$/,G=/\s*,\s*/,$={hs:1,rg:1},Y=/,?([achlmqrstvxz]),?/gi,K=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,X=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,Z=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,J=function(e,t){return e.key-t.key};if(t.type=c.SVGAngle||l.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var Q,ee=l.createElement("div");if(ee.innerHTML='<v:shape adj="1"/>',(Q=ee.firstChild).style.behavior="url(#default#VML)",!Q||"object"!=typeof Q.adj)return t.type=null;ee=null}function te(){for(var e=[],t=0;t<32;t++)e[t]=(~~(16*j.random())).toString(16);return e[12]=4,e[16]=(3&e[16]|8).toString(16),"r-"+e.join("")}t.svg=!(t.vml="VML"==t.type),p[o]=t[o],n=p[o],t._id=0,t._oid=0,t.fn={},t.is=function(e,t){return"finite"==(t=y.call(t))?!R[a](+e):"null"==t&&null===e||t==typeof e||"object"==t&&e===Object(e)||"array"==t&&Array.isArray&&Array.isArray(e)||P.call(e).slice(8,-1).toLowerCase()==t},t.angle=function(e,n,s,i,r,o){if(null==r){var a=e-s,l=n-i;return a||l?(180*(a<0)+180*j.atan(-l/-a)/k+360)%360:0}return t.angle(e,n,r,o)-t.angle(s,i,r,o)},t.rad=function(e){return e%360*k/180},t.deg=function(e){return 180*e/k%360},t.snapTo=function(e,n,s){if(s=t.is(s,"finite")?s:10,t.is(e,M)){for(var i=e.length;i--;)if(C(e[i]-n)<=s)return e[i]}else{var r=n%(e=+e);if(r<s)return n-r;if(r>e-s)return n-r+e}return n},t.setWindow=function(e){l=(c=e).document};var ne=function(e){if(t.vml){var n,s=/^\s+|\s+$/g;try{var i=new ActiveXObject("htmlfile");i.write("<body>"),i.close(),n=i.body}catch(a){n=createPopup().document.body}var r=n.createTextRange();ne=oe((function(e){try{n.style.color=m(e)[H](s,g);var t=r.queryCommandValue("ForeColor");return"#"+("000000"+(t=(255&t)<<16|65280&t|(16711680&t)>>>16).toString(16)).slice(-6)}catch(a){return"none"}}))}else{var o=l.createElement("i");o.title="Rapha\xebl Colour Picker",o.style.display="none",l.body.appendChild(o),ne=oe((function(e){return o.style.color=e,l.defaultView.getComputedStyle(o,g).getPropertyValue("color")}))}return ne(e)},se=function(){return"hsb("+[this.h,this.s,this.b]+")"},ie=function(){return"hsl("+[this.h,this.s,this.l]+")"},re=function(){return this.hex};function oe(e,t,n){return function s(){var i=Array[o].slice.call(arguments,0),r=i.join("\u25ba"),l=s.cache=s.cache||{},c=s.count=s.count||[];return l[a](r)||(c[x]>=1e3&&delete l[c.shift()],c[I](r),l[r]=e[u](t,i)),n?n(l[r]):l[r]}}t.hsb2rgb=function(e,n,s,i){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(s=e.b,n=e.s,i=(e=e.h).o),t.hsl2rgb(e,n,s/2,i)},t.hsl2rgb=function(e,n,s,i){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(s=e.l,n=e.s,e=e.h),(e>1||n>1||s>1)&&(e/=360,n/=100,s/=100);var r,o,a,l={},c=["r","g","b"];if(n){o=2*s-(r=s<.5?s*(1+n):s+n-s*n);for(var h=0;h<3;h++)(a=e+1/3*-(h-1))<0&&a++,a>1&&a--,l[c[h]]=6*a<1?o+6*(r-o)*a:2*a<1?r:3*a<2?o+(r-o)*(2/3-a)*6:o}else l={r:s,g:s,b:s};return l.r*=255,l.g*=255,l.b*=255,l.hex="#"+(16777216|l.b|l.g<<8|l.r<<16).toString(16).slice(1),t.is(i,"finite")&&(l.opacity=i),l.toString=re,l},t.rgb2hsb=function(e,n,s){if(null==n&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(s=e.b,n=e.g,e=e.r),null==n&&t.is(e,T)){var i=t.getRGB(e);e=i.r,n=i.g,s=i.b}(e>1||n>1||s>1)&&(e/=255,n/=255,s/=255);var r,o=w(e,n,s),a=O(e,n,s);if(a==o)return{h:0,s:0,b:o,toString:se};var l=o-a;return r=e==o?(n-s)/l:n==o?2+(s-e)/l:4+(e-n)/l,(r/=6)<0&&r++,r>1&&r--,{h:r,s:l/o,b:o,toString:se}},t.rgb2hsl=function(e,n,s){if(null==n&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(s=e.b,n=e.g,e=e.r),null==n&&t.is(e,T)){var i=t.getRGB(e);e=i.r,n=i.g,s=i.b}(e>1||n>1||s>1)&&(e/=255,n/=255,s/=255);var r,o,a=w(e,n,s),l=O(e,n,s),c=(a+l)/2;if(l==a)o={h:0,s:0,l:c};else{var h=a-l;r=e==a?(n-s)/h:n==a?2+(s-e)/h:4+(e-n)/h,(r/=6)<0&&r++,r>1&&r--,o={h:r,s:c<.5?h/(a+l):h/(2-a-l),l:c}}return o.toString=ie,o},t._path2string=function(){return this.join(",")[H](Y,"$1")},t.getRGB=oe((function(e){if(!e||(e=m(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!$[a](e.toLowerCase().substring(0,2))&&"#"!=e.charAt()&&(e=ne(e));var n,s,i,r,o,l,c=e.match(A);return c?(c[2]&&(i=z(c[2].substring(5),16),s=z(c[2].substring(3,5),16),n=z(c[2].substring(1,3),16)),c[3]&&(i=z((o=c[3].charAt(3))+o,16),s=z((o=c[3].charAt(2))+o,16),n=z((o=c[3].charAt(1))+o,16)),c[4]&&(l=c[4].split(G),n=L(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),s=L(l[1]),"%"==l[1].slice(-1)&&(s*=2.55),i=L(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(r=L(l[3])),l[3]&&"%"==l[3].slice(-1)&&(r/=100)),c[5]?(l=c[5].split(G),n=L(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),s=L(l[1]),"%"==l[1].slice(-1)&&(s*=2.55),i=L(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),("deg"==l[0].slice(-3)||"\xb0"==l[0].slice(-1))&&(n/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(r=L(l[3])),l[3]&&"%"==l[3].slice(-1)&&(r/=100),t.hsb2rgb(n,s,i,r)):c[6]?(l=c[6].split(G),n=L(l[0]),"%"==l[0].slice(-1)&&(n*=2.55),s=L(l[1]),"%"==l[1].slice(-1)&&(s*=2.55),i=L(l[2]),"%"==l[2].slice(-1)&&(i*=2.55),("deg"==l[0].slice(-3)||"\xb0"==l[0].slice(-1))&&(n/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(r=L(l[3])),l[3]&&"%"==l[3].slice(-1)&&(r/=100),t.hsl2rgb(n,s,i,r)):((c={r:n,g:s,b:i}).hex="#"+(16777216|i|s<<8|n<<16).toString(16).slice(1),t.is(r,"finite")&&(c.opacity=r),c)):{r:-1,g:-1,b:-1,hex:"none",error:1}}),t),t.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},n=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),n.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=oe((function(e){if(!e)return null;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=[];return t.is(e,M)&&t.is(e[0],M)&&(s=le(e)),s[x]||m(e)[H](K,(function(e,t,i){var r=[],o=y.call(t);for(i[H](X,(function(e,t){t&&r[I](+t)})),"m"==o&&r[x]>2&&(s[I]([t].concat(r.splice(0,2))),o="l",t="m"==t?"l":"L");r[x]>=n[o]&&(s[I]([t].concat(r.splice(0,n[o]))),n[o]););})),s.toString=t._path2string,s})),t.findDotsAtSegment=function(e,t,n,s,i,r,o,a,l){var c=1-l,h=S(c,3)*e+3*S(c,2)*l*n+3*c*l*l*i+S(l,3)*o,p=S(c,3)*t+3*S(c,2)*l*s+3*c*l*l*r+S(l,3)*a,u=e+2*l*(n-e)+l*l*(i-2*n+e),d=t+2*l*(s-t)+l*l*(r-2*s+t),g=n+2*l*(i-n)+l*l*(o-2*i+n),f=s+2*l*(r-s)+l*l*(a-2*r+s),m=(1-l)*e+l*n,b=(1-l)*t+l*s,v=(1-l)*i+l*o,x=(1-l)*r+l*a,y=90-180*j.atan((u-g)/(d-f))/k;return(u>g||d<f)&&(y+=180),{x:h,y:p,m:{x:u,y:d},n:{x:g,y:f},start:{x:m,y:b},end:{x:v,y:x},alpha:y}};var ae=oe((function(e){if(!e)return{x:0,y:0,width:0,height:0};for(var t,n=0,s=0,i=[],r=[],o=0,a=(e=me(e))[x];o<a;o++)if("M"==(t=e[o])[0])n=t[1],s=t[2],i[I](n),r[I](s);else{var l=fe(n,s,t[1],t[2],t[3],t[4],t[5],t[6]);i=i.concat(l.min.x,l.max.x),r=r.concat(l.min.y,l.max.y),n=t[5],s=t[6]}var c=O[u](0,i),h=O[u](0,r);return{x:c,y:h,width:w[u](0,i)-c,height:w[u](0,r)-h}})),le=function(e){var n=[];t.is(e,M)&&t.is(e&&e[0],M)||(e=t.parsePathString(e));for(var s=0,i=e[x];s<i;s++){n[s]=[];for(var r=0,o=e[s][x];r<o;r++)n[s][r]=e[s][r]}return n.toString=t._path2string,n},ce=oe((function(e){t.is(e,M)&&t.is(e&&e[0],M)||(e=t.parsePathString(e));var n=[],s=0,i=0,r=0,o=0,a=0;"M"==e[0][0]&&(r=s=e[0][1],o=i=e[0][2],a++,n[I](["M",s,i]));for(var l=a,c=e[x];l<c;l++){var h=n[l]=[],p=e[l];if(p[0]!=y.call(p[0]))switch(h[0]=y.call(p[0]),h[0]){case"a":h[1]=p[1],h[2]=p[2],h[3]=p[3],h[4]=p[4],h[5]=p[5],h[6]=+(p[6]-s).toFixed(3),h[7]=+(p[7]-i).toFixed(3);break;case"v":h[1]=+(p[1]-i).toFixed(3);break;case"m":r=p[1],o=p[2];default:for(var u=1,d=p[x];u<d;u++)h[u]=+(p[u]-(u%2?s:i)).toFixed(3)}else{h=n[l]=[],"m"==p[0]&&(r=p[1]+s,o=p[2]+i);for(var g=0,f=p[x];g<f;g++)n[l][g]=p[g]}var m=n[l][x];switch(n[l][0]){case"z":s=r,i=o;break;case"h":s+=+n[l][m-1];break;case"v":i+=+n[l][m-1];break;default:s+=+n[l][m-2],i+=+n[l][m-1]}}return n.toString=t._path2string,n}),0,le),he=oe((function(e){t.is(e,M)&&t.is(e&&e[0],M)||(e=t.parsePathString(e));var n=[],s=0,i=0,r=0,o=0,a=0;"M"==e[0][0]&&(r=s=+e[0][1],o=i=+e[0][2],a++,n[0]=["M",s,i]);for(var l=a,c=e[x];l<c;l++){var h=n[l]=[],p=e[l];if(p[0]!=W.call(p[0]))switch(h[0]=W.call(p[0]),h[0]){case"A":h[1]=p[1],h[2]=p[2],h[3]=p[3],h[4]=p[4],h[5]=p[5],h[6]=+(p[6]+s),h[7]=+(p[7]+i);break;case"V":h[1]=+p[1]+i;break;case"H":h[1]=+p[1]+s;break;case"M":r=+p[1]+s,o=+p[2]+i;default:for(var u=1,d=p[x];u<d;u++)h[u]=+p[u]+(u%2?s:i)}else for(var g=0,f=p[x];g<f;g++)n[l][g]=p[g];switch(h[0]){case"Z":s=r,i=o;break;case"H":s=h[1];break;case"V":i=h[1];break;case"M":r=n[l][n[l][x]-2],o=n[l][n[l][x]-1];default:s=n[l][n[l][x]-2],i=n[l][n[l][x]-1]}}return n.toString=t._path2string,n}),null,le),pe=function(e,t,n,s){return[e,t,n,s,n,s]},ue=function(e,t,n,s,i,r){var o=1/3,a=2/3;return[o*e+a*n,o*t+a*s,o*i+a*n,o*r+a*s,i,r]},de=function(e,t,n,s,i,r,o,a,l,c){var h,p=120*k/180,u=k/180*(+i||0),d=[],g=oe((function(e,t,n){return{x:e*j.cos(n)-t*j.sin(n),y:e*j.sin(n)+t*j.cos(n)}}));if(c)_=c[0],T=c[1],O=c[2],S=c[3];else{e=(h=g(e,t,-u)).x,t=h.y,a=(h=g(a,l,-u)).x,l=h.y;j.cos(k/180*i),j.sin(k/180*i);var f=(e-a)/2,m=(t-l)/2,b=f*f/(n*n)+m*m/(s*s);b>1&&(n*=b=j.sqrt(b),s*=b);var v=n*n,y=s*s,w=(r==o?-1:1)*j.sqrt(C((v*y-v*m*m-y*f*f)/(v*m*m+y*f*f))),O=w*n*m/s+(e+a)/2,S=w*-s*f/n+(t+l)/2,_=j.asin(((t-S)/s).toFixed(9)),T=j.asin(((l-S)/s).toFixed(9));(_=e<O?k-_:_)<0&&(_=2*k+_),(T=a<O?k-T:T)<0&&(T=2*k+T),o&&_>T&&(_-=2*k),!o&&T>_&&(T-=2*k)}var M=T-_;if(C(M)>p){var N=T,P=a,I=l;T=_+p*(o&&T>_?1:-1),a=O+n*j.cos(T),l=S+s*j.sin(T),d=de(a,l,n,s,i,0,o,P,I,[T,N,O,S])}M=T-_;var E=j.cos(_),A=j.sin(_),R=j.cos(T),D=j.sin(T),F=j.tan(M/4),L=4/3*n*F,z=4/3*s*F,q=[e,t],W=[e+L*A,t-z*E],B=[a+L*D,l-z*R],V=[a,l];if(W[0]=2*q[0]-W[0],W[1]=2*q[1]-W[1],c)return[W,B,V].concat(d);for(var H=[],U=0,G=(d=[W,B,V].concat(d).join().split(","))[x];U<G;U++)H[U]=U%2?g(d[U-1],d[U],u).y:g(d[U],d[U+1],u).x;return H},ge=function(e,t,n,s,i,r,o,a,l){var c=1-l;return{x:S(c,3)*e+3*S(c,2)*l*n+3*c*l*l*i+S(l,3)*o,y:S(c,3)*t+3*S(c,2)*l*s+3*c*l*l*r+S(l,3)*a}},fe=oe((function(e,t,n,s,i,r,o,a){var l,c=i-2*n+e-(o-2*i+n),h=2*(n-e)-2*(i-n),p=e-n,d=(-h+j.sqrt(h*h-4*c*p))/2/c,g=(-h-j.sqrt(h*h-4*c*p))/2/c,f=[t,a],m=[e,o];return C(d)>"1e12"&&(d=.5),C(g)>"1e12"&&(g=.5),d>0&&d<1&&(l=ge(e,t,n,s,i,r,o,a,d),m[I](l.x),f[I](l.y)),g>0&&g<1&&(l=ge(e,t,n,s,i,r,o,a,g),m[I](l.x),f[I](l.y)),c=r-2*s+t-(a-2*r+s),p=t-s,d=(-(h=2*(s-t)-2*(r-s))+j.sqrt(h*h-4*c*p))/2/c,g=(-h-j.sqrt(h*h-4*c*p))/2/c,C(d)>"1e12"&&(d=.5),C(g)>"1e12"&&(g=.5),d>0&&d<1&&(l=ge(e,t,n,s,i,r,o,a,d),m[I](l.x),f[I](l.y)),g>0&&g<1&&(l=ge(e,t,n,s,i,r,o,a,g),m[I](l.x),f[I](l.y)),{min:{x:O[u](0,m),y:O[u](0,f)},max:{x:w[u](0,m),y:w[u](0,f)}}})),me=oe((function(e,t){for(var n=he(e),s=t&&he(t),i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},r={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=function(e,t){if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(de[u](0,[t.x,t.y].concat(e.slice(1))));break;case"S":e=["C",t.x+(t.x-(t.bx||t.x)),t.y+(t.y-(t.by||t.y))].concat(e.slice(1));break;case"T":t.qx=t.x+(t.x-(t.qx||t.x)),t.qy=t.y+(t.y-(t.qy||t.y)),e=["C"].concat(ue(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(ue(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(pe(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(pe(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(pe(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(pe(t.x,t.y,t.X,t.Y))}return e},a=function(e,t){if(e[t][x]>7){e[t].shift();for(var i=e[t];i[x];)e.splice(t++,0,["C"].concat(i.splice(0,6)));e.splice(t,1),h=w(n[x],s&&s[x]||0)}},l=function(e,t,i,r,o){e&&t&&"M"==e[o][0]&&"M"!=t[o][0]&&(t.splice(o,0,["M",r.x,r.y]),i.bx=0,i.by=0,i.x=e[o][1],i.y=e[o][2],h=w(n[x],s&&s[x]||0))},c=0,h=w(n[x],s&&s[x]||0);c<h;c++){n[c]=o(n[c],i),a(n,c),s&&(s[c]=o(s[c],r)),s&&a(s,c),l(n,s,i,r,c),l(s,n,r,i,c);var p=n[c],d=s&&s[c],g=p[x],f=s&&d[x];i.x=p[g-2],i.y=p[g-1],i.bx=L(p[g-4])||i.x,i.by=L(p[g-3])||i.y,r.bx=s&&(L(d[f-4])||r.x),r.by=s&&(L(d[f-3])||r.y),r.x=s&&d[f-2],r.y=s&&d[f-1]}return s?[n,s]:n}),null,le),be=oe((function(e){for(var n=[],s=0,i=e[x];s<i;s++){var r={},o=e[s].match(/^([^:]*):?([\d\.]*)/);if(r.color=t.getRGB(o[1]),r.color.error)return null;r.color=r.color.hex,o[2]&&(r.offset=o[2]+"%"),n[I](r)}for(s=1,i=n[x]-1;s<i;s++)if(!n[s].offset){for(var a=L(n[s-1].offset||0),l=0,c=s+1;c<i;c++)if(n[c].offset){l=n[c].offset;break}l||(l=100,c=i);for(var h=((l=L(l))-a)/(c-s+1);s<c;s++)a+=h,n[s].offset=a+"%"}return n})),ve=function(e,n,s,i){var r;return t.is(e,T)||t.is(e,"object")?(r=t.is(e,T)?l.getElementById(e):e).tagName?null==n?{container:r,width:r.style.pixelWidth||r.offsetWidth,height:r.style.pixelHeight||r.offsetHeight}:{container:r,width:n,height:s}:void 0:{container:1,x:e,y:n,width:s,height:i}},xe=function(e,t){var n=this;for(var s in t)if(t[a](s)&&!(s in e))switch(typeof t[s]){case"function":!function(t){e[s]=e===n?t:function(){return t[u](n,arguments)}}(t[s]);break;case"object":e[s]=e[s]||{},xe.call(this,e[s],t[s]);break;default:e[s]=t[s]}},ye=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)},je=function(e,t){t.top!==e&&(ye(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e)},we=function(e,t){t.bottom!==e&&(ye(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e)},Oe=function(e,t,n){ye(e,n),t==n.top&&(n.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},Ce=function(e,t,n){ye(e,n),t==n.bottom&&(n.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},Se=function(e){return function(){throw new Error("Rapha\xebl: you are calling to method \u201c"+e+"\u201d of removed object")}};if(t.pathToRelative=ce,t.svg){n.svgns="http://www.w3.org/2000/svg",n.xlink="http://www.w3.org/1999/xlink",F=function(e){return+e+.5*(~~e===e)};var ke=function(t,s){if(!s)return(t=l.createElementNS(n.svgns,t)).style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in s)s[a](i)&&e(t,i,m(s[i]))};t.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var _e=function(e,t){var n=ke("path");t.canvas&&t.canvas.appendChild(n);var s=new Ie(n,t);return s.type="path",Ne(s,{fill:"none",stroke:"#000",path:e}),s},Te=function(e,t,n){var s="linear",i=.5,r=.5,o=e.style;if(t=(t=m(t)[H](Z,(function(e,t,n){if(s="radial",t&&n){i=L(t);var o=2*((r=L(n))>.5)-1;S(i-.5,2)+S(r-.5,2)>.25&&(r=j.sqrt(.25-S(i-.5,2))*o+.5)&&.5!=r&&(r=r.toFixed(5)-1e-5*o)}return g}))).split(/\s*\-\s*/),"linear"==s){var a=t.shift();if(a=-L(a),isNaN(a))return null;var c=[0,0,j.cos(a*k/180),j.sin(a*k/180)],h=1/(w(C(c[2]),C(c[3]))||1);c[2]*=h,c[3]*=h,c[2]<0&&(c[0]=-c[2],c[2]=0),c[3]<0&&(c[1]=-c[3],c[3]=0)}var p=be(t);if(!p)return null;var u=e.getAttribute(N);(u=u.match(/^url\(#(.*)\)$/))&&n.defs.removeChild(l.getElementById(u[1]));var d=ke(s+"Gradient");d.id=te(),ke(d,"radial"==s?{fx:i,fy:r}:{x1:c[0],y1:c[1],x2:c[2],y2:c[3]}),n.defs.appendChild(d);for(var f=0,b=p[x];f<b;f++){var v=ke("stop");ke(v,{offset:p[f].offset?p[f].offset:f?"100%":"0%","stop-color":p[f].color||"#fff"}),d.appendChild(v)}return ke(e,{fill:"url(#"+d.id+")",opacity:1,"fill-opacity":1}),o.fill=g,o.opacity=1,o.fillOpacity=1,1},Me=function(e){var n=e.getBBox();ke(e.pattern,{patternTransform:t.format("translate({0},{1})",n.x,n.y)})},Ne=function(n,i){var r={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},o=n.node,c=n.attrs,h=n.rotate(),p=function(e,t){if(t=r[y.call(t)]){for(var n=e.attrs["stroke-width"]||"1",s={round:n,square:n,butt:0}[e.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,a=[],l=t[x];l--;)a[l]=t[l]*n+(l%2?1:-1)*s;ke(o,{"stroke-dasharray":a.join(",")})}};i[a]("rotation")&&(h=i.rotation);var u=m(h).split(s);for(var d in u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null,L(h)&&n.rotate(0,!0),i)if(i[a](d)){if(!B[a](d))continue;var b=i[d];switch(c[d]=b,d){case"blur":n.blur(b);break;case"rotation":n.rotate(b,!0);break;case"href":case"title":case"target":var v=o.parentNode;if("a"!=y.call(v.tagName)){var j=ke("a");v.insertBefore(j,o),j.appendChild(o),v=j}"target"==d&&"blank"==b?v.setAttributeNS(n.paper.xlink,"show","new"):v.setAttributeNS(n.paper.xlink,d,b);break;case"cursor":o.style.cursor=b;break;case"clip-rect":var w=m(b).split(s);if(4==w[x]){n.clip&&n.clip.parentNode.parentNode.removeChild(n.clip.parentNode);var O=ke("clipPath"),C=ke("rect");O.id=te(),ke(C,{x:w[0],y:w[1],width:w[2],height:w[3]}),O.appendChild(C),n.paper.defs.appendChild(O),ke(o,{"clip-path":"url(#"+O.id+")"}),n.clip=C}if(!b){var S=l.getElementById(o.getAttribute("clip-path")[H](/(^url\(#|\)$)/g,g));S&&S.parentNode.removeChild(S),ke(o,{"clip-path":g}),delete n.clip}break;case"path":"path"==n.type&&ke(o,{d:b?c.path=he(b):"M0,0"});break;case"width":if(e(o,d,b),!c.fx)break;d="x",b=c.x;case"x":c.fx&&(b=-c.x-(c.width||0));case"rx":if("rx"==d&&"rect"==n.type)break;case"cx":u&&("x"==d||"cx"==d)&&(u[1]+=b-c[d]),e(o,d,b),n.pattern&&Me(n);break;case"height":if(e(o,d,b),!c.fy)break;d="y",b=c.y;case"y":c.fy&&(b=-c.y-(c.height||0));case"ry":if("ry"==d&&"rect"==n.type)break;case"cy":u&&("y"==d||"cy"==d)&&(u[2]+=b-c[d]),e(o,d,b),n.pattern&&Me(n);break;case"r":"rect"==n.type?ke(o,{rx:b,ry:b}):e(o,d,b);break;case"src":"image"==n.type&&o.setAttributeNS(n.paper.xlink,"href",b);break;case"stroke-width":o.style.strokeWidth=b,e(o,d,b),c["stroke-dasharray"]&&p(n,c["stroke-dasharray"]);break;case"stroke-dasharray":p(n,b);break;case"translation":var k=m(b).split(s);k[0]=+k[0]||0,k[1]=+k[1]||0,u&&(u[1]+=k[0],u[2]+=k[1]),bt.call(n,k[0],k[1]);break;case"scale":k=m(b).split(s),n.scale(+k[0]||1,+k[1]||+k[0]||1,isNaN(L(k[2]))?null:+k[2],isNaN(L(k[3]))?null:+k[3]);break;case N:var _=m(b).match(E);if(_){O=ke("pattern");var T=ke("image");O.id=te(),ke(O,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),ke(T,{x:0,y:0}),T.setAttributeNS(n.paper.xlink,"href",_[1]),O.appendChild(T);var M=l.createElement("img");M.style.cssText="position:absolute;left:-9999em;top-9999em",M.onload=function(){ke(O,{width:this.offsetWidth,height:this.offsetHeight}),ke(T,{width:this.offsetWidth,height:this.offsetHeight}),l.body.removeChild(this),n.paper.safari()},l.body.appendChild(M),M.src=_[1],n.paper.defs.appendChild(O),o.style.fill="url(#"+O.id+")",ke(o,{fill:"url(#"+O.id+")"}),n.pattern=O,n.pattern&&Me(n);break}var P=t.getRGB(b);if(P.error){if(({circle:1,ellipse:1}[a](n.type)||"r"!=m(b).charAt())&&Te(o,b,n.paper)){c.gradient=b,c.fill="none";break}}else delete i.gradient,delete c.gradient,!t.is(c.opacity,"undefined")&&t.is(i.opacity,"undefined")&&ke(o,{opacity:c.opacity}),!t.is(c["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&ke(o,{"fill-opacity":c["fill-opacity"]});P[a]("opacity")&&ke(o,{"fill-opacity":P.opacity>1?P.opacity/100:P.opacity});case"stroke":P=t.getRGB(b),e(o,d,P.hex),"stroke"==d&&P[a]("opacity")&&ke(o,{"stroke-opacity":P.opacity>1?P.opacity/100:P.opacity});break;case"gradient":({circle:1,ellipse:1}[a](n.type)||"r"!=m(b).charAt())&&Te(o,b,n.paper);break;case"opacity":c.gradient&&!c[a]("stroke-opacity")&&ke(o,{"stroke-opacity":b>1?b/100:b});case"fill-opacity":if(c.gradient){var I=l.getElementById(o.getAttribute(N)[H](/^url\(#|\)$/g,g));if(I){var A=I.getElementsByTagName("stop");e(A[A[x]-1],"stop-opacity",b)}break}default:"font-size"==d&&(b=z(b,10)+"px");var R=d[H](/(\-.)/g,(function(e){return W.call(e.substring(1))}));o.style[R]=b,e(o,d,b)}}Pe(n,i),u?n.rotate(u.join(f)):L(h)&&n.rotate(h,!0)},Pe=function(e,n){if("text"==e.type&&(n[a]("text")||n[a]("font")||n[a]("font-size")||n[a]("x")||n[a]("y"))){var s=e.attrs,i=e.node,r=i.firstChild?z(l.defaultView.getComputedStyle(i.firstChild,g).getPropertyValue("font-size"),10):10;if(n[a]("text")){for(s.text=n.text;i.firstChild;)i.removeChild(i.firstChild);for(var o=m(n.text).split("\n"),c=0,h=o[x];c<h;c++)if(o[c]){var p=ke("tspan");c&&ke(p,{dy:1.2*r,x:s.x}),p.appendChild(l.createTextNode(o[c])),i.appendChild(p)}}else for(c=0,h=(o=i.getElementsByTagName("tspan"))[x];c<h;c++)c&&ke(o[c],{dy:1.2*r,x:s.x});ke(i,{y:s.y});var u=e.getBBox(),d=s.y-(u.y+u.height/2);d&&t.is(d,"finite")&&ke(i,{y:s.y+d})}},Ie=function(e,n){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=n,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!n.bottom&&(n.bottom=this),this.prev=n.top,n.top&&(n.top.next=this),n.top=this,this.next=null},Ee=Ie[o];Ie[o].rotate=function(e,n,i){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy].join(f):this._.rt.deg;var r=this.getBBox();return(e=m(e).split(s))[x]-1&&(n=L(e[1]),i=L(e[2])),e=L(e[0]),null!=n&&!1!==n?this._.rt.deg=e:this._.rt.deg+=e,null==i&&(n=null),this._.rt.cx=n,this._.rt.cy=i,n=null==n?r.x+r.width/2:n,i=null==i?r.y+r.height/2:i,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,n,i),this.clip&&ke(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,n,i)})):(this.transformations[0]=g,this.clip&&ke(this.clip,{transform:g})),ke(this.node,{transform:this.transformations.join(f)}),this},Ie[o].hide=function(){return!this.removed&&(this.node.style.display="none"),this},Ie[o].show=function(){return!this.removed&&(this.node.style.display=""),this},Ie[o].remove=function(){if(!this.removed){for(var e in ye(this,this.paper),this.node.parentNode.removeChild(this.node),this)delete this[e];this.removed=!0}},Ie[o].getBBox=function(){if(this.removed)return this;if("path"==this.type)return ae(this.attrs.path);if("none"==this.node.style.display){this.show();var e=!0}var t={};try{t=this.node.getBBox()}catch(r){}finally{t=t||{}}if("text"==this.type){t={x:t.x,y:1/0,width:0,height:0};for(var n=0,s=this.node.getNumberOfChars();n<s;n++){var i=this.node.getExtentOfChar(n);i.y<t.y&&(t.y=i.y),i.y+i.height-t.y>t.height&&(t.height=i.y+i.height-t.y),i.x+i.width-t.x>t.width&&(t.width=i.x+i.width-t.x)}}return e&&this.hide(),t},Ie[o].attr=function(e,n){if(this.removed)return this;if(null==e){var s={};for(var i in this.attrs)this.attrs[a](i)&&(s[i]=this.attrs[i]);return this._.rt.deg&&(s.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(s.scale=this.scale()),s.gradient&&"none"==s.fill&&(s.fill=s.gradient)&&delete s.gradient,s}if(null==n&&t.is(e,T))return"translation"==e?bt.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==N&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==n&&t.is(e,M)){for(var r={},o=0,l=e.length;o<l;o++)r[e[o]]=this.attr(e[o]);return r}if(null!=n){var c={};c[e]=n}else null!=e&&t.is(e,"object")&&(c=e);for(var h in this.paper.customAttributes)if(this.paper.customAttributes[a](h)&&c[a](h)&&t.is(this.paper.customAttributes[h],"function")){var p=this.paper.customAttributes[h].apply(this,[].concat(c[h]));for(var u in this.attrs[h]=c[h],p)p[a](u)&&(c[u]=p[u])}return Ne(this,c),this},Ie[o].toFront=function(){if(this.removed)return this;this.node.parentNode.appendChild(this.node);var e=this.paper;return e.top!=this&&je(this,e),this},Ie[o].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),we(this,this.paper);this.paper}return this},Ie[o].insertAfter=function(e){if(this.removed)return this;var t=e.node||e[e.length-1].node;return t.nextSibling?t.parentNode.insertBefore(this.node,t.nextSibling):t.parentNode.appendChild(this.node),Oe(this,e,this.paper),this},Ie[o].insertBefore=function(e){if(this.removed)return this;var t=e.node||e[0].node;return t.parentNode.insertBefore(this.node,t),Ce(this,e,this.paper),this},Ie[o].blur=function(e){var t=this;if(0!==+e){var n=ke("filter"),s=ke("feGaussianBlur");t.attrs.blur=e,n.id=te(),ke(s,{stdDeviation:+e||1.5}),n.appendChild(s),t.paper.defs.appendChild(n),t._blur=n,ke(t.node,{filter:"url(#"+n.id+")"})}else t._blur&&(t._blur.parentNode.removeChild(t._blur),delete t._blur,delete t.attrs.blur),t.node.removeAttribute("filter")};var Ae=function(e,t,n,s){var i=ke("circle");e.canvas&&e.canvas.appendChild(i);var r=new Ie(i,e);return r.attrs={cx:t,cy:n,r:s,fill:"none",stroke:"#000"},r.type="circle",ke(i,r.attrs),r},Re=function(e,t,n,s,i,r){var o=ke("rect");e.canvas&&e.canvas.appendChild(o);var a=new Ie(o,e);return a.attrs={x:t,y:n,width:s,height:i,r:r||0,rx:r||0,ry:r||0,fill:"none",stroke:"#000"},a.type="rect",ke(o,a.attrs),a},De=function(e,t,n,s,i){var r=ke("ellipse");e.canvas&&e.canvas.appendChild(r);var o=new Ie(r,e);return o.attrs={cx:t,cy:n,rx:s,ry:i,fill:"none",stroke:"#000"},o.type="ellipse",ke(r,o.attrs),o},Fe=function(e,t,n,s,i,r){var o=ke("image");ke(o,{x:n,y:s,width:i,height:r,preserveAspectRatio:"none"}),o.setAttributeNS(e.xlink,"href",t),e.canvas&&e.canvas.appendChild(o);var a=new Ie(o,e);return a.attrs={x:n,y:s,width:i,height:r,src:t},a.type="image",a},Le=function(e,t,n,s){var i=ke("text");ke(i,{x:t,y:n,"text-anchor":"middle"}),e.canvas&&e.canvas.appendChild(i);var r=new Ie(i,e);return r.attrs={x:t,y:n,"text-anchor":"middle",text:s,font:B.font,stroke:"none",fill:"#000"},r.type="text",Ne(r,r.attrs),r},ze=function(t,n){return this.width=t||this.width,this.height=n||this.height,e(this.canvas,"width",this.width),e(this.canvas,"height",this.height),this},qe=function(){var e=ve[u](0,arguments),n=e&&e.container,s=e.x,i=e.y,r=e.width,o=e.height;if(!n)throw new Error("SVG container not found.");var a=ke("svg");return s=s||0,i=i||0,ke(a,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:r=r||512,height:o=o||342}),1==n?(a.style.cssText="position:absolute;left:"+s+"px;top:"+i+"px",l.body.appendChild(a)):n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),(n=new p).width=r,n.height=o,n.canvas=a,xe.call(n,n,t.fn),n.clear(),n};n.clear=function(){for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=ke("desc")).appendChild(l.createTextNode("Created with Rapha\xebl")),e.appendChild(this.desc),e.appendChild(this.defs=ke("defs"))},n.remove=function(){for(var e in this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[e]=Se(e)}}if(t.vml){var We,Be={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Ve=/([clmz]),?([^clmz]*)/gi,He=/ progid:\S+Blur\([^\)]+\)/g,Ue=/-?[^,\s-]+/g,Ge="1000 1000",$e=10,Ye={path:1,rect:1};function Ke(e,n,s,i,r){return r?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+r,n,s-2*r,r,-r,i-2*r,2*r-s,2*r-i):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,n,s,i,-s)}t.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version},_e=function(e,t){var n=We("group");n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=t.coordsize,n.coordorigin=t.coordorigin;var s=We("shape"),i=s.style;i.width=t.width+"px",i.height=t.height+"px",s.coordsize=Ge,s.coordorigin=t.coordorigin,n.appendChild(s);var r=new Ie(s,n,t),o={fill:"none",stroke:"#000"};return e&&(o.path=e),r.type="path",r.path=[],r.Path=g,Ne(r,o),t.canvas.appendChild(n),r},Ne=function(e,n){e.attrs=e.attrs||{};var i,r=e.node,o=e.attrs,c=r.style,h=(n.x!=o.x||n.y!=o.y||n.width!=o.width||n.height!=o.height||n.r!=o.r)&&"rect"==e.type,p=e;for(var u in n)n[a](u)&&(o[u]=n[u]);if(h&&(o.path=Ke(o.x,o.y,o.width,o.height,o.r),e.X=o.x,e.Y=o.y,e.W=o.width,e.H=o.height),n.href&&(r.href=n.href),n.title&&(r.title=n.title),n.target&&(r.target=n.target),n.cursor&&(c.cursor=n.cursor),"blur"in n&&e.blur(n.blur),(n.path&&"path"==e.type||h)&&(r.path=function(e){var t=/[ahqstv]/gi,n=he;if(m(e).match(t)&&(n=me),t=/[clmz]/g,n==he&&!m(e).match(t)){var s=m(e)[H](Ve,(function(e,t,n){var s=[],i="m"==y.call(t),r=Be[t];return n[H](Ue,(function(e){i&&2==s[x]&&(r+=s+Be["m"==t?"l":"L"],s=[]),s[I](F(e*$e))})),r+s}));return s}var i,r,o=n(e);s=[];for(var a=0,l=o[x];a<l;a++){i=o[a],"z"==(r=y.call(o[a][0]))&&(r="x");for(var c=1,h=i[x];c<h;c++)r+=F(i[c]*$e)+(c!=h-1?",":g);s[I](r)}return s.join(f)}(o.path)),null!=n.rotation&&e.rotate(n.rotation,!0),n.translation&&(i=m(n.translation).split(s),bt.call(e,i[0],i[1]),null!=e._.rt.cx&&(e._.rt.cx+=+i[0],e._.rt.cy+=+i[1],e.setBox(e.attrs,i[0],i[1]))),n.scale&&(i=m(n.scale).split(s),e.scale(+i[0]||1,+i[1]||+i[0]||1,+i[2]||null,+i[3]||null)),"clip-rect"in n){var d=m(n["clip-rect"]).split(s);if(4==d[x]){d[2]=+d[2]+ +d[0],d[3]=+d[3]+ +d[1];var b=r.clipRect||l.createElement("div"),v=b.style,j=r.parentNode;v.clip=t.format("rect({1}px {2}px {3}px {0}px)",d),r.clipRect||(v.position="absolute",v.top=0,v.left=0,v.width=e.paper.width+"px",v.height=e.paper.height+"px",j.parentNode.insertBefore(b,j),b.appendChild(j),r.clipRect=b)}n["clip-rect"]||r.clipRect&&(r.clipRect.style.clip=g)}if("image"==e.type&&n.src&&(r.src=n.src),"image"==e.type&&n.opacity&&(r.filterOpacity=q+".Alpha(opacity="+100*n.opacity+")",c.filter=(r.filterMatrix||g)+(r.filterOpacity||g)),n.font&&(c.font=n.font),n["font-family"]&&(c.fontFamily='"'+n["font-family"].split(",")[0][H](/^['"]+|['"]+$/g,g)+'"'),n["font-size"]&&(c.fontSize=n["font-size"]),n["font-weight"]&&(c.fontWeight=n["font-weight"]),n["font-style"]&&(c.fontStyle=n["font-style"]),null!=n.opacity||null!=n["stroke-width"]||null!=n.fill||null!=n.stroke||null!=n["stroke-width"]||null!=n["stroke-opacity"]||null!=n["fill-opacity"]||null!=n["stroke-dasharray"]||null!=n["stroke-miterlimit"]||null!=n["stroke-linejoin"]||null!=n["stroke-linecap"]){var C=(r=e.shape||r).getElementsByTagName(N)&&r.getElementsByTagName(N)[0],S=!1;if(!C&&(S=C=We(N)),"fill-opacity"in n||"opacity"in n){var k=((+o["fill-opacity"]+1||2)-1)*((+o.opacity+1||2)-1)*((+t.getRGB(n.fill).o+1||2)-1);k=O(w(k,0),1),C.opacity=k}if(n.fill&&(C.on=!0),null!=C.on&&"none"!=n.fill||(C.on=!1),C.on&&n.fill){var _=n.fill.match(E);_?(C.src=_[1],C.type="tile"):(C.color=t.getRGB(n.fill).hex,C.src=g,C.type="solid",t.getRGB(n.fill).error&&(p.type in{circle:1,ellipse:1}||"r"!=m(n.fill).charAt())&&Te(p,n.fill)&&(o.fill="none",o.gradient=n.fill))}S&&r.appendChild(C);var T=r.getElementsByTagName("stroke")&&r.getElementsByTagName("stroke")[0],M=!1;!T&&(M=T=We("stroke")),(n.stroke&&"none"!=n.stroke||n["stroke-width"]||null!=n["stroke-opacity"]||n["stroke-dasharray"]||n["stroke-miterlimit"]||n["stroke-linejoin"]||n["stroke-linecap"])&&(T.on=!0),("none"==n.stroke||null==T.on||0==n.stroke||0==n["stroke-width"])&&(T.on=!1);var P=t.getRGB(n.stroke);T.on&&n.stroke&&(T.color=P.hex),k=((+o["stroke-opacity"]+1||2)-1)*((+o.opacity+1||2)-1)*((+P.o+1||2)-1);var A=.75*(L(n["stroke-width"])||1);if(k=O(w(k,0),1),null==n["stroke-width"]&&(A=o["stroke-width"]),n["stroke-width"]&&(T.weight=A),A&&A<1&&(k*=A)&&(T.weight=1),T.opacity=k,n["stroke-linejoin"]&&(T.joinstyle=n["stroke-linejoin"]||"miter"),T.miterlimit=n["stroke-miterlimit"]||8,n["stroke-linecap"]&&(T.endcap="butt"==n["stroke-linecap"]?"flat":"square"==n["stroke-linecap"]?"square":"round"),n["stroke-dasharray"]){var R={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};T.dashstyle=R[a](n["stroke-dasharray"])?R[n["stroke-dasharray"]]:g}M&&r.appendChild(T)}if("text"==p.type)switch(c=p.paper.span.style,o.font&&(c.font=o.font),o["font-family"]&&(c.fontFamily=o["font-family"]),o["font-size"]&&(c.fontSize=o["font-size"]),o["font-weight"]&&(c.fontWeight=o["font-weight"]),o["font-style"]&&(c.fontStyle=o["font-style"]),p.node.string&&(p.paper.span.innerHTML=m(p.node.string)[H](/</g,"&#60;")[H](/&/g,"&#38;")[H](/\n/g,"<br>")),p.W=o.w=p.paper.span.offsetWidth,p.H=o.h=p.paper.span.offsetHeight,p.X=o.x,p.Y=o.y+F(p.H/2),o["text-anchor"]){case"start":p.node.style["v-text-align"]="left",p.bbx=F(p.W/2);break;case"end":p.node.style["v-text-align"]="right",p.bbx=-F(p.W/2);break;default:p.node.style["v-text-align"]="center"}},Te=function(e,t){e.attrs=e.attrs||{};e.attrs;var n,s="linear",i=".5 .5";if(e.attrs.gradient=t,t=(t=m(t)[H](Z,(function(e,t,n){return s="radial",t&&n&&(t=L(t),n=L(n),S(t-.5,2)+S(n-.5,2)>.25&&(n=j.sqrt(.25-S(t-.5,2))*(2*(n>.5)-1)+.5),i=t+f+n),g}))).split(/\s*\-\s*/),"linear"==s){var r=t.shift();if(r=-L(r),isNaN(r))return null}var o=be(t);if(!o)return null;if(!(n=(e=e.shape||e.node).getElementsByTagName(N)[0]||We(N)).parentNode&&e.appendChild(n),o[x]){n.on=!0,n.method="none",n.color=o[0].color,n.color2=o[o[x]-1].color;for(var a=[],l=0,c=o[x];l<c;l++)o[l].offset&&a[I](o[l].offset+f+o[l].color);n.colors&&(n.colors.value=a[x]?a.join():"0% "+n.color),"radial"==s?(n.type="gradientradial",n.focus="100%",n.focussize=i,n.focusposition=i):(n.type="gradient",n.angle=(270-r)%360)}return 1},(Ee=(Ie=function(e,n,s){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=n,this.paper=s,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!s.bottom&&(s.bottom=this),this.prev=s.top,s.top&&(s.top.next=this),s.top=this,this.next=null})[o]).rotate=function(e,t,n){return this.removed?this:null==e?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy].join(f):this._.rt.deg:((e=m(e).split(s))[x]-1&&(t=L(e[1]),n=L(e[2])),e=L(e[0]),null!=t?this._.rt.deg=e:this._.rt.deg+=e,null==n&&(t=null),this._.rt.cx=t,this._.rt.cy=n,this.setBox(this.attrs,t,n),this.Group.style.rotation=this._.rt.deg,this)},Ee.setBox=function(e,t,n){if(this.removed)return this;var s=this.Group.style,i=this.shape&&this.shape.style||this.node.style;for(var r in e=e||{})e[a](r)&&(this.attrs[r]=e[r]);t=t||this._.rt.cx,n=n||this._.rt.cy;var o,l,c,h,p=this.attrs;switch(this.type){case"circle":o=p.cx-p.r,l=p.cy-p.r,c=h=2*p.r;break;case"ellipse":o=p.cx-p.rx,l=p.cy-p.ry,c=2*p.rx,h=2*p.ry;break;case"image":o=+p.x,l=+p.y,c=p.width||0,h=p.height||0;break;case"text":this.textpath.v=["m",F(p.x),", ",F(p.y-2),"l",F(p.x)+1,", ",F(p.y-2)].join(g),o=p.x-F(this.W/2),l=p.y-this.H/2,c=this.W,h=this.H;break;case"rect":case"path":if(this.attrs.path){var u=ae(this.attrs.path);o=u.x,l=u.y,c=u.width,h=u.height}else o=0,l=0,c=this.paper.width,h=this.paper.height;break;default:o=0,l=0,c=this.paper.width,h=this.paper.height}n=null==n?l+h/2:n;var d,f=(t=null==t?o+c/2:t)-this.paper.width/2,m=n-this.paper.height/2;s.left!=(d=f+"px")&&(s.left=d),s.top!=(d=m+"px")&&(s.top=d),this.X=Ye[a](this.type)?-f:o,this.Y=Ye[a](this.type)?-m:l,this.W=c,this.H=h,Ye[a](this.type)?(i.left!=(d=-f*$e+"px")&&(i.left=d),i.top!=(d=-m*$e+"px")&&(i.top=d)):"text"==this.type?(i.left!=(d=-f+"px")&&(i.left=d),i.top!=(d=-m+"px")&&(i.top=d)):(s.width!=(d=this.paper.width+"px")&&(s.width=d),s.height!=(d=this.paper.height+"px")&&(s.height=d),i.left!=(d=o-f+"px")&&(i.left=d),i.top!=(d=l-m+"px")&&(i.top=d),i.width!=(d=c+"px")&&(i.width=d),i.height!=(d=h+"px")&&(i.height=d))},Ee.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Ee.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Ee.getBBox=function(){return this.removed?this:Ye[a](this.type)?ae(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Ee.remove=function(){if(!this.removed){for(var e in ye(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape),this)delete this[e];this.removed=!0}},Ee.attr=function(e,n){if(this.removed)return this;if(null==e){var s={};for(var i in this.attrs)this.attrs[a](i)&&(s[i]=this.attrs[i]);return this._.rt.deg&&(s.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(s.scale=this.scale()),s.gradient&&"none"==s.fill&&(s.fill=s.gradient)&&delete s.gradient,s}if(null==n&&t.is(e,"string"))return"translation"==e?bt.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==N&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==n&&t.is(e,M)){var r,o={};for(i=0,r=e[x];i<r;i++)o[e[i]]=this.attr(e[i]);return o}var l;if(null!=n&&((l={})[e]=n),null==n&&t.is(e,"object")&&(l=e),l){for(var c in this.paper.customAttributes)if(this.paper.customAttributes[a](c)&&l[a](c)&&t.is(this.paper.customAttributes[c],"function")){var h=this.paper.customAttributes[c].apply(this,[].concat(l[c]));for(var p in this.attrs[c]=l[c],h)h[a](p)&&(l[p]=h[p])}l.text&&"text"==this.type&&(this.node.string=l.text),Ne(this,l),l.gradient&&({circle:1,ellipse:1}[a](this.type)||"r"!=m(l.gradient).charAt())&&Te(this,l.gradient),(!Ye[a](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Ee.toFront=function(){return!this.removed&&this.Group.parentNode.appendChild(this.Group),this.paper.top!=this&&je(this,this.paper),this},Ee.toBack=function(){return this.removed||this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),we(this,this.paper)),this},Ee.insertAfter=function(e){return this.removed||(e.constructor==yt&&(e=e[e.length-1]),e.Group.nextSibling?e.Group.parentNode.insertBefore(this.Group,e.Group.nextSibling):e.Group.parentNode.appendChild(this.Group),Oe(this,e,this.paper)),this},Ee.insertBefore=function(e){return this.removed||(e.constructor==yt&&(e=e[0]),e.Group.parentNode.insertBefore(this.Group,e.Group),Ce(this,e,this.paper)),this},Ee.blur=function(e){var n=this.node.runtimeStyle,s=n.filter;s=s.replace(He,g),0!==+e?(this.attrs.blur=e,n.filter=s+f+q+".Blur(pixelradius="+(+e||1.5)+")",n.margin=t.format("-{0}px 0 0 -{0}px",F(+e||1.5))):(n.filter=s,n.margin=0,delete this.attrs.blur)},Ae=function(e,t,n,s){var i=We("group"),r=We("oval");r.style;i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=Ge,i.coordorigin=e.coordorigin,i.appendChild(r);var o=new Ie(r,i,e);return o.type="circle",Ne(o,{stroke:"#000",fill:"none"}),o.attrs.cx=t,o.attrs.cy=n,o.attrs.r=s,o.setBox({x:t-s,y:n-s,width:2*s,height:2*s}),e.canvas.appendChild(i),o},Re=function(e,t,n,s,i,r){var o=Ke(t,n,s,i,r),a=e.path(o),l=a.attrs;return a.X=l.x=t,a.Y=l.y=n,a.W=l.width=s,a.H=l.height=i,l.r=r,l.path=o,a.type="rect",a},De=function(e,t,n,s,i){var r=We("group"),o=We("oval");o.style;r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=Ge,r.coordorigin=e.coordorigin,r.appendChild(o);var a=new Ie(o,r,e);return a.type="ellipse",Ne(a,{stroke:"#000"}),a.attrs.cx=t,a.attrs.cy=n,a.attrs.rx=s,a.attrs.ry=i,a.setBox({x:t-s,y:n-i,width:2*s,height:2*i}),e.canvas.appendChild(r),a},Fe=function(e,t,n,s,i,r){var o=We("group"),a=We("image");o.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",o.coordsize=Ge,o.coordorigin=e.coordorigin,a.src=t,o.appendChild(a);var l=new Ie(a,o,e);return l.type="image",l.attrs.src=t,l.attrs.x=n,l.attrs.y=s,l.attrs.w=i,l.attrs.h=r,l.setBox({x:n,y:s,width:i,height:r}),e.canvas.appendChild(o),l},Le=function(e,n,s,i){var r=We("group"),o=We("shape"),a=o.style,l=We("path"),c=(l.style,We("textpath"));r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=Ge,r.coordorigin=e.coordorigin,l.v=t.format("m{0},{1}l{2},{1}",F(10*n),F(10*s),F(10*n)+1),l.textpathok=!0,a.width=e.width,a.height=e.height,c.string=m(i),c.on=!0,o.appendChild(c),o.appendChild(l),r.appendChild(o);var h=new Ie(c,r,e);return h.shape=o,h.textpath=l,h.type="text",h.attrs.text=i,h.attrs.x=n,h.attrs.y=s,h.attrs.w=1,h.attrs.h=1,Ne(h,{font:B.font,stroke:"none",fill:"#000"}),h.setBox(),e.canvas.appendChild(r),h},ze=function(e,t){var n=this.canvas.style;return e==+e&&(e+="px"),t==+t&&(t+="px"),n.width=e,n.height=t,n.clip="rect(0 "+e+" "+t+" 0)",this},l.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!l.namespaces.rvml&&l.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),We=function(e){return l.createElement("<rvml:"+e+' class="rvml">')}}catch(wt){We=function(e){return l.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}qe=function(){var e=ve[u](0,arguments),n=e.container,s=e.height,i=e.width,r=e.x,o=e.y;if(!n)throw new Error("VML container not found.");var a=new p,c=a.canvas=l.createElement("div"),h=c.style;return r=r||0,o=o||0,(i=i||512)==+i&&(i+="px"),(s=s||342)==+s&&(s+="px"),a.width=1e3,a.height=1e3,a.coordsize="10000 10000",a.coordorigin="0 0",a.span=l.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",c.appendChild(a.span),h.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",i,s),1==n?(l.body.appendChild(c),h.left=r+"px",h.top=o+"px",h.position="absolute"):n.firstChild?n.insertBefore(c,n.firstChild):n.appendChild(c),xe.call(a,a,t.fn),a},n.clear=function(){this.canvas.innerHTML=g,this.span=l.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},n.remove=function(){for(var e in this.canvas.parentNode.removeChild(this.canvas),this)this[e]=Se(e);return!0}}var Xe=navigator.userAgent.match(/Version\/(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(Xe&&Xe[1]<4||"iP"==navigator.platform.slice(0,2))?n.safari=function(){var e=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});c.setTimeout((function(){e.remove()}))}:n.safari=function(){};for(var Ze=function(){this.returnValue=!1},Je=function(){return this.originalEvent.preventDefault()},Qe=function(){this.cancelBubble=!0},et=function(){return this.originalEvent.stopPropagation()},tt=l.addEventListener?function(e,t,n,s){var i=d&&v[t]?v[t]:t,r=function(i){if(d&&v[a](t))for(var r=0,o=i.targetTouches&&i.targetTouches.length;r<o;r++)if(i.targetTouches[r].target==e){var l=i;(i=i.targetTouches[r]).originalEvent=l,i.preventDefault=Je,i.stopPropagation=et;break}return n.call(s,i)};return e.addEventListener(i,r,!1),function(){return e.removeEventListener(i,r,!1),!0}}:l.attachEvent?function(e,t,n,s){var i=function(e){return(e=e||c.event).preventDefault=e.preventDefault||Ze,e.stopPropagation=e.stopPropagation||Qe,n.call(s,e)};return e.attachEvent("on"+t,i),function(){return e.detachEvent("on"+t,i),!0}}:void 0,nt=[],st=function(e){for(var t,n=e.clientX,s=e.clientY,i=l.documentElement.scrollTop||l.body.scrollTop,r=l.documentElement.scrollLeft||l.body.scrollLeft,o=nt.length;o--;){if(t=nt[o],d){for(var a,c=e.touches.length;c--;)if((a=e.touches[c]).identifier==t.el._drag.id){n=a.clientX,s=a.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();n+=r,s+=i,t.move&&t.move.call(t.move_scope||t.el,n-t.el._drag.x,s-t.el._drag.y,n,s,e)}},it=function(e){t.unmousemove(st).unmouseup(it);for(var n,s=nt.length;s--;)(n=nt[s]).el._drag={},n.end&&n.end.call(n.end_scope||n.start_scope||n.move_scope||n.el,e);nt=[]},rt=b[x];rt--;)!function(e){t[e]=Ie[o][e]=function(n,s){return t.is(n,"function")&&(this.events=this.events||[],this.events.push({name:e,f:n,unbind:tt(this.shape||this.node||l,e,n,s||this)})),this},t["un"+e]=Ie[o]["un"+e]=function(t){for(var n=this.events,s=n[x];s--;)if(n[s].name==e&&n[s].f==t)return n[s].unbind(),n.splice(s,1),!n.length&&delete this.events,this;return this}}(b[rt]);function ot(){return this.x+f+this.y}Ee.hover=function(e,t,n,s){return this.mouseover(e,n).mouseout(t,s||n)},Ee.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)},Ee.drag=function(e,n,s,i,r,o){return this._drag={},this.mousedown((function(a){(a.originalEvent||a).preventDefault();var c=l.documentElement.scrollTop||l.body.scrollTop,h=l.documentElement.scrollLeft||l.body.scrollLeft;this._drag.x=a.clientX+h,this._drag.y=a.clientY+c,this._drag.id=a.identifier,n&&n.call(r||i||this,a.clientX+h,a.clientY+c,a),!nt.length&&t.mousemove(st).mouseup(it),nt.push({el:this,move:e,end:s,move_scope:i,start_scope:r,end_scope:o})})),this},Ee.undrag=function(e,n,s){for(var i=nt.length;i--;)nt[i].el==this&&nt[i].move==e&&nt[i].end==s&&nt.splice(i++,1);!nt.length&&t.unmousemove(st).unmouseup(it)},n.circle=function(e,t,n){return Ae(this,e||0,t||0,n||0)},n.rect=function(e,t,n,s,i){return Re(this,e||0,t||0,n||0,s||0,i||0)},n.ellipse=function(e,t,n,s){return De(this,e||0,t||0,n||0,s||0)},n.path=function(e){return e&&!t.is(e,T)&&!t.is(e[0],M)&&(e+=g),_e(t.format[u](t,arguments),this)},n.image=function(e,t,n,s,i){return Fe(this,e||"about:blank",t||0,n||0,s||0,i||0)},n.text=function(e,t,n){return Le(this,e||0,t||0,m(n))},n.set=function(e){return arguments[x]>1&&(e=Array[o].splice.call(arguments,0,arguments[x])),new yt(e)},n.setSize=ze,n.top=n.bottom=null,n.raphael=t,Ee.resetScale=function(){if(this.removed)return this;this._.sx=1,this._.sy=1,this.attrs.scale="1 1"},Ee.scale=function(t,n,s,i){if(this.removed)return this;if(null==t&&null==n)return{x:this._.sx,y:this._.sy,toString:ot};!+(n=n||t)&&(n=t);var r,o,a=this.attrs;if(0!=t){var l=this.getBBox(),c=l.x+l.width/2,h=l.y+l.height/2,p=C(t/this._.sx),u=C(n/this._.sy);s=+s||0==s?s:c,i=+i||0==i?i:h;var d=this._.sx>0,m=this._.sy>0,b=~~(t/C(t)),v=~~(n/C(n)),y=p*b,j=u*v,w=this.node.style,O=s+C(c-s)*y*(c>s==d?1:-1),S=i+C(h-i)*j*(h>i==m?1:-1),k=t*b>n*v?u:p;switch(this.type){case"rect":case"image":var _=a.width*p,T=a.height*u;this.attr({height:T,r:a.r*k,width:_,x:O-_/2,y:S-T/2});break;case"circle":case"ellipse":this.attr({rx:a.rx*p,ry:a.ry*u,r:a.r*k,cx:O,cy:S});break;case"text":this.attr({x:O,y:S});break;case"path":for(var M=ce(a.path),N=!0,P=d?y:p,I=m?j:u,E=0,A=M[x];E<A;E++){var R=M[E],D=W.call(R[0]);if("M"!=D||!N)if(N=!1,"A"==D)R[M[E][x]-2]*=P,R[M[E][x]-1]*=I,R[1]*=p,R[2]*=u,R[5]=+(b+v?!!+R[5]:!+R[5]);else if("H"==D)for(var F=1,L=R[x];F<L;F++)R[F]*=P;else if("V"==D)for(F=1,L=R[x];F<L;F++)R[F]*=I;else for(F=1,L=R[x];F<L;F++)R[F]*=F%2?P:I}var z=ae(M);r=O-z.x-z.width/2,o=S-z.y-z.height/2,M[0][1]+=r,M[0][2]+=o,this.attr({path:M})}!(this.type in{text:1,image:1})||1==b&&1==v?this.transformations?(this.transformations[2]=g,e(this.node,"transform",this.transformations.join(f)),a.fx=0,a.fy=0):(this.node.filterMatrix=g,w.filter=(this.node.filterMatrix||g)+(this.node.filterOpacity||g)):this.transformations?(this.transformations[2]="scale(".concat(b,",",v,")"),e(this.node,"transform",this.transformations.join(f)),r=-1==b?-a.x-(_||0):a.x,o=-1==v?-a.y-(T||0):a.y,this.attr({x:r,y:o}),a.fx=b-1,a.fy=v-1):(this.node.filterMatrix=q+".Matrix(M11=".concat(b,", M12=0, M21=0, M22=",v,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),w.filter=(this.node.filterMatrix||g)+(this.node.filterOpacity||g)),a.scale=[t,n,s,i].join(f),this._.sx=t,this._.sy=n}return this},Ee.clone=function(){if(this.removed)return null;var e=this.attr();return delete e.scale,delete e.translation,this.paper[this.type]().attr(e)};var at={},lt=function(e,n,s,i,r,o,a,l,c){if(e===s&&n===i&&r===a&&o==l){var h=a-e,p=l-n,u=Math.sqrt(h*h+p*p);if(null==c)return u;var d=c/u;return{start:{x:e,y:n},m:{x:e,y:n},n:{x:a,y:l},end:{x:a,y:l},x:e+d*h,y:n+d*p,alpha:90-180*j.atan(h/p)/k}}var g,f,m=0,b=100,v=[e,n,s,i,r,o,a,l].join(),x=at[v];(!x&&(at[v]=x={data:[]}),x.timer&&clearTimeout(x.timer),x.timer=setTimeout((function(){delete at[v]}),2e3),null!=c)&&(b=10*~~lt(e,n,s,i,r,o,a,l));for(var y=0;y<b+1;y++){if(x.data[c]>y?f=x.data[y*b]:(f=t.findDotsAtSegment(e,n,s,i,r,o,a,l,y/b),x.data[y]=f),y&&(m+=S(S(g.x-f.x,2)+S(g.y-f.y,2),.5)),null!=c&&m>=c)return f;g=f}if(null==c)return m},ct=function(e,n){return function(s,i,r){for(var o,a,l,c,h,p="",u={},d=0,g=0,f=(s=me(s)).length;g<f;g++){if("M"==(l=s[g])[0])o=+l[1],a=+l[2];else{if(d+(c=lt(o,a,l[1],l[2],l[3],l[4],l[5],l[6]))>i){if(n&&!u.start){if(p+=["C",(h=lt(o,a,l[1],l[2],l[3],l[4],l[5],l[6],i-d)).start.x,h.start.y,h.m.x,h.m.y,h.x,h.y],r)return p;u.start=p,p=["M",h.x,h.y+"C",h.n.x,h.n.y,h.end.x,h.end.y,l[5],l[6]].join(),d+=c,o=+l[5],a=+l[6];continue}if(!e&&!n)return{x:(h=lt(o,a,l[1],l[2],l[3],l[4],l[5],l[6],i-d)).x,y:h.y,alpha:h.alpha}}d+=c,o=+l[5],a=+l[6]}p+=l}return u.end=p,(h=e?d:n?u:t.findDotsAtSegment(o,a,l[1],l[2],l[3],l[4],l[5],l[6],1)).alpha&&(h={x:h.x,y:h.y,alpha:h.alpha}),h}},ht=ct(1),pt=ct(),ut=ct(0,1);Ee.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():ht(this.attrs.path)},Ee.getPointAtLength=function(e){if("path"==this.type)return pt(this.attrs.path,e)},Ee.getSubpath=function(e,t){if("path"==this.type){if(C(this.getTotalLength()-t)<"1e-6")return ut(this.attrs.path,e).end;var n=ut(this.attrs.path,t,1);return e?ut(n,e).end:n}},t.easing_formulas={linear:function(e){return e},"<":function(e){return S(e,3)},">":function(e){return S(e-1,3)+1},"<>":function(e){return(e*=2)<1?S(e,3)/2:(S(e-=2,3)+2)/2},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},elastic:function(e){if(0==e||1==e)return e;return S(2,-10*e)*j.sin(2*k*(e-.075)/.3)+1},bounce:function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375}};var dt=[],gt=function(){for(var e=+new Date,n=0;n<dt[x];n++){var s=dt[n];if(!s.stop&&!s.el.removed){var i,r=e-s.start,o=s.ms,l=s.easing,c=s.from,h=s.diff,p=s.to,u=s.t,d=s.el,m={};if(r<o){var b=l(r/o);for(var v in c)if(c[a](v)){switch(V[v]){case"along":i=b*o*h[v],p.back&&(i=p.len-i);var y=pt(p[v],i);d.translate(h.sx-h.x||0,h.sy-h.y||0),h.x=y.x,h.y=y.y,d.translate(y.x-h.sx,y.y-h.sy),p.rot&&d.rotate(h.r+y.alpha,y.x,y.y);break;case _:i=+c[v]+b*o*h[v];break;case"colour":i="rgb("+[mt(F(c[v].r+b*o*h[v].r)),mt(F(c[v].g+b*o*h[v].g)),mt(F(c[v].b+b*o*h[v].b))].join(",")+")";break;case"path":i=[];for(var j=0,w=c[v][x];j<w;j++){i[j]=[c[v][j][0]];for(var O=1,C=c[v][j][x];O<C;O++)i[j][O]=+c[v][j][O]+b*o*h[v][j][O];i[j]=i[j].join(f)}i=i.join(f);break;case"csv":switch(v){case"translation":var S=b*o*h[v][0]-u.x,k=b*o*h[v][1]-u.y;u.x+=S,u.y+=k,i=S+f+k;break;case"rotation":i=+c[v][0]+b*o*h[v][0],c[v][1]&&(i+=","+c[v][1]+","+c[v][2]);break;case"scale":i=[+c[v][0]+b*o*h[v][0],+c[v][1]+b*o*h[v][1],2 in p[v]?p[v][2]:g,3 in p[v]?p[v][3]:g].join(f);break;case"clip-rect":for(i=[],j=4;j--;)i[j]=+c[v][j]+b*o*h[v][j]}break;default:var T=[].concat(c[v]);for(i=[],j=d.paper.customAttributes[v].length;j--;)i[j]=+T[j]+b*o*h[v][j]}m[v]=i}d.attr(m),d._run&&d._run.call(d)}else p.along&&(y=pt(p.along,p.len*!p.back),d.translate(h.sx-(h.x||0)+y.x-h.sx,h.sy-(h.y||0)+y.y-h.sy),p.rot&&d.rotate(h.r+y.alpha,y.x,y.y)),(u.x||u.y)&&d.translate(-u.x,-u.y),p.scale&&(p.scale+=g),d.attr(p),dt.splice(n--,1)}}t.svg&&d&&d.paper&&d.paper.safari(),dt[x]&&setTimeout(gt)},ft=function(e,n,s,i,r){var o=s-i;n.timeouts.push(setTimeout((function(){t.is(r,"function")&&r.call(n),n.animate(e,o,e.easing)}),i))},mt=function(e){return w(O(e,255),0)},bt=function(e,t){if(null==e)return{x:this._.tx,y:this._.ty,toString:ot};switch(this._.tx+=+e,this._.ty+=+t,this.type){case"circle":case"ellipse":this.attr({cx:+e+this.attrs.cx,cy:+t+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+e+this.attrs.x,y:+t+this.attrs.y});break;case"path":var n=ce(this.attrs.path);n[0][1]+=+e,n[0][2]+=+t,this.attr({path:n})}return this};function vt(e){return function(n,s,i,r){var o={back:e};return t.is(i,"function")?r=i:o.rot=i,n&&n.constructor==Ie&&(n=n.attrs.path),n&&(o.along=n),this.animate(o,s,r)}}function xt(e,t,n,s,i,r){var o=3*t,a=3*(s-t)-o,l=1-o-a,c=3*n,h=3*(i-n)-c,p=1-c-h;function u(e){return((l*e+a)*e+o)*e}return function(e,t){var n=function(e,t){var n,s,i,r,c,h;for(i=e,h=0;h<8;h++){if(r=u(i)-e,C(r)<t)return i;if(C(c=(3*l*i+2*a)*i+o)<1e-6)break;i-=r/c}if(s=1,(i=e)<(n=0))return n;if(i>s)return s;for(;n<s;){if(r=u(i),C(r-e)<t)return i;e>r?n=i:s=i,i=(s-n)/2+n}return i}(e,t);return((p*n+h)*n+c)*n}(e,1/(200*r))}Ee.animateWith=function(e,t,n,s,i){for(var r=0,o=dt.length;r<o;r++)dt[r].el.id==e.id&&(t.start=dt[r].start);return this.animate(t,n,s,i)},Ee.animateAlong=vt(),Ee.animateAlongBack=vt(1),Ee.onAnimation=function(e){return this._run=e||0,this},Ee.animate=function(e,n,i,r){var o=this;if(o.timeouts=o.timeouts||[],!t.is(i,"function")&&i||(r=i||null),o.removed)return r&&r.call(o),o;var l={},c={},h=!1,p={};for(var u in e)if(e[a](u)&&(V[a](u)||o.paper.customAttributes[a](u)))switch(h=!0,l[u]=o.attr(u),null==l[u]&&(l[u]=B[u]),c[u]=e[u],V[u]){case"along":var d=ht(e[u]),g=pt(e[u],d*!!e.back),f=o.getBBox();p[u]=d/n,p.tx=f.x,p.ty=f.y,p.sx=g.x,p.sy=g.y,c.rot=e.rot,c.back=e.back,c.len=d,e.rot&&(p.r=L(o.rotate())||0);break;case _:p[u]=(c[u]-l[u])/n;break;case"colour":l[u]=t.getRGB(l[u]);var b=t.getRGB(c[u]);p[u]={r:(b.r-l[u].r)/n,g:(b.g-l[u].g)/n,b:(b.b-l[u].b)/n};break;case"path":var v=me(l[u],c[u]);l[u]=v[0];var y=v[1];p[u]=[];for(var j=0,w=l[u][x];j<w;j++){p[u][j]=[0];for(var O=1,C=l[u][j][x];O<C;O++)p[u][j][O]=(y[j][O]-l[u][j][O])/n}break;case"csv":var S=m(e[u]).split(s),k=m(l[u]).split(s);switch(u){case"translation":l[u]=[0,0],p[u]=[S[0]/n,S[1]/n];break;case"rotation":l[u]=k[1]==S[1]&&k[2]==S[2]?k:[0,S[1],S[2]],p[u]=[(S[0]-l[u][0])/n,0,0];break;case"scale":e[u]=S,l[u]=m(l[u]).split(s),p[u]=[(S[0]-l[u][0])/n,(S[1]-l[u][1])/n,0,0];break;case"clip-rect":for(l[u]=m(l[u]).split(s),p[u]=[],j=4;j--;)p[u][j]=(S[j]-l[u][j])/n}c[u]=S;break;default:for(S=[].concat(e[u]),k=[].concat(l[u]),p[u]=[],j=o.paper.customAttributes[u][x];j--;)p[u][j]=((S[j]||0)-(k[j]||0))/n}if(h){var T=t.easing_formulas[i];if(!T)if((T=m(i).match(D))&&5==T[x]){var M=T;T=function(e){return xt(e,+M[1],+M[2],+M[3],+M[4],n)}}else T=function(e){return e};dt.push({start:e.start||+new Date,ms:n,easing:T,from:l,diff:p,to:c,el:o,t:{x:0,y:0}}),t.is(r,"function")&&(o._ac=setTimeout((function(){r.call(o)}),n)),1==dt[x]&&setTimeout(gt)}else{var N,P=[];for(var I in e)e[a](I)&&U.test(I)&&(u={value:e[I]},"from"==I&&(I=0),"to"==I&&(I=100),u.key=z(I,10),P.push(u));for(P.sort(J),P[0].key&&P.unshift({key:0,value:o.attrs}),j=0,w=P[x];j<w;j++)ft(P[j].value,o,n/100*P[j].key,n/100*(P[j-1]&&P[j-1].key||0),P[j-1]&&P[j-1].value.callback);(N=P[P[x]-1].value.callback)&&o.timeouts.push(setTimeout((function(){N.call(o)}),n))}return this},Ee.stop=function(){for(var e=0;e<dt.length;e++)dt[e].el.id==this.id&&dt.splice(e--,1);for(e=0,ii=this.timeouts&&this.timeouts.length;e<ii;e++)clearTimeout(this.timeouts[e]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Ee.translate=function(e,t){return this.attr({translation:e+" "+t})},Ee.toString=function(){return"Rapha\xebl\u2019s object"},t.ae=dt;var yt=function(e){if(this.items=[],this[x]=0,this.type="set",e)for(var t=0,n=e[x];t<n;t++)!e[t]||e[t].constructor!=Ie&&e[t].constructor!=yt||(this[this.items[x]]=this.items[this.items[x]]=e[t],this[x]++)};for(var jt in yt[o][I]=function(){for(var e,t,n=0,s=arguments[x];n<s;n++)!(e=arguments[n])||e.constructor!=Ie&&e.constructor!=yt||(this[t=this.items[x]]=this.items[t]=e,this[x]++);return this},yt[o].pop=function(){return delete this[this[x]--],this.items.pop()},Ee)Ee[a](jt)&&(yt[o][jt]=function(e){return function(){for(var t=0,n=this.items[x];t<n;t++)this.items[t][e][u](this.items[t],arguments);return this}}(jt));yt[o].attr=function(e,n){if(e&&t.is(e,M)&&t.is(e[0],"object"))for(var s=0,i=e[x];s<i;s++)this.items[s].attr(e[s]);else for(var r=0,o=this.items[x];r<o;r++)this.items[r].attr(e,n);return this},yt[o].animate=function(e,n,s,i){(t.is(s,"function")||!s)&&(i=s||null);var r,o,a=this.items[x],l=a,c=this;for(i&&(o=function(){!--a&&i.call(c)}),s=t.is(s,T)?s:o,r=this.items[--l].animate(e,n,s,o);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(r,e,n,s,o);return this},yt[o].insertAfter=function(e){for(var t=this.items[x];t--;)this.items[t].insertAfter(e);return this},yt[o].getBBox=function(){for(var e=[],t=[],n=[],s=[],i=this.items[x];i--;){var r=this.items[i].getBBox();e[I](r.x),t[I](r.y),n[I](r.x+r.width),s[I](r.y+r.height)}return{x:e=O[u](0,e),y:t=O[u](0,t),width:w[u](0,n)-e,height:w[u](0,s)-t}},yt[o].clone=function(e){e=new yt;for(var t=0,n=this.items[x];t<n;t++)e[I](this.items[t].clone());return e},t.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},n=e.face["font-family"];for(var s in e.face)e.face[a](s)&&(t.face[s]=e.face[s]);if(this.fonts[n]?this.fonts[n][I](t):this.fonts[n]=[t],!e.svg)for(var i in t.face["units-per-em"]=z(e.face["units-per-em"],10),e.glyphs)if(e.glyphs[a](i)){var r=e.glyphs[i];if(t.glyphs[i]={w:r.w,k:{},d:r.d&&"M"+r.d[H](/[mlcxtrv]/g,(function(e){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[e]||"M"}))+"z"},r.k)for(var o in r.k)r[a](o)&&(t.glyphs[i].k[o]=r.k[o])}return e},n.getFont=function(e,n,s,i){if(i=i||"normal",s=s||"normal",n=+n||{normal:400,bold:700,lighter:300,bolder:800}[n]||400,t.fonts){var r,o=t.fonts[e];if(!o){var l=new RegExp("(^|\\s)"+e[H](/[^\w\d\s+!~.:_-]/g,g)+"(\\s|$)","i");for(var c in t.fonts)if(t.fonts[a](c)&&l.test(c)){o=t.fonts[c];break}}if(o)for(var h=0,p=o[x];h<p&&((r=o[h]).face["font-weight"]!=n||r.face["font-style"]!=s&&r.face["font-style"]||r.face["font-stretch"]!=i);h++);return r}},n.print=function(e,n,i,r,o,a,l){a=a||"middle",l=w(O(l||0,1),-1);var c,h=this.set(),p=m(i).split(g),u=0;if(t.is(r,i)&&(r=this.getFont(r)),r){c=(o||16)/r.face["units-per-em"];for(var d=r.face.bbox.split(s),f=+d[0],b=+d[1]+("baseline"==a?d[3]-d[1]+ +r.face.descent:(d[3]-d[1])/2),v=0,y=p[x];v<y;v++){var j=v&&r.glyphs[p[v-1]]||{},C=r.glyphs[p[v]];u+=v?(j.w||r.w)+(j.k&&j.k[p[v]]||0)+r.w*l:0,C&&C.d&&h[I](this.path(C.d).attr({fill:"#000",stroke:"none",translation:[u,0]}))}h.scale(c,c,f,b).translate(e-f,n-b)}return h},t.format=function(e,n){var s=t.is(n,M)?[0].concat(n):arguments;return e&&t.is(e,T)&&s[x]-1&&(e=e[H](r,(function(e,t){return null==s[++t]?g:s[t]}))),e||g},t.ninja=function(){return h.was?c.Raphael=h.is:delete c.Raphael,t},t.el=Ee,t.st=yt[o],h.was?c.Raphael=t:Raphael=t}()},170:function(e,t){!function(e,t,n,s){var i="virtualMouseBindings",r="virtualTouchID",o="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),a="clientX clientY pageX pageY screenX screenY".split(" "),l=e.event.mouseHooks?e.event.mouseHooks.props:[],c=e.event.props.concat(l),h={},p=0,u=0,d=0,g=!1,f=[],m=!1,b=!1,v="addEventListener"in n,x=e(n),y=1,j=0;function w(e){for(;e&&"undefined"!==typeof e.originalEvent;)e=e.originalEvent;return e}function O(t){for(var n,s,r={};t;){for(s in n=e.data(t,i))n[s]&&(r[s]=r.hasVirtualBinding=!0);t=t.parentNode}return r}function C(){b=!0}function S(){b=!1}function k(){_(),p=setTimeout((function(){p=0,j=0,f.length=0,m=!1,C()}),e.vmouse.resetTimerDuration)}function _(){p&&(clearTimeout(p),p=0)}function T(t,n,s){var r;return(s&&s[t]||!s&&function(t,n){for(var s;t;){if((s=e.data(t,i))&&(!n||s[n]))return t;t=t.parentNode}return null}(n.target,t))&&(r=function(t,n){var s,i,r,o,l,h,p,u,d=t.type;if((t=e.Event(t)).type=n,s=t.originalEvent,i=e.event.props,d.search(/mouse/)>-1&&(i=c),s)for(p=i.length;p;)t[o=i[--p]]=s[o];if(d.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==d.search(/^touch/)&&(d=(r=w(s)).touches,l=r.changedTouches,h=d&&d.length?d[0]:l&&l.length?l[0]:void 0))for(u=0,len=a.length;u<len;u++)t[o=a[u]]=h[o];return t}(n,t),e(n.target).trigger(r)),r}function M(t){var n=e.data(t.target,r);if(!m&&(!j||j!==n)){var s=T("v"+t.type,t);s&&(s.isDefaultPrevented()&&t.preventDefault(),s.isPropagationStopped()&&t.stopPropagation(),s.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}}function N(t){var n,s,i=w(t).touches;if(i&&1===i.length&&(s=O(n=t.target)).hasVirtualBinding){j=y++,e.data(n,r,j),_(),S(),g=!1;var o=w(t).touches[0];u=o.pageX,d=o.pageY,T("vmouseover",t,s),T("vmousedown",t,s)}}function P(e){b||(g||T("vmousecancel",e,O(e.target)),g=!0,k())}function I(t){if(!b){var n=w(t).touches[0],s=g,i=e.vmouse.moveDistanceThreshold;g=g||Math.abs(n.pageX-u)>i||Math.abs(n.pageY-d)>i,flags=O(t.target),g&&!s&&T("vmousecancel",t,flags),T("vmousemove",t,flags),k()}}function E(e){if(!b){C();var t,n=O(e.target);if(T("vmouseup",e,n),!g){var s=T("vclick",e,n);s&&s.isDefaultPrevented()&&(t=w(e).changedTouches[0],f.push({touchID:j,x:t.clientX,y:t.clientY}),m=!0)}T("vmouseout",e,n),g=!1,k()}}function A(t){var n,s=e.data(t,i);if(s)for(n in s)if(s[n])return!0;return!1}function R(){}function D(t){var n=t.substr(1);return{setup:function(s,r){A(this)||e.data(this,i,{}),e.data(this,i)[t]=!0,h[t]=(h[t]||0)+1,1===h[t]&&x.bind(n,M),e(this).bind(n,R),v&&(h.touchstart=(h.touchstart||0)+1,1===h.touchstart&&x.bind("touchstart",N).bind("touchend",E).bind("touchmove",I).bind("scroll",P))},teardown:function(s,r){--h[t],h[t]||x.unbind(n,M),v&&(--h.touchstart,h.touchstart||x.unbind("touchstart",N).unbind("touchmove",I).unbind("touchend",E).unbind("scroll",P));var o=e(this),a=e.data(this,i);a&&(a[t]=!1),o.unbind(n,R),A(this)||o.removeData(i)}}}e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var F=0;F<o.length;F++)e.event.special[o[F]]=D(o[F]);v&&n.addEventListener("click",(function(t){var n,s,i,o,a,l=f.length,c=t.target;if(l)for(n=t.clientX,s=t.clientY,threshold=e.vmouse.clickDistanceThreshold,i=c;i;){for(o=0;o<l;o++)if(a=f[o],0,i===c&&Math.abs(a.x-n)<threshold&&Math.abs(a.y-s)<threshold||e.data(i,r)===a.touchID)return t.preventDefault(),void t.stopPropagation();i=i.parentNode}}),!0)}(jQuery,window,document)},267:function(e,t,n){},268:function(e,t,n){"use strict";n.r(t);var s=n(5),i=n.n(s),r=n(58),o=n.n(r),a=n(4),l=n.n(a),c=n(1),h=n.n(c),p=n(17),u=n.n(p),d=n(21),g=n.n(d),f=n(38),m=n.n(f),b=n(9),v=n.n(b),x=n(2),y=function(e){return 1!=e},j={accents:y,af:y,ar:function(e){return 0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11&&e%100<=99?4:5},az:y,bg:y,bn:y,boxes:y,ca:y,cs:function(e){return 1==e?0:e>=2&&e<=4?1:2},da:y,de:y,el:y,empty:y,en:y,"en-pt":y,es:y,fa:function(e){return 0},"fa-af":function(e){return 0},fi:y,fr:function(e){return e>1},he:y,hi:y,hu:y,hy:y,id:function(e){return 0},it:y,ja:function(e){return 0},ko:function(e){return 0},lol:y,mn:y,ms:function(e){return 0},nb:y,nl:y,pl:function(e){return 1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},pt:y,"pt-pt":y,ro:function(e){return 1==e?0:0==e||e%100>0&&e%100<20?1:2},ru:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},"si-LK":y,sk:function(e){return 1==e?0:e>=2&&e<=4?1:2},sr:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},"sv-SE":y,sw:y,te:y,th:function(e){return 0},tr:function(e){return 0},uk:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},ur:y,vi:function(e){return 0},xh:y,"zh-hans":function(e){return 0},"zh-hant":function(e){return 0},zu:y},w=/%\(([\w_]+)\)s/g,O=function(e,t){t=t||{};for(var n,s=e.split(w),i={text_0:s[0]},r=1;r<s.length;r+=2){var o=s[r],a=t[o];void 0===a&&(a="%("+o+")s");for(var l=0;l+"_"+o in i;)l++;i[l+"_"+o]=a,i["text_"+(r+1)]=s[r+1]}return n=i,React.createElement(React.Fragment,null,Object.keys(n).map((e=>React.createElement(React.Fragment,{key:e},n[e]))))},C=function(e,t){return"object"===typeof e&&e.messages&&(e=e.messages[0]),t=t||{},e.replace(w,(function(e,n){var s=t[n];return void 0===s?e:s}))};var S=function(e,t){var n=(j[t]||j.en)(e);return!0===n?1:n||0},k=C;window.i18n={_:C,ngettext:function(e,t,n,s){var i,r;"object"===typeof e?(i=e.lang,r=e.messages,s=n,n=t):(i="en",r=[e,t]);var o=S(n,i),a="";return o<r.length&&(a=r[o]),(s=s||{}).num=s.num||n,C(a,s)},i18nDoNotTranslate:k,ngetpos:S};window.$_=function(e,t){return 2!==arguments.length||"string"!==typeof t?"<$_> must have exactly one child, which must be a string":O(t,e)},window.$i18nDoNotTranslate=function(e,t){return t};var T=n(74),M=n.n(T);window.createReactClass=u.a,window.PropTypes=g.a,window.ReactDOMtags={span:e=>h.a.createElement("span",e),input:e=>h.a.createElement("input",e)},window.jQuery=window.$=l.a,window.katex=m.a,window.MathQuill=M.a,window.classnames=v.a,window._=x.b,window.Raphael=void 0;const N=o.a;window.React=h.a,window.ReactDOM=i.a,window.underscore=window._,window.react=window.React,window["react-dom"]=window.ReactDOM,window.classnames=window.classNames,window.jquery=window.jQuery,window["react-addons-pure-render-mixin"]=N,window.icu={getDecimalFormatSymbols:function(){return{decimal_separator:".",grouping_separator:",",minus:"-"}}},window.KhanUtil={debugLog:function(){},localeToFixed:function(e,t){return e.toFixed(t)}},window.Exercises={localMode:!0,useKatex:!0,khanExercisesUrlBase:"../",getCurrentFramework:function(){return"khan-exercises"},PerseusBridge:{cleanupProblem:function(){return!1}}},window.Khan={Util:window.KhanUtil,error:function(){},query:{debug:""},imageBase:"/images/"};n(131),n(132),n(133),n(134);var P={exports:{}};P.exports;const I={type:"hint"},E=e=>({type:"array",elementShape:e}),A=E(I);P.exports={content:{type:"content"},hint:I,hints:A,tags:{type:"tags"},arrayOf:E,shape:e=>({type:"object",shape:e})};var R=P.exports;function D(e){if("content"===e.type)return PropTypes.shape({__type:PropTypes.oneOf(["content","item"]).isRequired,content:PropTypes.string,images:PropTypes.objectOf(PropTypes.any),widgets:PropTypes.objectOf(PropTypes.any)});if("hint"===e.type)return PropTypes.shape({__type:PropTypes.oneOf(["hint"]).isRequired,content:PropTypes.string,images:PropTypes.objectOf(PropTypes.any),widgets:PropTypes.objectOf(PropTypes.any),replace:PropTypes.bool});if("tags"===e.type)return PropTypes.arrayOf(PropTypes.string.isRequired);if("array"===e.type){const t=D(e.elementShape);return PropTypes.arrayOf(t.isRequired)}if("object"===e.type){const t=e.shape,n={};return Object.keys(t).forEach((e=>{n[e]=D(t[e]).isRequired})),PropTypes.shape(n)}throw new Error(`unexpected shape type ${e.type}`)}const F=/^web\+graphie\:/;function L(e){return F.test(e)}function z(e){const t="http:"===window.location.protocol?"http:":"https:";return e.replace(F,t)}function q(e){return z(e)+".svg"}function W(e){return z(e)+"-data.json"}const B=/\/(?=[^/]+$)/;function V(e){return L(e)?q(e):e}const H={};!function(e){var t=function(){var e=function(e,t,n,s){for(n=n||{},s=e.length;s--;n[e[s]]=t);return n},t=[1,7],n=[1,17],s=[1,13],i=[1,14],r=[1,15],o=[1,32],a=[1,22],l=[1,23],c=[1,24],h=[1,25],p=[1,26],u=[1,33],d=[1,27],g=[1,28],f=[1,29],m=[1,30],b=[1,20],v=[1,36],x=[1,37],y=[5,6,8,10,33,35,41,43,45],j=[1,39],w=[1,40],O=[5,6,8,10,12,14,16,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],C=[10,16,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],S=[5,6,8,10,12,14,16,18,19,21,22,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],k={trace:function(){},yy:{},symbols_:{error:2,equation:3,expression:4,SIGN:5,EOF:6,additive:7,"+":8,multiplicative:9,"-":10,triglog:11,"*":12,negative:13,"/":14,trig:15,TRIG:16,trigfunc:17,"^":18,TRIGINV:19,logbase:20,ln:21,log:22,_:23,subscriptable:24,power:25,primitive:26,variable:27,VAR:28,CONST:29,INT:30,FLOAT:31,"{":32,"}":33,"(":34,")":35,function:36,FUNC:37,invocation:38,sqrt:39,"[":40,"]":41,abs:42,"|":43,"LEFT|":44,"RIGHT|":45,FRAC:46,$accept:0,$end:1},terminals_:{2:"error",5:"SIGN",6:"EOF",8:"+",10:"-",12:"*",14:"/",16:"TRIG",18:"^",19:"TRIGINV",21:"ln",22:"log",23:"_",28:"VAR",29:"CONST",30:"INT",31:"FLOAT",32:"{",33:"}",34:"(",35:")",37:"FUNC",39:"sqrt",40:"[",41:"]",42:"abs",43:"|",44:"LEFT|",45:"RIGHT|",46:"FRAC"},productions_:[0,[3,4],[3,2],[3,1],[4,1],[7,3],[7,3],[7,1],[9,2],[9,3],[9,3],[9,1],[13,2],[13,1],[15,1],[17,1],[17,3],[17,1],[20,1],[20,1],[20,3],[11,2],[11,2],[11,1],[25,3],[25,1],[27,1],[24,3],[24,1],[24,1],[24,1],[24,1],[24,3],[24,3],[36,1],[38,4],[38,4],[38,7],[38,4],[38,3],[38,3],[38,4],[26,1],[26,1],[26,7]],performAction:function(e,t,n,s,i,r,o){var a=r.length-1;switch(i){case 1:return new s.Eq(r[a-3],r[a-2],r[a-1]);case 2:return r[a-1];case 3:return new s.Add([]);case 4:case 7:case 11:case 13:case 15:case 20:case 23:case 25:case 42:case 43:this.$=r[a];break;case 5:this.$=s.Add.createOrAppend(r[a-2],r[a]);break;case 6:this.$=s.Add.createOrAppend(r[a-2],s.Mul.handleNegative(r[a],"subtract"));break;case 8:this.$=s.Mul.fold(s.Mul.createOrAppend(r[a-1],r[a]));break;case 9:this.$=s.Mul.fold(s.Mul.createOrAppend(r[a-2],r[a]));break;case 10:this.$=s.Mul.fold(s.Mul.handleDivide(r[a-2],r[a]));break;case 12:this.$=s.Mul.handleNegative(r[a]);break;case 14:case 17:this.$=[e];break;case 16:this.$=r[a-2].concat(r[a]);break;case 18:this.$=s.Log.natural();break;case 19:this.$=s.Log.common();break;case 21:this.$=s.Trig.create(r[a-1],r[a]);break;case 22:this.$=s.Log.create(r[a-1],r[a]);break;case 24:this.$=new s.Pow(r[a-2],r[a]);break;case 26:case 34:this.$=e;break;case 27:this.$=new s.Var(r[a-2],r[a]);break;case 28:this.$=new s.Var(r[a]);break;case 29:this.$=new s.Const(e.toLowerCase());break;case 30:this.$=s.Int.create(Number(e));break;case 31:this.$=s.Float.create(Number(e));break;case 32:this.$=r[a-1].completeParse();break;case 33:this.$=r[a-1].completeParse().addHint("parens");break;case 35:case 36:this.$=s.Pow.sqrt(r[a-1]);break;case 37:this.$=new s.Pow.nthroot(r[a-1],r[a-4]);break;case 38:case 39:case 40:this.$=new s.Abs(r[a-1]);break;case 41:this.$=new s.Func(r[a-3],r[a-1]);break;case 44:this.$=s.Mul.handleDivide(r[a-4],r[a-1])}},table:[{3:1,4:2,6:[1,3],7:4,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{1:[3]},{5:[1,34],6:[1,35]},{1:[2,3]},e([5,6],[2,4],{8:v,10:x}),e(y,[2,7],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:j,14:w,16:n,19:s,21:i,22:r,28:o,29:a,30:l,31:c,32:h,34:p,37:u,39:d,42:g,44:m,46:b}),e(O,[2,11]),{10:t,11:8,13:41,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,13]),{10:t,11:8,13:42,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{10:t,11:8,13:43,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,23]),e(C,[2,15],{18:[1,44]}),e(C,[2,17]),e(C,[2,18]),e(C,[2,19],{23:[1,45]}),e(O,[2,25],{18:[1,46]}),e([10,16,18,19,21,22,28,29,30,31,32,34,37,39,42,43,44,46],[2,14]),e(S,[2,42]),e(S,[2,43]),{32:[1,47]},e(S,[2,28],{23:[1,48]}),e(S,[2,29]),e(S,[2,30]),e(S,[2,31]),{7:49,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:50,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{32:[1,52],34:[1,51],40:[1,53]},{34:[1,54]},{7:55,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:56,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{34:[1,57]},e([5,6,8,10,12,14,16,18,19,21,22,23,28,29,30,31,32,33,34,35,37,39,41,42,43,44,45,46],[2,26]),{34:[2,34]},{4:58,7:4,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{1:[2,2]},{9:59,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{9:60,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,8]),{10:t,11:8,13:61,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{10:t,11:8,13:62,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},e(O,[2,12]),e(O,[2,21]),e(O,[2,22]),{10:t,11:8,13:63,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{24:64,27:21,28:o,29:a,30:l,31:c,32:h,34:p},{10:t,11:8,13:65,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:66,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{24:67,27:21,28:o,29:a,30:l,31:c,32:h,34:p},{8:v,10:x,33:[1,68]},{8:v,10:x,35:[1,69]},{7:70,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:71,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:72,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:73,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{8:v,10:x,43:[1,74]},{8:v,10:x,45:[1,75]},{7:76,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{6:[1,77]},e(y,[2,5],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:j,14:w,16:n,19:s,21:i,22:r,28:o,29:a,30:l,31:c,32:h,34:p,37:u,39:d,42:g,44:m,46:b}),e(y,[2,6],{17:9,20:10,25:11,15:12,26:16,24:18,38:19,27:21,36:31,11:38,12:j,14:w,16:n,19:s,21:i,22:r,28:o,29:a,30:l,31:c,32:h,34:p,37:u,39:d,42:g,44:m,46:b}),e(O,[2,9]),e(O,[2,10]),e(C,[2,16]),e(C,[2,20]),e(O,[2,24]),{8:v,10:x,33:[1,78]},e(S,[2,27]),e(S,[2,32]),e(S,[2,33]),{8:v,10:x,35:[1,79]},{8:v,10:x,33:[1,80]},{8:v,10:x,41:[1,81]},{8:v,10:x,35:[1,82]},e(S,[2,39]),e(S,[2,40]),{8:v,10:x,35:[1,83]},{1:[2,1]},{32:[1,84]},e(S,[2,35]),e(S,[2,36]),{32:[1,85]},e(S,[2,38]),e(S,[2,41]),{7:86,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{7:87,9:5,10:t,11:8,13:6,15:12,16:n,17:9,19:s,20:10,21:i,22:r,24:18,25:11,26:16,27:21,28:o,29:a,30:l,31:c,32:h,34:p,36:31,37:u,38:19,39:d,42:g,43:f,44:m,46:b},{8:v,10:x,33:[1,88]},{8:v,10:x,33:[1,89]},e(S,[2,44]),e(S,[2,37])],defaultActions:{3:[2,3],33:[2,34],35:[2,2],77:[2,1]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],s=[null],i=[],r=this.table,o="",a=0,l=0,c=0,h=2,p=1,u=i.slice.call(arguments,1),d=Object.create(this.lexer),g={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(g.yy[f]=this.yy[f]);d.setInput(e,g.yy),g.yy.lexer=d,g.yy.parser=this,"undefined"==typeof d.yylloc&&(d.yylloc={});var m=d.yylloc;i.push(m);var b=d.options&&d.options.ranges;function v(){var e;return"number"!==typeof(e=d.lex()||p)&&(e=t.symbols_[e]||e),e}"function"===typeof g.yy.parseError?this.parseError=g.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var x,y,j,w,O,C,S,k,_,T={};;){if(j=n[n.length-1],this.defaultActions[j]?w=this.defaultActions[j]:(null!==x&&"undefined"!=typeof x||(x=v()),w=r[j]&&r[j][x]),"undefined"===typeof w||!w.length||!w[0]){var M="";for(C in _=[],r[j])this.terminals_[C]&&C>h&&_.push("'"+this.terminals_[C]+"'");M=d.showPosition?"Parse error on line "+(a+1)+":\n"+d.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[x]||x)+"'":"Parse error on line "+(a+1)+": Unexpected "+(x==p?"end of input":"'"+(this.terminals_[x]||x)+"'"),this.parseError(M,{text:d.match,token:this.terminals_[x]||x,line:d.yylineno,loc:m,expected:_})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+j+", token: "+x);switch(w[0]){case 1:n.push(x),s.push(d.yytext),i.push(d.yylloc),n.push(w[1]),x=null,y?(x=y,y=null):(l=d.yyleng,o=d.yytext,a=d.yylineno,m=d.yylloc,c>0&&c--);break;case 2:if(S=this.productions_[w[1]][1],T.$=s[s.length-S],T._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},b&&(T._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),"undefined"!==typeof(O=this.performAction.apply(T,[o,l,a,g.yy,w[1],s,i].concat(u))))return O;S&&(n=n.slice(0,-1*S*2),s=s.slice(0,-1*S),i=i.slice(0,-1*S)),n.push(this.productions_[w[1]][0]),s.push(T.$),i.push(T._$),k=r[n[n.length-2]][n[n.length-1]],n.push(k);break;case 3:return!0}}return!0}},_=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===s.length?this.yylloc.first_column:0)+s[s.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,s,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(s=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var r in i)this[r]=i[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),r=0;r<i.length;r++)if((n=this._input.match(this.rules[i[r]]))&&(!t||n[0].length>t[0].length)){if(t=n,s=r,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[r])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[s]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{flex:!0},performAction:function(e,t,n,s){switch(n){case 0:case 1:case 2:break;case 3:return"INT";case 4:return"FLOAT";case 5:case 15:return"^";case 6:case 7:case 8:case 9:return"*";case 10:case 11:return"/";case 12:case 13:return"-";case 14:return"+";case 16:case 18:return"(";case 17:case 19:return")";case 20:return"[";case 21:return"]";case 22:case 24:return"{";case 23:case 25:return"}";case 26:return"_";case 27:return"|";case 28:return"LEFT|";case 29:return"RIGHT|";case 30:return"!";case 31:return"SIGN";case 32:case 34:case 40:return t.yytext="<=","SIGN";case 33:case 35:case 41:return t.yytext=">=","SIGN";case 36:case 37:case 38:case 39:return t.yytext="<>","SIGN";case 42:case 43:return"FRAC";case 44:return"sqrt";case 45:return"abs";case 46:return"ln";case 47:return"log";case 48:case 49:case 50:case 51:return"TRIG";case 52:return t.yytext="sin","TRIG";case 53:return t.yytext="cos","TRIG";case 54:return t.yytext="tan","TRIG";case 55:return t.yytext="csc","TRIG";case 56:return t.yytext="sec","TRIG";case 57:return t.yytext="cot","TRIG";case 58:return t.yytext="arcsin","TRIG";case 59:return t.yytext="arccos","TRIG";case 60:return t.yytext="arctan","TRIG";case 61:return t.yytext="arccsc","TRIG";case 62:return t.yytext="arcsec","TRIG";case 63:return t.yytext="arccot","TRIG";case 64:case 65:return"TRIGINV";case 66:return t.yytext="sinh","TRIG";case 67:return t.yytext="cosh","TRIG";case 68:case 71:return t.yytext="tanh","TRIG";case 69:return t.yytext="csch","TRIG";case 70:return t.yytext="sech","TRIG";case 72:return"CONST";case 73:case 74:return t.yytext="pi","CONST";case 75:case 78:return"VAR";case 76:case 77:return t.yytext="theta","VAR";case 79:case 80:return t.yytext="phi","VAR";case 81:return e.symbolLexer(t.yytext);case 82:return"EOF";case 83:return"INVALID";case 84:console.log(t.yytext)}},rules:[/^(?:\s+)/,/^(?:\\space)/,/^(?:\\ )/,/^(?:[0-9]+\.?)/,/^(?:([0-9]+)?\.[0-9]+)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\\cdot|\xb7)/,/^(?:\\times|\xd7)/,/^(?:\\ast)/,/^(?:\/)/,/^(?:\\div|\xf7)/,/^(?:-)/,/^(?:\u2212)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:\\left\()/,/^(?:\\right\))/,/^(?:\[)/,/^(?:\])/,/^(?:\{)/,/^(?:\})/,/^(?:\\left\{)/,/^(?:\\right\})/,/^(?:_)/,/^(?:\|)/,/^(?:\\left\|)/,/^(?:\\right\|)/,/^(?:\!)/,/^(?:<=|>=|<>|<|>|=)/,/^(?:\\le)/,/^(?:\\ge)/,/^(?:\\leq)/,/^(?:\\geq)/,/^(?:=\/=)/,/^(?:\\ne)/,/^(?:\\neq)/,/^(?:\u2260)/,/^(?:\u2264)/,/^(?:\u2265)/,/^(?:\\frac)/,/^(?:\\dfrac)/,/^(?:sqrt|\\sqrt)/,/^(?:abs|\\abs)/,/^(?:ln|\\ln)/,/^(?:log|\\log)/,/^(?:sin|cos|tan)/,/^(?:csc|sec|cot)/,/^(?:sinh|cosh|tanh)/,/^(?:csch|sech|coth)/,/^(?:\\sin)/,/^(?:\\cos)/,/^(?:\\tan)/,/^(?:\\csc)/,/^(?:\\sec)/,/^(?:\\cot)/,/^(?:\\arcsin)/,/^(?:\\arccos)/,/^(?:\\arctan)/,/^(?:\\arccsc)/,/^(?:\\arcsec)/,/^(?:\\arccot)/,/^(?:arcsin|arccos|arctan)/,/^(?:arccsc|arcsec|arccot)/,/^(?:\\sinh)/,/^(?:\\cosh)/,/^(?:\\tanh)/,/^(?:\\csch)/,/^(?:\\sech)/,/^(?:\\coth)/,/^(?:pi)/,/^(?:\u03c0)/,/^(?:\\pi)/,/^(?:theta)/,/^(?:\u03b8)/,/^(?:\\theta)/,/^(?:phi)/,/^(?:\u03c6)/,/^(?:\\phi)/,/^(?:[a-zA-Z])/,/^(?:$)/,/^(?:.)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84],inclusive:!0}}};return e}();function T(){this.yy={}}return k.lexer=_,T.prototype=k,k.Parser=T,new T}();e.parser=t}(H),function(e){var t=function(){var e=function(e,t,n,s){for(n=n||{},s=e.length;s--;n[e[s]]=t);return n},t=[1,11],n=[1,9],s=[8,17],i=[6,11],r=[6,11,13,17],o={trace:function(){},yy:{},symbols_:{error:2,unitvalue:3,magnitude:4,unit:5,EOF:6,float:7,POW:8,int:9,multatoms:10,DIV:11,expatom:12,MUL:13,atom:14,"^":15,nat:16,ATOM:17,FLOAT:18,NAT:19,NEG:20,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:"POW",11:"DIV",13:"MUL",15:"^",17:"ATOM",18:"FLOAT",19:"NAT",20:"NEG"},productions_:[0,[3,3],[3,2],[4,3],[4,1],[5,3],[5,1],[10,3],[10,2],[10,1],[12,3],[12,1],[14,1],[7,1],[7,1],[16,1],[9,2],[9,1]],performAction:function(e,t,n,s,i,r,o){var a=r.length-1;switch(i){case 1:return{type:"unitMagnitude",magnitude:r[a-2],unit:r[a-1]};case 2:return{type:"unitStandalone",unit:r[a-1]};case 3:this.$=r[a-2]+"e"+r[a];break;case 4:case 13:case 14:case 15:case 17:this.$=r[a];break;case 5:this.$={num:r[a-2],denom:r[a]};break;case 6:this.$={num:r[a],denom:null};break;case 7:this.$=[r[a-2]].concat(r[a]);break;case 8:this.$=[r[a-1]].concat(r[a]);break;case 9:this.$=[r[a]];break;case 10:this.$={name:r[a-2],pow:r[a]};break;case 11:this.$={name:r[a],pow:1};break;case 12:this.$=e;break;case 16:this.$="-"+r[a]}},table:[{3:1,4:2,5:3,7:4,10:5,12:8,14:10,16:7,17:t,18:[1,6],19:n},{1:[3]},{5:12,10:5,12:8,14:10,17:t},{6:[1,13]},{8:[1,14],17:[2,4]},{6:[2,6],11:[1,15]},e(s,[2,13]),e(s,[2,14]),e(i,[2,9],{12:8,14:10,10:17,13:[1,16],17:t}),e([6,8,11,13,17],[2,15]),e(r,[2,11],{15:[1,18]}),e([6,11,13,15,17],[2,12]),{6:[1,19]},{1:[2,2]},{9:20,19:[1,22],20:[1,21]},{10:23,12:8,14:10,17:t},{10:24,12:8,14:10,17:t},e(i,[2,8]),{16:25,19:n},{1:[2,1]},{17:[2,3]},{19:[1,26]},{17:[2,17]},{6:[2,5]},e(i,[2,7]),e(r,[2,10]),{17:[2,16]}],defaultActions:{13:[2,2],19:[2,1],20:[2,3],22:[2,17],23:[2,5],26:[2,16]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],s=[null],i=[],r=this.table,o="",a=0,l=0,c=0,h=2,p=1,u=i.slice.call(arguments,1),d=Object.create(this.lexer),g={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(g.yy[f]=this.yy[f]);d.setInput(e,g.yy),g.yy.lexer=d,g.yy.parser=this,"undefined"==typeof d.yylloc&&(d.yylloc={});var m=d.yylloc;i.push(m);var b=d.options&&d.options.ranges;function v(){var e;return"number"!==typeof(e=d.lex()||p)&&(e=t.symbols_[e]||e),e}"function"===typeof g.yy.parseError?this.parseError=g.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var x,y,j,w,O,C,S,k,_,T={};;){if(j=n[n.length-1],this.defaultActions[j]?w=this.defaultActions[j]:(null!==x&&"undefined"!=typeof x||(x=v()),w=r[j]&&r[j][x]),"undefined"===typeof w||!w.length||!w[0]){var M="";for(C in _=[],r[j])this.terminals_[C]&&C>h&&_.push("'"+this.terminals_[C]+"'");M=d.showPosition?"Parse error on line "+(a+1)+":\n"+d.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[x]||x)+"'":"Parse error on line "+(a+1)+": Unexpected "+(x==p?"end of input":"'"+(this.terminals_[x]||x)+"'"),this.parseError(M,{text:d.match,token:this.terminals_[x]||x,line:d.yylineno,loc:m,expected:_})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+j+", token: "+x);switch(w[0]){case 1:n.push(x),s.push(d.yytext),i.push(d.yylloc),n.push(w[1]),x=null,y?(x=y,y=null):(l=d.yyleng,o=d.yytext,a=d.yylineno,m=d.yylloc,c>0&&c--);break;case 2:if(S=this.productions_[w[1]][1],T.$=s[s.length-S],T._$={first_line:i[i.length-(S||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(S||1)].first_column,last_column:i[i.length-1].last_column},b&&(T._$.range=[i[i.length-(S||1)].range[0],i[i.length-1].range[1]]),"undefined"!==typeof(O=this.performAction.apply(T,[o,l,a,g.yy,w[1],s,i].concat(u))))return O;S&&(n=n.slice(0,-1*S*2),s=s.slice(0,-1*S),i=i.slice(0,-1*S)),n.push(this.productions_[w[1]][0]),s.push(T.$),i.push(T._$),k=r[n[n.length-2]][n[n.length-1]],n.push(k);break;case 3:return!0}}return!0}},a=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var s=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===s.length?this.yylloc.first_column:0)+s[s.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,s,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(s=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var r in i)this[r]=i[r];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,s;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),r=0;r<i.length;r++)if((n=this._input.match(this.rules[i[r]]))&&(!t||n[0].length>t[0].length)){if(t=n,s=r,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[r])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[s]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,s){switch(n){case 0:return 11;case 1:return"(";case 2:return")";case 3:return 8;case 4:return 15;case 5:return 13;case 6:return 18;case 7:return 19;case 8:return 20;case 9:case 10:case 11:return 17;case 12:break;case 13:return 6}},rules:[/^(?:\/)/,/^(?:\()/,/^(?:\))/,/^(?:(\*|x|\u00d7|\u2219|\u22c5|\u00b7)\s*10\s*\^)/,/^(?:\^)/,/^(?:\*)/,/^(?:[0-9]+\.[0-9]+)/,/^(?:[0-9]+)/,/^(?:-)/,/^(?:\u00b0( ?)[cCfF])/,/^(?:fl\.? oz\.?)/,/^(?:[\u00b5]?([A-Za-z-]+|[\u2103\u2109\u212b]))/,/^(?:\s+)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return e}();function l(){this.yy={}}return o.lexer=a,l.prototype=o,o.Parser=l,new l}();e.unitParser=t}(H),function(e){var t=function(){throw new Error("Abstract method - must override for expr: "+this.print())},n=function(e){throw new Error(e)},s=function(e){return e!==e},i=function(e,t){var n=t-e;return Math.random()*n+e};function r(){}function o(){}function a(){this.terms=1===arguments.length?arguments[0]:_.toArray(arguments)}function l(){this.terms=1===arguments.length?arguments[0]:_.toArray(arguments)}function c(e,t){this.base=e,this.exp=t}function h(e,t){this.base=e,this.power=t}function p(e,t){this.type=e,this.arg=t}function u(e){this.arg=e}function d(e,t,n){this.left=e,this.type=t,this.right=n}function g(){}function f(e,t){this.symbol=e,this.arg=t}function m(e,t){this.symbol=e,this.subscript=t}function b(e){this.symbol=e}function v(){}function x(e,t){var n=e,s=t;s<0&&(n=-n,s=-s),this.n=n,this.d=s}function y(e){this.n=e}function j(e){this.n=e}_.extend(r.prototype,{func:t,args:t,construct:function(e){var t=new this.func;return this.func.apply(t,e),t},recurse:function(e){var t=Array.prototype.slice.call(arguments,1),n=_.map(this.args(),(function(n){return _.isString(n)?n:n[e].apply(n,t)}));return this.construct(n)},eval:t,codegen:t,compile:function(){var e=this.codegen();try{return new Function("vars","return "+e+";")}catch(t){throw new Error("Function did not compile: "+e)}},print:t,tex:t,asTex:function(e){e=e||{},_.defaults(e,{display:!0,dynamic:!0,times:!1});var t=this.tex();return e.display&&(t="\\displaystyle "+t),e.dynamic&&(t=(t=t.replace(/\(/g,"\\left(")).replace(/\)/g,"\\right)")),e.times&&(t=t.replace(/\\cdot/g,"\\times")),t},name:function(){return this.func.name?this.func.name:this.func.toString().match(/^function\s*([^\s(]+)/)[1]},repr:function(){return this.name()+"("+_.map(this.args(),(function(e){return _.isString(e)?e:e.repr()})).join(",")+")"},strip:function(){return this.recurse("strip")},normalize:function(){return this.recurse("normalize")},expand:function(){return this.recurse("expand")},factor:function(e){return this.recurse("factor",e)},collect:function(e){return this.recurse("collect",e)},equals:function(e){return this.normalize().print()===e.normalize().print()},simplify:function(e){e=_.extend({once:!1},e);var t=this.factor(e),n=t.collect(e);t.equals(n)&&(n=this.collect(e));var s=n.expand(e),i=s.collect(e);s.equals(i)&&(i=n.collect(e));var r=i;return e.once||this.equals(r)?r:r.simplify(e)},isSimplified:function(){return this.equals(this.simplify())},exprArgs:function(){return _.filter(this.args(),(function(e){return e instanceof r}))},getVars:function(e){return _.uniq(_.flatten(_.invoke(this.exprArgs(),"getVars",e))).sort()},getConsts:function(){return _.uniq(_.flatten(_.invoke(this.exprArgs(),"getConsts"))).sort()},getUnits:function(){return _.flatten(_.invoke(this.exprArgs(),"getUnits"))},is:function(e){return this instanceof e},has:function(e){return this instanceof e||_.any(this.exprArgs(),(function(t){return t.has(e)}))},raiseToThe:function(e){return new c(this,e)},isSubtract:function(){return!1},isDivide:function(){return!1},isRoot:function(){return!1},needsExplicitMul:function(){return this.args()[0].needsExplicitMul()},sameVars:function(e){var t=this.getVars(),n=e.getVars(),s=function(e,t){return!_.difference(e,t).length},i=function(e){return _.uniq(_.invoke(e,"toLowerCase")).sort()};return{equal:s(t,n),equalIgnoringCase:s(i(t),i(n))}},compare:function(e){if(e instanceof d)return!1;var t=_.union(this.getVars(!0),e.getVars(!0)),n=function(e,t){var n=function(e,t){return Math.abs(e)<1||Math.abs(t)<1?Math.abs(e-t):Math.abs(1-e/t)}(e,t);return e===t||s(e)&&s(t)||n<Math.pow(10,-9)};if(!t.length&&!this.has(O)&&!e.has(O))return n(this.eval(),e.eval());var r=this.collect(),o=e.collect(),a=this.getUnits(),l=e.getUnits();if(!_.isEqual(a,l))return!1;for(var c=0;c<12;c++){var h,p={},u=Math.pow(10,1+Math.floor(3*c/12)),g=c%2===0;if(_.each(t,(function(e){p[e]=g?i(-u,u):_.random(-u,u)})),r.has(f)||o.has(f)||r.has(O)||o.has(O)){var m=r.partialEval(p),b=o.partialEval(p);h=m.simplify().equals(b.simplify())}else{h=n(m=r.eval(p),b=o.eval(p))}if(!h)return!1}return!0},partialEval:function(e){return this instanceof O?this:this.has(f)?this instanceof f?new f(this.symbol,this.arg.partialEval(e)):this.recurse("partialEval",e):new j(this.eval(e).toFixed(9)).collect()},sameForm:function(e){return this.strip().equals(e.strip())},findGCD:function(e){return this.equals(e)?e:v.One},getDenominator:function(){return v.One},asMul:function(){return new l(v.One,this)},isPositive:t,isNegative:function(){return!1},asPositiveFactor:function(){return this.isPositive()?this:v.One},addHint:function(e){if(!e)return this;var t=this.construct(this.args());return t.hints=_.clone(this.hints),t.hints[e]=!0,t},hints:{parens:!1},asExpr:function(){return this},completeParse:function(){return this.recurse("completeParse")},abs:t,negate:function(){return new l(v.Neg,this)}}),o.prototype=new r,_.extend(o.prototype,{args:function(){return this.terms},normalize:function(){var e=_.sortBy(_.invoke(this.terms,"normalize"),(function(e){return e.print()}));return new this.func(e)},expand:function(){return this.recurse("expand").flatten()},partition:function(){var e=_.groupBy(this.terms,(function(e){return e instanceof v})),t=e[!0]||[],n=e[!1]||[];return[new this.func(t),new this.func(n)]},flatten:function(){var e=this,t=_.reject(this.terms,(function(t){return t.equals(e.identity)}));if(0===t.length)return e.identity;if(1===t.length)return t[0];var n=_.groupBy(t,(function(t){return t instanceof e.func})),s=n[!0]||[],i=(n[!1]||[]).concat(_.flatten(_.pluck(s,"terms"),!0));return new e.func(i)},identity:void 0,reduce:t,isPositive:function(){var e=_.invoke(this.terms,"collect");return _.all(_.invoke(e,"isPositive"))},replace:function(e,t){var n;n=e instanceof r?_.indexOf(this.terms,e):e;var s=[];_.isArray(t)?s=t:t&&(s=[t]);var i=this.terms.slice(0,n).concat(s).concat(this.terms.slice(n+1));return new this.func(i)},remove:function(e){return this.replace(e)},getDenominator:function(){return new l(_.invoke(this.terms,"getDenominator")).flatten()}}),a.prototype=new o,_.extend(a.prototype,{func:a,eval:function(e,t){return _.reduce(this.terms,(function(n,s){return n+s.eval(e,t)}),0)},codegen:function(){return _.map(this.terms,(function(e){return"("+e.codegen()+")"})).join(" + ")||"0"},print:function(){return _.invoke(this.terms,"print").join("+")},tex:function(){var e="";return _.each(this.terms,(function(t){!e||t.isSubtract()?e+=t.tex():e+="+"+t.tex()})),e},collect:function(e){var t=_.invoke(this.terms,"collect",e),n=[];_.each(t,(function(t){if(t instanceof l){var s=t.partition();n.push([s[1].flatten(),s[0].reduce(e)])}else t instanceof v?n.push([v.One,t]):n.push([t,v.One])}));var s=_.groupBy(n,(function(e){return e[0].normalize().print()})),i=_.compact(_.map(s,(function(t){var n=t[0][0];return new l(new a(_.zip.apply(_,t)[1]).reduce(e),n).collect(e)})));return new a(i).flatten()},factor:function(e){e=_.extend({keepNegative:!1},e);var t,n=_.invoke(this.terms,"collect");t=n[0]instanceof l?n[0].terms:[n[0]],_.each(_.rest(this.terms),(function(e){t=_.map(t,(function(t){return e.findGCD(t)}))})),!e.keepNegative&&this.isNegative()&&t.push(v.Neg),t=new l(t).flatten().collect();var s=_.map(n,(function(e){return l.handleDivide(e,t).simplify()}));return s=new a(s).flatten(),l.createOrAppend(t,s).flatten()},reduce:function(e){return _.reduce(this.terms,(function(t,n){return t.add(n,e)}),this.identity)},needsExplicitMul:function(){return!1},isNegative:function(){var e=_.invoke(this.terms,"collect");return _.all(_.invoke(e,"isNegative"))},negate:function(){return new a(_.invoke(this.terms,"negate"))}}),l.prototype=new o,_.extend(l.prototype,{func:l,eval:function(e,t){return _.reduce(this.terms,(function(n,s){return n*s.eval(e,t)}),1)},codegen:function(){return _.map(this.terms,(function(e){return"("+e.codegen()+")"})).join(" * ")||"0"},print:function(){return _.map(this.terms,(function(e){return e instanceof a?"("+e.print()+")":e.print()})).join("*")},getUnits:function(){var e=_.chain(this.terms).map((function(e){return e.getUnits()})).flatten().value();return e.sort((function(e,t){return e.unit<t.unit})),e},tex:function(){for(var e,t=" \\cdot ",n=_.groupBy(this.terms,(function(e){return e.isDivide()?"inverse":e instanceof v?"number":"other"})),s=n.inverse||[],i=n.number||[],r=n.other||[],o="",h=0;h<i.length;h++){if(i[h]instanceof x&&!(i[h]instanceof y)&&r.length>0&&s.length>0){var p=i.slice();p.splice(h,1);var u=p.concat(s).concat(r);return i[h].tex()+new l(u).tex()}}if(0===(i=_.compact(_.map(i,(function(e){var t=e instanceof x&&!(e instanceof y),n=!e.hints.fraction||s.length>0;if(t&&n){s.push(new c(new y(e.d),v.Div));var i=new y(e.n);return i.hints=e.hints,_.any(e.hints)?i:null}return e})))).length&&1===r.length)e=r[0].tex();else{var d="";_.each(i,(function(e){e.hints.subtract&&e.hints.entered?(o+="-",d+=(d?t:"")+e.abs().tex()):e instanceof y&&-1===e.n&&(e.hints.negate||e.hints.subtract)?o+="-":d+=(d?t:"")+e.tex()})),_.each(r,(function(e){e.needsExplicitMul()?d+=(d?t:"")+e.tex():d+=e instanceof a?"("+e.tex()+")":e.tex()})),e=d||"1"}if(s.length){var g=new l(_.invoke(s,"asDivide")).flatten().tex();return o+"\\frac{"+e+"}{"+g+"}"}return o+e},strip:function(){return new l(_.map(this.terms,(function(e){return e instanceof v?e.abs():e.strip()}))).flatten()},expand:function(){var e=function(e){return e instanceof a},t=function(e){return e instanceof c&&e.exp.isNegative()},n=this.recurse("expand").flatten(),s=_.any(n.terms,e),i=_.any(n.terms,(function(n){return t(n)&&e(n.base)}));if(!s&&!i)return n;var r=_.groupBy(n.terms,t),o=r[!1]||[],h=r[!0]||[];if(s){var p=_.groupBy(o,e),u=p[!0]||[],d=p[!1]||[],g=_.reduce(u,(function(e,t){return _.reduce(e,(function(e,n){return e.concat(_.map(t.terms,(function(e){return n.concat(e)})))}),[])}),[[]]);o=[new a(_.map(g,(function(e){return new l(d.concat(e)).flatten()})))]}i&&(h=[new c(new l(_.invoke(h,"getDenominator")).flatten().expand(),v.Div)]);return new l(o.concat(h)).flatten()},factor:function(e){var t=this.recurse("factor",e).flatten();if(!(t instanceof l))return t;var n=_.groupBy(t.terms,(function(e){return e instanceof x})),s=_.reduce(n[!0],(function(e,t){return{n:e.n*t.n,d:e.d*t.d}}),{n:1,d:1});return s=1===s.d?new y(s.n):new x(s.n,s.d),new l((n[!1]||[]).concat(s)).flatten()},collect:function(e){var t=this.recurse("collect",e).partition(),n=t[0].reduce(e);if(0===n.eval())return v.Zero;var s=t[1].flatten();if(!(s instanceof l))return new l(n,s).flatten();s=s.terms;var i=[];_.each(s,(function(e){e instanceof c?i.push([e.base,e.exp]):i.push([e,v.One])}));var r=_.groupBy(i,(function(e){return e[0].normalize().print()})),o=_.compact(_.map(r,(function(t){var n=t[0][0],s=new a(_.zip.apply(_,t)[1]).collect(e);return s instanceof v&&0===s.eval()?null:[n,s]}))),u=(i=_.groupBy(o,(function(e){return e[0]instanceof p&&e[0].isBasic()?"trig":e[0]instanceof h?"log":"expr"}))).trig||[],d=i.log||[],g=i.expr||[];if(u.length>1){var f=_.groupBy(u,(function(e){return e[0].arg.normalize().print()}));u=[],_.each(f,(function(t){var n=t[0][0].arg,s={sin:v.Zero,cos:v.Zero};_.each(t,(function(e){s[e[0].type]=e[1]})),l.handleNegative(s.sin).collect(e).equals(s.cos)&&(s=s.cos.isNegative()?{tan:s.sin}:{cot:s.cos}),_.each(s,(function(e,t){u.push([new p(t,n),e])}))}))}if(d.length>1){var m=_.groupBy(d,(function(e){return e[0].base.normalize().print()}));d=[],_.each(m,(function(t){2===t.length&&l.handleNegative(t[0][1]).collect(e).equals(t[1][1])?t[0][1].isNegative()?d.push([new h(t[0][0].power,t[1][0].power),t[1][1]]):d.push([new h(t[1][0].power,t[0][0].power),t[0][1]]):d=d.concat(t)}))}i=u.concat(d).concat(g);var b=_.map(i,(function(t){return new c(t[0],t[1]).collect(e)}));return new l([n].concat(b)).flatten()},isSubtract:function(){return _.any(this.terms,(function(e){return e instanceof v&&e.hints.subtract}))},factorIn:function(e){var t=this.partition()[0].terms,n=t.length&&_.all(t,(function(e){return e.n>0}));if(n){var s=t[0].negate();return s.hints=t[0].hints,this.replace(t[0],s.addHint(e))}return new l([v.negativeOne(e)].concat(this.terms))},factorOut:function(){var e=!1,t=_.compact(_.map(this.terms,(function(t,n,s){return!e&&t instanceof v&&t.hints.divide?(e=!0,-1!==t.n?t.negate():null):t})));return 1===t.length?t[0]:new l(t)},reduce:function(e){return _.reduce(this.terms,(function(t,n){return t.mul(n,e)}),this.identity)},findGCD:function(e){return new l(_.invoke(this.terms,"findGCD",e)).flatten()},asMul:function(){return this},asPositiveFactor:function(){return this.isPositive()?this:new l(_.invoke(this.collect().terms,"asPositiveFactor")).flatten()},isNegative:function(){return _.any(_.invoke(this.collect().terms,"isNegative"))},fold:function(){return l.fold(this)},negate:function(){var e=function(e){return e instanceof v};if(_.any(this.terms,e)){var t=_.find(this.terms,e);return this.replace(t,t.negate())}return new l([v.Neg].concat(this.terms))}}),_.each([a,l],(function(e){_.extend(e,{createOrAppend:function(t,n){return t instanceof e?new e(t.terms.concat(n)):new e(t,n)}})})),_.extend(l,{handleNegative:function(e,t){if(e instanceof v&&e.n>0){var n=e.negate();return n.hints=e.hints,n.addHint(t)}return e instanceof l?e.factorIn(t):new l(v.negativeOne(t),e)},handleDivide:function(e,t){if(t instanceof l){var n=l.handleDivide(e,t.terms[0]),s=new l(_.rest(t.terms)).flatten();return l.handleDivide(n,s)}var i=function(e){return e instanceof y};if(i(t)&&e instanceof l&&_.any(e.terms,i)){var r=e.terms.slice().reverse(),o=_.find(r,(function(e){return e instanceof x}));if(!i(o))return new l(e.terms.concat([new x(1,t.n).addHint("fraction")]));var a=new x(o.n,t.n);return a.hints=o.hints,o===r[0]&&(a=a.addHint("fraction")),o.n<0&&t.n<0?(a.d=-a.d,e.replace(o,[v.Neg,a])):e.replace(o,a)}var h=function(e,t){if(t instanceof y){if(e instanceof y)return e.n<0&&t.n<0?[v.Neg,new x(e.n,-t.n).addHint("fraction")]:[new x(e.n,t.n).addHint("fraction")];var n=new x(1,t.eval());return t.eval()<0?[e,n.addHint("negate")]:[e,n]}var s;if(t instanceof p&&t.exp){var i=t.exp;t.exp=void 0,t=new c(t,i)}return s=t instanceof c?new c(t.base,l.handleNegative(t.exp,"divide")):new c(t,v.Div),e instanceof y&&1===e.n?[s]:[e,s]};if(e instanceof l){var u=h(_.last(e.terms),t);return new l(_.initial(e.terms).concat(u))}return new l(u=h(e,t)).flatten()},fold:function(e){if(e instanceof l){var t=_.find(_.initial(e.terms),(function(e){return(e instanceof p||e instanceof h)&&e.hints.open})),n=_.indexOf(e.terms,t);if(t){var s,i=_.last(e.terms);if(!(t.hints.parens||i.hints.parens||i.has(p)||i.has(h)))return s=t instanceof p?p.create([t.type,t.exp],l.createOrAppend(t.arg,i).fold()):h.create(t.base,l.createOrAppend(t.power,i).fold()),0===n?s:new l(e.terms.slice(0,n).concat(s)).fold();t.hints.open=!1}var r=e.partition()[0].terms,o=function(e){return e.n>0},a=function(e){return-1===e.n&&e.hints.negate};if(r.length>1&&_.some(r,a)&&_.some(r,o)&&_.every(r,(function(e){return o(e)||a(e)}))){var c=_.indexOf(e.terms,_.find(e.terms,a)),u=_.indexOf(e.terms,_.find(e.terms,o));if(c<u)return e.replace(u,e.terms[u].negate()).remove(c)}}return e}}),c.prototype=new r,_.extend(c.prototype,{func:c,args:function(){return[this.base,this.exp]},eval:function(e,t){var n=this.base.eval(e,t),s=this.exp.eval(e,t);if(n<0){var i=this.exp.simplify();if(i instanceof j){var r=i.n,o=(r-r.toFixed()).toString().length-2,a=Math.pow(10,o);i=new x(r*a,a).simplify()}if(i instanceof x)if(Math.abs(i.d)%2===1)return(Math.abs(i.n)%2===1?-1:1)*Math.pow(-1*n,s)}return Math.pow(n,s)},getUnits:function(){return this.base.getUnits().map(function(e){return{unit:e.unit,pow:e.pow*this.exp.n}}.bind(this))},codegen:function(){return"Math.pow("+this.base.codegen()+", "+this.exp.codegen()+")"},print:function(){var e=this.base.print();return(this.base instanceof o||this.base instanceof c)&&(e="("+e+")"),e+"^("+this.exp.print()+")"},tex:function(){if(this.isDivide())return"\\frac{1}{"+this.asDivide().tex()+"}";if(this.isRoot())return 1!==this.exp.n&&n("Node marked with hint 'root' does not have exponent of form 1/x."),2===this.exp.d?"\\sqrt{"+this.base.tex()+"}":"\\sqrt["+this.exp.d+"]{"+this.base.tex()+"}";if(this.base instanceof p&&!this.base.isInverse()&&this.exp instanceof v&&this.exp.isSimple()&&this.exp.eval()>=0){var e=this.base.tex({split:!0});return e[0]+"^{"+this.exp.tex()+"}"+e[1]}var t=this.base.tex();return this.base instanceof o||this.base instanceof c||this.base instanceof v&&!this.base.isSimple()?t="("+t+")":(this.base instanceof p||this.base instanceof h)&&(t="["+t+"]"),t+"^{"+this.exp.tex()+"}"},needsExplicitMul:function(){return!this.isRoot()&&this.base.needsExplicitMul()},expand:function(){var e=this.recurse("expand");if(e.base instanceof l)return new l(_.map(e.base.terms,(function(t){return new c(t,e.exp)}))).expand();if(e.base instanceof a&&e.exp instanceof y&&e.exp.abs().eval()>1){for(var t=e.exp.eval()>0,n=e.exp.abs().eval(),s=function(e){return t?e:new c(e,v.Div)},i={1:e.base},r=2;r<=n;r*=2){var o=new l(i[r/2],i[r/2]);i[r]=o.expand().collect()}if(_.has(i,n))return s(i[n]);var h=_.map(n.toString(2).split(""),(function(e,t,n){return Number(e)*Math.pow(2,n.length-t-1)}));return h=_.without(h,0),s(o=new l(_.pick(i,h)).expand().collect())}return e.exp instanceof a?new l(_.map(e.exp.terms,(function(t){return new c(e.base,t).expand()}))).expand():e},factor:function(){var e=this.recurse("factor");return e.base instanceof l?new l(_.map(e.base.terms,(function(t){return t instanceof y&&e.exp.equals(v.Div)?new x(1,t.n):new c(t,e.exp)}))):e},collect:function(e){if(this.base instanceof c)return new c(this.base.base,i=l.createOrAppend(this.base.exp,this.exp)).collect(e);var t=this.recurse("collect",e),n=function(e){return e instanceof h&&e.base.equals(t.base)};if(t.exp instanceof v&&0===t.exp.eval())return v.One;if(t.exp instanceof v&&1===t.exp.eval())return t.base;if(n(t.exp))return t.exp.power;if(t.exp instanceof l&&_.any(t.exp.terms,n)){var s=_.find(t.exp.terms,n);return new c(s.power,i=t.exp.remove(s).flatten()).collect(e)}if(t.base instanceof v&&t.exp instanceof v){if(e&&e.preciseFloats){var i=t.exp.asRational(),r=t.base.getDecimalPlaces();if(new c(t.base,new x(1,i.d)).collect().getDecimalPlaces()>r){var o=new c(t.base,new y(i.n)).collect();return new c(o,new x(1,i.d))}}return t.base.raiseToThe(t.exp,e)}return t},isDivide:function(){var e=function(e){return e instanceof v&&e.hints.divide};return e(this.exp)||this.exp instanceof l&&_.any(this.exp.terms,e)},asDivide:function(){if(this.exp instanceof v){if(-1===this.exp.eval())return this.base;var e=this.exp.negate();return e.hints=_.clone(this.exp.hints),e.hints.divide=!1,new c(this.base,e)}if(this.exp instanceof l)return new c(this.base,this.exp.factorOut());n("called asDivide() on an Expr that wasn't a Num or Mul")},isRoot:function(){return this.exp instanceof x&&this.exp.hints.root},isSquaredTrig:function(){return this.base instanceof p&&!this.base.isInverse()&&this.exp instanceof v&&2===this.exp.eval()},getDenominator:function(){if(this.exp instanceof v&&-1===this.exp.eval())return l.createOrAppend(this.base,this.base.getDenominator()).flatten();if(this.exp.isNegative()){var e=new c(this.base,l.handleNegative(this.exp).collect());return l.createOrAppend(e,e.collect().getDenominator()).flatten()}return this.base instanceof v?new c(this.base.getDenominator(),this.exp).collect():v.One},findGCD:function(e){var t,n;if(e instanceof c?(t=e.base,n=e.exp):(t=e,n=v.One),this.base.equals(t)){if(this.exp.equals(n))return this;if(this.exp instanceof v&&n instanceof v)return new c(this.base,v.min(this.exp,n)).collect();if(this.exp instanceof v||n instanceof v)return v.One;var s=this.exp.asMul().partition(),i=n.asMul().partition();if(s[1].equals(i[1]))return new c(t,new l(v.min(s[0].reduce(),i[0].reduce()),s[1].flatten()).flatten()).collect()}return v.One},isPositive:function(){if(this.base.isPositive())return!0;var e=this.exp.simplify();return e instanceof y&&e.eval()%2===0},asPositiveFactor:function(){if(this.isPositive())return this;var e=this.exp.simplify();if(e instanceof y){var t=e.eval();if(t>2)return new c(this.base,new y(t-1));if(t<-2)return new c(this.base,new y(t+1))}return v.One}}),_.extend(c,{sqrt:function(e){return new c(e,v.Sqrt)},nthroot:function(e,t){return new c(e,l.fold(l.handleDivide(new y(1),t)).addHint("root"))}}),h.prototype=new r,_.extend(h.prototype,{func:h,args:function(){return[this.base,this.power]},eval:function(e,t){return Math.log(this.power.eval(e,t))/Math.log(this.base.eval(e,t))},codegen:function(){return"(Math.log("+this.power.codegen()+") / Math.log("+this.base.codegen()+"))"},print:function(){var e="("+this.power.print()+")";return this.isNatural()?"ln"+e:"log_("+this.base.print()+") "+e},tex:function(){var e="("+this.power.tex()+")";return this.isNatural()?"\\ln"+e:"\\log_{"+this.base.tex()+"}"+e},collect:function(e){var t=this.recurse("collect",e);return t.power instanceof v&&1===t.power.eval()?v.Zero:t.base.equals(t.power)?v.One:t.power instanceof c&&t.power.base.equals(t.base)?t.power.exp:t},expand:function(){var e=this.recurse("expand");return e.power instanceof l?new a(_.map(e.power.terms,(function(t){return new h(e.base,t).expand()}))):e.power instanceof c?new l(e.power.exp,new h(e.base,e.power.base).expand()).flatten():e.isNatural()?e:l.handleDivide(new h(b.e,e.power),new h(b.e,e.base))},hints:_.extend(h.prototype.hints,{open:!1}),isPositive:function(){var e=this.collect();return e.base instanceof v&&e.power instanceof v&&this.eval()>0},needsExplicitMul:function(){return!1},isNatural:function(){return this.base.equals(b.e)}}),_.extend(h,{natural:function(){return b.e},common:function(){return v.Ten},create:function(e,t){var n=new h(e,t);return t.hints.parens||(n=n.addHint("open")),n}}),p.prototype=new r,_.extend(p.prototype,{func:p,args:function(){return[this.type,this.arg]},functions:{sin:{eval:Math.sin,codegen:"Math.sin((",tex:"\\sin",expand:function(){return this}},cos:{eval:Math.cos,codegen:"Math.cos((",tex:"\\cos",expand:function(){return this}},tan:{eval:Math.tan,codegen:"Math.tan((",tex:"\\tan",expand:function(){return l.handleDivide(p.sin(this.arg),p.cos(this.arg))}},csc:{eval:function(e){return 1/Math.sin(e)},codegen:"(1/Math.sin(",tex:"\\csc",expand:function(){return l.handleDivide(v.One,p.sin(this.arg))}},sec:{eval:function(e){return 1/Math.cos(e)},codegen:"(1/Math.cos(",tex:"\\sec",expand:function(){return l.handleDivide(v.One,p.cos(this.arg))}},cot:{eval:function(e){return 1/Math.tan(e)},codegen:"(1/Math.tan(",tex:"\\cot",expand:function(){return l.handleDivide(p.cos(this.arg),p.sin(this.arg))}},arcsin:{eval:Math.asin,codegen:"Math.asin((",tex:"\\arcsin"},arccos:{eval:Math.acos,codegen:"Math.acos((",tex:"\\arccos"},arctan:{eval:Math.atan,codegen:"Math.atan((",tex:"\\arctan"},arccsc:{eval:function(e){return Math.asin(1/e)},codegen:"Math.asin(1/(",tex:"\\operatorname{arccsc}"},arcsec:{eval:function(e){return Math.acos(1/e)},codegen:"Math.acos(1/(",tex:"\\operatorname{arcsec}"},arccot:{eval:function(e){return Math.atan(1/e)},codegen:"Math.atan(1/(",tex:"\\operatorname{arccot}"},sinh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / 2)"},tex:"\\sinh",expand:function(){return this}},cosh:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/2},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / 2)"},tex:"\\cosh",expand:function(){return this}},tanh:{eval:function(e){return(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") - Math.exp(-("+e+"))) / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\tanh",expand:function(){return l.handleDivide(p.sinh(this.arg),p.cosh(this.arg))}},csch:{eval:function(e){return 2/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\csch",expand:function(){return l.handleDivide(v.One,p.sinh(this.arg))}},sech:{eval:function(e){return 2/(Math.exp(e)+Math.exp(-e))},codegen:function(e){return"(2 / (Math.exp("+e+") + Math.exp(-("+e+"))))"},tex:"\\sech",expand:function(){return l.handleDivide(v.One,p.cosh(this.arg))}},coth:{eval:function(e){return(Math.exp(e)+Math.exp(-e))/(Math.exp(e)-Math.exp(-e))},codegen:function(e){return"((Math.exp("+e+") + Math.exp(-("+e+"))) / (Math.exp("+e+") - Math.exp(-("+e+"))))"},tex:"\\coth",expand:function(){return l.handleDivide(p.cosh(this.arg),p.sinh(this.arg))}}},isEven:function(){return _.contains(["cos","sec"],this.type)},isInverse:function(){return 0===this.type.indexOf("arc")},isBasic:function(){return _.contains(["sin","cos"],this.type)},eval:function(e,t){return(0,this.functions[this.type].eval)(this.arg.eval(e,t))},codegen:function(){var e=this.functions[this.type].codegen;if("function"===typeof e)return e(this.arg.codegen());if("string"===typeof e)return e+this.arg.codegen()+"))";throw new Error("codegen not implemented for "+this.type)},print:function(){return this.type+"("+this.arg.print()+")"},tex:function(e){var t=this.functions[this.type].tex,n="("+this.arg.tex()+")";return e&&e.split?[t,n]:t+n},hints:_.extend(p.prototype.hints,{open:!1}),isPositive:function(){return this.collect().arg instanceof v&&this.eval()>0},completeParse:function(){if(this.exp){var e=new c(this,this.exp);return this.exp=void 0,e}return this},needsExplicitMul:function(){return!1},expand:function(){var e=this.recurse("expand");if(e.isInverse())return e;var t=e.functions[e.type].expand;return _.bind(t,e)()},collect:function(e){var t,n=this.recurse("collect",e);return!n.isInverse()&&n.arg.isNegative()?(t=n.arg instanceof v?n.arg.abs():l.handleDivide(n.arg,v.Neg).collect(e),n.isEven()?new p(n.type,t):new l(v.Neg,new p(n.type,t))):n}}),_.extend(p,{create:function(e,t){var n=e[0],s=e[1];s&&s.equals(v.Neg)&&(n="arc"+n,s=void 0);var i=new p(n,t);return t.hints.parens||(i=i.addHint("open")),s&&(i.exp=s),i},sin:function(e){return new p("sin",e)},cos:function(e){return new p("cos",e)},sinh:function(e){return new p("sinh",e)},cosh:function(e){return new p("cosh",e)}}),u.prototype=new r,_.extend(u.prototype,{func:u,args:function(){return[this.arg]},eval:function(e,t){return Math.abs(this.arg.eval(e,t))},codegen:function(){return"Math.abs("+this.arg.codegen()+")"},print:function(){return"abs("+this.arg.print()+")"},tex:function(){return"\\left|"+this.arg.tex()+"\\right|"},collect:function(e){var t=this.recurse("collect",e);if(t.arg.isPositive())return t.arg;if(t.arg instanceof v)return t.arg.abs();if(t.arg instanceof l){var n=_.groupBy(t.arg.terms,(function(e){return e.isPositive()?"positive":e instanceof v?"number":"other"})),s=n.positive.concat(_.invoke(n.number,"abs"));return n.other.length&&s.push(new u(new l(n.other).flatten())),new l(s).flatten()}return t},expand:function(){var e=this.recurse("expand");return e.arg instanceof l?new l(_.map(e.arg.terms,(function(e){return new u(e)}))):e},isPositive:function(){return!0}}),d.prototype=new r,_.extend(d.prototype,{func:d,args:function(){return[this.left,this.type,this.right]},needsExplicitMul:function(){return!1},print:function(){return this.left.print()+this.type+this.right.print()},signs:{"=":" = ","<":" < ",">":" > ","<>":" \\ne ","<=":" \\le ",">=":" \\ge "},tex:function(){return this.left.tex()+this.signs[this.type]+this.right.tex()},normalize:function(){var e=this.recurse("normalize");return _.contains([">",">="],e.type)?new d(e.right,e.type.replace(">","<"),e.left):e},asExpr:function(e){var t=function(e){return e instanceof v&&e.isSimple()&&0===e.eval()},n=[];this.left instanceof a?n=_.clone(this.left.terms):t(this.left)||(n=[this.left]),this.right instanceof a?n=n.concat(this.right.negate().terms):t(this.right)||n.push(this.right.negate());var s=!this.isEquality();n=_.invoke(n,"collect",{preciseFloats:!0});for(var i=0;i<n.length;i++){var r=n[i].getDenominator();s&&!r.isPositive()&&(r=r.asPositiveFactor()),r.equals(v.One)||(n=_.map(n,(function(e){return l.createOrAppend(e,r).simplify({once:!0,preciseFloats:!0})})))}var o=new a(n).flatten();return e?o:this.divideThrough(o)},divideThrough:function(e){var t=!this.isEquality(),n=e.simplify({once:!0}),s=n.factor({keepNegative:t});if(!(s instanceof l))return e;var i=s.terms,r=_.groupBy(i,(function(e){return e instanceof a})),o=r[!0]||[],h=r[!1]||[];if(o.length&&this.isEquality())return new l(o).flatten();var p=h;o.length||(p=_.reject(p,(function(e){return!!e.getVars().length}))),t&&(p=_.invoke(p,"asPositiveFactor")),p=_.reject(p,(function(e){return e.equals(v.One)})),p=_.map(p,(function(e){return new c(e,v.Div)}));var u=new l(i.concat(p)).collect();return u.equals(s)?n:u},isEquality:function(){return _.contains(["=","<>"],this.type)},compare:function(e){if(!(e instanceof d))return!1;var t=this.normalize(),n=e.normalize();if(t.type!==n.type)return!1;var s=t.divideThrough(t.asExpr(!0).collect()),i=n.divideThrough(n.asExpr(!0).collect());return t.isEquality()?s.compare(i)||s.compare(l.handleNegative(i)):s.compare(i)},sameForm:function(e){var t=this.normalize(),n=e.normalize(),s=t.left.sameForm(n.left)&&t.right.sameForm(n.right);return t.isEquality()?s||t.left.sameForm(n.right)&&t.right.sameForm(n.left):s},isSimplified:function(){var e=this.asExpr(!0),t=this.divideThrough(e).simplify();return e.equals(t)&&this.left.isSimplified()&&this.right.isSimplified()}}),_.extend(d.prototype,{solveLinearEquationForVariable:function(e){var t=this.asExpr();if(!t.is(a)||2!==t.terms.length)throw new Error("Can only handle linear equations of the form a + bx (= 0)");var n,s,i;return(i=t.terms[0]).has(m)&&_.contains(i.getVars(),e.symbol)?(n=l.handleNegative(t.terms[1]),s=l.handleDivide(t.terms[0],e)):(n=l.handleNegative(t.terms[0]),s=l.handleDivide(t.terms[1],e)),l.handleDivide(n,s).simplify()}}),g.prototype=new r,_.extend(g.prototype,{needsExplicitMul:function(){return!1},findGCD:function(e){return e instanceof g||e instanceof v?this.equals(e)?this:v.One:e.findGCD(this)}}),f.prototype=new g,_.extend(f.prototype,{func:f,args:function(){return[this.symbol,this.arg]},print:function(){return this.symbol+"("+this.arg.print()+")"},tex:function(){return this.symbol+"("+this.arg.tex()+")"},eval:function(t,n){var s=this.arg,i=t[this.symbol],r=_.extend(_.clone(t),{x:s.eval(t,n)}),o=e.parse(i,n);return o.parsed?o.expr.eval(r,n):o},codegen:function(){return'vars["'+this.symbol+'"]('+this.arg.codegen()+")"},getUnits:function(){return this.arg.getUnits()},getVars:function(e){return e?this.arg.getVars():_.union(this.arg.getVars(),[this.symbol]).sort()},getConsts:function(){return this.arg.getConsts()}}),m.prototype=new g,_.extend(m.prototype,{func:m,args:function(){return[this.symbol,this.subscript]},exprArgs:function(){return[]},recurse:function(){return this},print:function(){var e="";return this.subscript&&(e="_("+this.subscript.print()+")"),this.symbol+e},prettyPrint:function(){var e=this.subscript;return e&&(e instanceof v||e instanceof g)?this.symbol+"_"+e.print():this.print()},tex:function(){var e="";return this.subscript&&(e="_{"+this.subscript.tex()+"}"),(this.symbol.length>1?"\\":"")+this.symbol+e},repr:function(){return"Var("+this.print()+")"},eval:function(e,t){return e[this.prettyPrint()]},codegen:function(){return'vars["'+this.prettyPrint()+'"]'},getVars:function(){return[this.prettyPrint()]},isPositive:function(){return!1}}),b.prototype=new g,_.extend(b.prototype,{func:b,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,t){return"pi"===this.symbol?Math.PI:"e"===this.symbol?Math.E:void 0},codegen:function(){return"pi"===this.symbol?"Math.PI":"e"===this.symbol?"Math.E":void 0},print:function(){return this.symbol},tex:function(){return"pi"===this.symbol?"\\pi ":"e"===this.symbol?"e":void 0},isPositive:function(){return this.eval()>0},abs:function(){return this.eval()>0?this:l.handleNegative(this)},getConsts:function(){return[this.print()]}}),b.e=new b("e"),b.pi=new b("pi"),v.prototype=new r,_.extend(v.prototype,{repr:function(){return this.print()},strip:function(){return this.abs()},recurse:function(){return this},codegen:function(){return this.print()},add:t,mul:t,negate:t,isSubtract:function(){return this.hints.subtract},abs:t,needsExplicitMul:function(){return!0},findGCD:t,isPositive:function(){return this.eval()>0},isNegative:function(){return this.eval()<0},asPositiveFactor:function(){return this.isPositive()?this:this.abs()},hints:_.extend(v.prototype.hints,{negate:!1,subtract:!1,divide:!1,root:!1,fraction:!1,entered:!1}),isSimple:t,getDecimalPlaces:function(){var e=(""+this.n).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},asRational:t}),x.prototype=new v,_.extend(x.prototype,{func:x,args:function(){return[this.n,this.d]},eval:function(){return this.n/this.d},print:function(){return this.n.toString()+"/"+this.d.toString()},tex:function(){var e="\\frac{"+Math.abs(this.n).toString()+"}{"+this.d.toString()+"}";return this.n<0?"-"+e:e},add:function(e,t){return e instanceof x?new x(this.n*e.d+this.d*e.n,this.d*e.d).collect():e.add(this,t)},mul:function(e,t){return e instanceof x?new x(this.n*e.n,this.d*e.d).collect():e.mul(this,t)},collect:function(){var e=v.findGCD(this.n,this.d),t=this.n/e,n=this.d/e;return 1===n?new y(t):new x(t,n)},negate:function(){return new x(-this.n,this.d)},abs:function(){return new x(Math.abs(this.n),this.d)},findGCD:function(e){return e instanceof x?new x(v.findGCD(this.n*e.d,e.n*this.d),this.d*e.d).collect():e instanceof y?new x(v.findGCD(this.n,e.n),this.d):e.findGCD(this)},raiseToThe:function(e){if(e instanceof y){var t=e.eval()>0,n=e.abs().eval(),s=Math.pow(this.n,n),i=Math.pow(this.d,n);return t?new x(s,i).collect():new x(i,s).collect()}return new j(this.eval()).raiseToThe(e)},getDenominator:function(){return new y(this.d)},isSimple:function(){return!1},asRational:function(){return this}}),y.prototype=new x(0,1),_.extend(y.prototype,{func:y,args:function(){return[this.n]},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},negate:function(){return new y(-this.n)},abs:function(){return new y(Math.abs(this.n))},isSimple:function(){return!0},findGCD:function(e){return e instanceof y?new y(v.findGCD(this.n,e.n)):e.findGCD(this)}}),_.extend(y,{create:function(e){return new y(e).addHint("entered")}}),j.prototype=new v,_.extend(j.prototype,{func:j,args:function(){return[this.n]},eval:function(){return this.n},print:function(){return this.n.toString()},tex:function(){return this.n.toString()},add:function(e,t){return t&&t.preciseFloats?j.toDecimalPlaces(this.n+e.eval(),Math.max(this.getDecimalPlaces(),e.getDecimalPlaces())):new j(this.n+e.eval()).collect()},mul:function(e,t){return t&&t.preciseFloats?j.toDecimalPlaces(this.n*e.eval(),this.getDecimalPlaces()+e.getDecimalPlaces()):new j(this.n*e.eval()).collect()},collect:function(){return this},negate:function(){return new j(-this.n)},abs:function(){return new j(Math.abs(this.n))},findGCD:function(e){return e instanceof v?new j(v.findGCD(this.eval(),e.eval())).collect():e.findGCD(this)},raiseToThe:function(e,t){return t&&t.preciseFloats&&e instanceof y&&e.n>1?j.toDecimalPlaces(new c(this,e).eval(),this.getDecimalPlaces()*e.n):new j(new c(this,e).eval()).collect()},asRational:function(){var e=this.n.toString().split(".");return 1===e.length?new x(this.n,1):new x(Number(e.join("")),Math.pow(10,e[1].length)).collect()},getDenominator:function(){return this.asRational().getDenominator()},isSimple:function(){return!0}}),_.extend(j,{create:function(e){return new j(e).addHint("entered")},toDecimalPlaces:function(e,t){return new j(+e.toFixed(Math.min(t,20))).collect()}}),_.extend(v,{negativeOne:function(e){return"subtract"===e?v.Sub:"divide"===e?v.Div:v.Neg},findGCD:function(e,t){var n;if(e=Math.abs(e),t=Math.abs(t),e!==Math.floor(e)||t!==Math.floor(t))return 1;for(;t;)n=e%t,e=t,t=n;return e},min:function(){return _.min(_.toArray(arguments),(function(e){return e.eval()}))},max:function(){return _.max(_.toArray(arguments),(function(e){return e.eval()}))}}),v.Neg=new y(-1).addHint("negate"),v.Sub=new y(-1).addHint("subtract"),v.Div=new y(-1).addHint("divide"),v.Sqrt=new x(1,2).addHint("root"),v.Zero=new y(0),v.One=new y(1),v.Ten=new y(10),a.prototype.identity=v.Zero,l.prototype.identity=v.One;var w=e.parser;function O(e){this.symbol=e}w.yy={Add:a,Mul:l,Pow:c,Log:h,Trig:p,Eq:d,Abs:u,Func:f,Const:b,Var:m,Int:y,Float:j,parseError:function(e,t){throw new Error(t.loc.first_column)},constants:["e"],symbolLexer:function(e){return _.contains(w.yy.constants,e)?"CONST":_.contains(w.yy.functions,e)?"FUNC":"VAR"}},e.parse=function(e,t){try{return t&&t.functions?w.yy.functions=_.without(t.functions,"i"):w.yy.functions=[],t&&t.decimal_separator&&(e=e.split(t.decimal_separator).join(".")),{parsed:!0,expr:w.parse(e).completeParse()}}catch(n){return{parsed:!1,error:n.message}}},O.prototype=new g;var C=function(e){if(_.has(S,e)||_.has(P,e))return new O(e);var t=Object.keys(k).find((function(t){return new RegExp("^"+t).test(e)}));if(t){var n=e.replace(new RegExp("^"+t),"");if(_.has(S,n)||P[n]&&P[n].prefixes===T)return new l(k[t],new O(n));throw new Error(n+" does not allow prefixes")}return new O(e)};e.unitParse=function(t){try{var n=e.unitParser.parse(t),s=[];n.unit.num.forEach((function(e){s.push(new c(C(e.name),new y(e.pow)))})),n.unit.denom.forEach((function(e){s.push(new c(C(e.name),new y(-1*e.pow)))}));var i=new l(s).flatten();return"unitMagnitude"===n.type?{parsed:!0,unit:i,expr:new l([new j(+n.magnitude)].concat(s)),coefficient:n.magnitude,type:n.type}:{parsed:!0,unit:i,type:n.type}}catch(r){return{parsed:!1,error:r.message}}},_.extend(O.prototype,{func:O,args:function(){return[this.symbol]},recurse:function(){return this},eval:function(e,t){return 1},getUnits:function(){return[{unit:this.symbol,pow:1}]},codegen:function(){return"1"},print:function(){return this.symbol},tex:function(){return this.symbol},collect:function(e){if(_.has(S,this.symbol))return this;if(_.has(P,this.symbol))return P[this.symbol].conversion;throw new Error("could not understand unit: "+this.symbol)}});var S={m:new O("m"),g:new O("g"),s:new O("s"),A:new O("A"),K:new O("K"),mol:new O("mol"),cd:new O("cd")},k={a:new c(new y(10),new y(-18)),f:new c(new y(10),new y(-15)),p:new c(new y(10),new y(-12)),n:new c(new y(10),new y(-9)),u:new c(new y(10),new y(-6)),m:new c(new y(10),new y(-3)),c:new c(new y(10),new y(-2)),d:new c(new y(10),new y(-1)),da:new y(10),h:new c(new y(10),new y(2)),k:new c(new y(10),new y(3)),M:new c(new y(10),new y(6)),G:new c(new y(10),new y(9)),T:new c(new y(10),new y(12)),P:new c(new y(10),new y(15)),E:new c(new y(10),new y(18)),hella:new c(new y(10),new y(27))},T={},M={},N=function(t,n){var s=t.split("|"),i=s[0].trim(),r=s[1].trim(),o=v.One;""!==i&&(o=e.parse(i).expr);var a=r.split("/"),h=[o];return a[0]&&a[0].split(" ").filter((function(e){return""!==e})).map((function(e){h.push(new O(e))})),a[1]&&a[1].split(" ").filter((function(e){return""!==e})).map((function(e){h.push(new c(new O(e),v.Div))})),{conversion:new l(h),prefixes:n}},P={Da:N("1.6605388628 x 10^-24 | g",T),u:N("| Da",M),meter:N("| m",M),meters:N("| m",M),in:N("254 / 10000 | m",M),ft:N("3048  / 10000 | m",M),yd:N("9144  / 10000 | m",M),mi:N("1609344 / 1000 | m",M),ly:N("9.4607 x 10^15 | m",M),nmi:N("1852 | m",M),"\xc5":N("10^-10 | m",M),pc:N("3.0857 x 10^16 | m",M),min:N("60 | s",M),hr:N("3600 | s",M),sec:N("| s",M),day:N("86400 | s",M),wk:N("604800 | s",M),fortnight:N("14 | day",M),shake:N("10^-8 | s",M),olympiad:N("126200000 | s",M),"\xb0C":N("1 | K",M),"\xb0F":N("5/9 | K",M),"\xb0R":N("5/9 | K",M),e:N("1.6021765314 x 10^-19 | C",M),c:N("299792458 | m / s",M),kn:N("514/1000 | m / s",M),kt:N("| kn",M),knot:N("| kn",M),J:N("| N m",T),BTU:N("1060 | J",M),cal:N("4184 / 1000 | J",T),eV:N("1.602176514 x 10^-19 | J",T),erg:N("10^\u22127 | J",T),W:N("| J / s",T),"H-e":N("80 | W",M),N:N("1000 | g m / s s",T),lb:N("4448221615 / 1000000000 | N",M),dyn:N("10^-5 | N",M),Pa:N("1 | N / m m m",T),bar:N("10^5 | Pa",T),"\u33d4":N("1/1000 | bar",M),"\u3374":N("| bar",M),atm:N("101325 | Pa",M),Torr:N("1/760 | atm",M),mmHg:N("| Torr",M),ha:N("10^4 | m m",M),b:N("10^\u221228 | m m",T),barn:N("| b",T),acre:N("4046.87 | m m",M),skilodge:N("10^-31 | m m",M),outhouse:N("10^-34 | m m",M),shed:N("10^-52 | m m",M),L:N("1/1000 | m m m",T),gal:N("3785/1000 | L",T),cup:N("1/16 | gal",M),qt:N("1/4 | gal",M),quart:N("| qt",M),p:N("1/8 | gal",M),pt:N("| p",M),pint:N("| p",M),"fl oz":N("1/8 | cup",M),"fl. oz.":N("1/8 | cup",M),tbsp:N("1/16 | cup",M),tsp:N("1/3 | tbsp",M),rev:N("2 pi | rad",M),deg:N("180 pi | rad",M),"\xb0":N("| deg",M),arcminute:N("1/60 | deg",M),arcsec:N("1/3600 | deg",M),Hu:N("1000 | dB",T),dozen:N("12 |",M),mol:N("6.0221412927 x 10^23 |",T),"%":N("1/100 |",M),percent:N("| %",M),ppm:N("1/1000000 |",M),V:N("1000 | g m m / s s C",T),C:N("| A s",T),ampere:N("| A",M),"\u03a9":N("| V / A",T),ohm:N("| \u03a9",M),F:N("| C / V",T),H:N("| ohm s",T),T:N("1000 | g / C s",T),Wb:N("1000 | g m m / C s",T),lm:N("pi x 10^4 | cd / m m",M),lx:N("| lm / m m",M),nit:N("| cd / m m",M),sb:N("10^4 | cd / m m",M),stilb:N("1 | sb",M),apostilb:N("1 / pi x 10^(-4) | sb",M),blondel:N("| apostilb",M),asb:N("| apostilb",M),la:N("| lm",M),Lb:N("| lm",M),sk:N("10^-7 | lm",M),skot:N("| sk",M),bril:N("10^-11 | lm",M),Hz:N("| / s",T)};e.Add=a,e.Mul=l,e.Pow=c,e.Log=h,e.Eq=d,e.Trig=p,e.Abs=u,e.Func=f,e.Var=m,e.Const=b,e.Unit=O,e.Rational=x,e.Int=y,e.Float=j,e.Zero=v.Zero,e.One=v.One}(H),function(e){e.compare=function(e,t,n){var s={form:!1,simplify:!1};n=void 0!==n?_.extend(s,n):s;var i=e.sameVars(t);if(!i.equal){var r=null;return i.equalIgnoringCase&&(r="Some of your variables are in the wrong case (upper vs. lower)."),{equal:!1,message:r}}return e.compare(t)?n.form&&!e.sameForm(t)?{equal:!1,message:"Your answer is not in the correct form."}:n.simplify&&!e.isSimplified()?{equal:!1,message:"Your answer is not fully expanded and simplified."}:{equal:!0,message:null}:{equal:!1,message:null}}}(H);var U=H,G=n(6),Y={exports:{}};Y.exports;x.b;const K=G.a.number,X={cleanMath:function(e){return"string"===typeof e?e.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):e},bound:function(e){return 0===e?e:e<0?-X.bound(-e):Math.max(1e-6,Math.min(e,1e20))},factorial:function(e){return e<=1?e:e*X.factorial(e-1)},getGCD:function(e,t){if(arguments.length>2){const t=[].slice.call(arguments,1);return X.getGCD(e,X.getGCD(...t))}{let n;for(e=Math.abs(e),t=Math.abs(t);t;)n=e%t,e=t,t=n;return e}},getLCM:function(e,t){if(arguments.length>2){const t=[].slice.call(arguments,1);return X.getLCM(e,X.getLCM(...t))}return Math.abs(e*t)/X.getGCD(e,t)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],isPrime:function(e){if(e<=1)return!1;if(e<101)return!!l.a.grep(X.primes,(function(t,n){return Math.abs(t-e)<=.5})).length;if(e<=1||e>2&&e%2===0)return!1;for(let t=3,n=Math.sqrt(e);t<=n;t+=2)if(e%t===0)return!1;return!0},getPrimeFactorization:function(e){if(1===e)return[];if(X.isPrime(e))return[e];const t=Math.sqrt(e);for(let n=2;n<=t;n++)if(e%n===0)return l.a.merge(X.getPrimeFactorization(n),X.getPrimeFactorization(e/n))},roundToNearest:function(e,t){return Math.round(t/e)*e},roundTo:function(e,t){const n=Math.pow(10,e).toFixed(5);return Math.round((t*n).toFixed(5))/n},toFixedApprox:function(e,t){const n=e.toFixed(t);return K.equal(+n,e)?n:"\\approx "+n},roundToApprox:function(e,t){const n=X.roundTo(t,e);return K.equal(n,e)?String(n):X.toFixedApprox(e,t)},toFraction:function(e,t){if(null==t&&(t=Math.pow(2,-46)),e<0||e>1){let n=e%1;n+=n<0?1:0;const s=X.toFraction(n,t);return s[0]+=Math.round(e-n)*s[1],s}if(Math.abs(Math.round(Number(e))-e)<=t)return[Math.round(e),1];{let n=0,s=1,i=1,r=1,o=1,a=2;for(;;){if(Math.abs(Number(o/a)-e)<=t)return[o,a];o/a<e?(n=o,s=a):(i=o,r=a),o=n+i,a=s+r}}},getNumericFormat:function(e){if((e=(e=l.a.trim(e)).replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1")).match(/^[+-]?\d+$/))return"integer";if(e.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";const t=e.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return t?parseFloat(t[1])>parseFloat(t[2])?"improper":"proper":e.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":e.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(e,t){if(null==e)return"";if(0===e)return"0";if("percent"===t)return 100*e+"%";if("pi"===t){const t=K.toFraction(e/Math.PI),n=Math.abs(t[0]),s=t[1];if(K.isInteger(n)){return(e<0?"-":"")+(1===n?"":n)+"\u03c0"+(1===s?"":"/"+s)}}if(["proper","improper","mixed","fraction"].includes(t)){const n=K.toFraction(e),s=Math.abs(n[0]),i=n[1],r=e<0?"-":"";if(1===i)return r+s;if("mixed"===t){const e=s%i,t=(s-e)/i;return r+(t?t+" ":"")+e+"/"+i}return r+s+"/"+i}return String(e)}};Y.exports=X;var Z=Y.exports,J={exports:{}};J.exports;const Q=l.a,ee=x.b,te=Z,ne=Math.pow(2,-42),se={predicate:{defaultForms:"integer, proper, improper, mixed, decimal",createValidatorFunctional:function(e,t){let n;t=ee.extend({simplify:"required",ratio:!1,forms:se.predicate.defaultForms},t),n=ee.isArray(t.forms)?t.forms:t.forms.split(/\s*,\s*/),void 0===t.inexact&&(t.maxError=0),t.maxError=+t.maxError+ne,ee.contains(n,"percent")&&(n=ee.without(n,"percent"),n.push("percent"));const s=function(e){const n=(e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"")).match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),s=parseInt(e,10);if(n){const e=parseFloat(n[1]),s=parseFloat(n[2]);return[{value:e/s,exact:s>0&&(t.ratio||"1"!==n[2])&&1===te.getGCD(e,s)}]}return isNaN(s)||""+s!==e?[]:[{value:s,exact:!0}]},i={integer:function(e){const t=i.decimal(e),n=i.decimal(e,1);return null!=t[0].value&&t[0].value===n[0].value||null!=t[1].value&&t[1].value===n[1].value?t:[]},proper:function(e){return Q.map(s(e),(function(e){return Math.abs(e.value)<1?[e]:[]}))},improper:function(e){return Q.map(s(e),(function(e){return Math.abs(e.value)>=1?[e]:[]}))},pi:function(e){let t,n=[];if(t=(e=e.replace(/\u2212/,"-")).match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))n=[{value:parseFloat(t[1]+"1"),exact:!0}];else if(t=e.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))n=s(t[1]);else if(t=e.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){const e=parseFloat(t[1]+"1"),s=parseFloat(t[2]),i=parseFloat(t[3]),r=parseFloat(t[4]);n=[{value:e*(s+i/r),exact:i<r&&1===te.getGCD(i,r)}]}else if(t=e.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))n=s(t[1]+"/"+t[3]);else if(t=e.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))n=s(t[1]+"1/"+t[3]);else if("0"===e)n=[{value:0,exact:!0}];else{if(!(t=e.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))){n=ee.reduce(se.predicate.defaultForms.split(/\s*,\s*/),(function(t,n){return t.concat(i[n](e))}),[]);let t=!1;const s=parseFloat(e);if(isNaN(s)||s===parseInt(e))e.match(/\/\s*7/)&&(t=!0);else{const e=Math.PI/12,n=e*Math.round(s/e);Math.abs(s-n)<.01&&(t=!0)}return t&&ee.each(n,(function(e){e.piApprox=!0})),n}n=i.decimal(t[1])}let r=Math.PI;return e.match(/\\?tau|t|\u03c4/)&&(r=2*Math.PI),e.match(/pau/)&&(r=1.5*Math.PI),Q.each(n,(function(e,t){t.value*=r})),n},coefficient:function(e){let t=[];return""===(e=e.replace(/\u2212/,"-"))?t=[{value:1,exact:!0}]:"-"===e&&(t=[{value:-1,exact:!0}]),t},log:function(e){let t,n=[];return(t=(e=(e=e.replace(/\u2212/,"-")).replace(/[ \(\)]/g,"")).match(/^log\s*(\S+)\s*$/i))?n=i.decimal(t[1]):"0"===e&&(n=[{value:0,exact:!0}]),n},percent:function(e){e=Q.trim(e);let t=!1;e.indexOf("%")===e.length-1&&(e=Q.trim(e.substring(0,e.length-1)),t=!0);const n=i.decimal(e);return Q.each(n,(function(e,n){n.exact=t,n.value=n.value/100})),n},mixed:function(e){const t=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(t){const e=parseFloat(t[1]+"1"),n=parseFloat(t[2]),s=parseFloat(t[3]),i=parseFloat(t[4]);return[{value:e*(n+s/i),exact:s<i&&1===te.getGCD(s,i)}]}return[]},decimal:function(e,n){null==n&&(n=1e10);const s=function(e){const s=(e=Q.trim(e)).replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),i=e.match(/^0[0,]*,/);if(s&&!i){let e=parseFloat(s[1].replace(/[, ]/g,""));return void 0===t.inexact&&(e=Math.round(e*n)/n),e}};return[{value:s(e),exact:!0},{value:function(e){return e=e.replace(/([\.,])/g,(function(e,t){return"."===t?",":"."})),s(e)}(e),exact:!0}]}};return function(s){const r=null!=t.fallback?""+t.fallback:"",o={empty:""===(s=Q.trim(s)||r),correct:!1,message:null,guess:s};if(Q.each(n,(function(n,r){const a=i[r](s);for(let s=0,i=a.length;s<i;s++){const n=a[s].value,i=a[s].exact,l=a[s].piApprox;if(e(n,t.maxError))return i||"optional"===t.simplify?(o.correct=!0,o.message=t.message||null,o.empty=!1):"percent"===r?(o.empty=!0,o.message=i18n._("Your answer is almost correct, but it is missing a <code>\\%</code> at the end.")):("enforced"!==t.simplify&&(o.empty=!0),o.message=i18n._("Your answer is almost correct, but it needs to be simplified.")),!1;l&&e(n,Math.abs(.001*n))&&(o.empty=!0,o.message=i18n._("Your answer is close, but you may have approximated pi. Enter your answer as a multiple of pi, like <code>12\\ \\text{pi}</code> or <code>2/3\\ \\text{pi}</code>"))}})),!1===o.correct){let e=!1;if(ee.each(i,(function(t){ee.any(t(s),(function(e){return null!=e.value&&!ee.isNaN(e.value)}))&&(e=!0)})),!e)return o.empty=!0,o.message=i18n._("We could not understand your answer. Please check your answer for extra text or symbols."),o}return o}}},number:{convertToPredicate:function(e,t){const n=parseFloat(Q.trim(e));return[function(e,t){return Math.abs(e-n)<t},Q.extend({},t,{type:"predicate"})]},createValidatorFunctional:function(e,t){return se.predicate.createValidatorFunctional(...se.number.convertToPredicate(e,t))}},expression:{parseSolution:function(e,t){let n=U.parse(e,t);if(!n.parsed)throw new Error("The provided solution ("+e+") didn't parse.");if(t.simplified&&!n.expr.isSimplified())throw new Error("The provided solution ("+e+") isn't fully expanded and simplified.");return n=n.expr,n},createValidatorFunctional:function(e,t){return function(n){const s={empty:!1,correct:!1,message:null,guess:n};if(!n)return s.empty=!0,s;const i=U.parse(n,t);if(!i.parsed)return s.empty=!0,s;"string"===typeof e&&(e=se.expression.parseSolution(e,t));const r=U.compare(i.expr,e,t);if(r.equal)s.correct=!0;else if(r.message)s.message=r.message;else{const i=U.parse(n.replace(/[xX]/g,"*"),t);if(i.parsed){const n=U.compare(i.expr,e,t);n.equal?(s.empty=!0,s.message="I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign."):n.message&&(s.message=n.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return s}}}};J.exports=se;var ie=J.exports;const re=x.b,oe=ie,ae=function(e,t,n){return re.isArray(e)?re.map(e,(function(e){return ae(e,t)})):t.call(n,e)},le={inputPathsEqual:(e,t)=>null==e||null==t?null==e===(null==t):e.length===t.length&&e.every(((e,n)=>t[n]===e)),nestedMap:ae,rWidgetParts:/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]$/,rWidgetRule:/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/,rTypeFromWidgetId:/^([a-z-]+) ([0-9]+)$/,snowman:"\u2603",noScore:{type:"points",earned:0,total:0,message:null},seededRNG:function(e){var t=e;return function(){var e=t;return(t=268435455&(e=4294967295&(3042594569^(e=(e=4294967295&((e=(e=4294967295&(3345072700^(e=e+2127912214+(e<<12)&4294967295)^e>>>19))+374761393+(e<<5)&4294967295)+3550635116^e<<9))+4251993797+(e<<3)&4294967295)^e>>>16)))/268435456}},shuffle:function(e,t,n){var s,i=re.clone(e);if(!i.length||re.all(i,(function(e){return re.isEqual(e,i[0])})))return i;s=re.isFunction(t)?t:le.seededRNG(t);do{for(var r=i.length;r>0;r--){var o=Math.floor(s()*r),a=i[o];i[o]=i[r-1],i[r-1]=a}}while(n&&re.isEqual(e,i));return i},split:"x".split(/(.)/g).length?function(e,t){return e.split(t)}:function(e,t){for(var n,s=[],i=t.lastIndex=0;n=t.exec(e);)s.push(e.slice(i,n.index)),s.push.apply(s,n.slice(1)),i=n.index+n[0].length;return s.push(e.slice(i)),s},combineScores:function(e,t){var n;return"points"===e.type&&"points"===t.type?(n=e.message&&t.message&&e.message!==t.message?null:e.message||t.message,{type:"points",earned:e.earned+t.earned,total:e.total+t.total,message:n}):"points"===e.type&&"invalid"===t.type?t:"invalid"===e.type&&"points"===t.type?e:"invalid"===e.type&&"invalid"===t.type?{type:"invalid",message:n=e.message&&t.message&&e.message!==t.message?null:e.message||t.message}:void 0},keScoreFromPerseusScore:function(e,t,n){if("points"===e.type)return{empty:!1,correct:e.earned>=e.total,message:e.message,guess:t,state:n};if("invalid"===e.type)return{empty:!0,correct:!1,message:e.message,guess:t,state:n};throw new Error("Invalid score type: "+e.type)},firstNumericalParse:function(e){var t;return oe.predicate.createValidatorFunctional((function(e){return t=e,!0}),{simplify:"optional",inexact:!0,forms:"integer, proper, improper, pi, log, mixed, decimal"})(e),t},stringArrayOfSize:function(e){return re.times(e,(function(){return""}))},gridDimensionConfig:function(e,t,n,s){var i=le.scaleFromExtent(t,n);return{scale:i,tickStep:e/s,unityLabel:e*i>30}},getGridStep:function(e,t,n){return re.times(2,(function(s){var i=le.scaleFromExtent(e[s],n);return le.gridStepFromTickStep(t[s],i)}))},snapStepFromGridStep:function(e){return re.map(e,(function(e){return e/2}))},scaleFromExtent:function(e,t){return t/(e[1]-e[0])},tickStepFromExtent:function(e,t){var n=e[1]-e[0],s=(15<n&&n<=20?23:n>100||n<5?10:16)*(t/500);return le.tickStepFromNumTicks(n,s)},gridStepFromTickStep:function(e,t){var n=e*t,s=e,i=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),r=Math.floor(s/i);return n<25?e:n<50?5===r?e:e/2:1===r?e/2:2===r?e/4:5===r?e/5:void 0},tickStepFromNumTicks:function(e,t){var n=Math.pow(10,Math.floor(Math.log(e/t)/Math.LN10)),s=t/e*n;return s<=.15?n*=10:s<=.35?n*=5:s<=.75&&(n*=2),n},constrainedTickStepsFromTickSteps:function(e,t){const n=[];for(let s=0;s<2;s++){const i=t[s][1]-t[s][0],r=i/e[s];n[s]=r<=10?e[s]:r<=20?2*e[s]:le.tickStepFromNumTicks(i,10)}return n},DeprecationMixin:{componentWillMount:function(){var e={};re.each(this.deprecatedProps,(function(t,n){re.has(this.props,n)&&re.extend(e,t(this.props))}),this),re.isEmpty(e)||(re.extend(this.props,e),setTimeout(this.props.onChange,0,e))}},eq:function(e,t){return re.isNumber(e)&&re.isNumber(t)?Math.abs(e-t)<1e-9:e===t},deepEq:function(e,t){if(re.isArray(e)&&re.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!le.deepEq(e[n],t[n]))return!1;return!0}return!re.isArray(e)&&!re.isArray(t)&&(re.isFunction(e)&&re.isFunction(t)?le.eq(e,t):!re.isFunction(e)&&!re.isFunction(t)&&(re.isObject(e)&&re.isObject(t)?e===t||re.all(e,(function(e,n){return le.deepEq(t[n],e)}))&&re.all(t,(function(t,n){return le.deepEq(e[n],t)})):!re.isObject(e)&&!re.isObject(t)&&le.eq(e,t)))},parseQueryString:function(e){e=e||window.location.search.substring(1);for(var t,n={},s=/\+/g,i=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(s," "))};t=i.exec(e);)n[r(t[1])]=r(t[2]);return n},updateQueryString:function(e,t,n){n=encodeURIComponent(n);var s=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(s)?e.replace(s,"$1"+t+"="+n+"$2"):e+i+t+"="+n},strongEncodeURIComponent:function(e){return encodeURIComponent(e).replace(/['()!]/g,window.escape).replace(/\*/g,"%2A")},widgetShouldHighlight:function(e){if(!e)return!1;return!re.contains(["measurer","protractor"],e.type)},scoreIsEmpty:function(e){return"invalid"===e.type&&(!e.message||0===e.message.length)},touchHandlers:{pointerDown:!1,currentTouchIdentifier:null},resetTouchHandlers:function(){re.extend(le.touchHandlers,{pointerDown:!1,currentTouchIdentifier:null})},extractPointerLocation:function(e){var t;if(le.touchHandlers.pointerDown){if(null!=le.touchHandlers.currentTouchIdentifier)for(var n=e.changedTouches?e.changedTouches.length:0,s=0;s<n;s++)e.changedTouches[s].identifier===le.touchHandlers.currentTouchIdentifier&&(t=e.changedTouches[s]);else t=e;var i="touchend"===e.type||"touchcancel"===e.type;t&&i&&(le.touchHandlers.pointerDown=!1,le.touchHandlers.currentTouchIdentifier=null)}else le.touchHandlers.pointerDown=!0,e.changedTouches?(t=e.changedTouches[0],le.touchHandlers.currentTouchIdentifier=t.identifier):t=e;if(t)return{left:t.pageX,top:t.pageY}},captureScratchpadTouchStart:function(e){e.stopPropagation()},getImageSize:function(e,t){var n=new Image;n.onload=function(){0===n.width&&0===n.height?(document.body.appendChild(n),re.defer((function(){t(n.clientWidth,n.clientHeight),document.body.removeChild(n)}))):t(n.width,n.height)},n.src=V(e)},textarea:{getWordBeforeCursor:function(e){var t=e.value,n=e.selectionStart-1,s=Math.max(t.lastIndexOf("\n",n),t.lastIndexOf(" ",n))+1;return{string:t.substring(s,n+1),pos:{start:s,end:n}}},moveCursor:function(e,t){e.selectionStart=t,e.selectionEnd=t}}};le.random=le.seededRNG(4294967295&(new Date).getTime());var ce=le;class he{constructor(e,t,n){this.content=e,this.hint=t,this.tags=n,this.array=ue}setContentMapper(e){return new he(e,this.hint,this.tags)}setHintMapper(e){return new he(this.content,e,this.tags)}setTagsMapper(e){return new he(this.content,this.hint,e)}setArrayMapper(e){return new pe(this.content,this.hint,this.tags,e)}mapTree(e,t){return ge(e,t,[],this)}}class pe{constructor(e,t,n,s){this.content=e,this.hint=t,this.tags=n,this.array=s}setArrayMapper(e){return new pe(this.content,this.hint,this.tags,e)}mapTree(e,t){return ge(e,t,[],this)}}function ue(e){return e}function de(){return new he(ue,ue,ue)}function ge(e,t,n,s){if("content"===t.type){const i=e;return s.content(i,t,n)}if("hint"===t.type){const i=e;return s.hint(i,t,n)}if("tags"===t.type){const i=e;return s.tags(i,t,n)}if("array"===t.type){const i=e;if(!Array.isArray(i))throw new Error(`Invalid object of type "${typeof i}" found at path ${["<root>"].concat(n).join(".")}. Expected array.`);const r=t.elementShape,o=i.map(((e,t)=>ge(e,r,n.concat(t),s)));return s.array(o,i,t,n)}if("object"===t.type){const i=e;if(i&&"object"!==typeof i)throw new Error(`Invalid object of type "${typeof i}" found at path ${["<root>"].concat(n).join(".")}. Expected "object" type.`);const r=t.shape;if(!r)throw new Error(`Unexpected shape ${JSON.stringify(t)} at path ${["<root>"].concat(n).join(".")}.`);const o={};return Object.keys(r).forEach((e=>{if(!(e in i))throw new Error(`Key "${e}" is missing from shape at path ${["<root>"].concat(n).join(".")}.`);o[e]=ge(i[e],r[e],n.concat(e),s)})),o}throw new Error(`unexpected shape type ${t.type}`)}const fe=x.b,me=function(e,t){const n={};return fe.each(fe.keys(e),(function(s){n[s]=t(e[s],s)})),n},be=function(e,t){const n={};return fe.each(e,(function(e){n[e]=t(e)})),n};var ve={pluck:function(e,t){return fe.object(fe.map(e,(function(e,n){return[n,e[t]]})))},mapObject:me,mapObjectFromArray:be},xe=n(13),ye=n.n(xe);h.a,PropTypes.shape({contentType:PropTypes.string,highlightLint:PropTypes.bool,paths:PropTypes.arrayOf(PropTypes.string),stack:PropTypes.arrayOf(PropTypes.string)});const je={contentType:"",highlightLint:!1,paths:[],stack:[]};class we{static parse(e){return new Oe(e).parse()}match(e){throw new Error("Selector subclasses must implement match()")}toString(){return"Unknown selector class"}}class Oe{constructor(e){e=e.trim().replace(/\s+/g," "),this.tokens=e.match(Oe.TOKENS)||[],this.tokenIndex=0}nextToken(){return this.tokens[this.tokenIndex]||""}consume(){this.tokenIndex++}isIdentifier(){const e=this.tokens[this.tokenIndex][0];return e>="a"&&e<="z"||e>="A"&&e<="Z"}skipSpace(){for(;" "===this.nextToken();)this.consume()}parse(){const e=this.parseTreeSelector();let t=this.nextToken();if(!t)return e;const n=[e];for(;t;){if(","!==t)throw new Ce("Expected comma");this.consume(),n.push(this.parseTreeSelector()),t=this.nextToken()}return new Se(n)}parseTreeSelector(){this.skipSpace();let e=this.parseNodeSelector();for(;;){const t=this.nextToken();if(!t||","===t)break;if(" "===t)this.consume(),e=new Me(e,this.parseNodeSelector());else if(">"===t)this.consume(),e=new Ne(e,this.parseNodeSelector());else if("+"===t)this.consume(),e=new Pe(e,this.parseNodeSelector());else{if("~"!==t)throw new Ce("Unexpected token: "+t);this.consume(),e=new Ie(e,this.parseNodeSelector())}}return e}parseNodeSelector(){this.skipSpace();const e=this.nextToken();if("*"===e)return this.consume(),new ke;if(this.isIdentifier())return this.consume(),new _e(e);throw new Ce("Expected node type")}}Oe.TOKENS=/([a-zA-Z][\w-]*)|(\d+)|[^\s]|(\s(?=[a-zA-Z\*]))/g;class Ce extends Error{constructor(e){super(e)}}class Se extends we{constructor(e){super(),this.selectors=e}match(e){for(let t=0;t<this.selectors.length;t++){const n=this.selectors[t].match(e);if(n)return n}return null}toString(){let e="";for(let t=0;t<this.selectors.length;t++)e+=t>0?", ":"",e+=this.selectors[t].toString();return e}}class ke extends we{match(e){return[e.currentNode()]}toString(){return"*"}}class _e extends we{constructor(e){super(),this.type=e}match(e){const t=e.currentNode();return t.type===this.type?[t]:null}toString(){return this.type}}class Te extends we{constructor(e,t){super(),this.left=e,this.right=t}}class Me extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t)for(e=e.clone();e.hasParent();){e.goToParent();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" "+this.right.toString()}}class Ne extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t&&e.hasParent()){(e=e.clone()).goToParent();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" > "+this.right.toString()}}class Pe extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t&&e.hasPreviousSibling()){(e=e.clone()).goToPreviousSibling();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" + "+this.right.toString()}}class Ie extends Te{constructor(e,t){super(e,t)}match(e){const t=this.right.match(e);if(t)for(e=e.clone();e.hasPreviousSibling();){e.goToPreviousSibling();const n=this.left.match(e);if(n)return n.concat(t)}return null}toString(){return this.left.toString()+" ~ "+this.right.toString()}}class Ee{constructor(e,t,n,s,i,r){if(!n&&!s)throw new Error("Lint rules must have a selector or pattern");this.name=e||"unnamed rule",this.severity=t||Ee.Severity.BULK_WARNING,this.selector=n||Ee.DEFAULT_SELECTOR,this.pattern=s||null,"function"===typeof i?(this.lint=i,this.message=null):(this.lint=this._defaultLintFunction,this.message=i),this.applies=r||function(){return!0}}static makeRule(e){return new Ee(e.name,e.severity,e.selector?we.parse(e.selector):null,Ee.makePattern(e.pattern),e.lint||e.message,e.applies)}check(e,t,n,s){const i=this.selector.match(t);if(!i)return null;let r;if(r=this.pattern?n.match(this.pattern):Ee.FakePatternMatch(n,n,0),!r)return null;try{const e=this.lint(t,n,i,r,s);return e?"string"===typeof e?{rule:this.name,severity:this.severity,message:e,start:0,end:n.length}:{rule:this.name,severity:this.severity,message:e.message,start:e.start,end:e.end}:null}catch(o){return{rule:"lint-rule-failure",message:`Exception in rule ${this.name}: ${o.message}\nStack trace:\n${o.stack}`,start:0,end:n.length}}}_defaultLintFunction(e,t,n,s){return{message:this.message||"",start:s.index,end:s.index+s[0].length}}static makePattern(e){if(e){if(e instanceof RegExp)return e;if("/"===e[0]){const t=e.lastIndexOf("/"),n=e.substring(1,t),s=e.substring(t+1);return new RegExp(n,s)}return new RegExp(e)}return null}static FakePatternMatch(e,t,n){const s=[t];return s.index=n,s.input=e,s}}Ee.Severity={ERROR:1,WARNING:2,GUIDELINE:3,BULK_WARNING:4},Ee.DEFAULT_SELECTOR=we.parse("text");var Ae={exports:{}};Ae.exports;Ae.exports=Ee.makeRule({name:"image-widget",severity:Ee.Severity.BULK_WARNING,selector:"widget",lint:function(e,t,n,s,i){if("image"!==e.currentNode().widgetType)return;const r=i&&i.widgets&&i.widgets[e.currentNode().id];if(!r)return;const o=r.options.alt;return o?o.trim().length<8?`Images should have alt text:\nfor accessibility, all images should have descriptive alt text.\nThis image's alt text is only ${o.trim().length} characters long.`:r.options.caption&&r.options.caption.match(/[^\\]\$/)?"No math in image captions:\nDon't include math expressions in image captions.":void 0:'Images should have alt text:\nfor accessibility, all images should have a text description.\nAdd a description in the "Alt Text" box of the image widget.'}});var Re=Ae.exports,De={exports:{}};De.exports;De.exports=Ee.makeRule({name:"image-spaces-around-urls",severity:Ee.Severity.ERROR,selector:"image",lint:function(e,t,n,s,i){const r=n[0].target;if(i&&i.content){const e=i.content.indexOf(r);if(-1===e)return;if("("!==i.content[e-1]||")"!==i.content[e+r.length])return"Whitespace before or after image url:\nFor images, don't include any space or newlines after '(' or before ')'.\nWhitespace in image URLs causes translation difficulties."}}});var Fe=De.exports,Le={exports:{}};Le.exports;Le.exports=Ee.makeRule({name:"unbalanced-code-delimiters",severity:Ee.Severity.ERROR,pattern:/[`~]+/,message:"Unbalanced code delimiters:\ncode blocks should begin and end with the same type and number of delimiters"});var ze=Le.exports,qe={exports:{}};qe.exports;qe.exports=Ee.makeRule({name:"math-without-dollars",severity:Ee.Severity.GUIDELINE,pattern:/\\\w+{[^}]*}|{|}/,message:"This looks like LaTeX:\ndid you mean to put it inside dollar signs?"});var We=qe.exports,Be={exports:{}};Be.exports;Be.exports=Ee.makeRule({name:"profanity",pattern:/\b(shit|piss|fuck|cunt|cocksucker|motherfucker|tits)\b/i,message:"Avoid profanity"});var Ve=Be.exports,He={exports:{}};He.exports;He.exports=Ee.makeRule({name:"widget-in-table",severity:Ee.Severity.BULK_WARNING,selector:"table widget",message:"Widget in table:\ndo not put widgets inside of tables."});var Ue=He.exports,Ge={exports:{}};Ge.exports;Ge.exports=Ee.makeRule({name:"unescaped-dollar",severity:Ee.Severity.ERROR,selector:"unescapedDollar",message:"Unescaped dollar sign:\nDollar signs must appear in pairs or be escaped as \\$"});var $e=Ge.exports,Ye={exports:{}};Ye.exports;Ye.exports=Ee.makeRule({name:"table-missing-cells",severity:Ee.Severity.WARNING,selector:"table",lint:function(e,t,n,s){const i=n[0],r=i.header.length,o=i.cells.map((e=>e.length));for(let a=0;a<o.length;a++)if(o[a]!==r)return`Table rows don't match header:\nThe table header has ${r} cells, but\nRow ${a+1} has ${o[a]} cells.`}});var Ke=Ye.exports,Xe={exports:{}};Xe.exports;Xe.exports=Ee.makeRule({name:"nested-lists",severity:Ee.Severity.WARNING,selector:"list list",message:"Nested lists:\nnested lists are hard to read on mobile devices;\ndo not use additional indentation."});var Ze=Xe.exports,Je={exports:{}};Je.exports;Je.exports=Ee.makeRule({name:"math-text-empty",severity:Ee.Severity.WARNING,selector:"math, blockMath",pattern:/\\text{\s*}/,message:"Empty \\text{} block in math expression"});var Qe=Je.exports,et={exports:{}};et.exports;et.exports=Ee.makeRule({name:"math-starts-with-space",severity:Ee.Severity.GUIDELINE,selector:"math, blockMath",pattern:/^\s*(~|\\qquad|\\quad|\\,|\\;|\\:|\\ |\\!|\\enspace|\\phantom)/,message:"Math starts with space:\nmath should not be indented. Do not begin math expressions with\nLaTeX space commands like ~, \\;, \\quad, or \\phantom"});var tt=et.exports,nt={exports:{}};nt.exports;nt.exports=Ee.makeRule({name:"math-nested",severity:Ee.Severity.ERROR,selector:"math, blockMath",pattern:/\\text{[^$}]*\$[^$}]*\$[^}]*}/,message:"Nested math:\nDon't nest math expressions inside \\text{} blocks"});var st=nt.exports,it={exports:{}};it.exports;it.exports=Ee.makeRule({name:"math-frac",severity:Ee.Severity.GUIDELINE,selector:"math, blockMath",pattern:/\\frac[ {]/,message:"Use \\dfrac instead of \\frac in your math expressions."});var rt=it.exports,ot={exports:{}};ot.exports;ot.exports=Ee.makeRule({name:"math-font-size",severity:Ee.Severity.GUIDELINE,selector:"math, blockMath",pattern:/\\(tiny|Tiny|small|large|Large|LARGE|huge|Huge|scriptsize|normalsize)\s*{/,message:"Math font size:\nDon't change the default font size with \\Large{} or similar commands"});var at=ot.exports,lt={exports:{}};lt.exports;lt.exports=Ee.makeRule({name:"math-empty",severity:Ee.Severity.WARNING,selector:"math, blockMath",pattern:/^$/,message:"Empty math: don't use $$ in your markdown."});var ct=lt.exports,ht={exports:{}};ht.exports;ht.exports=Ee.makeRule({name:"math-align-linebreaks",severity:Ee.Severity.WARNING,selector:"blockMath",pattern:/\\begin{align}.*[^\\](\\{2,3}[^\\]|\\{5,}).*\\end{align}/,message:"Use four backslashes between lines of an align block"});var pt=ht.exports,ut={exports:{}};ut.exports;ut.exports=Ee.makeRule({name:"math-align-extra-break",severity:Ee.Severity.WARNING,selector:"blockMath",pattern:/(\\{2,})\s*\\end{align}/,message:"Extra space at end of block:\nDon't end an align block with backslashes"});var dt=ut.exports,gt={exports:{}};gt.exports;gt.exports=Ee.makeRule({name:"math-adjacent",severity:Ee.Severity.WARNING,selector:"blockMath+blockMath",message:"Adjacent math blocks:\ncombine the blocks between \\begin{align} and \\end{align}"});var ft=gt.exports,mt={exports:{}};mt.exports;mt.exports=Ee.makeRule({name:"long-paragraph",severity:Ee.Severity.GUIDELINE,selector:"paragraph",pattern:/^.{501,}/,lint:function(e,t,n,s){return`Paragraph too long:\nThis paragraph is ${t.length} characters long.\nShorten it to 500 characters or fewer.`}});var bt=mt.exports,vt={exports:{}};vt.exports;vt.exports=Ee.makeRule({name:"link-click-here",severity:Ee.Severity.WARNING,selector:"link",pattern:/click here/i,message:'Inappropriate link text:\nDo not use the words "click here" in links.'});var xt=vt.exports,yt={exports:{}};yt.exports;yt.exports=Ee.makeRule({name:"image-in-table",severity:Ee.Severity.BULK_WARNING,selector:"table image",message:"Image in table:\ndo not put images inside of tables."});var jt=yt.exports,wt={exports:{}};wt.exports;wt.exports=Ee.makeRule({name:"image-alt-text",severity:Ee.Severity.BULK_WARNING,selector:"image",lint:function(e,t,n,s){const i=n[0];return i.alt&&i.alt.trim()?i.alt.length<8?`Images should have alt text:\nfor accessibility, all images should have descriptive alt text.\nThis image's alt text is only ${i.alt.length} characters long.`:void 0:"Images should have alt text:\nfor accessibility, all images should have alt text.\nSpecify alt text inside square brackets after the !."}});var Ot=wt.exports,Ct={exports:{}};Ct.exports;const St={and:!0,nor:!0,but:!0,the:!0,for:!0};Ct.exports=Ee.makeRule({name:"heading-title-case",severity:Ee.Severity.GUIDELINE,selector:"heading",pattern:/[^\s:]\s+[A-Z]+[a-z]/,locale:"en",lint:function(e,t,n,s){let i=t.trim().split(/\s+/);if(i.shift(),i=i.filter((e=>e.length>2&&!St.hasOwnProperty(e))),i.length>=3&&i.every((e=>function(e){const t=e[0];return t===t.toUpperCase()}(e))))return"Title-case heading:\nThis heading appears to be in title-case, but should be sentence-case.\nOnly capitalize the first letter and proper nouns."}});var kt=Ct.exports,_t={exports:{}};_t.exports;_t.exports=Ee.makeRule({name:"heading-sentence-case",severity:Ee.Severity.GUIDELINE,selector:"heading",pattern:/^\W*[a-z]/,message:"First letter is lowercase:\nthe first letter of a heading should be capitalized."});var Tt=_t.exports,Mt={exports:{}};Mt.exports;Mt.exports=Ee.makeRule({name:"heading-level-skip",severity:Ee.Severity.WARNING,selector:"heading ~ heading",lint:function(e,t,n,s){const i=n[1],r=n[0];if(i.level>r.level+1)return`Skipped heading level:\nthis heading is level ${i.level} but\nthe previous heading was level ${r.level}`}});var Nt=Mt.exports,Pt={exports:{}};Pt.exports;Pt.exports=Ee.makeRule({name:"heading-level-1",severity:Ee.Severity.WARNING,selector:"heading",lint:function(e,t,n,s){if(1===n[0].level)return"Don't use level-1 headings:\nBegin headings with two or more # characters."}});var It=Pt.exports,Et={exports:{}};Et.exports;Et.exports=Ee.makeRule({name:"extra-content-spacing",selector:"paragraph",pattern:/\s+$/,applies:function(e){return"article"===e.contentType},message:"No extra whitespace at the end of content blocks."});var At=Et.exports,Rt={exports:{}};Rt.exports;Rt.exports=Ee.makeRule({name:"double-spacing-after-terminal",severity:Ee.Severity.BULK_WARNING,selector:"paragraph",pattern:/[.!\?] {2}/i,message:"Use a single space after a sentence-ending period, or\nany other kind of terminal punctuation."});var Dt=Rt.exports,Ft={exports:{}};Ft.exports;Ft.exports=Ee.makeRule({name:"blockquoted-widget",severity:Ee.Severity.WARNING,selector:"blockQuote widget",message:"Blockquoted widget:\nwidgets should not be indented."});var Lt=Ft.exports,zt={exports:{}};zt.exports;zt.exports=Ee.makeRule({name:"blockquoted-math",severity:Ee.Severity.WARNING,selector:"blockQuote math, blockQuote blockMath",message:"Blockquoted math:\nmath should not be indented."});var qt=zt.exports;const Wt=/\/\/([^\/]+)/;function Bt(e){if(!e)return"";const t=e.match(Wt);return t?t[1]:""}var Vt={exports:{}};Vt.exports;Vt.exports=Ee.makeRule({name:"absolute-url",severity:Ee.Severity.GUIDELINE,selector:"link, image",lint:function(e,t,n,s){const i=Bt(n[0].target);if("khanacademy.org"===i||i.endsWith(".khanacademy.org"))return"Don't use absolute URLs:\nWhen linking to KA content or images, omit the\nhttps://www.khanacademy.org URL prefix.\nUse a relative URL beginning with / instead."}});var Ht=Vt.exports,Ut={exports:{}};Ut.exports;Ut.exports=[Ht,qt,Lt,Dt,At,It,Nt,Tt,kt,Ot,jt,xt,bt,ft,dt,pt,ct,at,rt,st,tt,Qe,Ze,Ke,$e,Ue,Ve,We,ze,Fe,Re];var Gt=Ut.exports,$t=n(0),Yt={exports:{}};Yt.exports;h.a;Yt.exports=e=>{let{path:t,width:n,height:s,style:i={},title:r}=e;return Object($t.jsxs)("svg",{role:"img","aria-hidden":!r,style:{verticalAlign:"middle",...i},width:n/s+"em",height:"1em",viewBox:`0 0 ${n} ${s}`,children:[!!r&&Object($t.jsx)("title",{children:r}),Object($t.jsx)("path",{d:t,fill:"currentColor"})]})};var Kt=Yt.exports;const Xt="'Proxima Nova',sans-serif",Zt="'Proxima Nova Semibold',sans-serif",Jt="#71B307",Qt="#1C758A",en="#FFBABA",tn="#FFFFFF",nn="#F0F1F2",sn="#D6D8DA",rn="#BABEC2",on="#888D93",an="#21242c",ln="#F86700",cn="#F9F9F9",hn="#0084CE",pn="#009900",un="#00CC00",dn="#990000",gn="#CC5252",fn=16,mn=-16,bn=16,vn=400,xn=288,yn="#f86700",jn="#df5c00",wn=Jt;var On=n(3);h.a;const Cn=i.a,Sn=Kt,kn={path:"M6 11a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm0-9a1 1 0 0 1 1 1v4a1 1 0 1 1-2 0V3a1 1 0 0 1 1-1z",height:12,width:12},_n=createReactClass({displayName:"Lint",getInitialState:function(){return{tooltipAbove:!0}},componentDidMount:function(){this._positionTimeout=window.setTimeout(this.getPosition)},componentWillUnmount:function(){window.clearTimeout(this._positionTimeout)},getPosition:function(){const e=Cn.findDOMNode(this).getBoundingClientRect();this.setState({tooltipAbove:e.top>100})},renderLink:function(e){const t=this.state.tooltipAbove;let n,s,i;return 1===this.props.severity?(n=Tn.indicatorError,s="Error",i=Tn.publishBlockingError):2===this.props.severity?(n=Tn.indicatorWarning,s="Warning",i=Tn.warning):(n=Tn.indicatorGuideline,s="Recommendation",i=Tn.warning),Object($t.jsxs)("a",{href:"https://khanacademy.org/r/linter-rules#"+this.props.ruleName,target:"lint-help-window",className:Object(On.css)(e),children:[Object($t.jsx)("span",{className:Object(On.css)(Tn.indicator,n),children:1===this.props.severity&&Object($t.jsx)(Sn,{...kn})}),Object($t.jsxs)("div",{className:Object(On.css)(Tn.tooltip,t&&Tn.tooltipAbove),children:[this.props.message.split("\n\n").map(((e,t)=>Object($t.jsxs)("p",{className:Object(On.css)(Tn.tooltipParagraph),children:[Object($t.jsxs)("span",{className:Object(On.css)(i),children:[s,":"," "]}),e]},t))),Object($t.jsx)("div",{className:Object(On.css)(Tn.tail,t&&Tn.tailAbove)})]})]})},render:function(){return this.props.insideTable?this.props.inline?Object($t.jsx)("span",{"data-lint-inside-table":"true",children:this.props.children}):Object($t.jsx)("div",{"data-lint-inside-table":"true",children:this.props.children}):this.props.inline?Object($t.jsxs)("span",{className:Object(On.css)(Tn.lintContainer),children:[this.renderLink(Tn.inlineHoverTarget),Object($t.jsx)("span",{children:this.props.children})]}):Object($t.jsxs)("div",{className:Object(On.css)(Tn.lintContainer),children:[this.renderLink(Tn.hoverTarget),Object($t.jsx)("div",{children:this.props.children})]})}}),Tn=On.StyleSheet.create({lintContainer:{position:"relative"},hoverTarget:{position:"absolute",top:0,right:-40,display:"block",width:24,height:24,":hover > span":{backgroundColor:jn},":hover div":{display:"block"},":hover ~ div":{outline:"1px solid #f86700"},":hover ~ div div[data-lint-inside-table]":{outline:"1px solid #f86700"},":hover ~ div span[data-lint-inside-table]":{backgroundColor:yn,color:tn}},inlineHoverTarget:{float:"right",position:"relative",marginRight:-40,display:"block",width:24,height:24,":hover > span":{backgroundColor:jn},":hover div":{display:"block"},":hover ~ span":{backgroundColor:yn,color:tn}},indicator:{alignItems:"center",borderRadius:4,color:"white",display:"flex",fontSize:12,height:8,justifyContent:"center",margin:8,width:8},indicatorError:{backgroundColor:"#be2612",borderRadius:8,height:16,width:16},indicatorWarning:{backgroundColor:"#f86700"},indicatorGuideline:{backgroundColor:"#ffbe26"},tooltip:{position:"absolute",right:-12,display:"none",zIndex:"1000",color:tn,backgroundColor:an,opacity:"0.9",fontFamily:Xt,fontSize:"12px",lineHeight:"15px",width:"320px",borderRadius:"4px"},tooltipAbove:{bottom:32},tail:{position:"absolute",top:-12,right:16,width:0,height:0,borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderBottom:"12px solid #21242c"},tailAbove:{bottom:-12,borderBottom:"none",borderTop:"12px solid #21242c",top:"auto"},tooltipParagraph:{margin:12},warning:{color:yn,fontFamily:Zt},publishBlockingError:{color:"#be2612"}});var Mn=_n,Nn=n(19),Pn=n(40),In=n.n(Pn),En={exports:{}},An=(En.exports,x.b),Rn=In.a,Dn=Nn.a,Fn=ce;const Ln=Mn;var zn=(e,t,n)=>{var s=e.length,i=0;if(n){if(t.inline)return null;for(;i<s&&" "===e[i];)i++}if(!(i<s&&"$"===e[i]))return null;for(var r=++i,o=0;i<s;){var a=e[i];if("\\"===a)i++;else{if(o<=0&&"$"===a){var l=i+1;if(n){var c=/^(?: *\n){2,}/.exec(e.slice(l));l=c?l+c[0].length:null}return l?[e.substring(0,l),e.substring(r,i)]:null}if("{"===a)o++;else if("}"===a)o--;else if("\n"===a&&"\n"===e[i-1])return null}i++}return null},qn=new RegExp("^\\|\\| +(.*) +\\|\\| *\\n("+Rn.defaultRules.nptable.match.regex.source.substring(1)+")"),Wn=Rn.blockRegex(/^(crwdns.*)\n\s*\n/),Bn=An.extend({},Rn.defaultRules,{columns:{order:-2,match:Rn.blockRegex(/^([\s\S]*\n\n)={5,}\n\n([\s\S]*)/),parse:(e,t,n)=>({col1:t(e[1],n),col2:t(e[2],n)}),react:(e,t,n)=>Object($t.jsxs)("div",{className:"perseus-two-columns",children:[Object($t.jsx)("div",{className:"perseus-column",children:Object($t.jsx)("div",{className:"perseus-column-content",children:t(e.col1,n)})}),Object($t.jsxs)("div",{className:"perseus-column",children:[Object($t.jsx)("div",{className:"sat-header-grafting-area"}),Object($t.jsxs)("div",{className:"perseus-column-content",children:[Object($t.jsx)("div",{className:"sat-skill-subscore-grafting-area"}),t(e.col2,n),Object($t.jsx)("div",{className:"sat-grafting-area"})]})]})]},n.key)},crowdinId:{order:-1,match:(e,t,n)=>t.isJipt?Wn(e,t,n):null,parse:(e,t,n)=>({id:e[1]}),react:(e,t,n)=>e.id},titledTable:{order:Rn.defaultRules.nptable.order-.5,match:Rn.blockRegex(qn),parse:(e,t,n)=>{var s=Rn.parseInline(t,e[1],n),i=An.rest(e,2);return{title:s,table:Rn.defaultRules.nptable.parse(i,t,n)}},react:(e,t,n)=>{let s;if(e.table){const i=Rn.defaultRules.table.react(e.table,t,n),r=Object($t.jsx)("caption",{className:"perseus-table-title",children:t(e.title,n)},"caption");s=h.a.cloneElement(i,null,[r,...i.props.children])}else s="//invalid table//";return Object($t.jsx)("div",{className:"perseus-titled-table",children:s},n.key)}},widget:{order:Rn.defaultRules.link.order-.75,match:Rn.inlineRegex(Fn.rWidgetRule),parse:(e,t,n)=>({id:e[1],widgetType:e[2]}),react:(e,t,n)=>Object($t.jsxs)("em",{children:["[Widget: ",e.id,"]"]},n.key)},blockMath:{order:Rn.defaultRules.codeBlock.order+.5,match:(e,t)=>zn(e,t,!0),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>Object($t.jsx)(Dn,{children:e.content},n.key)},math:{order:Rn.defaultRules.link.order-.25,match:(e,t)=>zn(e,t,!1),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>Object($t.jsx)(Dn,{children:e.content},n.key)},unescapedDollar:{order:Rn.defaultRules.link.order-.24,match:Rn.inlineRegex(/^(?!\\)\$/),parse:(e,t,n)=>({}),react:(e,t,n)=>"$"},fence:An.extend({},Rn.defaultRules.fence,{parse:(e,t,n)=>{var s=Rn.defaultRules.fence.parse(e,t,n);return"alt"===s.lang?{type:"codeBlock",lang:"alt",content:t(s.content+"\n\n",n)}:s}}),link:An.extend({},Rn.defaultRules.link,{react:function(e,t,n){const s=Rn.defaultRules.link.react(e,t,n);let i=s.props.href;"undefined"!==typeof KA&&KA.isZeroRated&&(i=i.match(/https?:\/\/[^\/]*khanacademy.org/)?i.replace("khanacademy.org","zero.khanacademy.org"):"/zero/external-link?url="+encodeURIComponent(i));const r={...s.props,href:i};return n.baseElements&&n.baseElements.Link?n.baseElements.Link(r):h.a.cloneElement(s,r)}}),codeBlock:An.extend({},Rn.defaultRules.codeBlock,{react:(e,t,n)=>"alt"===e.lang?Object($t.jsx)("div",{className:"perseus-markdown-alt perseus-sr-only",children:t(e.content,n)},n.key):Rn.defaultRules.codeBlock.react(e,t,n)}),list:An.extend({},Rn.defaultRules.list,{match:(e,t,n)=>t.isJipt?null:Rn.defaultRules.list.match(e,t,n)}),lint:{order:1e3,match:e=>null,parse:(e,t,n)=>({}),react:(e,t,n)=>Object($t.jsx)(Ln,{message:e.message,ruleName:e.ruleName,inline:Vn(e.content),insideTable:e.insideTable,severity:e.severity,children:t(e.content,n)})}});function Vn(e){return!!(e&&e.type&&Hn.hasOwnProperty(e.type))}const Hn={text:!0,math:!0,unescapedDollar:!0,link:!0,img:!0,strong:!0,u:!0,em:!0,del:!0,code:!0};var Un=Rn.parserFor(Bn),Gn=(e,t)=>Un(e+"\n\n",An.extend({inline:!1},t)),$n=(e,t)=>{An.isArray(e)?An.each(e,(e=>$n(e,t))):An.isObject(e)&&(t(e),"table"===e.type?($n(e.header,t),$n(e.cells,t)):"list"===e.type?$n(e.items,t):"titledTable"===e.type?$n(e.table,t):"columns"===e.type?($n(e.col1,t),$n(e.col2,t)):An.isArray(e.content)&&$n(e.content,t))},Yn=e=>{if(An.isArray(e))return An.flatten(An.map(e,Yn));if(e.content&&An.isString(e.content))return-1!==e.type.toLowerCase().indexOf("code")?["",e.content,""]:[e.content.replace(/\s+/g," ")];var t=An.chain(e).values().flatten().filter((e=>null!=e&&An.has(e,"type"))).value();if(t.length){var n=Yn(t);if("paragraph"===e.type&&n.length){n[0]=n[0].replace(/^\s+/,"");var s=n.length-1;n[s]=n[s].replace(/\s+$/,"")}return n}return[]};En.exports={characterCount:e=>{var t=Gn(e);return Yn(t).join("").length},traverseContent:$n,parse:Gn,parseInline:(e,t)=>Un(e,An.extend({inline:!0},t)),reactFor:Rn.reactFor,ruleOutput:Rn.ruleOutput(Bn,"react"),basicOutput:Rn.reactFor(Rn.ruleOutput(Bn,"react")),sanitizeUrl:Rn.sanitizeUrl};var Kn=En.exports;class Xn{constructor(e){this.root=e}static isNode(e){return e&&"object"===typeof e&&"string"===typeof e.type}static isTextNode(e){return Xn.isNode(e)&&"text"===e.type&&"string"===typeof e.content}traverse(e){this._traverse(this.root,new Zn(this.root),e)}_traverse(e,t,n){let s="";if(Xn.isNode(e)){const i=e;t._containers.push(i),t._ancestors.push(i),"string"===typeof i.content&&(s=i.content);Object.keys(i).forEach((e=>{if("type"===e)return;const r=i[e];r&&"object"===typeof r&&(t._indexes.push(e),s+=this._traverse(r,t,n),t._indexes.pop())})),t._currentNode=t._ancestors.pop(),t._containers.pop(),n(i,t,s)}else if(Array.isArray(e)){const i=e;t._containers.push(i);let r=0;for(;r<i.length;)t._indexes.push(r),s+=this._traverse(i[r],t,n),r=t._indexes.pop()+1;t._containers.pop()}return s}}class Zn{constructor(e){this.root=e,this._currentNode=null,this._containers=new Jn,this._indexes=new Jn,this._ancestors=new Jn}currentNode(){return this._currentNode||this.root}parent(){return this._ancestors.top()}ancestors(){return this._ancestors.values()}nextSibling(){const e=this._containers.top();if(!e||!Array.isArray(e))return null;const t=this._indexes.top();return e.length>t+1?e[t+1]:null}previousSibling(){const e=this._containers.top();if(!e||!Array.isArray(e))return null;const t=this._indexes.top();return t>0?e[t-1]:null}removeNextSibling(){const e=this._containers.top();if(e&&Array.isArray(e)){const t=this._indexes.top();if(e.length>t+1)return e.splice(t+1,1)[0]}return null}replace(){const e=this._containers.top();if(!e)throw new Error("Can't replace the root of the tree");const t=Array.isArray(e),n=e,s=this._indexes.top(),i=e,r=this._indexes.top();for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];t?(n.splice(s,1,...a),this._indexes.pop(),this._indexes.push(s+a.length-1)):0===a.length?delete i[r]:1===a.length?i[r]=a[0]:i[r]=a}hasPreviousSibling(){return Array.isArray(this._containers.top())&&this._indexes.top()>0}goToPreviousSibling(){if(!this.hasPreviousSibling())throw new Error("goToPreviousSibling(): node has no previous sibling");this._currentNode=this.previousSibling();const e=this._indexes.pop();this._indexes.push(e-1)}hasParent(){return 0!==this._ancestors.size()}goToParent(){if(!this.hasParent())throw new Error("goToParent(): node has no ancestor");for(this._currentNode=this._ancestors.pop();this._containers.size()&&this._containers.top()[this._indexes.top()]!==this._currentNode;)this._containers.pop(),this._indexes.pop()}clone(){const e=new Zn(this.root);return e._currentNode=this._currentNode,e._containers=this._containers.clone(),e._indexes=this._indexes.clone(),e._ancestors=this._ancestors.clone(),e}equals(e){return this.root===e.root&&this._currentNode===e._currentNode&&this._containers.equals(e._containers)&&this._indexes.equals(e._indexes)&&this._ancestors.equals(e._ancestors)}}class Jn{constructor(e){this.stack=e?e.slice(0):[]}push(e){this.stack.push(e)}pop(){return this.stack.pop()}top(){return this.stack[this.stack.length-1]}values(){return this.stack.slice(0)}size(){return this.stack.length}toString(){return this.stack.toString()}clone(){return new Jn(this.stack)}equals(e){if(!e||!e.stack||e.stack.length!==this.stack.length)return!1;for(let t=0;t<this.stack.length;t++)if(this.stack[t]!==e.stack[t])return!1;return!0}}var Qn={exports:{}};Qn.exports;const es=Gt.filter((e=>e.severity<Ee.Severity.BULK_WARNING));Qn.exports={runLinter:function(e,t,n,s){s=s||es;const i=[],r=new Xn(e);r.traverse(((e,t,n)=>{if(Xn.isTextNode(e)){let n=t.nextSibling();for(;Xn.isTextNode(n);)e.content+=n.content,t.removeNextSibling(),n=t.nextSibling()}}));let o=[],a=!1;return r.traverse(((e,r,l)=>{const c=[],h=s.filter((e=>e.applies(t))),p=[...t.stack];p.push(e.type);const u={...t,stack:p.join(".")};if(h.forEach((t=>{const s=t.check(e,r,l,u);s&&((s.start||s.end)&&(s.target=l.substring(s.start,s.end)),i.push(s),n&&c.push(s))})),n&&("table"===e.type?(o.length&&c.push(...o),a=!1,o=[]):a||(a=r.ancestors().some((e=>"table"===e.type))),a&&c.length&&o.push(...c),c.length))if(c.sort(((e,t)=>e.severity-t.severity)),"text"!==e.type||c.length>1)r.replace({type:"lint",content:e,message:c.map((e=>e.message)).join("\n\n"),ruleName:c[0].rule,insideTable:a,severity:c[0].severity});else{const t=e.content,n=c[0],s=n.start||0,i=n.end||t.length,o=t.substring(0,s),l=t.substring(s,i),h=t.substring(i),p=[];o&&p.push({type:"text",content:o}),p.push({type:"lint",content:{type:"text",content:l},message:n.message,ruleName:n.rule,insideTable:a,severity:n.severity}),h&&p.push({type:"text",content:h}),r.replace(...p)}})),i},parse:Kn.parse,pushContextStack:function(e,t){const n=e.stack||[];return{...e,stack:n.concat(t)}},rules:es};var ts=Qn.exports,ns={exports:{}};ns.exports;ns.exports=e=>e.replace(/\{align[*]?\}/g,"{aligned}").replace(/[\u00a0]/g," ");var ss=ns.exports,is={exports:{}};is.exports;is.exports=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}then(e){return this.promise.then(e)}};var rs=is.exports,os={exports:{}};os.exports;h.a;const as=i.a,ls=rs,cs=createReactClass({displayName:"Zoomable",getDefaultProps(){const e=new ls;return e.resolve(),{animateHeight:!1,readyToMeasureDeferred:e,computeChildBounds:e=>{const t=e.firstElementChild;return{width:t.offsetWidth+1,height:t.offsetHeight+1}}}},getInitialState:()=>({visible:!1,marginBottomPx:0,zoomed:!0}),componentDidMount(){this._node=as.findDOMNode(this),this.props.readyToMeasureDeferred.then((()=>{this.isMounted()&&(this.scaleChildToFit(!1),window.MutationObserver&&(this._observer=new MutationObserver((e=>{if(this.isMounted())for(const t of e)if(t.target!==this._node){this.scaleChildToFit(this.state.zoomed);break}})),this._observer.observe(this._node,{childList:!0,subtree:!0,attributes:!0})),window.addEventListener("resize",this.reset))}))},componentWillUnmount(){window.removeEventListener("resize",this.reset),this._observer&&this._observer.disconnect()},reset(){this.isMounted()&&this.state.visible&&(this._originalWidth=null,this.setState({visible:!1,compactHeight:null,expandedHeight:null,zoomed:!0},(()=>{this.scaleChildToFit(!1)})))},stopPropagationIfZoomed(e){this.state.zoomed||e.stopPropagation()},scaleChildToFit(e){const t={width:this._node.offsetWidth,height:this._node.offsetHeight},n=this.props.computeChildBounds(this._node,t),s=n.width,i=n.height;if(s>t.width){const n=t.width/s;this.setState({scale:n,zoomed:e,compactHeight:Math.ceil(n*i),expandedHeight:i}),setTimeout((()=>{this.isMounted()&&this.setState({visible:!0})}))}else this.setState({visible:!0})},handleClickIfZoomed(e){this.state.zoomed||(e.stopPropagation(),this.handleClick())},handleClick(){this.setState({zoomed:!this.state.zoomed})},render(){const{visible:e,scale:t,compactHeight:n,expandedHeight:s,zoomed:i}=this.state,{animateHeight:r}=this.props,o=r?"opacity transform height":"opacity transform",a=e?"":" translate(0, 8px)",l=i?`scale(1, 1) ${a}`:`scale(${t}, ${t}) ${a}`,c={display:"block",width:"100%",height:i?s:n,transform:l,WebkitTransform:l,msTransform:l,transformOrigin:"0 0",WebkitTransformOrigin:"0 0",msTransformOrigin:"0 0",opacity:e?1:0,WebkitTapHighlightColor:"transparent",...e?{transitionProperty:o,WebkitTransitionProperty:o,msTransitionProperty:o,transitionDuration:"0.3s",WebkitTransitionDuration:"0.3s",msTransitionDuration:"0.3s",transitionTimingFunction:"ease-out",WebkitTransitionTimingfunction:"ease-out",msTransitionTmingFunction:"ease-out"}:{}};return Object($t.jsx)("span",{onClick:this.handleClick,onClickCapture:this.handleClickIfZoomed,onTouchCancelCapture:this.stopPropagationIfZoomed,onTouchEndCapture:this.stopPropagationIfZoomed,onTouchStartCapture:this.stopPropagationIfZoomed,style:c,children:this.props.children})}});os.exports=cs;var hs=os.exports,ps={exports:{}};ps.exports;h.a;const us=i.a,ds=x.b,gs={};function fs(e){if(!gs[e]){const t=$("<span>").text(e).appendTo("body");gs[e]=t.width()+5,t.remove()}return gs[e]}const ms=createReactClass({displayName:"TextListEditor",getDefaultProps:function(){return{options:[],layout:"horizontal"}},getInitialState:function(){return{items:this.props.options.concat("")}},componentWillReceiveProps:function(e){this.setState({items:e.options.concat("")})},render:function(){const e=["perseus-text-list-editor","perseus-clearfix","layout-"+this.props.layout].join(" "),t=ds.map(this.state.items,(function(e,t){return Object($t.jsx)("li",{children:Object($t.jsx)("input",{ref:"input_"+t,type:"text",value:e,onChange:this.onChange.bind(this,t),onKeyDown:this.onKeyDown.bind(this,t),style:{width:fs(e)}})},t)}),this);return Object($t.jsx)("ul",{className:e,children:t})},onChange:function(e,t){let n=ds.clone(this.state.items);n[e]=t.target.value,e===n.length-1&&(n=n.concat("")),this.setState({items:n}),this.props.onChange(ds.compact(n))},onKeyDown:function(e,t){const n=t.nativeEvent.keyCode;if(8===n&&""===this.state.items[e]){t.preventDefault();const n=ds.clone(this.state.items),s=0===e?0:e-1;e!==n.length-1||0!==e&&""===n[s]?(n.splice(e,1),this.setState({items:n},(function(){us.findDOMNode(this.refs["input_"+s]).focus()}))):us.findDOMNode(this.refs["input_"+s]).focus()}else if(8===n&&1===this.state.items[e].length&&e===this.state.items.length-2){t.preventDefault();const n=ds.clone(this.state.items);n.splice(e,1),this.setState({items:n}),this.props.onChange(ds.compact(n))}else if(13===n){t.preventDefault();const n=ds.clone(this.state.items),s=e+1;e===n.length-2?us.findDOMNode(this.refs["input_"+s]).focus():(n.splice(s,0,""),this.setState({items:n},(function(){us.findDOMNode(this.refs["input_"+s]).focus()})))}}});ps.exports=ms;var bs=ps.exports,vs={exports:{}};vs.exports;h.a;const xs=bs,ys=[],js=createReactClass({displayName:"StubTagEditor",getDefaultProps:function(){return{value:ys,showTitle:!0}},render:function(){return Object($t.jsxs)("div",{children:[this.props.showTitle&&Object($t.jsx)("div",{style:{fontSize:14},children:"Tags:"}),Object($t.jsx)(xs,{options:this.props.value||ys,layout:"vertical",onChange:this.props.onChange})]})}});vs.exports=js;var ws=vs.exports;const Os={propTypes:PropTypes.shape({isArticle:PropTypes.bool.isRequired,satStyling:PropTypes.bool.isRequired,onInputError:PropTypes.func.isRequired,onFocusChange:PropTypes.func.isRequired,staticRender:PropTypes.bool.isRequired,GroupMetadataEditor:PropTypes.func.isRequired,showAlignmentOptions:PropTypes.bool.isRequired,readOnly:PropTypes.bool.isRequired,answerableCallback:PropTypes.func,getAnotherHint:PropTypes.func,interactionCallback:PropTypes.func,groupAnnotator:PropTypes.func.isRequired,imagePlaceholder:PropTypes.node,widgetPlaceholder:PropTypes.node,baseElements:PropTypes.shape({Link:PropTypes.func}),imagePreloader:PropTypes.func,trackInteraction:PropTypes.func,customKeypad:PropTypes.bool,isMobile:PropTypes.bool,setDrawingAreaAvailable:PropTypes.func,useDraftEditor:PropTypes.bool,styling:PropTypes.shape({radioStyleVersion:PropTypes.oneOf(["intermediate","final"])}),hintProgressColor:PropTypes.string}).isRequired,defaults:{isArticle:!1,isMobile:!1,satStyling:!1,onInputError:function(){},onFocusChange:function(){},staticRender:!1,GroupMetadataEditor:ws,showAlignmentOptions:!1,readOnly:!1,groupAnnotator:function(){return null},baseElements:{Link:e=>Object($t.jsx)("a",{...e})},setDrawingAreaAvailable:function(){},useDraftEditor:!1,styling:{radioStyleVersion:"final"}}},Cs={RENDERER:"perseus-renderer",TWO_COLUMN_RENDERER:"perseus-renderer-two-columns",RESPONSIVE_RENDERER:"perseus-renderer-responsive",INPUT:"perseus-input",FOCUSED:"perseus-focused",RADIO:{OPTION:"perseus-radio-option",SELECTED:"perseus-radio-selected",OPTION_CONTENT:"perseus-radio-option-content"},INTERACTIVE:"perseus-interactive",CORRECT:"perseus-correct",INCORRECT:"perseus-incorrect",UNANSWERED:"perseus-unanswered",MOBILE:"perseus-mobile"};var Ss={Options:Os,ClassNames:Cs},ks={exports:{}};ks.exports;h.a;const _s=Ss.Options,Ts={propTypes:{apiOptions:PropTypes.any},getDefaultProps:()=>({apiOptions:{}}),getApiOptions(){return{..._s.defaults,...this.props.apiOptions}}};ks.exports=Ts;var Ms=ks.exports,Ns={exports:{}},Ps=(Ns.exports,x.b),Is="block",Es=["default"],As={},Rs={},Ds={register:function(e,t,n){As[e]=t,Rs[e]=n},registerMany:function(e){e.forEach((e=>{let[t,n]=e;t&&this.register(t.name,t,n)})),this.validateAlignments()},getWidget:function(e){return Ps.has(As,e)?As[e].getWidget?As[e].getWidget():As[e].widget:null},getEditor:function(e){return Ps.has(Rs,e)?Rs[e]:null},getTransform:function(e){return Ps.has(As,e)?As[e].transform||Ps.identity:null},getVersion:function(e){return As[e]?As[e].version||{major:0,minor:0}:null},getVersionVector:function(){var e={};return Ps.each(Ps.keys(As),(function(t){e[t]=Ds.getVersion(t)})),e},getPublicWidgets:function(){return Ps.pick(As,Ps.reject(Ps.keys(As),(function(e){return As[e].hidden})))},isAccessible:function(e){var t=As[e.type].accessible;return"function"===typeof t?t(e.options):!!t},getAllWidgetTypes:function(){return Ps.keys(As)},upgradeWidgetInfoToLatestVersion:function(e){var t=e.type;if(!Ps.isString(t))throw new Error("widget type must be a string, but was: "+t);var n=As[t];if(null==n)return e;var s=e.version||{major:0,minor:0},i=n.version||{major:0,minor:0};if(s.major>i.major||s.major===i.major&&s.minor>i.minor)return e;var r=Ps.clone(e.options)||{},o=n.propUpgrades||{};if(0!==Ps.keys(r).length)for(var a=s.major+1;a<=i.major;a++)o[a]?r=o[a](r):"undefined"!==typeof console&&console.warn&&console.warn("No upgrade found for widget `"+t+"` from major version `"+(a-1)+"` to major version `"+a+"` found. This is necessary to render this `"+t+"` correctly.");var l=Rs[t].defaultProps;r=Ps.extend({},l,r);var c=e.alignment;null!=c&&"default"!==c||(c=Ds.getSupportedAlignments(t)[0]);var h=e.static;return null==h&&(h=false),Ps.extend({},e,{version:i,graded:null==e.graded||e.graded,alignment:c,static:h,options:r})},getRendererPropsForWidgetInfo:function(e,t){var n=e.type,s=As[n];return null==s?e.options:(e.static?this.getStaticTransform(n)||Ps.identity:s.transform||Ps.identity)(e.options,t)},traverseChildWidgets:function(e,t){if(!t)throw new Error("traverseRenderer must be provided, but was not");if(!e||!e.type||!As[e.type])return e;var n=As[e.type],s=e.options;if(n.traverseChildWidgets&&s){var i=n.traverseChildWidgets(s,t);return Ps.extend({},e,{options:i})}return e},getSupportedAlignments:function(e){var t=As[e];return t&&t.supportedAlignments||Es},getDefaultAlignment:function(e){var t=As[e];return t&&(t.getDefaultAlignment?t.getDefaultAlignment():t.defaultAlignment)||Is},validAlignments:["block","inline-block","inline","float-left","float-right","full-width"],validateAlignments:function(){Ps.each(As,(function(e){if(e.defaultAlignment&&!Ps.contains(Ds.validAlignments,e.defaultAlignment))throw new Error("Widget '"+e.displayName+"' has an invalid defaultAlignment value: "+e.defaultAlignment);if(e.supportedAlignments){var t=Ps.difference(e.supportedAlignments,Ds.validAlignments);if(t.length)throw new Error("Widget '"+e.displayName+"' has an invalid value for supportedAlignments: "+t.join(" "))}}))},supportsStaticMode:function(e){var t=As[e];return t&&null!=t.staticTransform},getStaticTransform:function(e){var t=As[e];return t&&t.staticTransform},getTracking:function(e){var t=As[e];return t&&t.tracking||""},isLintable:function(e){var t=As[e];return t&&t.isLintable||false}};Ns.exports=Ds;var Fs=Ns.exports;h.a;const Ls={SMALL:"small",MEDIUM:"medium",LARGE:"large",XLARGE:"xlarge"},zs=(PropTypes.oneOf(Object.values(Ls)),e=>e===Ls.SMALL?[xn,xn]:[vn,vn]);var qs={exports:{}};qs.exports;const Ws=v.a,Bs=(h.a,i.a),Vs=Fs,Hs=createReactClass({displayName:"WidgetContainer",getDefaultProps:()=>({linterContext:je}),getInitialState:function(){return{sizeClass:Ls.MEDIUM,widgetProps:this.props.initialProps}},componentDidMount(){if(this.state.widgetProps.apiOptions.isMobile){const t=Bs.findDOMNode(this).offsetWidth;this.setState({sizeClass:(e=t,e?e<=512?Ls.SMALL:e<=688?Ls.MEDIUM:Ls.LARGE:Ls.MEDIUM)})}var e},render:function(){let e=Ws({"perseus-widget-container":!0,"widget-highlight":this.props.shouldHighlight,"widget-nohighlight":!this.props.shouldHighlight});const t=this.props.type,n=Vs.getWidget(t);if(null==n)return Object($t.jsx)("div",{className:e});let s=this.state.widgetProps.alignment;"default"===s&&(s=Vs.getDefaultAlignment(t)),e+=" widget-"+s;const i=this.state.widgetProps.apiOptions,r=this.state.widgetProps.static||i.readOnly,o={width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:"3"},a=this.props.linterContext;return Vs.isLintable(t)||(a.highlightLint=!1),Object($t.jsxs)("div",{className:e,style:r?{position:"relative",overflow:"visible"}:{},children:[Object($t.jsx)(n,{...this.state.widgetProps,linterContext:a,containerSizeClass:this.state.sizeClass,ref:"widget"}),r&&Object($t.jsx)("div",{style:o})]})},componentWillReceiveProps:function(e){if(this.props.type!==e.type)throw new Error("WidgetContainer can't change widget type; set a different key instead to recreate the container.")},shouldComponentUpdate:function(e,t){return this.props.shouldHighlight!==e.shouldHighlight||this.props.type!==e.type||this.state.widgetProps!==t.widgetProps||this.state.sizeClass!==t.sizeClass},getWidget:function(){return this.refs.widget},replaceWidgetProps:function(e){this.setState({widgetProps:e})}});qs.exports=Hs;var Us=qs.exports,Gs={},$s=Gs;function Ys(e,t){const n=window.scrollX,s=window.scrollY,i=document.querySelector("meta[name=viewport]");i?i.setAttribute("content",e):$("head").append(`<meta name="viewport" content="${e}">`),document.body.style.opacity=.9999,setTimeout((()=>{document.body.style.opacity=1,window.scrollTo(n,s),t&&setTimeout(t,0)}),0)}function Ks(){}function Xs(e,t){this._fullHeight=this._fullWidth=this._overlay=null,this._targetImage=e,this._enableMobilePinch=t,this._$body=$(document.body)}$.fn.emulateTransitionEnd=function(e){var t=!1,n=this;$(this).one("bsTransitionEnd",(function(){t=!0}));return setTimeout((function(){t||$(n).trigger($.support.transition.end)}),e),this},$((function(){$.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(e){if($(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})),Ks.prototype._initialize=function(e){this._$document||(this._activeZoom=this._initialScrollPosition=this._initialTouchPosition=this._touchMoveListener=null,this._$document=$(document),this._$window=$(window),this._$body=$(document.body),this._boundClick=$.proxy(this._clickHandler,this),this._enableMobilePinch=e)},Ks.prototype.handleZoomClick=function(e,t){this._initialize(t);var n=e.target;if(n&&"IMG"===n.tagName&&!this._$body.hasClass("zoom-overlay-open"))return e.metaKey||e.ctrlKey?window.open(e.target.src,"_blank"):void(!t&&n.width>=window.innerWidth-Xs.getOffset()||(this._activeZoomClose(!0),t?Ys("width=device-width, initial-scale=1, minimum-scale=1",(()=>this._zoom(n))):this._zoom(n),t||(this._$window.on("scroll.zoom",$.proxy(this._scrollHandler,this)),this._$document.on("keyup.zoom",$.proxy(this._keyHandler,this)),this._$document.on("touchstart.zoom",$.proxy(this._touchStart,this))),document.addEventListener("click",this._boundClick,!0),e.stopPropagation()))},Ks.prototype._zoom=function(e){this._activeZoom=new Xs(e,this._enableMobilePinch),this._activeZoom.zoomImage()},Ks.prototype._activeZoomClose=function(e){this._activeZoom&&(e?(this._activeZoom.dispose(),this._disposeActiveZoom()):Ys("width=device-width, initial-scale=1, minimum-scale=1,\n            maximum-scale=1",(()=>{this._activeZoom&&(this._activeZoom.close(),this._disposeActiveZoom())})))},Ks.prototype._disposeActiveZoom=function(){this._$window.off(".zoom"),this._$document.off(".zoom"),document.removeEventListener("click",this._boundClick,!0),this._activeZoom=null},Ks.prototype._scrollHandler=function(e){null===this._initialScrollPosition&&(this._initialScrollPosition=window.scrollY);var t=this._initialScrollPosition-window.scrollY;Math.abs(t)>=40&&this._activeZoomClose()},Ks.prototype._keyHandler=function(e){27===e.keyCode&&this._activeZoomClose()},Ks.prototype._clickHandler=function(e){e.stopPropagation(),e.preventDefault(),this._activeZoomClose()},Ks.prototype._touchStart=function(e){this._initialTouchPosition=e.originalEvent.touches[0].pageY,$(e.target).on("touchmove.zoom",$.proxy(this._touchMove,this))},Ks.prototype._touchMove=function(e){Math.abs(e.originalEvent.touches[0].pageY-this._initialTouchPosition)>10&&(this._activeZoomClose(),$(e.target).off("touchmove.zoom"))},Xs._OFFSET=80,Xs._MAX_WIDTH=2560,Xs._MAX_HEIGHT=4096,Xs.getOffset=function(e){return e?0:Xs._OFFSET},Xs.prototype.getOffset=function(){return Xs.getOffset(this._enableMobilePinch)},Xs.prototype.zoomImage=function(){var e=document.createElement("img"),t=$(e);e.onload=function(){this._fullHeight=Number(e.height),this._fullWidth=Number(e.width);var n=this._imageOffset=$(this._targetImage).offset(),s=this._left=n.left-$(window).scrollLeft(),i=this._top=n.top-$(window).scrollTop();t.css({left:s,top:i,width:this._targetImage.width,height:this._targetImage.height}),this._zoomOriginal()}.bind(this),e.src=this._targetImage.src,this.$zoomedImage=t},Xs.prototype._zoomOriginal=function(){this.$zoomedImage.addClass("zoom-img").attr("data-action","zoom-out"),$(this._targetImage).css("visibility","hidden"),this._backdrop=document.createElement("div"),this._backdrop.className="zoom-backdrop",document.body.appendChild(this._backdrop),this._overlay=document.createElement("div"),this._overlay.className="zoom-overlay",document.body.appendChild(this._overlay),this._overlay.appendChild(this.$zoomedImage[0]),this._calculateZoom(),this._triggerAnimation()},Xs.prototype._calculateZoom=function(){const e=this._fullWidth,t=this._fullHeight,n=window.innerHeight-this.getOffset(),s=window.innerWidth-this.getOffset(),i=e/this._targetImage.width,r=e/t,o=s/n;this._imgScaleFactor=e<s&&t<n?i:r<o?n/t*i:s/e*i},Xs.prototype._triggerAnimation=function(){var e=$(window).scrollTop()+window.innerHeight/2,t=$(window).scrollLeft()+window.innerWidth/2,n=this._imgScaleFactor,s=this._imageOffset.top+this._targetImage.height/2,i=this._imageOffset.left+this._targetImage.width/2;this._translateY=(e-s)/n,this._translateX=(t-i)/n,this._zoomedInTransformString=`\n        scale(${n})\n        translate3d(${this._translateX}px, ${this._translateY}px, 0)\n    `,this.$zoomedImage.css({transform:this._zoomedInTransformString}).addClass("zoom-transition").one($.support.transition.end,$.proxy(this._onZoomInFinish,this)).emulateTransitionEnd(300),this._$body.addClass("zoom-overlay-open")},Xs.prototype._onZoomInFinish=function(){const e=this._targetImage.height*this._imgScaleFactor,t=this._targetImage.width*this._imgScaleFactor;let n=0,s=0,i=0,r=0,o=0,a=0;t<window.innerWidth?(n="50%",i=-t/2):o=(t-window.innerWidth)/2,e<window.innerHeight?(s="50%",r=-e/2):a=(e-window.innerHeight)/2,this.$zoomedImage.css({height:e,left:n,marginLeft:i,marginTop:r,top:s,transform:"",width:t}).removeClass("zoom-transition"),$(this._overlay).scrollLeft(o).scrollTop(a)},Xs.prototype.close=function(){this._$body.removeClass("zoom-overlay-open").addClass("zoom-overlay-transitioning"),this.$zoomedImage.css({height:this._targetImage.height,left:this._left,marginLeft:0,marginTop:0,top:this._top,transform:this._zoomedInTransformString,width:this._targetImage.width}).removeClass("zoom-transition"),$(this._overlay).scrollLeft(0).scrollTop(0),setTimeout((()=>{this.$zoomedImage.css({transform:"scale(1)"}).addClass("zoom-transition").one($.support.transition.end,$.proxy(this.dispose,this)).emulateTransitionEnd(300)}),10)},Xs.prototype.dispose=function(){this.$zoomedImage&&this.$zoomedImage[0].parentNode&&(this.$zoomedImage.remove(),this.$zoomedImage=null,this._overlay.parentNode.removeChild(this._overlay),this._backdrop.parentNode.removeChild(this._backdrop),this._$body.removeClass("zoom-overlay-transitioning")),$(this._targetImage).css("visibility","visible")},$s.ZoomService=new Ks;$s.ZoomService;var Zs=Gs,Js={exports:{}};Js.exports;const Qs=/\\+([ !#$%*,.:;\[\]\^_{|}]|[a-zA-Z]*)/g,ei=[" ","!","#","%","*",",",".",":",";","[","]","^","_","{","|","}","alpha","angle","approx","arccos","arcsin","arctan","arrow","bar","barwedge","begin","beta","bf","big","Big","bigg","Bigg","bigl","Bigl","bigr","Bigr","bigstar","bigtriangledown","bigtriangleup","binom","blacklozenge","blue","blueA","blueB","blueC","blueD","blueE","boldsymbol","Box","boxdot","boxed","bullet","cancel","cap","cdot","cdots","checkmark","chi","circ","circledcirc","clubsuit","colon","color","cong","cos","cot","csc","cup","curvearrowright","dagger","dbinom","ddots","delta","Delta","det","dfrac","diamond","diamondsuit","displaystyle","div","dot","dots","downarrow","Downarrow","ell","end","enspace","epsilon","equiv","eta","fbox","flat","footnotesize","frac","frown","gamma","Gamma","gcf","ge","geq","gg","goldB","goldC","goldD","goldE","gray","grayD","grayE","grayF","green","greenB","greenC","greenD","greenE","gt","hat","hbox","heartsuit","hline","hphantom","huge","Huge","iff","iiint","iint","implies","in","infty","int","intercal","it","kaBlue","kappa","kern","lambda","langle","large","Large","LARGE","lcm","ldots","le","left","leftarrow","leftrightarrow","Leftrightarrow","leftrightharpoons","leftroot","leq","lfloor","lg","lim","limits","llap","ln","log","longrightarrow","Longrightarrow","lozenge","lt","lvert","maroonB","maroonC","maroonD","maroonE","mathbb","mathbf","mathcal","mathop","mathrm","mathsf","max","mbox","mid","mp","mu","nabla","ne","nearrow","neq","ngeq","ngtr","nleq","nless","normalsize","not","nu","nx","odot","oint","omega","Omega","operatorname","oplus","orange","oslash","otimes","overbrace","overleftarrow","overleftrightarrow","overline","overrightarrow","overset","parallel","partial","perp","phantom","phi","Phi","pi","pink","pm","prime","propto","psi","Psi","purple","purpleA","purpleC","purpleD","purpleE","qquad","quad","raise","rangle","red","redA","redB","redC","redD","redE","rfloor","rho","right","rightarrow","Rightarrow","rightleftharpoons","rvert","scriptsize","scriptstyle","searrow","sec","setminus","sharp","sigma","Sigma","sim","simeq","sin","small","space","sqrt","square","stackrel","star","substack","sum","swarrow","tan","tan","tau","tealA","tealB","tealC","tealD","tealE","text","textbf","textit","textrm","tfrac","therefore","theta","Theta","tilde","times","tiny","to","triangle","triangleleft","triangleright","underbrace","underline","underset","uparrow","uproot","varphi","vdots","vec","veebar","vert","vphantom","widehat","xi","xrightarrow","Begin","End","inte","lamba","textb"].reduce((function(e,t){return e[t]=null,e}),{}),ti={n:"\n",r:"\r",t:"\t","\\":"\\"},ni=function(e){let t=0;for(;t<e.length&&"\\"===e[t];)t++;if(0===t)return 2;if(t%2===0)return 3;{const n=e.substring(t);return"$"===n?1===t?4:1:ei.hasOwnProperty(n)?6:0}},si=function(e){let t=0,n="";for(;t<e.length;){const s=e[t];if("\\"===s){if(t+=1,t===e.length)return null;const s=e[t];if(!ti.hasOwnProperty(s))return null;n+=ti[s]}else n+=s;t+=1}return n},ii=function(e){if(e.indexOf("\\")<0)return!1;let t,n=0,s=0,i=!1,r=!1;for(Qs.lastIndex=0;null!==(t=Qs.exec(e));){const e=t[0],o=si(e);if(null===o)return!1;const a=ni(e);0===a&&(i=!0);const l=ni(o);0===l&&(r=!0),n+=a,s+=l}return i!==r?i:s>=n},ri=function(e){return ii(e)?si(e):e};Js.exports={maybeUnescape:ri,maybeUnescapeAccordingToSource:function(e,t){return ii(e)?[si(e),si(t)]:[e,t]},shouldUnescape:ii};var oi=Js.exports,ai={exports:{}};ai.exports;h.a;const li="pending",ci="loading",hi="loaded",pi="failed",ui=createReactClass({displayName:"ImageLoader",getInitialState:function(e){return{status:this.props.src?ci:li}},componentDidMount:function(){this.state.status===ci&&this.createLoader()},componentWillReceiveProps:function(e){this.props.src!==e.src&&this.setState({status:e.src?ci:li})},componentDidUpdate:function(e,t){this.state.status!==ci||this.img||this.createLoader(),t.status!==this.state.status&&this.props.onUpdate()},componentWillUnmount:function(){this.destroyLoader()},createLoader:function(){this.destroyLoader(),this.img=new Image,this.img.onload=this.handleLoad,this.img.onerror=this.handleError,this.img.src=this.props.src},destroyLoader:function(){this.img&&(this.img.onload=null,this.img.onerror=null,this.img=null)},handleLoad:function(e){this.destroyLoader(),this.setState({status:hi}),this.props.onLoad&&this.props.onLoad(e)},handleError:function(e){this.destroyLoader(),this.setState({status:pi}),this.props.onError&&this.props.onError(e)},renderImg:function(){const{src:e,imgProps:t}=this.props,n={src:e};for(const s in t)t.hasOwnProperty(s)&&(n[s]=t[s]);return Object($t.jsx)("img",{...n})},render:function(){switch(this.state.status){case hi:return this.renderImg();case pi:if(this.props.children)return this.props.children;break;default:if(this.props.preloader)return this.props.preloader()}return null}});ai.exports=ui;var di=ai.exports,gi={exports:{}};gi.exports;const fi=x.b,mi=G.a.point;function bi(e,t){return e+":"+t}const vi={_fireEvent:function(e,t,n){fi.invoke(e,"call",this,t,n)},_applyConstraints:function(e,t,n){let s=!1;return fi.reduce(this.state.constraints,((e,i)=>{if(!1===e)return!1;if(s)return e;const r=i.call(this,e,t,{onSkipRemaining:()=>{s=!0},...n});if(!1===r)return!1;if(mi.is(r,2))return r;if(!0===r||null==r)return e;throw new Error("Constraint returned invalid result: "+r)}),e,this)},draw:function(){const e=this.cloneState();vi._fireEvent.call(this,this.state.draw,e,this.prevState),this.prevState=e},listen:function(e,t,n){this._listenerMap=this._listenerMap||{};const s=bi(e,t),i=this._listenerMap[s]=this._listenerMap[s]||this.state[e].length;this.state[e][i]=n},unlisten:function(e,t){this._listenerMap=this._listenerMap||{};const n=bi(e,t),s=this._listenerMap[n];if(void 0!==s){this.state[e].splice(s,1),delete this._listenerMap[n];const t=fi.keys(this._listenerMap);fi.each(t,(function(t){(function(e){return e.split(":")[0]})(t)===e&&this._listenerMap[t]>s&&this._listenerMap[t]--}),this)}}};gi.exports=vi;var xi=gi.exports;const yi=x.b,ji=xi;let wi=null;let Oi=null;const Ci={assert:function(e,t){if(!e)throw new Error("Assertion Error"+(t?": "+t:""))},createGettersFor:function(e,t){yi.each(yi.keys(t),(function(t){void 0===e.prototype[t]&&(e.prototype[t]=function(){return this.state[t]})}))},addMovableHelperMethodsTo:function(e){yi.each(ji,(function(t,n){void 0===e.prototype[n]&&(e.prototype[n]=t)}))},arrayify:function(e){return null==e?[]:yi.isArray(e)?yi.filter(yi.flatten(e),yi.identity):[e]},normalizeOptions:function(e,t){const n=yi.clone(t);return yi.each(e,(function(e){const s=t[e];if(void 0!==s){const t=Ci.arrayify(s);n[e]=t}})),n},getPrefixedTransform:function(){return wi=wi||function(){const e=document.createElement("div");let t=null;return yi.each(["transform","msTransform","MozTransform","WebkitTransform","OTransform"],(function(n){"undefined"!==typeof e.style[n]&&(t=n)})),t}(),wi},getCanUse3dTransform:function(){return null==Oi&&(Oi=function(){const e=document.createElement("div"),t=Ci.getPrefixedTransform();return e.style[t]="translateZ(0px)",!!e.style[t]}()),Oi}},Si=Ci.getCanUse3dTransform;var ki=Ci,_i={exports:{}};_i.exports;const Ti={BLUE:"#6495ED",ORANGE:"#FFA500",PINK:"#FF00AF",GREEN:"#28AE7B",PURPLE:"#9D38BD",RED:"#DF0030",GRAY:"gray",BLACK:"black",LIGHT_BLUE:"#9AB8ED",LIGHT_ORANGE:"#EDD19B",LIGHT_PINK:"#ED9BD3",LIGHT_GREEN:"#9BEDCE",LIGHT_PURPLE:"#DA9BED",LIGHT_RED:"#ED9AAC",LIGHT_GRAY:"#ED9B9B",LIGHT_BLACK:"#ED9B9B",GRAY10:"#D6D6D6",GRAY20:"#CDCDCD",GRAY30:"#B3B3B3",GRAY40:"#9A9A9A",GRAY50:"#808080",GRAY60:"#666666",GRAY70:"#4D4D4D",GRAY80:"#333333",GRAY90:"#1A1A1A",BLUE_A:"#CCFAFF",BLUE_B:"#80F6FF",BLUE_C:"#63D9EA",BLUE_D:"#11ACCD",BLUE_E:"#0C7F99",TEAL_A:"#94FFF5",TEAL_B:"#26EDD5",TEAL_C:"#01D1C1",TEAL_D:"#01A995",TEAL_E:"#208170",GREEN_A:"#B6FFB0",GREEN_B:"#8AF281",GREEN_C:"#74CF70",GREEN_D:"#1FAB54",GREEN_E:"#0D923F",GOLD_A:"#FFD0A9",GOLD_B:"#FFBB71",GOLD_C:"#FF9C39",GOLD_D:"#E07D10",GOLD_E:"#A75A05",RED_A:"#FCA9A9",RED_B:"#FF8482",RED_C:"#F9685D",RED_D:"#E84D39",RED_E:"#BC2612",MAROON_A:"#FFBDE0",MAROON_B:"#FF92C6",MAROON_C:"#ED5FA6",MAROON_D:"#CA337C",MAROON_E:"#9E034E",PURPLE_A:"#DDD7FF",PURPLE_B:"#C6B9FC",PURPLE_C:"#AA87FF",PURPLE_D:"#7854AB",PURPLE_E:"#543B78",MINT_A:"#F5F9E8",MINT_B:"#EDF2DF",MINT_C:"#E0E5CC",GRAY_A:"#F6F7F7",GRAY_B:"#F0F1F2",GRAY_C:"#E3E5E6",GRAY_D:"#D6D8DA",GRAY_E:"#BABEC2",GRAY_F:"#888D93",GRAY_G:"#626569",GRAY_H:"#3B3E40",GRAY_I:"#21242C",KA_BLUE:"#314453",KA_GREEN:"#71B307",_BACKGROUND:"#FDFDFD"};Ti.INTERACTING=Ti.KA_GREEN,Ti.INTERACTIVE=Ti.KA_GREEN,Ti.DYNAMIC=Ti.BLUE,_i.exports=Ti;var Mi=_i.exports,Ni={exports:{}};Ni.exports;const Pi=x.b,Ii=ki,Ei=ve,Ai=G.a.vector,Ri=Pi.extend({transform:function(e){const t=Ii.getPrefixedTransform();this.wrapper.style[t]=e},toFront:function(){const e=this.wrapper.parentNode;e&&e.appendChild(this.wrapper)},toBack:function(){const e=this.wrapper.parentNode;e.firstChild!==this.wrapper&&e.insertBefore(this.wrapper,e.firstChild)},remove:function(){this.visibleShape.remove(),l()(this.wrapper).remove()},getMouseTarget:function(){return this.visibleShape[0]},moveTo:function(e){const t=Ai.subtract(this.graphie.scalePoint(e),this.graphie.scalePoint(this.initialPoint)),n=Ii.getCanUse3dTransform(),s="translateX("+t[0]+"px) translateY("+t[1]+"px)"+(n?" translateZ(0)":"");this.transform(s)},hide:function(){this.visibleShape.hide()},show:function(){this.visibleShape.show()}},Ei.mapObjectFromArray(["attr","animate"],(function(e){return function(){this.visibleShape[e](...arguments)}})));Ni.exports=Ri;var Di=Ni.exports,Fi={exports:{}};Fi.exports;const Li=x.b,zi=Di,qi={center:null,createPath:null,mouselayer:!1},Wi=function(e,t,n){n=Li.extend({},qi,n),Li.extend(this,e.fixedPath(t,n.center,n.createPath)),Li.extend(this,{graphie:e,initialPoint:e.scalePoint(Li.head(t))}),n.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper)};Li.extend(Wi.prototype,zi),Fi.exports=Wi;var Bi=Fi.exports,Vi={exports:{}};Vi.exports;const Hi=x.b,Ui=ki,Gi=Di,$i=G.a.point,Yi=G.a.vector,Ki=Z,Xi={thickness:2,mouselayer:!1},Zi=function(e,t,n,s){s=Hi.extend({},Xi,s);const i=[e.range[0][0],0],r=[e.range[0][1],0];Hi.extend(this,e.fixedLine(i,r,s.thickness)),this.visibleShape.attr(s.normalStyle),Hi.extend(this,{graphie:e,initialPoint:e.scalePoint(i),initialLength:$i.distanceToPoint(e.scalePoint(i),e.scalePoint(r))}),s.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),this.moveTo(t,n)};Hi.extend(Zi.prototype,Gi,{getMouseTarget:function(){return this.wrapper},moveTo:function(e,t){const n=this.graphie.scalePoint(e),s=this.graphie.scalePoint(t),i=Yi.polarDegFromCart(Yi.subtract(s,n)),r=i[0],o=Ki.bound(i[1]),a=Yi.subtract(n,this.initialPoint),l=Ki.bound(r/this.initialLength),c=Ui.getCanUse3dTransform(),h="translateX("+a[0]+"px) translateY("+a[1]+"px) "+(c?" translateZ(0)":"")+"rotate("+o+"deg) scaleX("+l+") scaleY(1)";this.transform(h)}}),Vi.exports=Zi;var Ji=Vi.exports,Qi={exports:{}};Qi.exports;const er=x.b,tr=Di,nr=ki,sr=G.a.vector,ir={maxScale:1,mouselayer:!1,shadow:!1,disableMouseEventsOnWrapper:!1},rr=function(e,t,n,s){s=er.extend({},ir,s);const i=e.fixedEllipse(t,n,s.maxScale,s.padding);if(er.extend(this,i,{graphie:e,initialPoint:t}),s.mouselayer?(this.wrapper.style.touchAction="none",this.graphie.addToMouseLayerWrapper(this.wrapper)):this.graphie.addToVisibleLayerWrapper(this.wrapper),s.shadow){const e="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))",t=this.wrapper;t.style.webkitFilter=e,t.style.filter=e,this.moveTo=function(e){const t=sr.subtract(this.graphie.scalePoint(e),this.graphie.scalePoint(this.initialPoint)),n=nr.getCanUse3dTransform(),s="translateX("+Math.round(t[0])+"px) translateY("+Math.round(t[1])+"px)"+(n?" translateZ(0)":"");this.transform(s)}}s.disableMouseEventsOnWrapper&&(this.wrapper.style.pointerEvents="none",this.visibleShape.node.style.pointerEvents="auto")};er.extend(rr.prototype,tr),Qi.exports=rr;var or=Qi.exports,ar={exports:{}};ar.exports;const lr=Z;function cr(e,t){const n=l()(e).find("."+t);return 0===n.length?l()("<span>").addClass(t).appendTo(l()(e)):n}function hr(e,t){let n=0;!function s(){e.scrollHeight>18||n>=10?t():(n++,setTimeout(s,100))}()}ar.exports={processMath:function(e,t,n,s){const i=l()(e);if(null==i.attr("data-math-formula")||n){const n=cr(i,"katex-holder"),o=cr(i,"mathjax-holder"),a=o.find("script[type='math/tex']")[0];if(null==t&&(i.attr("data-math-formula")?t=i.attr("data-math-formula"):a&&(t=a.text||a.textContent)),t=null!=t?t+"":"",t=lr.cleanMath(t),i.attr("data-math-formula",t),Exercises.useKatex)try{if(katex.render(t,n[0]),"mathjax"===i.attr("data-math-type")){const e=MathJax.Hub.getJaxFor(a);if(e){const t=e.SourceElement();t.previousSibling&&t.previousSibling.className&&e.Remove()}}return i.attr("data-math-type","katex"),void(s&&hr(e,s))}catch(r){if(r.__proto__!==katex.ParseError.prototype)throw r}i.attr("data-math-type","mathjax"),a?"text"in a?a.text=t:a.textContent=t:o.append("<script type='math/tex'>"+t.replace(/<\//g,"< /")+"<\/script>"),"undefined"!==typeof MathJax&&(MathJax.Hub.Queue(["Reprocess",MathJax.Hub,o[0]]),MathJax.Hub.Queue((function(){KhanUtil.debugLog("MathJax done typesetting ("+t+")")})),s&&MathJax.Hub.Queue((function(){const t=MathJax.Callback((function(){}));return hr(e,(function(){s(),t()})),t})))}},processAllMath:function(e,t){const n=l()(e);n.filter("code").add(n.find("code")).each((function(){const e=l()(this);let n=e.attr("data-math-formula");null==n&&(n=e.text(),e.empty()),KhanUtil.processMath(this,n,t)}))},cleanupMath:function(e){const t=l()(e);if(t.attr("data-math-formula")){if("undefined"!==typeof MathJax){const e=MathJax.Hub.getJaxFor(t.find("script")[0]);if(e){const t=e.SourceElement();t.previousSibling&&t.previousSibling.className&&e.Remove()}}t.text(t.attr("data-math-formula")),t.attr("data-math-formula",null),t.attr("data-math-type",null)}return e},retrieveMathFormula:function(e){return l()(e).attr("data-math-formula")}};var pr=ar.exports,ur=(n(169),{exports:{}});ur.exports;const dr=G.a.point,gr=G.a.vector,fr=x.b,mr=Z,br=pr.processMath,vr=Mi;function xr(e,t){return"number"===typeof e&&(e=[e,e]),t=t*Math.PI/180,[e[0]*Math.cos(t),e[1]*Math.sin(t)]}const yr={unscaledSvgPath:function(e){return!0===e[0]?"":l.a.map(e,(function(e,t){return!0===e?"z":(0===t?"M":"L")+e[0]+" "+e[1]})).join("")},getDistance:function(e,t){return dr.distanceToPoint(e,t)},coordDiff:function(e,t){return fr.map(t,(function(n,s){return t[s]-e[s]}))},snapCoord:function(e,t){return fr.map(e,(function(e,n){return mr.roundToNearest(t[n],e)}))},findAngle:function(e,t,n){if(void 0===n){const n=e[0]-t[0],s=e[1]-t[1];return n||s?(180+180*Math.atan2(-s,-n)/Math.PI+360)%360:0}return yr.findAngle(e,n)-yr.findAngle(t,n)},graphs:{}},jr=yr.Graphie=function(){};fr.extend(jr.prototype,{cartToPolar:function(e,t){const n=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));let s=Math.atan2(e[1],e[0]);return s<0&&(s+=2*Math.PI),t||(s=180*s/Math.PI),[n,s]},polar:xr});const wr={center:[-.5,-.5],above:[-.5,-1],"above right":[0,-1],right:[0,-.5],"below right":[0,0],below:[-.5,0],"below left":[-1,0],left:[-1,-.5],"above left":[-1,-1]},Or={"stroke-width":null};yr.createGraphie=function(e){let t,n,s=40,i=40;l()(e).css("position","relative");const r=Raphael(e);l()(e).children("div").css("position","absolute");let o={"stroke-width":2,fill:"none"};const a=function(e){if("number"===typeof e)return a([e,e]);const t=e[0],n=e[1];return[t*s,n*i]},c=function e(r){if("number"===typeof r)return e([r,r]);const o=r[0],a=r[1];return[(o-t[0])*s,(n[1]-a)*i]},h=function(e){if("number"===typeof e)return h([e,e]);const r=e[0],o=e[1];return[r/s+t[0],n[1]-o/i]},p=function(e){return"number"===typeof e?p([e,e]):[e[0]/s,e[1]/i]},u=function(e,t){const n=l()(e),s=n.data("labelDirection");if(n.css("visibility",""),"number"===typeof s){const e=Math.cos(s),i=Math.sin(s),r=Math.min(t[0]/2/Math.abs(e),t[1]/2/Math.abs(i));n.css({marginLeft:-t[0]/2+e*r,marginTop:-t[1]/2-i*r})}else{const e=wr[s||"center"];n.css({marginLeft:Math.round(t[0]*e[0]),marginTop:Math.round(t[1]*e[1])})}},d=function(e,t){return l.a.map(e,(function(e,n){if(!0===e)return"z";{const s=t?e:c(e);return(0===n?"M":"L")+mr.bound(s[0])+" "+mr.bound(s[1])}})).join("")},g=function(e,n,s){const i=function(t){return(e*t+n)*t+s};if(0===e){const e=fr.map(t,(function(e){return[e,i(e)]}));return d(e)}const r=-n/(2*e),o=r+Math.max(Math.abs(r-t[0]),Math.abs(r-t[1])),a=[r,i(r)],l=[o,i(o)],h=[a[0],a[1]-(l[1]-a[1])],p=Math.abs(a[0]-l[0]),u=[a[0]-p,l[1]],g=[a[0]+p,l[1]],f=fr.map([u,h,g],c),m=fr.map(fr.flatten(f),mr.bound);return"M"+m[0]+","+m[1]+" Q"+m[2]+","+m[3]+" "+m[4]+","+m[5]},f=function(e,n,s,i){const r=Math.abs(Math.PI/(2*n)),o=function(t){return e*Math.sin(n*t-s)+i},a=function(t){return e*n*Math.cos(s-n*t)},l=function(e,t){const n=e+r*t,s=n+r,i=[n,2*n/3+1*s/3,1*n/3+2*s/3,s],l=[o(n),o(n)+a(n)*(s-n)/3,o(s)-a(s)*(s-n)/3,o(s)];return fr.map(fr.zip(i,l),c)},h=t[1]-t[0],p=Math.ceil(h/r)+1;let u=s/n;const d=u-t[0];u-=r*Math.ceil(d/r);let g=l(u,0),f="M"+g[0][0]+","+g[0][1]+" C"+g[1][0]+","+g[1][1]+" "+g[2][0]+","+g[2][1]+" "+g[3][0]+","+g[3][1];for(let t=1;t<p;t++)g=l(u,t),f+=" C"+g[1][0]+","+g[1][1]+" "+g[2][0]+","+g[2][1]+" "+g[3][0]+","+g[3][1];return f};yr.svgPath=d;const m=function(e){const o={scale:function(e){"number"===typeof e&&(e=[e,e]),s=e[0],i=e[1],r.setSize((t[1]-t[0])*s,(n[1]-n[0])*i)},clipRect:function(e){const t=e[0],n=e[1];return t[1]+=n[1],{"clip-rect":c(t).concat(a(n)).join(" ")}},strokeWidth:function(e){return{"stroke-width":parseFloat(e)}},rx:function(e){return{rx:a([e,0])[0]}},ry:function(e){return{ry:a([0,e])[1]}},r:function(e){const t=a([e,e]);return{rx:t[0],ry:t[1]}}},h={};return l.a.each(e||{},(function(e,t){const n=o[e];if("function"===typeof n)l.a.extend(h,n(t));else{const n=e.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();h[n]=t}})),h},b=function e(t){const n=t.constructor.prototype;if(n===Raphael.el){if("path"===t.type&&"undefined"===typeof t.arrowheadsDrawn){const e=.6+.4*t.attr("stroke-width"),n=t.getTotalLength(),s=r.set(),i=r.path(x.isMobile?"M-4,4 C-4,4 -0.25,0 -0.25,0 C-0.25,0 -4,-4 -4,-4":"M-3 4 C-2.75 2.5 0 0.25 0.75 0C0 -0.25 -2.75 -2.5 -3 -4"),o=t.getPointAtLength(n-.4),a=t.getPointAtLength(n-.75*e),l=180*Math.atan2(o.y-a.y,o.x-a.x)/Math.PI,c=t.attr();delete c.path;let h=t.getSubpath(0,n-.75*e);return h=r.path(h).attr(c),h.arrowheadsDrawn=!0,t.remove(),i.rotate(l,x.isMobile?1e-5:.75,0).scale(e,e,.75,0).translate(a.x,a.y).attr(c).attr({"stroke-linejoin":"round","stroke-linecap":"round"}),i.arrowheadsDrawn=!0,s.push(h),s.push(i),s}}else if(n===Raphael.st)for(let s=0,i=t.items.length;s<i;s++)e(t.items[s]);return t},v={circle:function(e,t){return r.ellipse(...c(e).concat(a([t,t])))},rect:function(e,t,n,s){const i=c([e,t+s]),o=a([n,s]),l=r.rect(...i.concat(o));return x.isMobile&&(l.node.style.shapeRendering="crispEdges"),l},ellipse:function(e,t){return r.ellipse(...c(e).concat(a(t)))},fixedEllipse:function(e,t,n,s){const i=c(e),r=a(t),o=2*r[0]*n+s,h=2*r[1]*n+s,p=i[0]-o/2,u=i[1]-h/2,d=document.createElement("div");l()(d).css({position:"absolute",width:o+"px",height:h+"px",left:p+"px",top:u+"px"});return{wrapper:d,visibleShape:Raphael(d,o,h).ellipse(o/2,h/2,r[0],r[1])}},arc:function(e,t,n,s,i){n=(n%360+360)%360,s=(s%360+360)%360;const o=c(e),l=a(t),h=xr(t,n),p=xr(t,s),u=c([e[0]+h[0],e[1]+h[1]]),d=c([e[0]+p[0],e[1]+p[1]]),g=((s-n)%360+360)%360>180;return r.path("M"+u.join(" ")+"A"+l.join(" ")+" 0 "+(g?1:0)+" 0 "+d.join(" ")+(i?"L"+o.join(" ")+"z":""))},path:function(e){const t=r.path(d(e));return t.graphiePath=e,t},fixedPath:function(e,t,n){e=fr.map(e,c),t=t?c(t):null,n=n||d;const s=fr.min(fr.pluck(e,0)),i=fr.max(fr.pluck(e,0)),r=fr.min(fr.pluck(e,1)),o=fr.max(fr.pluck(e,1)),a=[4,4],h=[s,r];e=fr.map(e,(function(e){return gr.add(gr.subtract(e,h),gr.scale(a,.5))}));const p=i-s+a[0],u=o-r+a[1],g=h[0]-a[0]/2,f=h[1]-a[1]/2,m=document.createElement("div");l()(m).css({position:"absolute",width:p+"px",height:u+"px",left:g+"px",top:f+"px",transformOrigin:t?p/2+t[0]+"px "+(u/2+t[1])+"px":null});return{wrapper:m,visibleShape:Raphael(m,p,u).path(n(e))}},scaledPath:function(e){const t=r.path(d(e,!0));return t.graphiePath=e,t},line:function(e,t){const n=this.path([e,t]);return x.isMobile&&(n.node.style.shapeRendering="crispEdges"),n},parabola:function(e,t,n){return r.path(g(e,t,n))},fixedLine:function(e,t,n){const s=[n,n];e=c(e),t=c(t);const i=[Math.min(e[0],t[0]),Math.min(e[1],t[1])];e=gr.add(gr.subtract(e,i),gr.scale(s,.5)),t=gr.add(gr.subtract(t,i),gr.scale(s,.5));const r=i[0]-s[0]/2,o=i[1]-s[1]/2,a=Math.abs(e[0]-t[0])+s[0],h=Math.abs(e[1]-t[1])+s[1],p=document.createElement("div");l()(p).css({position:"absolute",width:a+"px",height:h+"px",left:r+"px",top:o+"px",transformOrigin:e[0]+"px "+e[1]+"px"});const u=Raphael(p,a,h),d="M"+e[0]+" "+e[1]+" L"+t[0]+" "+t[1],g=u.path(d);return g.graphiePath=[e,t],{wrapper:p,visibleShape:g}},sinusoid:function(e,t,n,s){return r.path(f(e,t,n,s))},grid:function(e,t){const n=o.step||[1,1],s=r.set();let i=n[0]*Math.ceil(e[0]/n[0]);for(;i<=e[1];i+=n[0])s.push(this.line([i,t[0]],[i,t[1]]));let a=n[1]*Math.ceil(t[0]/n[1]);for(;a<=t[1];a+=n[1])s.push(this.line([e[0],a],[e[1],a]));return s},label:function(t,n,s,i){i="undefined"===typeof i||i;const r=l()("<span>").addClass("graphie-label"),a=o["label-distance"];r.css(l.a.extend({},{position:"absolute",padding:(null!=a?a:7)+"px"})).data("labelDirection",s).appendTo(e),r.setPosition=function(e){const t=c(e);r.css({left:t[0],top:t[1]})},r.setPosition(t);const h=r[0];return r.processMath=function(e,t){br(h,e,t,(function(){const e=h.scrollWidth,t=h.scrollHeight;u(h,[e,t])}))},r.processText=function(e){r.html(e);const t=h.scrollWidth,n=h.scrollHeight;u(h,[t,n])},i?r.processMath(n,!1):r.processText(n),r},plotParametric:function(e,t,n,s){s=s||function(e){return[e,0]};const a=e=>Math.abs(e[1])>5e5?[e[0],Math.min(Math.max(e[1],-5e5),5e5)]:e,l=t=>a(e(t)),c=e=>a(s(e));o.strokeLinejoin||(o.strokeLinejoin="round"),o.strokeLinecap||(o.strokeLinecap="round");const h=t[0],p=t[1];let u=(p-h)/(o["plot-points"]||800);0===u&&(u=1);const d=r.set();let g=[],f=yr.coordDiff(l(h),c(h)),m=h;for(let r=h;r<=p;r+=u){const e=l(r),t=c(r),s=yr.coordDiff(e,t);if(s[1]<0!==f[1]<0&&Math.abs(s[1]-f[1])>2*i||isNaN(s[1])){if(n){g.push(e);for(let e=r-u;e>=m;e-=u)g.push(c(e));m=r}d.push(this.path(g)),g=[],n&&g.push(e)}else g.push(e);f=s}if(n)for(let i=p-u;i>=m;i-=u)g.push(c(i));return d.push(this.path(g)),d},plotPolar:function(e,t){const n=t[0],i=t[1];return o["plot-points"]||(o["plot-points"]=2*(i-n)*s),this.plotParametric((function(t){return xr(e(t),180*t/Math.PI)}),t)},plot:function(e,t,n,i,r){const a=t[0],l=t[1];if(o["plot-points"]||(o["plot-points"]=2*(l-a)*s),n){if(r)throw new Error("Can't shade area between functions with swapped axes.");return this.plotParametric((function(t){return[e(t),t]}),t,i)}if(r){if(i)return this.plotParametric((function(t){return[t,e(t)]}),t,i,(function(e){return[e,r(e)]}));throw new Error("fn2 should only be set when 'shade' is True.")}return this.plotParametric((function(t){return[t,e(t)]}),t,i)},plotPiecewise:function(e,t){const n=r.set(),s=this;return fr.times(e.length,(function(i){const r=e[i],o=t[i],a=s.plotParametric((function(e){return[e,r(e)]}),o);fr.each(a,(function(e){n.push(e)}))})),n},plotEndpointCircles:function(e){const t=r.set(),n=this;return fr.each(e,(function(e,s){t.push(n.circle(e,.15))})),t},plotAsymptotes:function(e,t){const n=t[0],s=t[1],a=(s-n)/(o["plot-points"]||800),l=r.set();let c=e(n);for(let r=n;r<=s;r+=a){const t=e(r);t<0!==c<0&&Math.abs(t-c)>2*i&&l.push(this.line([r,i],[r,-i])),c=t}return l}},x=new jr;return fr.extend(x,{raphael:r,init:function(o){let a=o.scale||[40,40];if(a="number"===typeof a?[a,a]:a,s=a[0],i=a[1],null==o.range)return Khan.error("range should be specified in graph init");t=o.range[0],n=o.range[1];const c=(t[1]-t[0])*s,h=(n[1]-n[0])*i;return r.setSize(c,h),l()(e).css({width:c,height:h}),this.range=o.range,this.scale=a,this.dimensions=[c,h],this.xpixels=c,this.ypixels=h,this.isMobile=o.isMobile,this},style:function(e,t){const n=m(e);if("function"===typeof t){const e=o;o=l.a.extend({},o,n);const s=t.call(x);return o=e,s}l.a.extend(o,n)},scalePoint:c,scaleVector:a,unscalePoint:h,unscaleVector:p,svgPath:d,svgParabolaPath:g,svgSinusoidPath:f}),l.a.each(v,(function(e){x[e]=function(){const t=arguments[arguments.length-1],n=o;let s;if("object"!==typeof t||fr.isArray(t))o=l.a.extend({},o),s=v[e](...arguments);else{o={...o,...m(t)};const n=[].slice.call(arguments,0,arguments.length-1);s=v[e](...n)}const i=s.constructor.prototype;return i===Raphael.el||i===Raphael.st?(s.attr(o),o.arrows&&(s=b(s))):s instanceof l.a&&s.css({...o,...Or}),o=n,s}})),x.graphInit=function(e){e=e||{},l.a.each(e,(function(t,n){t.match(/.*Opacity$/)||"range"===t||"number"!==typeof n||(e[t]=[n,n]),"range"!==t&&"gridRange"!==t||(n.constructor===Array?n[0].constructor!==Array&&(e[t]=[[-n[0],n[0]],[-n[1],n[1]]]):"number"===typeof n&&(e[t]=[[-n,n],[-n,n]]))}));const t=e.range||[[-10,10],[-10,10]],n=e.gridRange||e.range,s=e.scale||[20,20],i=null==e.grid||e.grid,r=e.gridOpacity||.1,o=e.gridStep||[1,1],a=null==e.axes||e.axes,c=e.axisArrows||"",h=e.axisOpacity||1,p=e.axisCenter||[Math.min(Math.max(t[0][0],0),t[0][1]),Math.min(Math.max(t[1][0],0),t[1][1])],u=null!=e.axisLabels&&e.axisLabels,d=null==e.ticks||e.ticks,g=e.tickStep||[2,2],f=e.tickLen||[5,5],m=e.tickOpacity||1,b=e.labels||e.labelStep||!1,v=e.labelStep||[1,1],x=e.labelOpacity||1;let y=e.unityLabels||!1;const j=e.labelFormat||function(e){return e};let w=e.xLabelFormat||j,O=e.yLabelFormat||j;const C=null==e.smartLabelPositioning||e.smartLabelPositioning,S=[[t[0][0]-(t[0][0]>0?1:0),t[0][1]+(t[0][1]<0?1:0)],[t[1][0]-(t[1][0]>0?1:0),t[1][1]+(t[1][1]<0?1:0)]];if(fr.isArray(y)||(y=[y,y]),C){const e=function(e){return function(t){return(e(t)+"").replace(/-(\d)/g,"\\llap{-}$1")}};w=e(w),O=e(O)}if(this.init({range:S,scale:s,isMobile:e.isMobile}),i&&this.grid(n[0],n[1],{stroke:e.isMobile?vr.GRAY_C:"#000000",opacity:e.isMobile?1:r,step:o,strokeWidth:e.isMobile?1:2}),a&&("<->"===c||!0===c?this.style({stroke:e.isMobile?vr.GRAY_G:"#000000",opacity:e.isMobile?1:h,strokeWidth:e.isMobile?1:2,arrows:"->"},(function(){t[1][0]<0&&t[1][1]>0&&(this.path([p,[n[0][0],p[1]]]),this.path([p,[n[0][1],p[1]]])),t[0][0]<0&&t[0][1]>0&&(this.path([p,[p[0],n[1][0]]]),this.path([p,[p[0],n[1][1]]]))})):"->"!==c&&""!==c||this.style({stroke:"#000000",opacity:h,strokeWidth:2,arrows:c},(function(){this.path([[n[0][0],p[1]],[n[0][1],p[1]]]),this.path([[p[0],n[1][0]],[p[0],n[1][1]]])})),u&&2===u.length&&(this.label([n[0][1],p[1]],u[0],"right"),this.label([p[0],n[1][1]],u[1],"above"))),d){const i=e.isMobile;this.style({stroke:e.isMobile?vr.GRAY_G:"#000000",opacity:e.isMobile?1:m,strokeWidth:1},(function(){let e=o[0]*g[0],r=f[0]/s[1],a=n[0][0],l=n[0][1];if(t[1][0]<0&&t[1][1]>0){for(let t=e+p[0];t<=l;t+=e)(t<l||!c)&&this.line([t,-r+p[1]],[t,i?0:r+p[1]]);for(let t=-e+p[0];t>=a;t-=e)(t>a||!c)&&this.line([t,-r+p[1]],[t,i?0:r+p[1]])}if(e=o[1]*g[1],r=f[1]/s[0],a=n[1][0],l=n[1][1],t[0][0]<0&&t[0][1]>0){for(let t=e+p[1];t<=l;t+=e)(t<l||!c)&&this.line([-r+p[0],t],[i?0:r+p[0],t]);for(let t=-e+p[1];t>=a;t-=e)(t>a||!c)&&this.line([-r+p[0],t],[i?0:r+p[0],t])}}))}b&&this.style({stroke:e.isMobile?vr.GRAY_G:"#000000",opacity:e.isMobile?1:x},(function(){let e=o[0]*g[0]*v[0],t=n[0][0],s=n[0][1];const i=p[0]<0?"above":"below",r=p[0]<0?"right":"left",a=0===p[0]&&0!==p[1],l=0!==p[0]&&0===p[1],h=0!==p[0]||0!==p[1],u=y[0]||h,d=y[1]||h;for(let n=(a?0:e)+p[0];n<=s;n+=e)(n<s||!c)&&this.label([n,p[1]],w(n),i);for(let n=-e*(u?1:2)+p[0];n>=t;n-=e)(n>t||!c)&&this.label([n,p[1]],w(n),i);e=o[1]*g[1]*v[1],t=n[1][0],s=n[1][1];for(let n=(l?0:e)+p[1];n<=s;n+=e)(n<s||!c)&&this.label([p[0],n],O(n),r);for(let n=-e*(d?1:2)+p[1];n>=t;n-=e)(n>t||!c)&&this.label([p[0],n],O(n),r)}))},x},ur.exports=yr;var Cr=ur.exports,Sr=(n(170),{exports:{}});Sr.exports;const kr=x.b,_r=Cr,Tr=G.a.vector,Mr=G.a.point,Nr=G.a.line,Pr=or,Ir=Ji,Er=Bi,Ar=Z,Rr=Mi;function Dr(e){return kr.reduce(e,(function(e,t){return e+t}),0)}function Fr(){const e=kr.toArray(arguments),t=kr.zip(...e);return kr.map(t,Dr)}function Lr(e){return kr.map(e,(function(e){return-1*e}))}function zr(e){const t=11.374597405497571;return 58.919514629750836*Math.exp(-.037587715462826674*e)+t}function qr(e,t){return[e*Math.cos(t),e*Math.sin(t)*-1]}function Wr(e,t){return qr(e,t*Math.PI/180)}let Br=!1;const Vr={bogusShape:{animate:function(){},attr:function(){},remove:function(){}}};function Hr(e,t){this.set=e.raphael.set(),this.cx=t[0],this.cy=t[1];const n=this,s=e.unscaleVector(180.5)[0],i=e.scalePoint([this.cx-s,this.cy+s-e.unscaleVector(10.5)[1]]),r=e.mouselayer.image("https://ka-perseus-graphie.s3.amazonaws.com/e9d032f2ab8b95979f674fbfa67056442ba1ff6a.png",i[0],i[1],360,180);this.set.push(r),r.node.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1});const o=function(n,i){const r=e.scaleVector(s);r[0]-=16,r[1]-=16;const o=e.scalePoint(t);return Math.sin((n+90)*Math.PI/180)*(r[0]+i)+o[0]+","+(Math.cos((n+90)*Math.PI/180)*(r[1]+i)+o[1])},a=e.raphael.path(" M"+o(180,6)+" L"+o(180,2)+" L"+o(183,10)+" L"+o(180,18)+" L"+o(180,14)+" A"+(e.scaleVector(s)[0]+10)+","+(e.scaleVector(s)[1]+10)+",0,0,1,"+o(170,14)+" L"+o(170,18)+" L"+o(167,10)+" L"+o(170,2)+" L"+o(170,6)+" A"+(e.scaleVector(s)[0]+10)+","+(e.scaleVector(s)[1]+10)+",0,0,0,"+o(180,6)+" Z").attr({stroke:null,fill:Rr.INTERACTIVE});this.set.push(a),this.centerPoint=e.addMovablePoint({coord:t,visible:!1}),this.rotateHandle=e.addMovablePoint({bounded:!1,coord:[Math.sin(275*Math.PI/180)*s+this.cx,Math.cos(275*Math.PI/180)*s+this.cy],onMove:function(e,t){const s=180*Math.atan2(n.centerPoint.coord[1]-t,n.centerPoint.coord[0]-e)/Math.PI;n.rotate(-s-5,!0)}}),this.rotateHandle.constraints.fixedDistance.dist=s,this.rotateHandle.constraints.fixedDistance.point=this.centerPoint,this.rotateHandle.visibleShape.remove(),this.rotateHandle.mouseTarget.attr({scale:2});let c=!1,h=!1;const p=function(){return h||c},u=l()(this.rotateHandle.mouseTarget.getMouseTarget());u.bind("vmousedown",(function(e){c=!0,u.css("cursor","-webkit-grabbing"),u.css("cursor","grabbing"),a.animate({scale:1.5,fill:Rr.INTERACTING},50),l()(document).bind("vmouseup.rotateHandle",(function(e){c=!1,u.css("cursor","-webkit-grab"),u.css("cursor","grab"),p()||a.animate({scale:1,fill:Rr.INTERACTIVE},50),l()(document).unbind("vmouseup.rotateHandle")}))})),u.bind("vmouseover",(function(e){h=!0,a.animate({scale:1.5,fill:Rr.INTERACTING},50)})),u.bind("vmouseout",(function(e){h=!1,p()||a.animate({scale:1,fill:Rr.INTERACTIVE},50)}));const d=l.a.map(this.set,(function(e){return e.node}));return this.makeTranslatable=function(){l()(d).css("cursor","move"),u.css("cursor","-webkit-grab"),u.css("cursor","grab"),l()(d).bind("vmousedown",(function(t){t.preventDefault();let s=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,i=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;l()(document).bind("vmousemove.protractor",(function(t){let r=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,o=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;r=Math.max(10,Math.min(e.xpixels-10,r)),o=Math.max(10,Math.min(e.ypixels-10,o));const a=r-s,c=o-i;l.a.each(n.set.items,(function(){this.translate(a,c)})),n.centerPoint.setCoord([n.centerPoint.coord[0]+a/e.scale[0],n.centerPoint.coord[1]-c/e.scale[1]]),n.rotateHandle.setCoord([n.rotateHandle.coord[0]+a/e.scale[0],n.rotateHandle.coord[1]-c/e.scale[1]]),s=r,i=o})),l()(document).one("vmouseup",(function(e){l()(document).unbind("vmousemove.protractor")}))}))},this.rotation=0,this.rotate=function(t,n){const s=e.scalePoint(this.centerPoint.coord);return n&&(this.rotation=0),this.set.rotate(this.rotation+t,s[0],s[1]),this.rotation=this.rotation+t,this},this.moveTo=function(t,s){const i=e.scalePoint(n.centerPoint.coord),r=e.scalePoint([t,s]),o=2*_r.getDistance(i,r);l()({x:i[0],y:i[1]}).animate({x:r[0],y:r[1]},{duration:o,step:function(t,s){let i=0,r=0;"x"===s.prop?i=t-e.scalePoint(n.centerPoint.coord)[0]:"y"===s.prop&&(r=t-e.scalePoint(n.centerPoint.coord)[1]),l.a.each(n.set.items,(function(){this.translate(i,r)})),n.centerPoint.setCoord([n.centerPoint.coord[0]+i/e.scale[0],n.centerPoint.coord[1]-r/e.scale[1]]),n.rotateHandle.setCoord([n.rotateHandle.coord[0]+i/e.scale[0],n.rotateHandle.coord[1]-r/e.scale[1]])}})},this.rotateTo=function(e){Math.abs(this.rotation-e)>180&&(this.rotation+=360);const t=5*Math.abs(this.rotation-e);l()({0:this.rotation}).animate({0:e},{duration:t,step:function(e,t){n.rotate(e,!0),n.rotateHandle.setCoord([Math.sin((e+275)*Math.PI/180)*s+n.centerPoint.coord[0],Math.cos((e+275)*Math.PI/180)*s+n.centerPoint.coord[1]])}})},this.remove=function(){this.set.remove()},this.makeTranslatable(),this}function Ur(e,t){kr.defaults(t,{center:[0,0],pixelsPerUnit:40,ticksPerUnit:10,units:10,label:"",style:{fill:null,stroke:Rr.GRAY}});const n=kr.extend({},t.style,{strokeWidth:1}),s=kr.extend({},t.style,{strokeWidth:2}),i=t.units*t.pixelsPerUnit,r=e.unscalePoint(Tr.subtract(e.scalePoint(t.center),Tr.scale([i,-50],.5))),o=t.pixelsPerUnit/e.scale[0],a=50/e.scale[0],c=Tr.add(r,[t.units*o,a]);let h;if(10===t.ticksPerUnit)h={10:1,5:.55,1:.35};else{const e=[1,.6,.45,.3];h={};for(let n=t.ticksPerUnit;n>=1;n/=2)h[n]=1*(e.shift()||.2)}const p=kr.keys(h).sort((function(e,t){return t-e}));const u=r[0],d=r[1],g=c[0],f=c[1],m=t.units*t.ticksPerUnit+1,b=e.raphael.set(),v=1/e.scale[0];b.push(e.line([u-v,d],[g+v,d],s)),b.push(e.line([u-v,f],[g+v,f],s)),kr.times(m,(function(i){const r=i/t.ticksPerUnit,l=u+r*o,c=function(e){for(let t=0;t<p.length;t++){const n=p[t];if(e%n===0)return h[n]}}(i)*a,g=0===i||i===m-1?s:n;if(b.push(e.line([l,d],[l,d+c],g)),r%1===0){const n=e.scalePoint([l,f]);let s,i;0===r?(s=t.label,i={mm:13,cm:11,m:8,km:11,in:8,ft:8,yd:10,mi:10}[s]||3*s.toString().length):(s=r,i=-3*(r.toString().length+1));const o=e.raphael.text(n[0]+i,n[1]+10,s);o.attr({"font-family":"KaTeX_Main","font-size":"12px",color:"#444"}),b.push(o)}}));const x=e.mouselayer.path(_r.svgPath([r,[u,f],c,[g,d],!0]));x.attr({fill:"#000",opacity:0,stroke:"#000","stroke-width":2}),b.push(x),x.node.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1});const y=l.a.map(b,(function(e){return e.node}));l()(y).css("cursor","move"),l()(y).bind("vmousedown",(function(t){t.preventDefault();let n=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,s=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;l()(document).bind("vmousemove.ruler",(function(t){let i=t.pageX-l()(e.raphael.canvas.parentNode).offset().left,r=t.pageY-l()(e.raphael.canvas.parentNode).offset().top;i=Math.max(10,Math.min(e.xpixels-10,i)),r=Math.max(10,Math.min(e.ypixels-10,r));const o=i-n,a=r-s;b.translate(o,a),j.setCoord([j.coord[0]+o/e.scale[0],j.coord[1]-a/e.scale[1]]),w.setCoord([w.coord[0]+o/e.scale[0],w.coord[1]-a/e.scale[1]]),n=i,s=r})),l()(document).one("vmouseup",(function(e){l()(document).unbind("vmousemove.ruler")}))}));const j=e.addMovablePoint({coord:r,normalStyle:{fill:Rr.INTERACTIVE,"fill-opacity":0,stroke:Rr.INTERACTIVE},highlightStyle:{fill:Rr.INTERACTING,"fill-opacity":.1,stroke:Rr.INTERACTING},pointSize:6,onMove:function(t,n){const s=w.coord[1]-n,i=w.coord[0]-t,r=180*Math.atan2(s,i)/Math.PI,o=Tr.scale(Tr.add([t,n],w.coord),.5),a=e.scalePoint(o),l=Tr.scale(Tr.add(j.coord,w.coord),.5),c=e.scalePoint(l),h=Tr.subtract(a,c);b.rotate(-r,c[0],c[1]),b.translate(h[0],h[1])}}),w=e.addMovablePoint({coord:[g,d],normalStyle:{fill:Rr.INTERACTIVE,"fill-opacity":0,stroke:Rr.INTERACTIVE},highlightStyle:{fill:Rr.INTERACTING,"fill-opacity":.1,stroke:Rr.INTERACTING},pointSize:6,onMove:function(t,n){const s=n-j.coord[1],i=t-j.coord[0],r=180*Math.atan2(s,i)/Math.PI,o=Tr.scale(Tr.add([t,n],j.coord),.5),a=e.scalePoint(o),l=Tr.scale(Tr.add(j.coord,w.coord),.5),c=e.scalePoint(l),h=Tr.subtract(a,c);b.rotate(-r,c[0],c[1]),b.translate(h[0],h[1])}});return j.constraints.fixedDistance.dist=i/e.scale[0],j.constraints.fixedDistance.point=w,w.constraints.fixedDistance.dist=i/e.scale[0],w.constraints.fixedDistance.point=j,this.remove=function(){b.remove(),j.remove(),w.remove()},this}function Gr(e,t){if(this.graphie=e,kr.extend(this,t),kr.defaults(this,{normalStyle:{stroke:Rr.INTERACTIVE,"stroke-width":2,fill:Rr.INTERACTIVE},highlightStyle:{stroke:Rr.INTERACTING,"stroke-width":2,fill:Rr.INTERACTING},labelStyle:{stroke:Rr.DYNAMIC,"stroke-width":1,color:Rr.DYNAMIC},angleStyle:{stroke:Rr.DYNAMIC,"stroke-width":1,color:Rr.DYNAMIC},allowReflex:!0}),!this.points||3!==this.points.length)throw new Error("MovableAngle requires 3 points");this.points=kr.map(t.points,(function(t){return kr.isArray(t)?e.addMovablePoint({coord:t,visible:!1,constraints:{fixed:!0},normalStyle:this.normalStyle}):t}),this),this.coords=kr.pluck(this.points,"coord"),null==this.reflex&&(this.allowReflex?this.reflex=this._getClockwiseAngle(this.coords)>180:this.reflex=!1),this.rays=kr.map([0,2],(function(t){return e.addMovableLineSegment({pointA:this.points[1],pointZ:this.points[t],fixed:!0,extendRay:!0})}),this),this.temp=[],this.labeledAngle=e.label([0,0],"","center",this.labelStyle),this.fixed||(this.addMoveHandlers(),this.addHighlightHandlers()),this.update()}kr.extend(_r.Graphie.prototype,{addMouseLayer:function(e){const t=this;e=kr.extend({allowScratchpad:!1,setDrawingAreaAvailable:function(){}},e);if(t.mouselayer=Raphael(t.raphael.canvas.parentNode,t.xpixels,t.ypixels),l()(t.mouselayer.canvas).css("z-index",2),e.onClick||e.onMouseDown||e.onMouseMove||e.onMouseOver||e.onMouseOut){const n=t.mouselayer.rect(0,0,t.xpixels,t.ypixels).attr({fill:"#000",opacity:0});let s=!1;l()(t.mouselayer.canvas).on("vmousedown",(function(i){i.target===n[0]&&(e.onMouseDown&&e.onMouseDown(t.getMouseCoord(i)),s=!0,e.onMouseMove&&l()(document).bind("vmousemove.mouseLayer",(function(n){s&&(n.preventDefault(),e.onMouseMove(t.getMouseCoord(n)))})),l()(document).bind("vmouseup.mouseLayer",(function(n){l()(document).unbind(".mouseLayer"),s&&e.onClick&&e.onClick(t.getMouseCoord(n)),s=!1})))})),e.onMouseOver&&l()(t.mouselayer.canvas).on("vmouseover",(function(n){e.onMouseOver(t.getMouseCoord(n))})),e.onMouseOut&&l()(t.mouselayer.canvas).on("vmouseout",(function(n){e.onMouseOut(t.getMouseCoord(n))}))}e.allowScratchpad||e.setDrawingAreaAvailable(!1),t._mouselayerWrapper=document.createElement("div"),l()(t._mouselayerWrapper).css({position:"absolute",left:0,top:0,zIndex:2}),t._visiblelayerWrapper=document.createElement("div"),l()(t._visiblelayerWrapper).css({position:"absolute",left:0,top:0});const n=t.raphael.canvas.parentNode;n.appendChild(t._visiblelayerWrapper),n.appendChild(t._mouselayerWrapper),t.addToMouseLayerWrapper=function(e){this._mouselayerWrapper.appendChild(e)},t.addToVisibleLayerWrapper=function(e){this._visiblelayerWrapper.appendChild(e)}},getMousePx:function(e){return[e.pageX-l()(this.raphael.canvas.parentNode).offset().left,e.pageY-l()(this.raphael.canvas.parentNode).offset().top]},getMouseCoord:function(e){return this.unscalePoint(this.getMousePx(e))},labelAngle:function(e){const t=this;kr.defaults(e,{point1:[0,0],vertex:[0,0],point3:[0,0],label:null,numArcs:1,showRightAngleMarker:!0,pushOut:0,clockwise:!1,style:{}});let n=void 0===e.text?"":e.text;const s=e.vertex,i=t.scalePoint(s);let r,o;e.clockwise?(r=e.point1,o=e.point3):(r=e.point3,o=e.point1);const a=_r.findAngle(r,s),l=_r.findAngle(o,s),c=(l+360-a)%360,h=(a+c/2)%360;let p=5*e.pushOut+zr(c);const u=[];if(Math.abs(c-90)<1e-9&&e.showRightAngleMarker){const n=Fr(i,Wr(p,a)),s=Fr(i,Wr(p,l));p*=Math.SQRT2;const r=Fr(i,Wr(p,h));kr.each([n,s],(function(n){u.push(t.scaledPath([n,r],e.style))}))}else kr.times(e.numArcs,(function(n){u.push(t.arc(s,t.unscaleVector(p),a,l,e.style)),p+=3}));if(n){const s=n.match(/\$deg(\d)?/);if(s){const e=s[1]||1;n=n.replace(s[0],Ar.toFixedApprox(c,e)+"^{\\circ}")}const r=Fr(i,Wr(p+15,h)),o=t.unscalePoint(r);e.label?(e.label.setPosition(o),e.label.processMath(n,!0)):t.label(o,n,"center",e.style)}return u},labelSide:function(e){const t=this;let n,s;kr.defaults(e,{point1:[0,0],point2:[0,0],label:null,text:"",numTicks:0,numArrows:0,clockwise:!1,style:{}}),e.clockwise?(n=e.point1,s=e.point2):(n=e.point2,s=e.point1);const i=[(n[0]+s[0])/2,(n[1]+s[1])/2],r=t.scalePoint(i),o=Math.atan2(s[1]-n[1],s[0]-n[0]),a=o+Math.PI/2,l=[];let c=0;if(e.numTicks){const n=e.numTicks,s=5,i=5,h=kr.extend({},e.style,{strokeWidth:2});kr.times(n,(function(e){const c=qr(s*(e-(n-1)/2),o),p=qr(i,a),u=[Fr(r,c,p),Fr(r,c,Lr(p))];l.push(t.scaledPath(u,h))})),c+=s*(n-1)+15}if(e.numArrows){const i=e.numArrows,a=[n,s].sort((function(e,t){return e[1]===t[1]?e[0]-t[0]:e[1]-t[1]}))[0],h=t.scalePoint(a),p=kr.extend({},e.style,{arrows:"->",strokeWidth:2}),u=5;kr.times(i,(function(e){let s=qr(c+u*e,o);a!==n&&(s=Lr(s));const i=Fr(r,s);l.push(t.scaledPath([h,i],p))}))}let h=e.text;if(h){const i=h.match(/\$len(\d)?/);if(i){const e=_r.getDistance(n,s),t=i[1]||1;h=h.replace(i[0],Ar.toFixedApprox(e,t))}const o=qr(20,a),l=Fr(r,o),c=t.unscalePoint(l);e.label?(e.label.setPosition(c),e.label.processMath(h,!0)):t.label(c,h,"center",e.style)}return l},labelVertex:function(e){const t=this;if(kr.defaults(e,{point1:null,vertex:[0,0],point3:null,label:null,text:"",clockwise:!1,style:{}}),!e.text)return;const n=e.vertex,s=t.scalePoint(n);let i,r;e.clockwise?(i=e.point1,r=e.point3):(i=e.point3,r=e.point1);let o,a=135;if(i&&r){const e=_r.findAngle(i,n);a=(_r.findAngle(r,n)+360-e)%360,o=(e+a/2+180)%360}else if(i){o=_r.findAngle(n,i)+90}else if(r){o=_r.findAngle(r,n)+90}else o=135;const l=Fr(s,Wr(10+zr(360-a),o)),c=t.unscalePoint(l);e.label?(e.label.setPosition(c),e.label.processMath(e.text,!0)):t.label(c,e.text,"center",e.style)},addMovablePoint:function(e){const t=l.a.extend(!0,{graph:this,coord:[0,0],snapX:0,snapY:0,pointSize:4,highlight:!1,dragging:!1,visible:!0,bounded:!0,constraints:{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},lineStarts:[],lineEnds:[],polygonVertices:[],normalStyle:{},highlightStyle:{fill:Rr.INTERACTING,stroke:Rr.INTERACTING},labelStyle:{color:Rr.INTERACTIVE},vertexLabel:"",mouseTarget:null},e),n=t.constraints.fixed?Rr.DYNAMIC:Rr.INTERACTIVE;t.normalStyle=kr.extend({},{fill:n,stroke:n},e.normalStyle),void 0!==e.coordX&&(t.coord[0]=e.coordX),void 0!==e.coordY&&(t.coord[1]=e.coordY);const s=t.graph,i=function(e){t.visible&&t.bounded&&!t.constraints.fixed&&(e=s.constrainToBounds(e,10));let n=e[0],i=e[1];if(0!==t.snapX&&(n=Math.round(n/t.snapX)*t.snapX),0!==t.snapY&&(i=Math.round(i/t.snapY)*t.snapY),t.constraints.fixedDistance.snapPoints){const r=s.scalePoint(e);let o=r[0],a=r[1];const l=2*Math.PI/t.constraints.fixedDistance.snapPoints,c=t.constraints.fixedDistance.dist,h=t.constraints.fixedDistance.point,p=(h[0]-s.range[0][0])*s.scale[0],u=(-h[1]+s.range[1][1])*s.scale[1];let d=o-p,g=-a+u,f=Math.atan(g/d);d<0&&(f+=Math.PI),f=Math.round(f/l)*l,d=c*Math.cos(f),g=c*Math.sin(f),o=d+p,a=-g+u,n=Ar.roundTo(5,o/s.scale[0]+s.range[0][0]),i=Ar.roundTo(5,s.range[1][1]-a/s.scale[1])}return t.applyConstraint([n,i])};t.applyConstraint=function(e,n,s){let i=e.slice();const r={};if(s?l.a.extend(r,{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},n):l.a.extend(r,this.constraints,n),r.constrainX)i=[this.coord[0],e[1]];else if(r.constrainY)i=[e[0],this.coord[1]];else if("number"===typeof r.fixedAngle.angle&&"number"===typeof r.fixedDistance.dist){const e=r.fixedAngle.vertex.coord||r.fixedAngle.vertex,t=r.fixedAngle.ref.coord||r.fixedAngle.ref,n=r.fixedDistance.point.coord||r.fixedDistance.point,s=(r.fixedAngle.angle+_r.findAngle(t,e))*Math.PI/180,o=r.fixedDistance.dist;i[0]=o*Math.cos(s)+n[0],i[1]=o*Math.sin(s)+n[1]}else if("number"===typeof r.fixedAngle.angle){const t=r.fixedAngle.vertex.coord||r.fixedAngle.vertex,n=r.fixedAngle.ref.coord||r.fixedAngle.ref,s=(r.fixedAngle.angle+_r.findAngle(n,t))*Math.PI/180,o=_r.findAngle(e,t)*Math.PI/180;let a=_r.getDistance(e,t)*Math.cos(s-o);a=a<1?1:a,i[0]=a*Math.cos(s)+t[0],i[1]=a*Math.sin(s)+t[1]}else if("number"===typeof r.fixedDistance.dist){const t=r.fixedDistance.point.coord||r.fixedDistance.point;let n=_r.findAngle(e,t);const s=r.fixedDistance.dist;n=n*Math.PI/180,i[0]=s*Math.cos(n)+t[0],i[1]=s*Math.sin(n)+t[1]}else r.fixed&&(i=t.coord);return i},t.coord=i(t.coord);if(t.visible&&s.style(t.normalStyle,(function(){const e=[t.pointSize/s.scale[0],t.pointSize/s.scale[1]],n={maxScale:2,padding:2};t.visibleShape=new Pr(s,t.coord,e,n),t.visibleShape.attr(kr.omit(t.normalStyle,"scale")),t.visibleShape.toFront()})),t.normalStyle.scale=1,t.highlightStyle.scale=2,t.vertexLabel&&(t.labeledVertex=this.label([0,0],"","center",t.labelStyle)),t.drawLabel=function(){t.vertexLabel&&t.graph.labelVertex({vertex:t.coord,label:t.labeledVertex,text:t.vertexLabel,style:t.labelStyle})},t.drawLabel(),t.grab=function(e){e=e||[0,0],l()(document).bind("vmousemove.point vmouseup.point",(function(n){n.preventDefault(),t.dragging=!0,Br=!0;let r=Tr.add(s.getMouseCoord(n),e);r=i(r);let o,a,c=r[0],h=r[1];if("vmousemove"===n.type){let e=!0;if(kr.isFunction(t.onMove)){const n=t.onMove(c,h);!1===n&&(e=!1),kr.isArray(n)&&(c=n[0],h=n[1])}if(o=(c-s.range[0][0])*s.scale[0],a=(-h+s.range[1][1])*s.scale[1],e){const e=s.unscalePoint([o,a]);t.visibleShape.moveTo(e),t.mouseTarget.moveTo(e),t.coord=[c,h],t.updateLineEnds(),l()(t).trigger("move")}t.drawLabel()}else if("vmouseup"===n.type){if(l()(document).unbind(".point"),t.dragging=!1,Br=!1,kr.isFunction(t.onMoveEnd)){const e=t.onMoveEnd(c,h);if(kr.isArray(e)){c=e[0],h=e[1],o=(c-s.range[0][0])*s.scale[0],a=(-h+s.range[1][1])*s.scale[1];const n=s.unscalePoint([o,a]);t.visibleShape.moveTo(n),t.mouseTarget.moveTo(n),t.coord=[c,h]}}t.highlight||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())}}))},t.visible&&!t.constraints.fixed){if(!t.mouseTarget){const e=s.unscaleVector(16),n={mouselayer:!0,padding:0,disableMouseEventsOnWrapper:!0};t.mouseTarget=new Pr(s,t.coord,e,n),t.mouseTarget.attr({fill:"#000",opacity:0})}const e=l()(t.mouseTarget.getMouseTarget());e.css("cursor","move"),e.bind("vmousedown vmouseover vmouseout",(function(e){if("vmouseover"===e.type)t.highlight=!0,Br||(t.visibleShape.animate(t.highlightStyle,50),t.onHighlight&&t.onHighlight());else if("vmouseout"===e.type)t.highlight=!1,t.dragging||Br||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight());else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault();const n=t.coord,i=s.getMouseCoord(e),r=!("ontouchstart"in window)?[0,0]:Tr.subtract(n,i);t.grab(r)}}))}return t.moveTo=function(e,n,s){const i=5*_r.getDistance(this.graph.scalePoint([e,n]),this.graph.scalePoint(this.coord)),r=s&&function(e){t.coord=e,t.updateLineEnds()};this.visibleShape.animateTo([e,n],i,r),this.mouseTarget.animateTo([e,n],i,r),this.coord=[e,n],kr.isFunction(this.onMove)&&this.onMove(e,n)},t.updateLineEnds=function(){l()(this.lineStarts).each((function(){this.coordA=t.coord,this.transform()})),l()(this.lineEnds).each((function(){this.coordZ=t.coord,this.transform()})),l()(this.polygonVertices).each((function(){this.transform()}))},t.setCoord=function(e){this.visible&&(this.visibleShape.moveTo(e),null!=this.mouseTarget&&this.mouseTarget.moveTo(e)),this.coord=e.slice()},t.setCoordConstrained=function(e){this.setCoord(i(e))},t.toBack=function(){this.visible&&(null!=this.mouseTarget&&this.mouseTarget.toBack(),this.visibleShape.toBack())},t.toFront=function(){this.visible&&(null!=this.mouseTarget&&this.mouseTarget.toFront(),this.visibleShape.toFront())},t.remove=function(){this.visibleShape&&this.visibleShape.remove(),this.mouseTarget&&this.mouseTarget.remove(),this.labeledVertex&&this.labeledVertex.remove()},t},addMovableLineSegment:function(e){const t=l.a.extend({graph:this,coordA:[0,0],coordZ:[1,1],snapX:0,snapY:0,fixed:!1,ticks:0,normalStyle:{},highlightStyle:{stroke:Rr.INTERACTING,"stroke-width":6},labelStyle:{stroke:Rr.INTERACTIVE,color:Rr.INTERACTIVE},highlight:!1,dragging:!1,tick:[],extendLine:!1,extendRay:!1,constraints:{fixed:!1,constrainX:!1,constrainY:!1},sideLabel:"",vertexLabels:[],numArrows:0,numTicks:0,movePointsWithLine:!1},e),n=t.fixed?Rr.DYNAMIC:Rr.INTERACTIVE;t.normalStyle=kr.extend({},{"stroke-width":2,stroke:n},e.normalStyle),t.arrowStyle=kr.extend({},t.normalStyle,{color:t.normalStyle.stroke}),void 0!==e.pointA?(t.coordA=e.pointA.coord,t.pointA.lineStarts.push(t)):void 0!==e.coordA&&(t.coordA=e.coordA.slice()),void 0!==e.pointZ?(t.coordZ=e.pointZ.coord,t.pointZ.lineEnds.push(t)):void 0!==e.coordA&&(t.coordA=t.coordA.slice());const s=t.graph;s.style(t.normalStyle);for(let r=0;r<t.ticks;++r)t.tick[r]=Vr.bogusShape;let i=_r.unscaledSvgPath([[0,0],[1,0]]);for(let r=0;r<t.ticks;++r){const e=.5-(t.ticks-1+2*r)/s.scale[0];i+=_r.unscaledSvgPath([[e,-7],[e,7]])}if(e={thickness:Math.max(t.normalStyle["stroke-width"],t.highlightStyle["stroke-width"])},t.visibleLine=new Ir(s,[0,0],[1,0],e),t.visibleLine.attr(t.normalStyle),!t.fixed){const e={thickness:30,mouselayer:!0};t.mouseTarget=new Ir(s,[0,0],[1,0],e),t.mouseTarget.attr({fill:"#000",opacity:0})}if(t.transform=function(e){e&&("object"===typeof this.pointA&&(this.coordA=this.pointA.coord),"object"===typeof this.pointZ&&(this.coordZ=this.pointZ.coord));const n=function(e,n,s){const i=(e=t.graph).range[0][1]-e.range[0][0]+(e.range[1][1]-e.range[1][0]),r=e.unscaleVector(Tr.cartFromPolarDeg([1,s])),o=Tr.scale(Tr.normalize(r),i),a=Tr.add(n,o),l=Tr.polarDegFromCart(r)[1];return e.constrainToBoundsOnAngle(a,4,l*Math.PI/180)},i=function(e){const t=e.graph.scalePoint(e.coordA),n=e.graph.scalePoint(e.coordZ);return Tr.polarDegFromCart(Tr.subtract(n,t))[1]}(this);let r=this.coordA,o=this.coordZ;this.extendLine?(r=n(s,r,360-i),o=n(s,o,(540-i)%360)):this.extendRay&&(o=n(s,r,360-i));const a=[this.visibleLine];this.fixed||a.push(this.mouseTarget),kr.each(a,(function(e){e.moveTo(r,o)}));const l=function(e,t){const s=[.75,0];let i=[[-3,4],[-2.75,2.5],[0,.25],s,[0,-.25],[-2.75,-2.5],[-3,-4]];i=kr.map(i,(function(e){const t=Tr.subtract(e,s),n=Tr.scale(t,1.4);return Tr.add(s,n)}));const r=kr.map(i,e.unscalePoint),o={center:e.unscalePoint(s),createPath:function(e){let t="M"+e[0][0]+" "+e[0][1];for(let n=1;n<e.length;n+=3)t+="C"+e[n][0]+" "+e[n][1]+" "+e[n+1][0]+" "+e[n+1][1]+" "+e[n+2][0]+" "+e[n+2][1];return t}},a=new Er(e,r,o);return a.attr(kr.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},t)),a.toCoordAtAngle=function(t,i){const r=e.scalePoint(n(e,t,i)),o=Si();a.transform("translateX("+(r[0]+1.4*s[0])+"px) translateY("+(r[1]+1.4*s[1])+"px) "+(o?"translateZ(0) ":"")+"rotate("+(360-Ar.bound(i))+"deg)")},a};null==this._arrows&&(this._arrows=[],this.extendLine?(this._arrows.push(l(s,this.normalStyle)),this._arrows.push(l(s,this.normalStyle))):this.extendRay&&this._arrows.push(l(s,this.normalStyle)));const c=[this.coordA,this.coordZ],h=[360-i,(540-i)%360];kr.each(this._arrows,(function(e,t){e.toCoordAtAngle(c[t],h[t])})),kr.invoke(this.temp,"remove"),this.temp=[];const p=this.coordA[0]<this.coordZ[0]||this.coordA[0]===this.coordZ[0]&&this.coordA[1]>this.coordZ[1];this.sideLabel&&this.temp.push(this.graph.labelSide({point1:this.coordA,point2:this.coordZ,label:this.labeledSide,text:this.sideLabel,numArrows:this.numArrows,numTicks:this.numTicks,clockwise:p,style:this.labelStyle})),this.vertexLabels.length&&(this.graph.labelVertex({vertex:this.coordA,point3:this.coordZ,label:this.labeledVertices[0],text:this.vertexLabels[0],clockwise:p,style:this.labelStyle}),this.graph.labelVertex({point1:this.coordA,vertex:this.coordZ,label:this.labeledVertices[1],text:this.vertexLabels[1],clockwise:p,style:this.labelStyle})),this.temp=kr.flatten(this.temp)},t.toBack=function(){t.fixed||t.mouseTarget.toBack(),t.visibleLine.toBack()},t.toFront=function(){t.fixed||t.mouseTarget.toFront(),t.visibleLine.toFront()},t.remove=function(){t.fixed||t.mouseTarget.remove(),t.visibleLine.remove(),t.labeledSide&&t.labeledSide.remove(),t.labeledVertices&&kr.invoke(t.labeledVertices,"remove"),t._arrows&&kr.invoke(t._arrows,"remove"),t.temp.length&&kr.invoke(t.temp,"remove")},t.hide=function(){t.visibleLine.hide(),t.temp.length&&kr.invoke(t.temp,"hide"),t._arrows&&kr.invoke(t._arrows,"hide")},t.show=function(){t.visibleLine.show(),t.temp.length&&kr.invoke(t.temp,"show"),t._arrows&&kr.invoke(t._arrows,"show")},t.sideLabel&&(t.labeledSide=this.label([0,0],"","center",t.labelStyle)),t.vertexLabels.length&&(t.labeledVertices=kr.map(t.vertexLabels,(function(e){return this.label([0,0],"","center",t.labelStyle)}),this)),!t.fixed&&!t.constraints.fixed){const e=l()(t.mouseTarget.getMouseTarget());e.css("cursor","move"),e.bind("vmousedown vmouseover vmouseout",(function(e){if("vmouseover"===e.type)Br||(t.highlight=!0,t.visibleLine.animate(t.highlightStyle,50),t.arrowStyle=kr.extend({},t.arrowStyle,{color:t.highlightStyle.stroke,stroke:t.highlightStyle.stroke}),t.transform());else if("vmouseout"===e.type)t.highlight=!1,t.dragging||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=kr.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform());else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault();let n=(e.pageX-l()(s.raphael.canvas.parentNode).offset().left)/s.scale[0]+s.range[0][0],i=s.range[1][1]-(e.pageY-l()(s.raphael.canvas.parentNode).offset().top)/s.scale[1];t.snapX>0&&(n=Math.round(n/t.snapX)*t.snapX),t.snapY>0&&(i=Math.round(i/t.snapY)*t.snapY);const r=[t.coordA[0]-n,t.coordA[1]-i],o=[t.coordZ[0]-n,t.coordZ[1]-i],a=-Math.min(s.scaleVector(r)[0],s.scaleVector(o)[0]),c=Math.max(s.scaleVector(r)[0],s.scaleVector(o)[0]),h=Math.max(s.scaleVector(r)[1],s.scaleVector(o)[1]),p=-Math.min(s.scaleVector(r)[1],s.scaleVector(o)[1]);l()(document).bind("vmousemove.lineSegment vmouseup.lineSegment",(function(e){e.preventDefault(),t.dragging=!0,Br=!0;let n=e.pageX-l()(s.raphael.canvas.parentNode).offset().left,i=e.pageY-l()(s.raphael.canvas.parentNode).offset().top;n=Math.max(a+10,Math.min(s.xpixels-10-c,n)),i=Math.max(h+10,Math.min(s.ypixels-10-p,i));let u=n/s.scale[0]+s.range[0][0],d=s.range[1][1]-i/s.scale[1];if(t.snapX>0&&(u=Math.round(u/t.snapX)*t.snapX),t.snapY>0&&(d=Math.round(d/t.snapY)*t.snapY),"vmousemove"===e.type){t.constraints.constrainX&&(u=t.coordA[0]-r[0]),t.constraints.constrainY&&(d=t.coordA[1]-r[1]);const e=u+r[0]-t.coordA[0],n=d+r[1]-t.coordA[1];t.coordA=[u+r[0],d+r[1]],t.coordZ=[u+o[0],d+o[1]],t.transform(),t.movePointsWithLine&&("object"===typeof t.pointA&&t.pointA.setCoord([t.pointA.coord[0]+e,t.pointA.coord[1]+n]),"object"===typeof t.pointZ&&t.pointZ.setCoord([t.pointZ.coord[0]+e,t.pointZ.coord[1]+n])),kr.isFunction(t.onMove)&&t.onMove(e,n)}else"vmouseup"===e.type&&(l()(document).unbind(".lineSegment"),t.dragging=!1,Br=!1,t.highlight||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=kr.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform()),kr.isFunction(t.onMoveEnd)&&t.onMoveEnd());l()(t).trigger("move")}))}}))}return void 0!==t.pointA&&t.pointA.toFront(),void 0!==t.pointZ&&t.pointZ.toFront(),t.transform(),t},addMovablePolygon:function(e){const t=this,n=l.a.extend({snapX:0,snapY:0,fixed:!1,constrainToGraph:!0,normalStyle:{},highlightStyle:{stroke:Rr.INTERACTING,"stroke-width":2,fill:Rr.INTERACTING,"fill-opacity":.05},pointHighlightStyle:{fill:Rr.INTERACTING,stroke:Rr.INTERACTING},labelStyle:{stroke:Rr.DYNAMIC,"stroke-width":1,color:Rr.DYNAMIC},angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],updateOnPointMove:!0,closed:!0},kr.omit(e,"points")),s=n.fixed?Rr.DYNAMIC:Rr.INTERACTIVE;n.normalStyle=kr.extend({"stroke-width":2,"fill-opacity":0,fill:s,stroke:s},e.normalStyle),n.points=e.points;const i=function(e){return!kr.isArray(e)};if(n.update=function(){const e=n.points.length;n.coords=kr.map(n.points,(function(e,t){return i(e)?e.coord:e})),n.left=kr.min(kr.pluck(n.coords,0)),n.right=kr.max(kr.pluck(n.coords,0)),n.top=kr.max(kr.pluck(n.coords,1)),n.bottom=kr.min(kr.pluck(n.coords,1));let s=kr.map(n.coords,(function(e){return t.scalePoint(e)}));n.closed?s.push(!0):s=s.concat(kr.clone(s).reverse()),n.path=_r.unscaledSvgPath(s),kr.invoke(n.temp,"remove"),n.temp=[];const r=function(e){const t=kr.zip(e,e.slice(1).concat(e.slice(0,1)));return Dr(kr.map(t,(function(e){const t=e[0],n=e[1];return(n[0]-t[0])*(n[1]+t[1])})))>0}(n.coords);(n.angleLabels.length||n.showRightAngleMarkers.length)&&kr.each(n.labeledAngles,(function(s,i){n.temp.push(t.labelAngle({point1:n.coords[(i-1+e)%e],vertex:n.coords[i],point3:n.coords[(i+1)%e],label:s,text:n.angleLabels[i],showRightAngleMarker:n.showRightAngleMarkers[i],numArcs:n.numArcs[i],clockwise:r,style:n.labelStyle}))})),n.sideLabels.length&&kr.each(n.labeledSides,(function(s,i){n.temp.push(t.labelSide({point1:n.coords[i],point2:n.coords[(i+1)%e],label:s,text:n.sideLabels[i],numArrows:n.numArrows[i],numTicks:n.numTicks[i],clockwise:r,style:n.labelStyle}))})),n.vertexLabels.length&&kr.each(n.labeledVertices,(function(s,i){t.labelVertex({point1:n.coords[(i-1+e)%e],vertex:n.coords[i],point3:n.coords[(i+1)%e],label:s,text:n.vertexLabels[i],clockwise:r,style:n.labelStyle})})),n.temp=kr.flatten(n.temp)},n.transform=function(){n.update(),n.visibleShape.attr({path:n.path}),n.fixed||n.mouseTarget.attr({path:n.path})},n.remove=function(){n.visibleShape.remove(),n.fixed||n.mouseTarget.remove(),n.labeledAngles&&kr.invoke(n.labeledAngles,"remove"),n.labeledSides&&kr.invoke(n.labeledSides,"remove"),n.labeledVertices&&kr.invoke(n.labeledVertices,"remove"),n.temp.length&&kr.invoke(n.temp,"remove")},n.toBack=function(){n.fixed||n.mouseTarget.toBack(),n.visibleShape.toBack()},n.toFront=function(){n.fixed||n.mouseTarget.toFront(),n.visibleShape.toFront()},n.updateOnPointMove&&kr.each(kr.filter(n.points,i),(function(e){e.polygonVertices.push(n)})),n.coords=new Array(n.points.length),n.angleLabels.length){const e=Math.max(n.angleLabels.length,n.showRightAngleMarkers.length);n.labeledAngles=kr.times(e,(function(){return this.label([0,0],"","center",n.labelStyle)}),this)}return n.sideLabels.length&&(n.labeledSides=kr.map(n.sideLabels,(function(e){return this.label([0,0],"","center",n.labelStyle)}),this)),n.vertexLabels.length&&(n.labeledVertices=kr.map(n.vertexLabels,(function(e){return this.label([0,0],"","center",n.labelStyle)}),this)),n.update(),n.visibleShape=t.raphael.path(n.path),n.visibleShape.attr(n.normalStyle),n.fixed||(n.mouseTarget=t.mouselayer.path(n.path),n.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"}),l()(n.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",(function(e){if("vmouseover"===e.type)Br&&!n.dragging||(n.highlight=!0,n.visibleShape.animate(n.highlightStyle,50),kr.each(kr.filter(n.points,i),(function(e){e.visibleShape.animate(n.pointHighlightStyle,50)})));else if("vmouseout"===e.type){if(n.highlight=!1,!n.dragging){n.visibleShape.animate(n.normalStyle,50);const e=kr.filter(n.points,i);kr.any(kr.pluck(e,"dragging"))||kr.each(e,(function(e){e.visibleShape.animate(e.normalStyle,50)}))}}else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault(),kr.each(kr.filter(n.points,i),(function(e){e.dragging=!0}));let s=(e.pageX-l()(t.raphael.canvas.parentNode).offset().left)/t.scale[0]+t.range[0][0],r=t.range[1][1]-(e.pageY-l()(t.raphael.canvas.parentNode).offset().top)/t.scale[1];n.snapX>0&&(s=Math.round(s/n.snapX)*n.snapX),n.snapY>0&&(r=Math.round(r/n.snapY)*n.snapY);let o=s,a=r;const c=n.coords.slice(),h=(s-n.left)*t.scale[0],p=(n.right-s)*t.scale[0],u=(n.top-r)*t.scale[1],d=(r-n.bottom)*t.scale[1];l()(document).bind("vmousemove.polygon vmouseup.polygon",(function(e){e.preventDefault(),n.dragging=!0,Br=!0;let g=e.pageX-l()(t.raphael.canvas.parentNode).offset().left,f=e.pageY-l()(t.raphael.canvas.parentNode).offset().top;n.constrainToGraph&&(g=Math.max(h+10,Math.min(t.xpixels-10-p,g)),f=Math.max(u+10,Math.min(t.ypixels-10-d,f)));let m=g/t.scale[0]+t.range[0][0],b=t.range[1][1]-f/t.scale[1];if(n.snapX>0&&(m=Math.round(m/n.snapX)*n.snapX),n.snapY>0&&(b=Math.round(b/n.snapY)*n.snapY),"vmousemove"===e.type){let e=m-s,t=b-r,h=!0;if(kr.isFunction(n.onMove)){const i=n.onMove(e,t);!1===i?h=!1:kr.isArray(i)&&(e=i[0],t=i[1],m=s+e,b=r+t)}const p=function(n){return[c[n][0]+e,c[n][1]+t]};h&&(kr.each(n.points,(function(e,t){i(e)?e.setCoord(p(t)):n.points[t]=p(t)})),n.transform(),l()(n).trigger("move"),o=m,a=b)}else if("vmouseup"===e.type){l()(document).unbind(".polygon");const e=kr.filter(n.points,i);kr.each(e,(function(e){e.dragging=!1})),n.dragging=!1,Br=!1,n.highlight||(n.visibleShape.animate(n.normalStyle,50),kr.each(e,(function(e){e.visibleShape.animate(e.normalStyle,50)}))),kr.isFunction(n.onMoveEnd)&&n.onMoveEnd(o-s,a-r)}}))}}))),kr.invoke(kr.filter(n.points,i),"toFront"),n},constrainToBounds:function(e,t){const n=this.unscalePoint([t,this.ypixels-t]),s=this.unscalePoint([this.xpixels-t,t]);return[Math.max(n[0],Math.min(s[0],e[0])),Math.max(n[1],Math.min(s[1],e[1]))]},constrainToBoundsOnAngle:function(e,t,n){const s=this.unscalePoint([t,this.ypixels-t]),i=this.unscalePoint([this.xpixels-t,t]);let r=e.slice();return r[0]<s[0]?r=[s[0],r[1]+(s[0]-r[0])*Math.tan(n)]:r[0]>i[0]&&(r=[i[0],r[1]-(r[0]-i[0])*Math.tan(n)]),r[1]<s[1]?r=[r[0]+(s[1]-r[1])/Math.tan(n),s[1]]:r[1]>i[1]&&(r=[r[0]-(r[1]-i[1])/Math.tan(n),i[1]]),r},addMovableAngle:function(e){return new Gr(this,e)},addCircleGraph:function(e){const t=this,n=l.a.extend({center:[0,0],radius:2,snapX:.5,snapY:.5,snapRadius:.5,minRadius:1,centerConstraints:{},centerNormalStyle:{},centerHighlightStyle:{stroke:Rr.INTERACTING,fill:Rr.INTERACTING},circleNormalStyle:{stroke:Rr.INTERACTIVE,"fill-opacity":0},circleHighlightStyle:{stroke:Rr.INTERACTING,fill:Rr.INTERACTING,"fill-opacity":.05}},e),s=n.centerConstraints.fixed?Rr.DYNAMIC:Rr.INTERACTIVE,i=e?e.centerNormalStyle:null;n.centerNormalStyle=kr.extend({},{fill:s,stroke:s},i),n.centerPoint=t.addMovablePoint({graph:t,coord:n.center,normalStyle:n.centerNormalStyle,snapX:n.snapX,snapY:n.snapY,constraints:n.centerConstraints}),n.circ=t.circle(n.center,n.radius,n.circleNormalStyle),n.perim=t.mouselayer.circle(t.scalePoint(n.center)[0],t.scalePoint(n.center)[1],t.scaleVector(n.radius)[0]).attr({"stroke-width":20,opacity:.002}),n.centerConstraints.fixed||l()(n.centerPoint.mouseTarget.getMouseTarget()).on("vmouseover vmouseout",(function(e){n.centerPoint.highlight||n.centerPoint.dragging?n.circ.animate(n.circleHighlightStyle,50):n.circ.animate(n.circleNormalStyle,50)})),n.toFront=function(){n.circ.toFront(),n.perim.toFront(),n.centerPoint.visibleShape.toFront(),n.centerConstraints.fixed||n.centerPoint.mouseTarget.toFront()},n.centerPoint.onMove=function(e,s){n.toFront(),n.circ.attr({cx:t.scalePoint(e)[0],cy:t.scalePoint(s)[1]}),n.perim.attr({cx:t.scalePoint(e)[0],cy:t.scalePoint(s)[1]}),n.onMove&&n.onMove(e,s)},l()(n.centerPoint).on("move",(function(){n.center=this.coord,l()(n).trigger("move")})),n.setCenter=function(e,t){n.centerPoint.setCoord([e,t]),n.centerPoint.onMove(e,t),n.center=[e,t]},n.setRadius=function(e){n.radius=e,n.perim.attr({r:t.scaleVector(e)[0]}),n.circ.attr({rx:t.scaleVector(e)[0],ry:t.scaleVector(e)[1]})},n.remove=function(){n.centerPoint.remove(),n.circ.remove(),n.perim.remove()};const r=[[-1*Math.PI,-.875*Math.PI,"ew-resize"],[-.875*Math.PI,-.625*Math.PI,"nesw-resize"],[-.625*Math.PI,-.375*Math.PI,"ns-resize"],[-.375*Math.PI,-.125*Math.PI,"nwse-resize"],[-.125*Math.PI,.125*Math.PI,"ew-resize"],[.125*Math.PI,.375*Math.PI,"nesw-resize"],[.375*Math.PI,.625*Math.PI,"ns-resize"],[.625*Math.PI,.875*Math.PI,"nwse-resize"],[.875*Math.PI,1*Math.PI,"ew-resize"]];return l()(n.perim.node).on("vmousemove",(e=>{let[t,s]=this.getMouseCoord(e);t-=n.center[0],s-=n.center[1];const i=Math.atan2(s,t);r.forEach((function(e){const[t,s,r]=e;i>=t&&i<s&&l()(n.perim.node).css("cursor",r)}))})),l()(n.perim.node).css("cursor","nesw-resize"),n.perim.node.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),l()(n.perim.node).on("vmouseover vmouseout vmousedown",(function(e){if("vmouseover"===e.type)n.highlight=!0,Br||(n.circ.animate(n.circleHighlightStyle,50),n.centerPoint.visibleShape.animate(n.centerHighlightStyle,50));else if("vmouseout"===e.type)n.highlight=!1,n.dragging||n.centerPoint.dragging||(n.circ.animate(n.circleNormalStyle,50),n.centerPoint.visibleShape.animate(n.centerNormalStyle,50));else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault(),n.toFront();const s=n.radius;l()(document).on("vmousemove vmouseup",(function(e){if(e.preventDefault(),n.dragging=!0,Br=!0,"vmousemove"===e.type){const s=t.constrainToBounds(t.getMouseCoord(e),10);let i=_r.getDistance(n.centerPoint.coord,s);i=Math.max(n.minRadius,Math.round(i/n.snapRadius)*n.snapRadius);const r=n.radius;let o=!0;if(n.onResize){const e=n.onResize(i,r);kr.isNumber(e)?i=e:!1===e&&(o=!1)}o&&(n.setRadius(i),l()(n).trigger("move"))}else"vmouseup"===e.type&&(l()(document).off("vmousemove vmouseup"),n.dragging=!1,Br=!1,n.onResizeEnd&&n.onResizeEnd(n.radius,s))}))}})),n},addRotateHandle:function(e){const t=this;let n=e.center;const s=e.radius,i=e.lengthAngle||30,r=e.hideArrow||!1,o=e.mouseTarget,a=kr.uniqueId("rotateHandle");kr.isArray(n)&&(n={coord:n});const c=t.addMovablePoint({coord:Mr.addVector(n.coord,Tr.cartFromPolarDeg(s,e.angleDeg||0)),constraints:{fixedDistance:{dist:s,point:n}},mouseTarget:o});n.toFront();let h,p=n.coord,u=c.coord,d=u,g=!1,f=!1;const m=function(s){if(r)return;const o=Tr.subtract(s,n.coord),a=Tr.polarDegFromCart(o)[1];h&&h.remove(),h=function(e,t,n,s,i,r,o){const a=function(s,i){const o=n+i,a=Tr.cartFromPolarDeg([o,r+s]),l=Tr.add(t,a),c=e.scalePoint(l);return c[0]+","+c[1]},l=e.scaleVector(n-s),c=e.scaleVector(n+s);return e.raphael.path(" M"+a(i,-s)+" L"+a(i,-3*s)+" L"+a(2*i,0)+" L"+a(i,3*s)+" L"+a(i,s)+" A"+c[0]+","+c[1]+",0,0,1,"+a(-i,s)+" L"+a(-i,3*s)+" L"+a(-2*i,0)+" L"+a(-i,-3*s)+" L"+a(-i,-s)+" A"+l[0]+","+l[1]+",0,0,0,"+a(i,-s)+" Z").attr({stroke:null,fill:o?Rr.INTERACTING:Rr.INTERACTIVE})}(t,n.coord,e.radius,g||f?e.hoverWidth/2:e.width/2,i,a,g||f)};l()(n).on("move."+a,(function(){const e=Tr.subtract(n.coord,p);c.setCoord(Tr.add(c.coord,e)),m(c.coord),p=n.coord,c.constraints.fixedDistance.point=n,u=c.coord})),c.onMove=function(t,s){g||(d=u,g=!0);let i=[t,s];if(e.onMove){const t=Tr.polarDegFromCart(Tr.subtract(u,n.coord)),s=Tr.polarDegFromCart(Tr.subtract(i,n.coord)),r=t[1],o=s[1];let a=e.onMove(o,r);null!=a&&!0!==a&&(!1===a&&(a=r),i=Tr.add(n.coord,Tr.cartFromPolarDeg([t[0],a])))}return m(i),u=i,i},c.onMoveEnd=function(){if(g=!1,m(c.coord),e.onMoveEnd){const t=Tr.polarDegFromCart(Tr.subtract(d,n.coord)),s=Tr.polarDegFromCart(Tr.subtract(c.coord,n.coord));e.onMoveEnd(s[1],t[1])}},c.visibleShape.remove(),o||c.mouseTarget.attr({scale:2});const b=l()(c.mouseTarget.getMouseTarget());b.bind("vmouseover",(function(e){f=!0,m(c.coord)})),b.bind("vmouseout",(function(e){f=!1,m(c.coord)})),m(c.coord);const v=c.remove;return c.remove=function(){v.call(c),h&&h.remove(),l()(n).off("move."+a)},c.update=function(){m(c.coord)},c},addReflectButton:function(e){const t=this,n=e.line,s=t.addMovablePoint({constraints:e.constraints,coord:Nr.midpoint([n.pointA.coord,n.pointZ.coord]),snapX:t.snap[0],snapY:t.snap[1],onMove:function(e,t){return!1},onMoveEnd:function(t,n){e.onMoveEnd&&e.onMoveEnd.call(this,t,n)}});let i,r=!1,o=!1;const a=function(){return r},c=kr.map([0,1],(function(t){const n=t?e.highlightStyle:e.normalStyle;return kr.map([0,1],(function(e){return kr.defaults({"fill-opacity":e},n)}))})),h=function(e){return o&&(e=!e),c[+a()][+e]},p=function(n,s){i&&i.remove(),i=function(e,t,n,s,i,r,o){Mr.equal(n[0],n[1])&&(n=[n[0],Mr.addVector(n[0],[1,1])]);const a=Tr.normalize(Tr.subtract(n[1],n[0])),l=Tr.scale(a,s/2),c=Tr.scale(a,i),h=Tr.rotateDeg(c,90),p=Tr.rotateDeg(c,-90),u=Tr.negate(l),d=Tr.rotateDeg(l,90),g=Tr.rotateDeg(l,-90),f=Mr.addVectors(t,h),m=Mr.addVectors(t,p),b=Mr.addVectors(t,h,l,d),v=Mr.addVectors(t,h,u,d),x=Mr.addVectors(t,p,l,g),y=Mr.addVectors(t,p,u,g),j=e.path([f,b,v,!0],r),w=e.path([m,x,y,!0],o);return{remove:function(){j.remove(),w.remove()}}}(t,n,s,a()?1.5*e.size:e.size,a()?.125*e.size:.25,h(0),h(1))},u=function(e,t){e=e||n.pointA.coord,t=t||n.pointZ.coord;const i=Nr.midpoint([e,t]);s.setCoord(i),p(i,[e,t])};l()(n).on("move",kr.bind(u,s,null,null));const d=l()(s.mouseTarget.getMouseTarget());d.on("vclick",(function(){!1!==e.onClick()&&(o=!o,p(s.coord,[n.pointA.coord,n.pointZ.coord]))})),n.pointA.toFront(),n.pointZ.toFront(),s.visibleShape.remove();const g=t.scaleVector(e.size)[0]/20;s.mouseTarget.attr({scale:1.5*g}),d.css("cursor","pointer"),d.bind("vmouseover",(function(e){r=!0,p(s.coord,[n.pointA.coord,n.pointZ.coord])})),d.bind("vmouseout",(function(e){r=!1,p(s.coord,[n.pointA.coord,n.pointZ.coord])}));const f=s.remove;return s.remove=function(){i.remove(),f.call(s)},s.update=u,s.isFlipped=function(){return o},u(),s},protractor:function(e){return new Hr(this,e)},ruler:function(e){return new Ur(this,e||{})},addPoints:Fr}),kr.extend(Gr.prototype,{points:[],snapDegrees:0,snapOffsetDeg:0,angleLabel:"",numArcs:1,pushOut:0,fixed:!1,addMoveHandlers:function(){const e=this.graphie;function t(t,n){return _r.getDistance(e.scalePoint(t),e.scalePoint(n))<30}const n=this.points;n[1].onMove=function(s,i){const r=n[1].coord,o=[s,i],a=Fr(o,Lr(r));let l=!0;const c={};return kr.each([0,2],(function(s){let i=Fr(n[s].coord,a),r=_r.findAngle(o,i);r*=Math.PI/180,i=e.constrainToBoundsOnAngle(i,10,r),c[s]=i,t(o,i)&&(l=!1)})),l&&kr.each(c,(function(e,t){n[t].setCoord(e)})),l};const s=this.snapDegrees,i=this.snapOffsetDeg;kr.each([0,2],(function(r){n[r].onMove=function(r,o){const a=[r,o],l=n[1].coord;if(t(l,a))return!1;if(s){let t=_r.findAngle(a,l);t=Math.round((t-i)/s)*s+i;const n=_r.getDistance(a,l);return Fr(l,e.polar(n,t))}return!0}})),l()(n).on("move",function(){this.update(),l()(this).trigger("move")}.bind(this))},addHighlightHandlers:function(){const e=this.points[1];e.onHighlight=function(){kr.each(this.points,(function(e){e.visibleShape.animate(this.highlightStyle,50)}),this),kr.each(this.rays,(function(e){e.visibleLine.animate(this.highlightStyle,50),e.arrowStyle=kr.extend({},e.arrowStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke})}),this),this.angleStyle=kr.extend({},this.angleStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke}),this.update()}.bind(this),e.onUnhighlight=function(){kr.each(this.points,(function(e){e.visibleShape.animate(this.normalStyle,50)}),this),kr.each(this.rays,(function(e){e.visibleLine.animate(e.normalStyle,50),e.arrowStyle=kr.extend({},e.arrowStyle,{color:e.normalStyle.stroke,stroke:e.normalStyle.stroke})}),this),this.angleStyle=kr.extend({},this.angleStyle,{color:Rr.DYNAMIC,stroke:Rr.DYNAMIC}),this.update()}.bind(this)},_getClockwiseAngle:function(e){return _r.findAngle(e[2],e[0],e[1])+0},isReflex:function(){return this.reflex},isClockwise:function(){return this._getClockwiseAngle(this.coords)>180===this.reflex},getClockwiseCoords:function(){return this.isClockwise()?kr.clone(this.coords):kr.clone(this.coords).reverse()},update:function(e){const t=this.coords;this.coords=kr.pluck(this.points,"coord"),kr.invoke(this.points,"updateLineEnds");const n=this._getClockwiseAngle(t),s=this._getClockwiseAngle(this.coords),i=n>180,r=s>180;this.allowReflex&&(null==e&&(e=i!==r&&Math.abs(s-n)<180),e&&(this.reflex=!this.reflex)),kr.invoke(this.temp,"remove"),this.temp=this.graphie.labelAngle({point1:this.coords[0],vertex:this.coords[1],point3:this.coords[2],label:this.labeledAngle,text:this.angleLabel,numArcs:this.numArcs,pushOut:this.pushOut,clockwise:this.reflex===r,style:this.angleStyle})},remove:function(){kr.invoke(this.rays,"remove"),kr.invoke(this.temp,"remove"),this.labeledAngle.remove()}}),Sr.exports=Vr;Sr.exports;var $r={exports:{}};$r.exports;const Yr=Cr;$r.exports=Yr;var Kr=$r.exports,Xr={exports:{}};Xr.exports;const Zr=x.b,Jr=G.a.point,Qr=G.a.vector;function eo(e){const t=Zr.zip(e,e.slice(1).concat(e.slice(0,1))),n=Zr.map(t,(function(e){const t=e[0],n=e[1];return(n[0]-t[0])*(n[1]+t[1])}));return s=n,Zr.reduce(s,(function(e,t){return e+t}),0)>0;var s}const to={constrain:function(){this.constrain()},pointsToFront:function(e){Zr.invoke(e.points,"toFront")}};to.standard=[to.constrain,to.pointsToFront];const no={draw:function(){this.draw()}};no.standard=[no.draw];const so={basic:function(e,t){const n=this.graphie,s=this.path(e);this.state.visibleShape||(this.state.visibleShape=n.raphael.path(s),this.state.visibleShape.attr(this.normalStyle())),e.normalStyle===t.normalStyle||Zr.isEqual(e.normalStyle,t.normalStyle)||this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.attr({path:s}),this.mouseTarget()&&this.mouseTarget().attr({path:s})},labels:function(e,t){const n=this.graphie,s=this,i=Zr.invoke(e.points,"coord"),r=eo(i),o=i.length;null!=s.state._labelCache&&Zr.invoke(s.state._labelCache,"remove"),s.state._labelCache=[],(e.angleLabels.length||e.showRightAngleMarkers.length)&&(null==s.state._labeledAngles&&(s.state._labeledAngles=Zr.times(Math.max(e.angleLabels.length,e.showRightAngleMarkers.length),(function(){return n.label([0,0],"","center",e.labelStyle)}))),Zr.each(s.state._labeledAngles,(function(t,a){s.state._labelCache.push(n.labelAngle({point1:i[(a-1+o)%o],vertex:i[a],point3:i[(a+1)%o],label:t,text:e.angleLabels[a],showRightAngleMarker:e.showRightAngleMarkers[a],numArcs:e.numArcs[a],clockwise:r,style:e.labelStyle}))}))),e.sideLabels.length&&(null==s.state._labeledSides&&(s.state._labeledSides=Zr.map(e.sideLabels,(function(t){return n.label([0,0],"","center",e.labelStyle)}))),Zr.each(s.state._labeledSides,(function(t,a){s.state._labelCache.push(n.labelSide({point1:i[a],point2:i[(a+1)%o],label:t,text:e.sideLabels[a],numArrows:e.numArrows[a],numTicks:e.numTicks[a],clockwise:r,style:e.labelStyle}))}))),e.vertexLabels.length&&(null==s.state._labeledVertices&&(s.state._labeledVertices=Zr.map(e.vertexLabels,(function(t){return n.label([0,0],"","center",e.labelStyle)}))),Zr.each(s.state._labeledVertices,(function(t,a){s.state._labelCache.push(n.labelVertex({point1:i[(a-1+o)%o],vertex:i[a],point3:i[(a+1)%o],label:t,text:e.vertexLabels[a],clockwise:r,style:e.labelStyle}))}))),s.state._labelCache=Zr.flatten(s.state._labelCache)},highlight:function(e,t){e.isHovering&&!t.isHovering?e.visibleShape.animate(this.highlightStyle(),50):!e.isHovering&&t.isHovering&&e.visibleShape.animate(this.normalStyle(),50)}};so.standard=[so.basic,so.labels,so.highlight];const io={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},labels:function(){const e=[this.state._labeledSides,this.state._labeledVertices,this.state._labeledAngles,this.state._labelCache];Zr.each(e,(function(e){null!=e&&e.length&&Zr.invoke(e,"remove")}))}};io.standard=[io.basic,io.labels];const ro={fixed:function(){return function(){return!1}},snap:function(e){return function(t){return null===e||(e=e||this.graphie.snap,Jr.roundTo(t,e))}},bound:function(e,t,n){return void 0===n&&(n=void 0===e?10:0),function(e,s){const i=this.graphie,r=Qr.subtract(e,s),o=o||i.range;void 0===t&&(t=i.snap);let a=i.unscalePoint([n,i.ypixels-n]),l=i.unscalePoint([i.xpixels-n,n]);t&&(a=Jr.ceilTo(a,t),l=Jr.floorTo(l,t));const c=Zr.map(this.coords(),(function(e,t){const n=Qr.subtract(l,e);return[Qr.subtract(a,e),n]})),h=Zr.reduce(c,(function(e,t){const n=t[0],s=t[1];return[Math.max(n[0],Math.min(s[0],e[0])),Math.max(n[1],Math.min(s[1],e[1]))]}),r);return Qr.add(s,h)}},standard:null},oo={updatePoints:function(e,t){const n=Qr.subtract(e,t);Zr.each(this.state.points,(function(e){e.setCoord(Qr.add(e.coord(),n))}))},standard:null};Xr.exports={add:to,modify:no,draw:so,remove:io,onMoveStart:{standard:null},constraints:ro,onMove:oo,onMoveEnd:{standard:null},onClick:{standard:null}};var ao=Xr.exports,lo={exports:{}};lo.exports;const co=G.a.vector,ho=x.b,po=ao,uo=ki,go=ve,fo=uo.assert,mo=uo.normalizeOptions,bo=Mi,vo=Kr,xo=ho.keys(po),yo={points:null,angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],closed:!0,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,labelStyle:null},jo={added:!1,hasMoved:!1,visibleShape:null,mouseTarget:null},wo=function(e,t,n){fo(null!=e),fo(null!=n),ho.extend(this,{graphie:e,movable:t,state:{id:ho.uniqueId("movablePolygon")}}),this.modify(ho.extend({},jo,n))};ho.extend(wo,po),uo.createGettersFor(wo,ho.extend({},yo,jo)),uo.addMovableHelperMethodsTo(wo),ho.extend(wo.prototype,{cloneState:function(){return ho.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return ho.extend({id:this.state.id},mo(xo,go.pluck(po,"standard")),yo)},modify:function(e){this.update(ho.extend(this._createDefaultState(),e))},update:function(e){const t=this,n=t.graphie,s=ho.extend(t.state,mo(xo,e)),i=s.static?bo.DYNAMIC:bo.INTERACTIVE;s.normalStyle=ho.extend({},s.normalStyle,{"stroke-width":2,"fill-opacity":0,fill:i,stroke:i},e.normalStyle),s.highlightStyle=ho.extend({},{stroke:bo.INTERACTING,"stroke-width":2,fill:bo.INTERACTING,"fill-opacity":.05},s.highlightStyle),s.labelStyle=ho.extend({},{stroke:bo.DYNAMIC,"stroke-width":1,color:bo.DYNAMIC},s.labelStyle),s.static||s.mouseTarget||(s.mouseTarget=n.mouselayer.path(this.path()),s.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"})),t.movable.modify(ho.extend({},s,{modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(e,n){const s=co.subtract(e,n);t._totalDelta=co.add(t._totalDelta,s);let i=co.add(t._initialRefCoord,t._totalDelta);i=t._applyConstraints(i,t._prevRefCoord),!1!==i&&(t._fireEvent(t.state.onMove,i,t._prevRefCoord),t._prevRefCoord=i)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),ho.invoke(s.points,"listen","onMove",s.id,t.draw.bind(t)),s.added||(t.prevState={},t._fireEvent(s.add,t.cloneState(),t.prevState),s.added=!0,t.prevState=t.cloneState()),t._fireEvent(s.modify,t.cloneState(),t.prevState)},path:function(e){const t=this.graphie;e=e||this.state;let n=ho.map(e.points,(function(e){return t.scalePoint(e.coord())}));return e.closed?n.push(!0):n=n.concat(ho.clone(n).reverse()),vo.unscaledSvgPath(n)},coords:function(){return ho.invoke(this.state.points,"coord")},point:function(e){return this.state.points[e]},coord:function(e){return this.point(e).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.points&&ho.invoke(this.state.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){if(null==this.points||0===this.points.length)return;const e=this.coord(0),t=this._applyConstraints(e,e);!1!==t&&this._fireEvent(this.state.onMove,t,e)},normalStyle:function(){return ho.clone(this.state.normalStyle)},highlightStyle:function(){return ho.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}}),lo.exports=wo;var Oo=lo.exports,Co={exports:{}};Co.exports;const So=x.b,ko=Ji,_o=Bi,To=G.a.vector,Mo=G.a.point,No=Z,Po=function(e){const t=e.graphie.scalePoint(e.coord(0)),n=e.graphie.scalePoint(e.coord(1));return To.polarDegFromCart(To.subtract(n,t))[1]},Io=function(e,t,n){const s=e.range[0][1]-e.range[0][0]+(e.range[1][1]-e.range[1][0]),i=e.unscaleVector(To.cartFromPolarDeg([1,n])),r=To.scale(To.normalize(i),s),o=To.add(t,r),a=To.polarDegFromCart(i)[1];return e.constrainToBoundsOnAngle(o,4,a*Math.PI/180)},Eo=function(e,t){const n=[.75,0];let s=[[-3,4],[-2.75,2.5],[0,.25],n,[0,-.25],[-2.75,-2.5],[-3,-4]];s=So.map(s,(function(e){const t=To.subtract(e,n),s=To.scale(t,1.4);return To.add(n,s)}));const i=So.map(s,e.unscalePoint),r={center:e.unscalePoint(n),createPath:function(e){let t="M"+e[0][0]+" "+e[0][1];for(let n=1;n<e.length;n+=3)t+="C"+e[n][0]+" "+e[n][1]+" "+e[n+1][0]+" "+e[n+1][1]+" "+e[n+2][0]+" "+e[n+2][1];return t}},o=new _o(e,i,r);return o.attr(So.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},t)),o.toCoordAtAngle=function(t,s){const i=e.scalePoint(Io(e,t,s));o.transform("translateX("+(i[0]+1.4*n[0])+"px) translateY("+(i[1]+1.4*n[1])+"px) translateZ(0) rotate("+(360-No.bound(s))+"deg)")},o},Ao={draw:function(){this.draw()},pointsToFront:function(e){So.invoke(e.points,"toFront")}};Ao.standard=[Ao.draw,Ao.pointsToFront];const Ro={draw:function(){this.draw()}};Ro.standard=[Ro.draw];const Do={basic:function(e){const t=this.graphie;let n=this.coord(0),s=this.coord(1);if(!this.state.visibleShape){const e={thickness:10};this.state.visibleShape=new ko(t,n,s,e),this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}const i=Po(this);e.extendLine?(n=Io(t,n,360-i),s=Io(t,s,(540-i)%360)):e.extendRay&&(s=Io(t,s,360-i));const r=[this.state.visibleShape];this.mouseTarget()&&r.push(this.mouseTarget()),So.each(r,(function(e){e.moveTo(n,s)}))},arrows:function(e){null==this._arrows&&(this._arrows=[],e.extendLine?(this._arrows.push(Eo(this.graphie,this.normalStyle())),this._arrows.push(Eo(this.graphie,this.normalStyle()))):e.extendRay&&this._arrows.push(Eo(this.graphie,this.normalStyle())));const t=Po(this),n=[360-t,(540-t)%360];So.each(this._arrows,(function(e,t){e.toCoordAtAngle(this.coord(t),n[t])}),this)},highlight:function(e,t){e.isHovering&&!t.isHovering?e.visibleShape.animate(e.highlightStyle,50):!e.isHovering&&t.isHovering&&e.visibleShape.animate(e.normalStyle,50)}};Do.standard=[Do.basic,Do.arrows,Do.highlight];const Fo={basic:function(){this.state.visibleShape&&this.state.visibleShape.remove()},arrows:function(){null!=this._arrows&&So.invoke(this._arrows,"remove"),this._arrows=null}};Fo.standard=[Fo.basic,Fo.arrows];const Lo={fixed:function(){return function(){return!1}},snap:function(e){return function(t,n){if(null===e)return!0;let s=To.subtract(t,n);return e=e||this.graphie.snap,s=Mo.roundTo(s,e),To.add(n,s)}},bound:function(e,t,n){return void 0===n&&(n=void 0===e?10:0),function(e,s){const i=this.graphie,r=To.subtract(e,s),o=o||i.range;void 0===t&&(t=i.snap);let a=i.unscalePoint([n,i.ypixels-n]),l=i.unscalePoint([i.xpixels-n,n]);t&&(a=Mo.ceilTo(a,t),l=Mo.floorTo(l,t));const c=So.map(this.coords(),(function(e,t){const n=To.subtract(l,e);return[To.subtract(a,e),n]})),h=So.reduce(c,(function(e,t){const n=t[0],s=t[1];return[Math.max(n[0],Math.min(s[0],e[0])),Math.max(n[1],Math.min(s[1],e[1]))]}),r);return To.add(s,h)}},standard:null},zo={updatePoints:function(e,t){const n=To.subtract(e,t);So.each(this.state.points,(function(e){e.setCoord(To.add(e.coord(),n))}))},standard:null};Co.exports={add:Ao,modify:Ro,draw:Do,remove:Fo,onMoveStart:{standard:null},constraints:Lo,onMove:zo,onMoveEnd:{standard:null}};var qo=Co.exports,Wo={exports:{}};Wo.exports;const Bo=x.b,Vo=qo,Ho=Ji,Uo=ki,Go=ve,$o=Uo.assert,Yo=Uo.normalizeOptions,Ko=G.a.vector,Xo=Mi,Zo=["add","draw","remove","onMoveStart","constraints","onMove","onMoveEnd"],Jo={points:null,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,extendLine:!1,extendRay:!1},Qo={visibleShape:null,mouseTarget:null},ea=function(e,t,n){$o(null!=e),$o(null!=n),Bo.extend(this,{graphie:e,movable:t,state:{id:Bo.uniqueId("movableLine")}}),this.modify(Bo.extend({},Qo,n))};Bo.extend(ea,Vo),Uo.createGettersFor(ea,Bo.extend({},Jo,Qo)),Uo.addMovableHelperMethodsTo(ea),Bo.extend(ea.prototype,{cloneState:function(){return Bo.extend(this.movable.cloneState(),{coords:this.coords()},this.state)},_createDefaultState:function(){return Bo.extend({id:this.state.id},Yo(Zo,Go.pluck(Vo,"standard")),Jo)},modify:function(e){this.update(Bo.extend(this._createDefaultState(),e))},update:function(e){const t=this,n=this.graphie,s=t.state=Bo.extend(t.state,Yo(Zo,e)),i=s.static?Xo.DYNAMIC:Xo.INTERACTIVE;if(s.normalStyle=Bo.extend({stroke:i,"stroke-width":2},s.normalStyle),s.highlightStyle=Bo.extend({stroke:Xo.INTERACTING,"stroke-width":3},s.highlightStyle),!s.static&&!s.mouseTarget){const e={thickness:30,mouselayer:!0};s.mouseTarget=new Ho(n,this.coord(0),this.coord(1),e),s.mouseTarget.attr({fill:"#000",opacity:0})}s.static&&s.mouseTarget&&(s.mouseTarget.remove(),s.mouseTarget=null),t.movable.modify(Bo.extend({},s,{mouseTarget:s.mouseTarget,add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:function(){t._initialRefCoord=t.coord(0),t._prevRefCoord=t._initialRefCoord,t._totalDelta=[0,0],t._fireEvent(t.state.onMoveStart,t.coord(0),t.coord(0))},onMove:function(e,n){const s=Ko.subtract(e,n);t._totalDelta=Ko.add(t._totalDelta,s);let i=Ko.add(t._initialRefCoord,t._totalDelta);i=t._applyConstraints(i,t._prevRefCoord),!1!==i&&(t._fireEvent(t.state.onMove,i,t._prevRefCoord),t._prevRefCoord=i)},onMoveEnd:function(){t._fireEvent(t.state.onMoveEnd,t._prevRefCoord,t._initialRefCoord)}})),s.added||(t.prevState={},t._fireEvent(s.add,t.cloneState(),t.prevState),s.added=!0,Bo.invoke(s.points,"listen","onMove",s.id,t.draw.bind(t)),t.prevState=t.cloneState()),t._fireEvent(s.modify,t.cloneState(),t.prevState)},coords:function(){return Bo.invoke(this.state.points,"coord")},point:function(e){return this.state.points[e]},coord:function(e){return this.point(e).coord()},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.points&&Bo.invoke(this.points,"unlisten","onMove",this.state.id),this.movable&&this.movable.remove()},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()}}),Wo.exports=ea;var ta=Wo.exports;const na={path:"M8.70710678,12.2928932 C8.31658249,11.9023689 7.68341751,11.9023689 7.29289322,12.2928932 C6.90236893,12.6834175 6.90236893,13.3165825 7.29289322,13.7071068 L9.82842712,16.2426407 C10.2207367,16.6349502 10.8574274,16.6328935 11.2471942,16.2380576 L16.7116603,10.7025237 C17.0996535,10.3094846 17.0955629,9.67633279 16.7025237,9.28833966 C16.3094846,8.90034653 15.6763328,8.90443714 15.2883397,9.29747629 L10.5309507,14.1167372 L8.70710678,12.2928932 Z",width:24,height:24},sa={path:"M99.669 13.048q0 3.36-2.352 5.712l-41.664 41.664q-2.408 2.408-5.88 2.408t-5.712-2.408l-41.664-41.664q-2.408-2.24-2.408-5.712t2.408-5.88l4.76-4.816q2.52-2.352 5.88-2.352t5.656 2.352l31.136 31.136 31.08-31.136q2.352-2.352 5.712-2.352t5.88 2.352l4.816 4.816q2.352 2.52 2.352 5.88z",width:100,height:63.034},ia={path:"M62.808 49.728q0 3.36-2.352 5.88l-41.72 41.664q-2.352 2.408-5.768 2.408t-5.768-2.408l-4.872-4.76q-2.352-2.52-2.352-5.88t2.352-5.712l31.08-31.136-31.08-31.024q-2.352-2.52-2.352-5.88t2.352-5.712l4.872-4.76q2.296-2.408 5.768-2.408t5.768 2.408l41.72 41.664q2.352 2.296 2.352 5.656z",width:63.034,height:100},ra={path:"M100.035 50.046q.057 13.623-6.669 25.137t-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.669 25.137z",width:100,height:100},oa={path:"M50.046 83.676q1.767 0 2.907-1.14l29.526-29.526q1.197-1.197 1.197-2.907t-1.197-2.964l-5.928-5.928q-1.197-1.14-2.964-1.14t-2.907 1.14l-12.312 12.312l0-32.661q0-1.71-1.254-2.964t-2.907-1.254l-8.322 0q-1.71 0-2.964 1.254t-1.254 2.964l0 32.661l-12.312-12.312q-1.197-1.254-2.907-1.254t-2.907 1.254l-5.928 5.928q-1.197 1.197-1.197 2.964t1.197 2.907l29.469 29.526q1.197 1.14 2.964 1.14zm49.989-33.63q.057 13.623-6.669 25.137t-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.669 25.137z",width:100,height:100},aa={path:"M54.207 83.391q1.653 0 2.907-1.254t1.254-2.907l0-32.718l12.312 12.312q1.254 1.254 2.964 1.254t2.907-1.254l5.928-5.928q1.197-1.197 1.14-2.964 0-1.767-1.14-2.907l-29.526-29.526q-1.197-1.14-2.907-1.14t-2.964 1.14l-29.469 29.526q-1.197 1.254-1.197 2.964t1.197 2.907l5.928 5.928q1.197 1.197 2.907 1.197t2.907-1.197l12.312-12.312l0 32.718q0 1.653 1.254 2.907t2.964 1.254l8.322 0zm45.828-33.345q.057 13.623-6.669 25.137t-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.669 25.137z",width:100,height:100},la={path:"M50.046 8.322q-8.493 0-16.188 3.306-15.561 6.669-22.173 22.23-3.363 7.695-3.363 16.188t3.306 16.188 8.949 13.281q5.586 5.586 13.281 8.892t16.188 3.306 16.188-3.306 13.281-8.892 8.892-13.281 3.306-16.188-3.306-16.188-8.892-13.281-13.281-8.949q-7.695-3.306-16.188-3.306zm0 91.713q-13.623 0-25.137-6.726t-18.183-18.183q-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.726 25.137-6.726 25.137-18.24 18.126q-11.514 6.726-25.08 6.726z",width:100,height:99.944},ca={path:"M94.208 52.119l0-43.746q0-.69-.506-1.15t-1.196-.506l-84.088 0q-.69 0-1.196.506t-.506 1.15l0 43.746q0 .69.506 1.196t1.196.506l84.088 0q.69 0 1.196-.506t.506-1.196zm6.716-43.746l0 57.224q0 3.45-2.484 5.934t-5.934 2.484l-28.566 0q0 3.128 2.53 7.774.828 1.61.828 2.622t-1.012 2.07q-1.012 1.012-2.346.966l-26.91 0q-1.38 0-2.392-1.012t-1.012-2.024q0-1.058 1.656-4.14t1.748-6.256l-28.612 0q-3.45 0-5.934-2.484t-2.484-5.934l0-57.224q0-3.45 2.484-5.934t5.934-2.438l84.088 0q3.45 0 5.98 2.438 2.438 2.484 2.438 5.934z",width:100,height:86.648},ha={path:"M9 9.8c0 .5.7 1.7 1.5 2.8 1.5 1.9 1.5 1.9 3 0C15.7 9.7 15.4 9 12 9c-1.6 0-3 .4-3 .8z",width:24,height:24},pa={path:"M58.368 81.225l0-12.369q0-.912-.57-1.539t-1.425-.627l-12.54 0q-.855-.057-1.482.627t-.684 1.539l0 12.369q-.057.855.627 1.482t1.539.684l12.54 0q.855 0 1.425-.627t.57-1.539zm1.026-62.871q0-1.596-2.223-1.71l-14.307 0q-2.109 0-2.223 1.71l1.14 40.47q0 .627.627 1.14t1.539.456l12.084 0q.912-.057 1.539-.513t.684-1.083zm-9.348-18.354q13.566 0 25.08 6.726 11.514 6.669 18.24 18.183t6.726 25.137-6.726 25.137-18.24 18.183-25.08 6.669-25.137-6.726q-11.514-6.726-18.183-18.183-6.726-11.571-6.726-25.137t6.726-25.08 18.24-18.24 25.08-6.669z",width:100,height:99.944},ua={path:"M1152 896q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zm512-109v222q0 12-8 23t-20 13l-185 28q-19 54-39 91 35 50 107 138 10 12 10 25t-9 23q-27 37-99 108t-94 71q-12 0-26-9l-138-108q-44 23-91 38-16 136-29 186-7 28-36 28h-222q-14 0-24.5-8.5t-11.5-21.5l-28-184q-49-16-90-37l-141 107q-10 9-25 9-14 0-25-11-126-114-165-168-7-10-7-23 0-12 8-23 15-21 51-66.5t54-70.5q-27-50-41-99l-183-27q-13-2-21-12.5t-8-23.5v-222q0-12 8-23t19-13l186-28q14-46 39-92-40-57-107-138-10-12-10-24 0-10 9-23 26-36 98.5-107.5t94.5-71.5q13 0 26 10l138 107q44-23 91-38 16-136 29-186 7-28 36-28h222q14 0 24.5 8.5t11.5 21.5l28 184q49 16 90 37l142-107q9-9 24-9 13 0 25 10 129 119 165 170 7 8 7 22 0 12-8 23-15 21-51 66.5t-54 70.5q26 50 41 98l183 28q13 2 21 12.5t8 23.5z",width:1792,height:1792},da={path:"M36.04 89.557q0-2.584-1.836-4.42t-4.42-1.836-4.352 1.836q-1.836 1.836-1.836 4.42t1.836 4.352 4.42 1.836q2.652-.068 4.42-1.836t1.768-4.352zm16.184-12.444l0-54.74q0-1.088-.748-1.768t-1.768-.68l-39.78 0q-1.088 0-1.768.748t-.68 1.7l0 54.74q0 1.02.748 1.768t1.7.68l39.78 0q1.02-.068 1.768-.748t.748-1.7zm-14.892-65.892q0-1.224-1.292-1.292l-12.444 0q-1.224.068-1.224 1.292t1.224 1.224l12.444 0q1.292 0 1.292-1.224zm22.372-1.292l0 79.628q0 3.944-2.992 6.936t-7.004 2.992l-39.78 0q-4.012 0-7.004-2.924-2.924-2.924-2.924-7.004l0-79.628q0-4.012 2.924-6.936t7.004-2.992l39.78 0q4.012-.068 7.004 2.924t2.992 7.004z",width:60.013,height:100},ga={path:"M37.964 76.048q-2.576 0-4.368-1.792l-31.864-31.864q-1.792-1.792-1.792-4.368t1.792-4.368l8.736-8.68q1.792-1.792 4.368-1.792t4.312 1.792l18.816 18.872 42-42.056q1.792-1.792 4.368-1.792t4.312 1.792l8.736 8.736q1.792 1.792 1.792 4.368t-1.792 4.312l-55.048 55.048q-1.792 1.792-4.368 1.792z",width:100,height:76.637},fa={path:"M99.758 43.09l0 13.578q0 2.852-1.984 4.836t-4.836 1.984l-29.45 0l0 29.45q0 2.852-1.984 4.836t-4.836 1.984l-13.578 0q-2.852 0-4.836-1.984t-1.984-4.836l0-29.45l-29.45 0q-2.852 0-4.836-1.984t-1.984-4.836l0-13.578q0-2.852 1.984-4.836t4.836-1.984l29.45 0l0-29.45q0-2.852 1.984-4.836t4.836-1.984l13.578 0q2.852 0 4.836 1.984t1.984 4.836l0 29.45l29.45 0q2.852 0 4.836 1.984t1.984 4.836z",width:100,height:100},ma={path:"M100.464 80.808q0 3.404-2.368 5.772l-11.47 11.544q-2.368 2.368-5.772 2.368t-5.698-2.368l-24.864-24.864-24.864 24.864q-2.368 2.368-5.772 2.368t-5.772-2.368l-11.47-11.544q-2.368-2.368-2.368-5.772t2.368-5.698l24.864-24.864-24.864-24.864q-2.368-2.368-2.368-5.772t2.368-5.772l11.47-11.47q2.368-2.368 5.772-2.368t5.772 2.368l24.864 24.864 24.864-24.864q2.294-2.368 5.698-2.368t5.772 2.368l11.47 11.47q2.368 2.368 2.368 5.772t-2.368 5.772l-24.864 24.864 24.864 24.864q2.368 2.294 2.368 5.698z",width:100,height:100},ba={path:"M15.1052249,9.55978547 L22.0028147,9.55978545 C23.6568673,9.55978545 23.9349557,10.3753626 22.6181351,11.3858845 L16.9943688,15.7015366 L19.2518801,22.8294455 C19.7526645,24.4106317 19.0984455,24.8825885 17.769353,23.8673293 L12.0490577,19.4977438 L6.5116497,23.8422153 C5.20921411,24.8640642 4.53299569,24.4067544 5.00266927,22.8160582 L7.10332364,15.7015366 L1.42794544,11.3634306 C0.110226041,10.3562014 0.383967283,9.54239221 2.0409646,9.54574013 L8.9924676,9.55978547 L11.1485117,2.72669438 C11.6458693,1.15043244 12.4548928,1.15900049 12.9494787,2.72669438 L15.1052249,9.55978547 Z",width:24,height:24},va={path:"M3.74890556,17.9799506 C2.19251241,16.1970909 1.10103636,13.4971457 1.13090903,11.1491783 C1.17160478,7.95052637 4.01704076,0.865059407 11.7028044,0.865059407 C19.388568,0.865059407 22.3026521,7.35203035 22.3026521,11.5879453 C22.3026521,15.8238603 19.386629,20.5574509 13.6832464,21.7131548 L13.6757539,17.3722171 C17.0812986,16.2190517 18.331158,14.1944123 18.3311578,11.5879451 C18.3311574,8.16554692 15.6664205,5.03476549 11.7028048,5.20494205 C7.73918903,5.37511861 5.59244567,8.66930079 5.59244567,11.1491783 C5.59244567,12.9090077 6.11128139,14.1753512 6.93640437,15.3053215 L8.14052356,14.2949456 C8.98559348,13.5858477 9.6994861,13.9070448 9.73489556,15.0076413 L9.91284941,20.5388014 C9.94832683,21.6415103 9.09967118,22.3514475 8.02194403,22.1254594 L2.60571602,20.9897332 C1.5259204,20.7633114 1.34338662,19.9984207 2.18070755,19.295825 L3.74890556,17.9799506 Z",width:23,height:23},xa={path:"M45.322 90.706q0-1.86-1.302-3.224-1.364-1.364-3.224-1.364t-3.224 1.364-1.302 3.224q0 1.86 1.364 3.224 1.302 1.364 3.162 1.302 1.86.062 3.224-1.302t1.302-3.224zm27.218-11.346l0-68.014q0-.93-.682-1.612t-1.55-.682l-58.962 0q-.93 0-1.612.682t-.682 1.612l0 68.014q0 .93.682 1.612t1.612.62l58.962 0q.992-.062 1.612-.682t.62-1.55zm9.114-68.014l0 77.066q0 4.65-3.348 7.998t-7.998 3.348l-58.962 0q-4.65 0-7.998-3.348t-3.348-7.998l0-77.066q0-4.65 3.348-7.998t7.998-3.348l58.962 0q4.65 0 7.998 3.348t3.348 7.998z",width:81.852,height:100},ya={path:"M31.293 37.506q2.052 0 2.052 2.109l0 37.506q0 1.995-2.052 2.109l-4.218 0q-.912-.057-1.482-.627t-.57-1.482l0-37.506q0-2.109 2.052-2.109l4.218 0zm18.753 2.109l0 37.506q0 .912-.57 1.482t-1.539.627l-4.161 0q-1.995 0-2.109-2.109l0-37.506q.057-.912.627-1.482t1.482-.627l4.161 0q.969.057 1.539.627t.57 1.482zm14.592-2.109q2.052 0 2.052 2.109l0 37.506q0 1.995-2.052 2.109l-4.161 0q-.969-.057-1.539-.627t-.57-1.482l0-37.506q0-2.109 2.109-2.109l4.161 0zm10.431 49.248l0-61.731l-58.368 0l0 61.731q.057 2.679.969 3.819t1.083 1.14l54.207 0q.171 0 1.14-1.083t.969-3.876zm-43.776-70.11l29.184 0l-3.135-7.581q-.456-.57-1.14-.741l-20.634 0q-.627.114-1.083.741zm-31.293 2.109q0-1.995 2.109-2.109l20.121 0l4.56-10.83q.969-2.394 3.477-4.104 2.565-1.71 5.187-1.71l20.805 0q2.622 0 5.187 1.71t3.477 4.104l4.56 10.83l20.178 0q.912.057 1.482.627t.57 1.482l0 4.161q0 1.995-2.052 2.109l-6.27 0l0 61.731q0 5.415-3.078 9.348t-7.353 3.933l-54.207 0q-4.275 0-7.353-3.819t-3.078-9.177l0-62.016l-6.213 0q-.969 0-1.539-.57t-.57-1.539l0-4.161z",width:91.681,height:100},ja={path:"M10,6.6C10,7.2,9.8,8,9.3,9.1c0,0,0,0.1-0.1,0.1S9.2,9.3,9.2,9.4c0,0,0,0.1-0.1,0.1C9,9.6,9,9.6,8.9,9.6 c-0.1,0-0.1,0-0.1-0.1c0,0,0-0.1,0-0.1c0,0,0-0.1,0-0.1s0-0.1,0-0.1c0-0.3,0-0.5,0-0.7c0-0.4,0-0.7-0.1-1C8.6,7.1,8.5,6.9,8.4,6.7S8.2,6.3,8,6.1C7.8,5.9,7.6,5.8,7.4,5.7S6.9,5.5,6.7,5.5S6.1,5.4,5.8,5.4c-0.3,0-0.6,0-1,0H3.6v1.4c0,0.1,0,0.2-0.1,0.3C3.4,7.1,3.3,7.1,3.2,7.1C3.1,7.1,3,7.1,3,7L0.1,4.1C0,4.1,0,4,0,3.9s0-0.2,0.1-0.3L3,0.8C3,0.7,3.1,0.7,3.2,0.7c0.1,0,0.2,0,0.3,0.1C3.5,0.9,3.6,0.9,3.6,1v1.4h1.2c2.6,0,4.3,0.7,4.9,2.2C9.9,5.2,10,5.8,10,6.6z",width:10,height:10},wa={path:"M8,13 L16,13 C16.5522847,13 17,12.5522847 17,12 C17,11.4477153 16.5522847,11 16,11 L8,11 C7.44771525,11 7,11.4477153 7,12 C7,12.5522847 7.44771525,13 8,13 Z",width:24,height:24};var Oa={exports:{}};Oa.exports;const Ca=x.b,Sa=or,ka=G.a.point,_a={constrain:function(){this.constrain()}};_a.standard=[_a.constrain];const Ta={draw:function(){this.draw()}};Ta.standard=[Ta.draw];const Ma={basic:function(e,t){const n=this.graphie;if(!this.state.visibleShape){const t=[this.pointSize()/n.scale[0],this.pointSize()/n.scale[1]],s={maxScale:Math.max(this.highlightStyle().scale,this.normalStyle().scale),padding:10,shadow:e.shadow};this.state.visibleShape=new Sa(n,this.coord(),t,s),this.state.visibleShape.attr(Ca.omit(this.normalStyle(),"scale")),this.state.visibleShape.toFront(),this.mouseTarget()&&this.mouseTarget().toFront()}e.normalStyle===t.normalStyle||Ca.isEqual(e.normalStyle,t.normalStyle)||this.state.visibleShape.attr(this.normalStyle()),this.state.visibleShape.moveTo(this.coord()),this.mouseTarget()&&this.mouseTarget().moveTo(this.coord())},highlight:function(e,t){e.isHovering&&!t.isHovering?e.visibleShape.animate(this.highlightStyle(),50):!e.isHovering&&t.isHovering&&e.visibleShape.animate(this.normalStyle(),50)}};Ma.standard=[Ma.basic,Ma.highlight];const Na={basic:function(){this.state.visibleShape&&(this.state.visibleShape.remove(),this.state.visibleShape=null)}};Na.standard=Na.basic;const Pa={fixed:function(){return function(){return!1}},snap:function(e){return function(t){return null===e||(e=e||this.graphie.snap,ka.roundTo(t,e))}},bound:function(e,t,n){return void 0===n&&(n=void 0===e?10:0),function(s,i,r){const o=this.graphie;e=e||o.range,void 0===t&&(t=o.snap);let a=o.unscalePoint([n,o.ypixels-n]),l=o.unscalePoint([o.xpixels-n,n]);if(t&&(a=ka.ceilTo(a,t),l=ka.floorTo(l,t)),r&&r.onOutOfBounds)return(s[0]>l[0]||s[0]<a[0]||s[1]>l[1]||s[1]<a[1])&&(r.onSkipRemaining(),r.onOutOfBounds()),s;return[Math.max(a[0],Math.min(l[0],s[0])),Math.max(a[1],Math.min(l[1],s[1]))]}},standard:null};Oa.exports={add:_a,modify:Ta,draw:Ma,remove:Na,onMoveStart:{standard:null},constraints:Pa,onMove:{standard:null},onMoveEnd:{standard:null},onClick:{standard:null}};var Ia=Oa.exports,Ea={exports:{}};Ea.exports;const Aa=x.b,Ra=Ia,Da=or,Fa=ki,La=ve,za=Fa.assert,qa=Fa.normalizeOptions,Wa=G.a.point,Ba=G.a.vector,Va=Mi,Ha=pr.processMath,Ua=(h.a,i.a),Ga=Kt,$a=Aa.keys(Ra),Ya={coord:[0,0],pointSize:4,static:!1,cursor:"move",normalStyle:null,highlightStyle:null,shadow:!1,tooltip:!1},Ka={added:!1,hasMoved:!1,visibleShape:null,outOfBounds:!1,mouseTarget:null,touchOffset:null},Xa=[],Za=function(e,t,n){Aa.extend(this,{graphie:e,movable:t,state:{id:Aa.uniqueId("movablePoint")}}),this.modify(Aa.extend({},Ka,n))};Aa.extend(Za,Ra),Fa.createGettersFor(Za,Aa.extend({},Ya,Ka)),Fa.addMovableHelperMethodsTo(Za),Aa.extend(Za.prototype,{cloneState:function(){return Aa.extend(this.movable.cloneState(),this.state)},_createDefaultState:function(){return Aa.extend({id:this.state.id},qa($a,La.pluck(Ra,"standard")),Ya)},modify:function(e){this.update(Aa.extend(this._createDefaultState(),e))},_showTooltip:function(e){this._tooltip||(this._tooltip=document.createElement("div"),this._tooltip.className="tooltip-content",this.state.visibleShape.wrapper.className="tooltip",this.state.visibleShape.wrapper.appendChild(this._tooltip),Xa.push((()=>{this.state.added&&this._hideTooltip()}))),this._tooltip.firstChild&&this._tooltip.removeChild(this._tooltip.firstChild),this.state.visibleShape.wrapper.className="tooltip visible",this._tooltip.appendChild(document.createElement("span")),"string"===typeof e?Ha(this._tooltip.firstChild,e,!1):"function"===typeof e?e(this._tooltip.firstChild):this._tooltip.firstChild.appendChild(e)},_hideTooltip:function(){this._tooltip&&(this.state.visibleShape.wrapper.className="tooltip")},update:function(e){const t=this,n=t.graphie,s=Aa.extend(t.state,qa($a,e));za(Wa.is(s.coord));const i=s.static?Va.DYNAMIC:Va.INTERACTIVE;if(s.normalStyle=Aa.extend({fill:i,stroke:i,scale:1},s.normalStyle),s.highlightStyle=Aa.extend({fill:Va.INTERACTING,stroke:Va.INTERACTING,scale:2},s.highlightStyle),!s.static&&!s.mouseTarget){const e=t.state.coord,i=n.unscaleVector(24),r={mouselayer:!0,padding:0};s.mouseTarget=new Da(n,e,i,r),s.mouseTarget.attr({fill:"#000",opacity:0})}const r=()=>{this._showTooltip((e=>{Ua.render(Object($t.jsx)("span",{style:{fontSize:"2em"},children:Object($t.jsx)(Ga,{...ya,style:{position:"static",color:Va.INTERACTIVE,marginLeft:9,marginRight:9}})}),e)}))};let o=s.coord;t.movable.modify(Aa.extend({},s,{add:null,modify:null,draw:t.draw.bind(t),remove:null,onMoveStart:e=>{if(s.hasMoved=!1,o=s.coord,null==s.touchOffset){const t=!("ontouchstart"in window);s.touchOffset=t?[0,0]:Ba.subtract(o,e)}const n=s.visibleShape.wrapper;if(s.shadow){const e="none";n.style.webkitFilter=e,n.style.filter=e}if(s.showHairlines&&s.showHairlines(s.coord),Xa.forEach((e=>e())),s.tooltip&&(s.xOnlyTooltip?this._showTooltip(`${s.coord[0]}`):this._showTooltip(`(${s.coord[0]}, ${s.coord[1]})`),s.shadow)){const e=n.getElementsByClassName("tooltip-content")[0],t="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";e.style.webkitFilter=t,e.style.filter=t}t._fireEvent(s.onMoveStart,o,o),t.draw()},onMove:(e,n)=>{const i=Ba.add(e,s.touchOffset);t.moveTo(i),s.showHairlines&&(this.state.outOfBounds?s.hideHairlines():s.showHairlines(s.coord)),s.tooltip&&(this.state.outOfBounds||(s.xOnlyTooltip?this._showTooltip(`${s.coord[0]}`):this._showTooltip(`(${s.coord[0]}, ${s.coord[1]})`))),s.onRemove&&this.state.outOfBounds&&r()},onMoveEnd:()=>{t.isHovering()&&!s.hasMoved&&t._fireEvent(s.onClick,s.coord,o);const e=s.visibleShape.wrapper;if(s.shadow){const t="drop-shadow(0px 0px 5px rgba(0, 0, 0, 0.5))";e.style.webkitFilter=t,e.style.filter=t}if(s.hideHairlines&&s.hideHairlines(),s.hasMoved)this._hideTooltip();else if(s.onRemove){r();const t=e.getElementsByClassName("tooltip-content")[0];t.style.webkitFilter="none",t.style.filter="none",this._tooltip.firstChild.addEventListener("touchstart",(e=>{e.stopPropagation()}),!0),this._tooltip.firstChild.addEventListener("touchend",(e=>{s.onRemove(),e.stopPropagation()}),!0)}else s.tooltip&&this._hideTooltip();s.outOfBounds&&s.onRemove(),t._fireEvent(s.onMoveEnd,s.coord,o),s.hasMoved=!1,s.touchOffset=null,t.draw()}})),s.added||(t.prevState={},t._fireEvent(s.add,t.cloneState(),t.prevState),s.added=!0,t.prevState=t.cloneState()),t._fireEvent(s.modify,t.cloneState(),t.prevState)},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.movable&&this.movable.remove(),this.state.mouseTarget=null},constrain:function(){const e=this._applyConstraints(this.coord(),this.coord());return Wa.is(e)&&this.setCoord(e),!1!==e},setCoord:function(e){za(Wa.is(e,2)),this.state.coord=Aa.clone(e),this.draw()},setCoordConstrained:function(e){za(Wa.is(e,2));const t=this._applyConstraints(e,this.coord());!1!==t&&(this.state.coord=Aa.clone(t),this.draw())},moveTo:function(e){const t=this.state;this.state.outOfBounds=!1;const n=this._applyConstraints(e,t.coord,t.onRemove?{onOutOfBounds:()=>{this.state.outOfBounds=!0}}:{});if(!1!==n&&(Wa.is(n)&&(e=n),!Wa.equal(e,t.coord))){const n=t.coord;t.coord=e,t.hasMoved=!0,this._fireEvent(t.onMove,t.coord,n),this.draw()}},normalStyle:function(){return Aa.clone(this.state.normalStyle)},highlightStyle:function(){return Aa.clone(this.state.highlightStyle)},toBack:function(){this.movable.toBack(),this.state.visibleShape&&this.state.visibleShape.toBack()},toFront:function(){this.state.visibleShape&&this.state.visibleShape.toFront(),this.movable.toFront()},isHovering:function(){return this.movable.isHovering()},isDragging:function(){return this.movable.isDragging()},mouseTarget:function(){return this.movable.mouseTarget()},grab:function(e){this.state.touchOffset=[0,0],this.movable.grab(e),this.moveTo(e)}}),Ea.exports=Za;var Ja=Ea.exports,Qa={exports:{}};Qa.exports;const el=x.b,tl=ki,nl=tl.normalizeOptions,sl=tl.assert,il=G.a.point,rl=["add","modify","draw","remove","onMoveStart","onMove","onMoveEnd","onClick"],ol={cursor:null},al={added:!1,isHovering:!1,isMouseOver:!1,isDragging:!1,mouseTarget:null},ll=function(e,t){el.extend(this,{graphie:e,state:{id:el.uniqueId("movable")}}),this.modify(el.extend({},al,t))};tl.createGettersFor(ll,el.extend({},ol,al)),tl.addMovableHelperMethodsTo(ll),el.extend(ll.prototype,{cloneState:function(){return el.clone(this.state)},_createDefaultState:function(){return el.extend({id:this.state.id,add:[],modify:[],draw:[],remove:[],onMoveStart:[],onMove:[],onMoveEnd:[],onClick:[]},ol)},modify:function(e){this.update(el.extend({},this._createDefaultState(),e))},grab:function(e){sl(il.is(e));const t=this,n=t.graphie,s=t.state;s.isHovering=!0,s.isDragging=!0,n.isDragging=!0;const i=e;let r=i;t._fireEvent(s.onMoveStart,i,i);const o=function(e){e.preventDefault();const i=n.getMouseCoord(e);t._fireEvent(s.onMove,i,r),t.draw(),r=i},a=function(e){l()(document).unbind("vmousemove",o),l()(document).unbind("vmouseup",a),s.isHovering&&t._fireEvent(s.onClick,r,i),s.isHovering=t.state.isMouseOver,s.isDragging=!1,n.isDragging=!1,t._fireEvent(s.onMoveEnd,r,i),t.draw()};l()(document).bind("vmousemove",o),l()(document).bind("vmouseup",a)},update:function(e){const t=this,n=t.graphie,s=t.cloneState(),i=el.extend(t.state,nl(rl,e));if(i.mouseTarget&&!s.mouseTarget){let e;e=i.mouseTarget.getMouseTarget?l()(i.mouseTarget.getMouseTarget()):l()(i.mouseTarget[0]);!("ontouchstart"in window)&&(e.on("vmouseover",(function(){i.isMouseOver=!0,n.isDragging||(i.isHovering=!0),t.state.added&&t.draw()})),e.on("vmouseout",(function(){i.isMouseOver=!1,i.isDragging||(i.isHovering=!1),t.state.added&&t.draw()}))),e[0].addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1}),e.on("vmousedown",(function(e){if(0!==e.which&&1!==e.which)return;e.preventDefault();const s=n.getMouseCoord(e);t.grab(s)}))}if(i.mouseTarget&&void 0!==i.cursor){let e;e=i.mouseTarget.getMouseTarget?l()(i.mouseTarget.getMouseTarget()):l()(i.mouseTarget[0]),e.css("cursor",i.cursor||"")}i.added||(t._fireEvent(i.modify,t.cloneState(),{}),i.added=!0,t.prevState=t.cloneState()),t._fireEvent(i.modify,t.cloneState(),t.prevState)},remove:function(){this.state.added=!1,this._fireEvent(this.state.remove),this.state.mouseTarget&&(l()(this.state.mouseTarget).off(),this.state.mouseTarget.remove(),this.state.mouseTarget=null)},toBack:function(){this.state.mouseTarget&&this.state.mouseTarget.toBack()},toFront:function(){this.state.mouseTarget&&this.state.mouseTarget.toFront()}}),Qa.exports=ll;var cl=Qa.exports,hl={exports:{}};hl.exports;const pl=cl,ul=Ja,dl=ta,gl=Oo,fl=Mi,ml={MovablePoint:ul,addMovablePoint:function(e,t){const n=new pl(e,{});return new ul(e,n,t)},MovableLine:dl,addMovableLine:function(e,t){const n=new pl(e,{});return new dl(e,n,t)},MovablePolygon:gl,addMovablePolygon:function(e,t){const n=new pl(e,{});return new gl(e,n,t)},addMaybeMobileMovablePoint:function(e,t){const n=e.props.apiOptions.isMobile,s=n?{stroke:"#ffffff","stroke-width":3,fill:fl.INTERACTIVE}:{stroke:fl.INTERACTIVE,fill:fl.INTERACTIVE},i=Object.assign(s,t.normalStyle),r=Object.assign(n?{...s,"stroke-width":0,scale:.75}:{},t.highlightStyle),o=Object.assign({normalStyle:i,highlightStyle:r,shadow:n,tooltip:n&&e.props.showTooltips,showHairlines:e.showHairlines,hideHairlines:e.hideHairlines},n?{pointSize:7}:{});return ml.addMovablePoint(e.graphie,Object.assign(t,o))}};hl.exports=ml;var bl=hl.exports,vl={exports:{}};vl.exports;const xl=ce,yl=xl.nestedMap,jl=xl.deepEq,wl=x.b;function Ol(e){wl.extend(this,e)}const Cl=function(){throw new Error("Abstract method! Must be implemented by Graphie Movable"+this.constructor.displayName)};wl.extend(Ol.prototype,{movableProps:[],add:Cl,modify:Cl,remove:Cl,toFront:function(){}});const Sl=function(e){const t=function(e){if(!(this instanceof t))throw new Error("Use createElement or JSX with graphie movables");return this.props=function(e,t){return wl.extend({},e,{children:wl.filter(wl.flatten(t),wl.identity)})}(e,e.children||[]),this};return e.displayName=e.displayName||wl.uniqueId("GraphieClass"),t.displayName=e.displayName,t.prototype=new Ol(e),t.prototype.constructor=t,t};vl.exports={GraphieMovable:Ol,createClass:Sl,createSimpleClass:function(e){return Sl({displayName:e.name||wl.uniqueId("GraphieSimpleClass"),movableProps:["children"],add:function(t){this._elements=e(t,this.props),this._prevProps=this.props},modify:function(e){if(!jl(this.props,this._prevProps))return this.remove(),this.add(e),this._prevProps=this.props,"reordered"},remove:function(){yl(this._elements,(e=>{e&&e.remove()})),this._elements=null,this._prevProps=null},toFront:function(){yl(this._elements,(e=>{wl.isFunction(e.toFront)&&e.toFront()}))}})}};var kl=vl.exports,_l={exports:{}};_l.exports;const Tl=x.b,Ml=kl,Nl=bl,Pl=Mi,Il=Ml.createClass({displayName:"MovablePoint",movableProps:["children"],_getProps:function(){if(this.props.isMobile){const e=this.props.isMobile,t=e?{stroke:"#ffffff","stroke-width":3,fill:Pl.INTERACTIVE}:{stroke:Pl.INTERACTIVE,fill:Pl.INTERACTIVE},n=e?Object.assign(t,this.props.mobileStyleOverride||{}):Object.assign(t,this.props.normalStyle),s=e?{...t,"stroke-width":0,scale:.75}:this.props.highlightStyle,i=Object.assign({normalStyle:n,highlightStyle:s,shadow:e,tooltip:e&&this.props.showTooltips},e?{pointSize:7}:{});return Object.assign(this.props,i)}return this.props},add:function(e){this.point=Nl.addMovablePoint(e,this._getProps())},modify:function(){this.point.modify(this._getProps())},remove:function(){this.point.remove()},toFront:function(){this.point.toFront()},grab:function(e){this.point.grab(e)}});Tl.extend(Il,Nl.MovablePoint);const El=Ml.createClass({displayName:"MovableLine",movableProps:["children"],add:function(e){const t=Tl.pluck(this.props.children,"point"),n=Tl.extend({},this.props,{points:t});this.line=Nl.addMovableLine(e,n)},modify:function(){const e=Tl.pluck(this.props.children,"point"),t=Tl.extend({},this.props,{points:e});this.line.modify(t)},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}});Tl.extend(El,Nl.MovableLine);const Al=Ml.createSimpleClass(((e,t)=>{let n=t.coord;return t.unscaled&&(n=e.unscalePoint(n)),e.label(n,t.text,t.direction,t.tex,t.style)})),Rl=Ml.createClass({displayName:"Line",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.line=this.graphie.line(t.start,t.end,t.style)},modify:function(){const e=this.props,t=this.graphie.svgPath([e.start,e.end]);this.line.attr(Tl.extend({},e.style,{path:t}))},remove:function(){this.line.remove()},toFront:function(){this.line.toFront()}}),Dl=Ml.createClass({displayName:"Parabola",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.parabola=this.graphie.parabola(t.a,t.b,t.c,t.style)},modify:function(){const e=this.props,t=this.graphie.svgParabolaPath(e.a,e.b,e.c);this.parabola.attr(Tl.extend({},e.style,{path:t}))},remove:function(){this.parabola.remove()},toFront:function(){this.parabola.toFront()}}),Fl=Ml.createClass({displayName:"Sinusoid",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.sinusoid=this.graphie.sinusoid(t.a,t.b,t.c,t.d,t.style)},modify:function(){const e=this.props,t=this.graphie.svgSinusoidPath(e.a,e.b,e.c,e.d);this.sinusoid.attr(Tl.extend({},e.style,{path:t}))},remove:function(){this.sinusoid.remove()},toFront:function(){this.sinusoid.toFront()}}),Ll=Ml.createSimpleClass(((e,t)=>e.plot(t.fn,t.range,t.style))),zl=Ml.createSimpleClass(((e,t)=>e.plotParametric(t.fn,t.range,t.style))),ql=Ml.createSimpleClass(((e,t)=>e.ellipse(t.coord,e.unscaleVector([4,4]),{fill:t.color||Pl.BLACK,stroke:t.color||Pl.BLACK}))),Wl=Ml.createClass({displayName:"Path",movableProps:["children"],add:function(e){const t=this.props;this.graphie=e,this.path=this.graphie.path(t.coords,t.style)},modify:function(){const e=this.props,t=this.graphie.svgPath(e.coords);this.path.attr({path:t})},remove:function(){this.path.remove()},toFront:function(){this.path.toFront()}}),Bl=Ml.createSimpleClass(((e,t)=>{let n=t.center,s=t.radius;return t.unscaled&&(n=e.unscalePoint(n),s=e.unscaleVector(s)),e.arc(n,s,t.startAngle,t.endAngle,t.sector,t.style)})),Vl=Ml.createSimpleClass(((e,t)=>e.circle(t.center,t.radius,t.style))),Hl=Ml.createSimpleClass(((e,t)=>e.rect(t.x,t.y,t.width,t.height,t.style)));_l.exports={Arc:Bl,Circle:Vl,Label:Al,Line:Rl,MovableLine:El,MovablePoint:Il,Parabola:Dl,Path:Wl,Plot:Ll,PlotParametric:zl,Point:ql,Sinusoid:Fl,Rect:Hl};var Ul=_l.exports,Gl={exports:{}};Gl.exports;h.a;const $l=i.a,Yl=x.b,Kl=kl,Xl=Ul,Zl=Kl.GraphieMovable,Jl=ce.deepEq,Ql=ce.nestedMap,ec=ki.assert,tc=Kr.createGraphie,nc=createReactClass({displayName:"Graphie",getDefaultProps:function(){return{range:[[-10,10],[-10,10]],options:{},responsive:!1,addMouseLayer:!0}},componentDidMount:function(){this._setupGraphie(),this._updateMovables()},shouldComponentUpdate:function(e){return!Jl(this.props,e)},componentDidUpdate:function(e){this.props.setup!==e.setup&&window.console&&window.console.warn&&window.console.warn("<Graphie> was given a new setup function. This is a bad idea; please refactor your code to give the same setup function reference to <Graphie> on every render."),Jl(this.props.options,e.options)&&Jl(this.props.box,e.box)&&Jl(this.props.range,e.range)||this._setupGraphie(),this._updateMovables()},getGraphie:function(){return this._graphie},_range:function(){return Yl.map(this.props.range,(e=>e[0]>=e[1]?[-10,10]:e))},_box:function(){return Yl.map(this.props.box,(e=>e>0?e:340))},_scale:function(){const e=this._box(),t=this._range();return Yl.map(e,((e,n)=>e/(t[n][1]-t[n][0])))},_setupGraphie:function(){this._removeMovables();const e=$l.findDOMNode(this.refs.graphieDiv);l()(e).empty();const t=this._graphie=tc(e);t.init({range:this._range(),scale:this._scale(),isMobile:this.props.isMobile}),this.props.addMouseLayer&&t.addMouseLayer({onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),t.snap=this.props.options.snapStep||[1,1],this.props.responsive&&(l()(e).css({width:"100%",height:"100%"}),t.raphael.setSize("100%","100%")),this.props.setup(t,Yl.extend({range:this._range(),scale:this._scale()},this.props.options))},_removeMovables:function(){Yl.invoke(this._movables,"remove"),this._movables={}},_renderMovables:function(e,t){const n=t.graphie,s=t.oldMovables,i=t.newMovables,r=e=>{Yl.each(e.movableProps,(n=>{e.props[n]=this._renderMovables(e.props[n],t)}))};let o=!1;return Ql(e,(e=>{if(!e)return t.nextKey++,e;const a=new e.type(e.props);ec(a instanceof Zl,"All children of a Graphie component must be Graphie movables");const l=e.key,c=null==l?"_no_id_"+t.nextKey:l;t.nextKey++;const h=e.ref;r(a);const p=s[c];if(p)if(a.constructor===p.constructor){p.props=a.props;"reordered"===p.modify(n)&&(o=!0),i[c]=p}else null==l&&"undefined"!==typeof console&&console.warn&&console.warn("Replacing a <Graphie> child with a child of a different type. Please add keys to your <Graphie> children"),p.remove(),a.add(n),o=!0,i[c]=a;else a.add(n),o=!0,i[c]=a;return o&&i[c].toFront(),h&&(this.movables[h]=i[c]),i[c]}))},_updateMovables:function(){const e=this._graphie,t=this._movables,n={};this._movables=n,this.movables={},this._renderMovables(this.props.children,{nextKey:1,graphie:e,oldMovables:t,newMovables:n}),Yl.each(t,((e,t)=>{n[t]||e.remove()}))},render:function(){return Object($t.jsx)("div",{className:"graphie-container",children:Object($t.jsx)("div",{className:"graphie",ref:"graphieDiv"})})}});Yl.extend(nc,Kl),Yl.extend(nc,Xl),Gl.exports=nc;var sc=Gl.exports,ic={exports:{}};ic.exports;const rc=v.a,oc=(h.a,createReactClass({displayName:"FixedToResponsive",getDefaultProps:function(){return{className:"",constrainHeight:!1,allowFullBleed:!1}},getInitialState:function(){return{viewportHeight:null,viewportWidth:null}},componentDidMount:function(){window.innerHeight<480?setTimeout(this._cacheViewportSize,800):this._cacheViewportSize()},_cacheViewportSize:function(){this.isMounted()&&this.setState({viewportHeight:Math.max(480,window.innerHeight),viewportWidth:window.innerWidth})},render:function(){const e=this.props.width/this.props.height,t=Object($t.jsx)("div",{style:{paddingBottom:100*(1/e).toFixed(4)+"%"}});let{width:n,height:s}=this.props;if(this.props.constrainHeight&&this.state.viewportHeight){const t=2/3*this.state.viewportHeight;this.props.height>=t&&(s=t,n=t*e)}const i={maxWidth:n,maxHeight:s},r=rc("fixed-to-responsive",this.props.className),o=Object($t.jsxs)("div",{className:r,style:i,children:[t,this.props.children]});return this.props.allowFullBleed&&this.state.viewportWidth&&n>=this.state.viewportWidth?Object($t.jsx)("div",{style:{marginLeft:mn,marginRight:mn},children:o}):o}}));ic.exports=oc;var ac=ic.exports,lc={exports:{}};lc.exports;const cc=v.a,hc=(h.a,l.a),pc=x.b,uc=ac,dc=sc,gc=di,fc=ce,mc=Zs,bc={},vc=/\/([^/]+)$/;function xc(e){return/\.(jpg|jpeg)$/i.test(e)}function yc(){return"undefined"!==typeof KA&&"en"!==KA.language}function jc(){return"undefined"!==typeof KA&&"en-pt"===KA.language}const wc=[];function Oc(){return ReactDOMtags.span({style:{background:"url(/images/spinner.gif) no-repeat",backgroundPosition:"center",width:"100%",height:"100%",position:"absolute",minWidth:"20px"}})}jc()&&(KA.jipt_dom_insert_checks||(KA.jipt_dom_insert_checks=[]),KA.jipt_dom_insert_checks.push((function(e,t,n){const s=hc(t).data("jipt-label-index");if(t&&"undefined"!==typeof s){const{label:t,useMath:n}=wc[s];if(t.text(""),e=ri(e),n){const n=/^\$(.*)\$$/,s=e.match(n),i=s?s[1]:"\\color{red}{\\text{Invalid Math}}";t.processMath(i,!0)}else t.processText(e);return!1}return e})));const Cc=createReactClass({displayName:"SvgImage",statics:{getRealImageUrl:V},getDefaultProps:function(){return{constrainHeight:!1,onUpdate:()=>{},responsive:!0,src:"",scale:1,zoomToFullSizeOnMobile:!1}},getInitialState:function(){return{imageLoaded:!1,imageDimensions:null,dataLoaded:!1,labelDataIsLocalized:!1,labels:[],range:[[0,0],[0,0]]}},componentDidMount:function(){L(this.props.src)&&this.loadResources()},componentWillReceiveProps:function(e){this.props.src!==e.src&&this.setState({imageLoaded:!1,dataLoaded:!1})},shouldComponentUpdate:function(e,t){if(!pc.isEqual(this.props,e))return!0;if(!L(e.src))return!1;return this.isLoadedInState(this.state)!==this.isLoadedInState(t)},componentDidUpdate:function(){L(this.props.src)&&!this.isLoadedInState(this.state)&&this.loadResources()},isLoadedInState:function(e){return e.imageLoaded&&e.dataLoaded},loadResources:function(){const e=function(e){const t=e.match(vc);return t&&t[1]}(this.props.src);if(bc[e])if(bc[e].loaded){const{data:t,localized:n}=bc[e];this.onDataLoaded(t,n)}else bc[e].dataCallbacks.push(this.onDataLoaded);else{const t={loaded:!1,dataCallbacks:[this.onDataLoaded],data:null,localized:yc()};bc[e]=t;const n=(n,s)=>{!function(e,t){t={callbackName:"callback",success:hc.noop,error:hc.noop,...t};const n=document.createElement("script");function s(){document.head.removeChild(n),delete window[t.callbackName]}n.setAttribute("async",""),n.setAttribute("src",e),window[t.callbackName]=function(){s(),t.success.apply(null,arguments)},n.addEventListener("error",(function(){s(),t.error.apply(null,arguments)})),document.head.appendChild(n)}(n,{callbackName:"svgData"+e,success:e=>{t.data=e,t.loaded=!0,pc.each(t.dataCallbacks,(e=>{e(t.data,t.localized)}))},error:s})};yc()?n(function(e){if("undefined"!==typeof KA){const[t,n]=z(e).split(B);return`${t}/${KA.language}/${n}-data.json`}return W(e)}(this.props.src),((e,s,i)=>{t.localized=!1,n(W(this.props.src),((e,t,n)=>{console.error("Data load failed:",W(this.props.src),n)}))})):n(W(this.props.src),((e,t,n)=>{console.error("Data load failed:",W(this.props.src),n)}))}},onDataLoaded:function(e,t){this.isMounted()&&e.labels&&e.range&&this.setState({dataLoaded:!0,labelDataIsLocalized:t,labels:e.labels,range:e.range})},sizeProvided:function(){return null!=this.props.width&&null!=this.props.height},onImageLoad:function(){this.sizeProvided()?this.setState({imageLoaded:!0}):fc.getImageSize(this.props.src,((e,t)=>{this.isMounted()&&this.setState({imageLoaded:!0,imageDimensions:[e,t]})}))},setupGraphie:function(e,t){pc.map(t.labels,(t=>{if(jc()&&this.state.labelDataIsLocalized){const n=e.label(t.coordinates,t.content,t.alignment,!1);hc(n).data("jipt-label-index",wc.length),wc.push({label:n,useMath:t.typesetAsMath})}else if(t.coordinates){const n=e.label(t.coordinates,t.content,t.alignment,t.typesetAsMath,{"font-size":100*this.props.scale+"%"}),s=n[0].style;let i=this._tryGetPixels(s.top),r=this._tryGetPixels(s.left);if(null===i||null===r){const e=n.position();i=e.top,r=e.left}const o=this.props.height*this.props.scale,a=this.props.width*this.props.scale;n.css({top:i/o*100+"%",left:r/a*100+"%"}),pc.each(t.style,((e,t)=>{n.css(t,e)}))}}))},_tryGetPixels:function(e){return(e=e||"").endsWith("px")&&parseFloat(e)||null},_handleZoomClick:function(e){(hc(e.target).width()<this.props.width||this.props.zoomToFullSizeOnMobile)&&mc.ZoomService.handleZoomClick(e,this.props.zoomToFullSizeOnMobile),this.props.trackInteraction&&this.props.trackInteraction()},render:function(){const e=this.props.src,t={alt:this.props.alt,title:this.props.title},n=this.props.width&&this.props.width*this.props.scale,s=this.props.height&&this.props.height*this.props.scale,i={width:n,height:s},r=this.props.responsive&&!(!n||!s);let o;this.props.extraGraphie&&this.props.extraGraphie.labels.length&&(o=Object($t.jsx)(dc,{box:this.props.extraGraphie.box,range:this.props.extraGraphie.range,options:{labels:this.props.extraGraphie.labels},responsive:!0,addMouseLayer:!1,setup:this.setupGraphie}));const a=void 0===this.props.preloader?Oc:this.props.preloader,l=a?()=>a(i):null;if(!L(e)){if(r){const i=cc({zoomable:n>700,"svg-image":!0});return t.onClick=this._handleZoomClick,Object($t.jsxs)(uc,{className:i,width:n,height:s,constrainHeight:this.props.constrainHeight,allowFullBleed:this.props.allowFullBleed&&xc(e),children:[Object($t.jsx)(gc,{src:e,imgProps:t,preloader:l,onUpdate:this.props.onUpdate}),o]})}return t.style=i,Object($t.jsx)(gc,{src:e,preloader:l,imgProps:t,onUpdate:this.props.onUpdate})}const c=q(e);let h;if(this.isLoadedInState(this.state)){let e;e=this.sizeProvided()?[n,s]:[this.state.imageDimensions[0]*this.props.scale,this.state.imageDimensions[1]*this.props.scale];const t=[40*this.props.scale,40*this.props.scale];h=Object($t.jsx)(dc,{ref:"graphie",box:e,scale:t,range:this.state.range,options:pc.pick(this.state,"labels"),responsive:r,addMouseLayer:!1,setup:this.setupGraphie})}return r?Object($t.jsxs)(uc,{className:"svg-image",width:n,height:s,constrainHeight:this.props.constrainHeight,children:[Object($t.jsx)(gc,{src:c,onLoad:this.onImageLoad,onUpdate:this.props.onUpdate,preloader:l,imgProps:t}),h,o]}):(t.style=i,Object($t.jsxs)("div",{className:"unresponsive-svg-image",style:i,children:[Object($t.jsx)(gc,{src:c,onLoad:this.onImageLoad,onUpdate:this.props.onUpdate,preloader:l,imgProps:t}),h]}))}});lc.exports=Cc;var Sc=lc.exports,kc={exports:{}},_c=(kc.exports,h.a,createReactClass({displayName:"QuestionParagraph",render:function(){var e=this.props.className?"paragraph "+this.props.className:"paragraph";return Object($t.jsx)("div",{className:e,"data-perseus-component-index":this.props.translationIndex,"data-perseus-paragraph-index":this.props.paragraphIndex,children:this.props.children})}}));kc.exports=_c;var Tc=kc.exports,Mc={exports:{}};Mc.exports;const Nc=In.a,Pc={fence:{match:Nc.defaultRules.fence.match,order:1,parse:(e,t,n)=>e[3]},paragraph:{match:Nc.defaultRules.paragraph.match,order:2,parse:(e,t,n)=>e[1]}},Ic=Nc.parserFor(Pc);Mc.exports={parseToArray:e=>{const t=e.replace(/^\n\s*\n/,"")+"\n\n";return Ic(t,{inline:!1})},joinFromArray:e=>e.join("\n\n")};var Ec=Mc.exports;class Ac{constructor(){this.previousContent=null,this.runLinter=Object(x.a)(((e,t)=>{"undefined"!==typeof KA&&e!==this.previousContent&&(this.previousContent=e,""!==e?fetch("/api/internal/translate/lint_poentry?preview=1&lang=en",{headers:{"Content-Type":"application/json"},body:JSON.stringify({msgid:e,msgstr:e,format:"perseus_text",filename:""}),method:"POST"}).then((e=>e.status>=400?{status:"error",message:"Could not run i18n linter."}:e.json()),(e=>({status:"error",message:"Could not run i18n linter."}))).then((e=>{"error"===e.status?t(["Some part of this text makes it untranslatable. The specific message from the i18n linter was: "+e.message.replace(/\n/g," ")]):t([])})):t([]))}),1e3)}applyLintErrors(e,t){if(t.length){const n=t.join("\n\n");e.unshift({content:{type:"text",content:""},insideTable:!1,message:n,ruleName:"legacy-error",severity:Ee.Severity.ERROR,type:"lint"})}}destroy(){this.runLinter=null,this.previousContent=null}}var Rc=l.a,Dc=(h.a,i.a),Fc=x.b,Lc=v.a,zc=Ec,qc=Kn,Wc=Tc,Bc=Sc,Vc=Nn.a,Hc=Us,Uc=Fs,Gc=ce,$c=Ms,Yc=Ss.ClassNames,Kc=hs,Xc=rs,Zc=ss;const Jc=ts;var Qc={exports:{}};Qc.exports;const{keypadElementPropType:eh}=ye.a.propTypes;var th=/\S/,nh=/(web\+graphie|https):\/\/[^\s]*/;const sh=()=>{};"undefined"!==typeof KA&&"en-pt"===KA.language&&(window.PerseusTranslationComponents=[],KA.jipt_dom_insert_checks||(KA.jipt_dom_insert_checks=[]),KA.jipt_dom_insert_checks.push((function(e,t,n){var s=Rc(t),i=s.data("perseus-component-index"),r=s.data("perseus-paragraph-index");if(t&&"undefined"!==typeof i){var o=window.PerseusTranslationComponents[i];return!!o&&(e=ri(e),o.replaceJiptContent(e,r),!1)}return e})));var ih=["content","problemNum","widgets"],rh=function(e,t,n,s){e?(this._tracked=!1,this.trackApi=e,this.widgetType=t,this.widgetID=n,this.setting=s,this.track=this._track.bind(this)):this.track=this._noop};rh.prototype._track=function(e){this._tracked&&!this.setting||(this._tracked=!0,this.trackApi({type:this.widgetType,id:this.widgetID,...e}))},rh.prototype._noop=function(){};var oh=createReactClass({displayName:"Renderer",getDefaultProps:function(){return{content:"",widgets:{},images:{},ignoreMissingWidgets:!0,highlightedWidgets:[],questionCompleted:!1,onRender:sh,onInteractWithWidget:function(){},findExternalWidgets:()=>[],alwaysUpdate:!1,reviewMode:!1,serializedState:null,onSerializedStateUpdated:()=>{},linterContext:je}},getInitialState:function(){return Fc.extend({jiptContent:null,notGorgon:new Ac,notGorgonLintErrors:[]},this._getInitialWidgetState())},componentDidMount:function(){this.handleRender({}),this._currentFocus=null,this._rootNode=Dc.findDOMNode(this),this._isMounted=!0,this.props.serializedState&&this.restoreSerializedState(this.props.serializedState),this.props.linterContext.highlightLint&&this.state.notGorgon.runLinter(this.props.content,this.handleNotGorgonLintErrors)},componentWillReceiveProps:function(e){Fc.isEqual(Fc.pick(this.props,ih),Fc.pick(e,ih))||this.setState(this._getInitialWidgetState(e))},shouldComponentUpdate:function(e,t){if(this.props.alwaysUpdate)return!0;var n=!Fc.isEqual(this.state,t);return!Fc.isEqual(this.props,e)||n},componentWillUpdate:function(e,t){var n=this.shouldRenderJiptPlaceholder(this.props,this.state),s=this.shouldRenderJiptPlaceholder(e,t),i=this.getContent(this.props,this.state),r=this.getContent(e,t),o=this.props.highlightedWidgets,a=e.highlightedWidgets;this.reuseMarkdown=!n&&!s&&i===r&&Fc.isEqual(this.state.notGorgonLintErrors,t.notGorgonLintErrors)&&(!this.props.linterContext.highlightLint||Fc.isEqual(this.props.widgets,e.widgets))&&this.props.linterContext.highlightLint===e.linterContext.highlightLint&&o===a},componentDidUpdate:function(e,t){this.handleRender(e),Fc.each(this.widgetIds,(e=>{this.refs["container:"+e].replaceWidgetProps(this.getWidgetProps(e))})),this.props.serializedState&&!Fc.isEqual(this.props.serializedState,this.getSerializedState())&&this.restoreSerializedState(this.props.serializedState),this.props.linterContext.highlightLint&&this.state.notGorgon.runLinter(this.props.content,this.handleNotGorgonLintErrors)},componentWillUnmount:function(){this.widgetIds=[],null!=this.translationIndex&&(window.PerseusTranslationComponents[this.translationIndex]=null),this.state.notGorgon.destroy(),this._isMounted=!1},getApiOptions(){return $c.getApiOptions.call(this)},_getInitialWidgetState:function(e){e=e||this.props;var t=this._getAllWidgetsInfo(e);return{widgetInfo:t,widgetProps:this._getAllWidgetsStartProps(t,e)}},_getAllWidgetsInfo:function(e){return e=e||this.props,me(e.widgets,((e,t)=>{if(!e.type||!e.alignment){var n={};e.type||(n.type=t.split(" ")[0]),e.alignment||(n.alignment="default"),e=Fc.extend({},e,n)}return Uc.upgradeWidgetInfoToLatestVersion(e)}))},_getAllWidgetsStartProps:function(e,t){return me(e,(e=>Uc.getRendererPropsForWidgetInfo(e,t.problemNum)))},_getDefaultWidgetInfo:function(e){var t=Gc.rTypeFromWidgetId.exec(e);return null==t?{}:{type:t[1],graded:!0,options:{}}},_getWidgetInfo:function(e){return this.state.widgetInfo[e]||this._getDefaultWidgetInfo(e)},renderWidget:function(e,t,n){var s=this.state.widgetInfo[t];if(s&&"full-width"===s.alignment&&(n.foundFullWidth=!0),s||this.props.ignoreMissingWidgets){var i=s&&s.type||e,r=Fc.contains(this.props.highlightedWidgets,t);return Object($t.jsx)(Hc,{ref:"container:"+t,type:i,initialProps:this.getWidgetProps(t),shouldHighlight:r,linterContext:Jc.pushContextStack(this.props.linterContext,"widget")},"container:"+t)}return null},getWidgetProps:function(e){var t=this;const n=this.getApiOptions(),s=this.state.widgetProps[e]||{};let i=null;const r=this.state.widgetInfo[e];this.props.reviewMode&&r&&(i=r.options),this._interactionTrackers||(this._interactionTrackers={});let o=this._interactionTrackers[e];return o||(o=this._interactionTrackers[e]=new rh(n.trackInteraction,r&&r.type,e,Uc.getTracking(r&&r.type))),{...s,ref:e,widgetId:e,alignment:r&&r.alignment,static:r&&r.static,problemNum:this.props.problemNum,apiOptions:this.getApiOptions(this.props),keypadElement:this.props.keypadElement,questionCompleted:this.props.questionCompleted,onFocus:Fc.partial(this._onWidgetFocus,e),onBlur:Fc.partial(this._onWidgetBlur,e),findWidgets:this.findWidgets,reviewModeRubric:i,onChange:function(n,s){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t._setWidgetProps(e,n,s,i)},trackInteraction:o.track}},getSerializedState:function(e){return me(e||this.state.widgetProps,((e,t)=>{var n=this.getWidgetInstance(t);return n&&n.getSerializedState?n.getSerializedState():e}))},restoreSerializedState:function(e,t){var n=Fc.keys(e),s=Fc.keys(this.state.widgetProps);if(n.length===s.length&&Fc.intersection(n,s).length===n.length){var i=1,r=()=>{--i,t&&0===i&&t()};this.setState({widgetProps:me(e,((e,t)=>{var n=this.getWidgetInstance(t);if(n&&n.restoreSerializedState){++i;var s=n.restoreSerializedState(e,r);return Fc.extend({},this.state.widgetProps[t],s)}return e}))},r)}else console.error("Refusing to restore bad serialized state:",e,"Current props:",this.state.widgetProps)},showRationalesForCurrentlySelectedChoices(){Object.keys(this.props.widgets).forEach((e=>{const t=this.getWidgetInstance(e);t&&t.showRationalesForCurrentlySelectedChoices&&t.showRationalesForCurrentlySelectedChoices(this._getWidgetInfo(e).options)}))},deselectIncorrectSelectedChoices(){Object.keys(this.props.widgets).forEach((e=>{const t=this.getWidgetInstance(e);t&&t.deselectIncorrectSelectedChoices&&t.deselectIncorrectSelectedChoices()}))},findInternalWidgets:function(e){var t;if("string"===typeof e)if(-1!==e.indexOf(" ")){var n=e;t=(e,t)=>e===n}else{var s=e;t=(e,t)=>t.type===s}else t=e;return this.widgetIds.filter((e=>{var n=this._getWidgetInfo(e),s=this.getWidgetInstance(e);return t(e,n,s)})).map(this.getWidgetInstance)},findWidgets:function(e){return[...this.findInternalWidgets(e),...this.props.findExternalWidgets(e)]},getWidgetInstance:function(e){var t=this.refs["container:"+e];return t?t.getWidget():null},_onWidgetFocus:function(e,t){if(void 0===t)t=[];else if(!Fc.isArray(t))throw new Error("widget props.onFocus focusPath must be an Array, but was"+JSON.stringify(t));this._setCurrentFocus([e].concat(t))},_onWidgetBlur:function(e,t){var n=this._currentFocus,s=[e].concat(t);Fc.isEqual(s,n)&&Fc.defer((()=>{Fc.isEqual(this._currentFocus,n)&&this._setCurrentFocus(null)}))},getContent:function(e,t){return t.jiptContent||e.content},shouldRenderJiptPlaceholder:function(e,t){return"undefined"!==typeof KA&&"en-pt"===KA.language&&null==t.jiptContent&&-1!==e.content.indexOf("crwdns")},replaceJiptContent:function(e,t){if(null==t)this.setState({jiptContent:e});else{/^\s*(`{3,}|~{3,})\s*(\S+)?\s*\n([\s\S]+?)\s*\1\s*$/.test(e)||(/\S\n\s*\n\S/.test(e)?e="$\\large{\\red{\\text{Please translate each paragraph to a single paragraph.}}}$":/^\s*$/.test(e)&&(e="$\\large{\\red{\\text{Translated paragraph is currently empty}}}$"));var n=this.getContent(this.props,this.state),s=zc.parseToArray(n);s[t]=e,this.setState({jiptContent:zc.joinFromArray(s)})}},outputMarkdown:function(e,t){if(Fc.isArray(e)){for(var n=t.key,s=[],i=!1,r=0;r<e.length;r++){t.key=r,t.paragraphIndex=r;var o=this.outputMarkdown(e[r],t),a="string"===typeof o;a&&i?s[s.length-1]+=o:s.push(o),i=a}return t.key=n,s}this._foundTextNodes=!1,t.foundFullWidth=!1;var l,c=this.outputNested(e,t);return l=null!=this.translationIndex?null:Lc({"perseus-paragraph-centered":!this._foundTextNodes,"perseus-paragraph-full-width":t.foundFullWidth&&1===e.content.length}),Object($t.jsx)(Wc,{className:l,translationIndex:this.translationIndex,paragraphIndex:t.paragraphIndex,children:c},t.key)},outputNested:function(e,t){if(Fc.isArray(e)){for(var n=t.key,s=[],i=!1,r=0;r<e.length;r++){t.key=r;var o=this.outputNested(e[r],t),a="string"===typeof o;a&&i?s[s.length-1]+=o:s.push(o),i=a}return t.key=n,s}return this.outputNode(e,this.outputNested,t)},outputNode:function(e,t,n){var s=this.getApiOptions(),i=s.imagePlaceholder;if("widget"===e.type){var r=s.widgetPlaceholder;return r||(this._foundTextNodes=!0,Fc.contains(this.widgetIds,e.id)?Object($t.jsxs)("span",{className:"renderer-widget-error",children:["Widget [[","\u2603"," ",e.id,"]] already exists."]},n.key):(this.widgetIds.push(e.id),this.renderWidget(e.widgetType,e.id,n)))}if("blockMath"===e.type){const t=new Xc,i=e=>{if(this.props.onRender&&this.props.onRender(e),s.isMobile&&e){const n=e.querySelector(".katex"),s=e.querySelector('script[type="math/tex"]')||e.querySelector(".MathJax");if(n)t.resolve();else{if(!s)throw new Error("No math present in Renderer");t.resolve()}}},r=Object($t.jsx)(Vc,{onRender:i,onResourceLoaded:i,children:Zc(e.content)}),o={overflowX:"auto",overflowY:"hidden",paddingTop:10,paddingBottom:10,marginTop:-10,marginBottom:-10};if(s.isMobile){const e=16,s={marginLeft:-e,marginRight:-e},i={paddingLeft:e,paddingRight:e},a=(e,t)=>{const n=e.querySelector(".katex-html")||e.querySelector(".MathJax"),s={width:n.offsetWidth,height:n.offsetHeight};return{width:Math.max(t.width,s.width),height:Math.max(t.height,s.height)}};return Object($t.jsx)("div",{className:"perseus-block-math",style:s,children:Object($t.jsx)("div",{className:"perseus-block-math-inner",style:{...o,...i},children:Object($t.jsx)(Kc,{readyToMeasureDeferred:t,computeChildBounds:a,children:r})})},n.key)}return Object($t.jsx)("div",{className:"perseus-block-math",children:Object($t.jsx)("div",{className:"perseus-block-math-inner",style:o,children:r})},n.key)}if("math"===e.type){const t=e.content.replace(/\{align[*]?\}/g,"{aligned}");return Object($t.jsxs)("span",{style:{whiteSpace:"nowrap"},children:[Object($t.jsx)("span",{}),Object($t.jsx)(Vc,{onRender:this.props.onRender,onResourceLoaded:this.props.onRender,children:t}),Object($t.jsx)("span",{})]},n.key)}if("image"===e.type){if(i)return i;var o=Fc.has(this.props.images,e.target)?this.props.images[e.target]:null,a=!n.inTable;return Object($t.jsx)(Bc,{src:qc.sanitizeUrl(e.target),alt:e.alt,title:e.title,responsive:a,onUpdate:this.props.onRender,zoomToFullSizeOnMobile:s.isMobile&&s.isArticle,...o},n.key)}if("columns"===e.type)return this._isTwoColumn=!0,qc.ruleOutput(e,t,n);if("text"===e.type)return th.test(e.content)&&(this._foundTextNodes=!0),i&&nh.test(e.content)?i:e.content;if("table"===e.type||"titledTable"===e.type){n.inTable=!0;const i=qc.ruleOutput(e,t,n);if(n.inTable=!1,!s.isMobile)return i;const r=16,o={marginLeft:-r,marginRight:-r},a={paddingLeft:0,paddingRight:0},l=Object($t.jsx)("div",{style:{...a,overflowX:"auto"},children:Object($t.jsx)(Kc,{animateHeight:!0,children:i})});return Object($t.jsx)("div",{style:o,children:l})}return qc.ruleOutput(e,t,n)},handleRender:function(e){const t=this.props.onRender,n=e.onRender;if(t!==sh||n!==sh){const e=Rc(Dc.findDOMNode(this)).find("img");n!==sh&&e.off("load",n),t!==sh&&e.on("load",t)}t()},_setCurrentFocus:function(e){const t=this.getApiOptions();if(s=e,i=this._currentFocus,!(null===s||null===i?s===i:Fc.every(s,((e,t)=>Fc.isEqual(e,i[t]))))){var n=this._currentFocus;n&&this.blurPath(n),this._currentFocus=e,null!=t.onFocusChange&&t.onFocusChange(this._currentFocus,n)}var s,i},focus:function(){for(var e,t,n,s=0;s<this.widgetIds.length;s++){var i=this.widgetIds[s],r=this.getWidgetInstance(i),o=r&&r.focus&&r.focus();if(o){e=i,t=o;break}}if(e)return n=Fc.isObject(t)?[e].concat(t.path||[]):[e],this._setCurrentFocus(n),!0},getDOMNodeForPath:function(e){var t=Fc.first(e),n=Fc.rest(e),s=this.getWidgetInstance(t),i=s.getDOMNodeForPath;return i?i(n):0===n.length?Dc.findDOMNode(s):void 0},getGrammarTypeForPath:function(e){var t=Fc.first(e),n=Fc.rest(e);return this.getWidgetInstance(t).getGrammarTypeForPath(n)},getInputPaths:function(){var e=[];return Fc.each(this.widgetIds,(t=>{var n=this.getWidgetInstance(t);if(n.getInputPaths){var s=n.getInputPaths();Fc.each(s,(n=>{var s=[t].concat(n);e.push(s)}))}})),e},focusPath:function(e){if(!Fc.isEqual(this._currentFocus,e)){this._currentFocus&&this.blurPath(this._currentFocus);var t=Fc.first(e),n=Fc.rest(e),s=this.getWidgetInstance(t).focusInputPath;s&&s(n)}},blurPath:function(e){if(Fc.isEqual(this._currentFocus,e)){var t=Fc.first(e),n=Fc.rest(e);if(this.getWidgetInstance(t)){var s=this.getWidgetInstance(t).blurInputPath;s&&s(n)}}},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},serialize:function(){var e={};return Fc.each(this.state.widgetInfo,(function(t,n){var s=this.getWidgetInstance(n).serialize();Fc.isEmpty(s)||(e[n]=s)}),this),e},emptyWidgets:function(){return Fc.filter(this.widgetIds,(e=>{var t=this._getWidgetInfo(e),n=this.getWidgetInstance(e).simpleValidate(t.options,null);return Gc.scoreIsEmpty(n)}))},_setWidgetProps:function(e,t,n,s){this.setState((n=>{const i={...n.widgetProps,[e]:{...n.widgetProps[e],...t}};return s||this.props.onSerializedStateUpdated(this.getSerializedState(i)),{widgetProps:i}}),(()=>{var t=n&&n();s||this.props.onInteractWithWidget(e),!1!==t&&this._setCurrentFocus([e])}))},setInputValue:function(e,t,n){var s=Fc.first(e),i=Fc.rest(e);this.getWidgetInstance(s).setInputValue(i,t,n)},getUserInput:function(){return Fc.map(this.widgetIds,(e=>this.getWidgetInstance(e).getUserInput()))},getWidgetIds:function(){return this.widgetIds},getAllWidgetIds:function(){return Fc.map(this.getWidgetIds(),(e=>{var t="group";return e.substring(0,t.length)===t&&this.getWidgetInstance(e)?{id:e,children:this.getWidgetInstance(e).getRenderer().getAllWidgetIds()}:{id:e,children:[]}}))},getUserInputForWidgets:function(){return be(this.widgetIds,(e=>this.getWidgetInstance(e).getUserInput()))},scoreWidgets:function(){var e=this.state.widgetInfo,t=this.getApiOptions().onInputError||function(){},n=Fc.filter(this.widgetIds,(t=>{var n=e[t];return null==n.graded||n.graded})),s={};return Fc.each(n,(n=>{var i=e[n],r=this.getWidgetInstance(n);r&&(s[n]=r.simpleValidate(i.options,t))})),s},score:function(){return Fc.reduce(this.scoreWidgets(),Gc.combineScores,Gc.noScore)},guessAndScore:function(){return[this.getUserInput(),this.score()]},examples:function(){var e=this.widgetIds,t=Fc.compact(Fc.map(e,(function(e){return e.examples?e.examples():null})));return t.length&&Fc.all(t,(function(e){return Fc.isEqual(t[0],e)}))?t[0]:null},handleNotGorgonLintErrors:function(e){this._isMounted&&this.setState({notGorgonLintErrors:e})},render:function(){const e=this.getApiOptions();if(this.reuseMarkdown)return this.lastRenderedMarkdown;var t=this.getContent(this.props,this.state);if(this.widgetIds=[],this.shouldRenderJiptPlaceholder(this.props,this.state)&&(this.translationIndex||(this.translationIndex=window.PerseusTranslationComponents.push(this)-1),!e.isArticle))return Object($t.jsx)("div",{"data-perseus-component-index":this.translationIndex,children:t});this._isTwoColumn=!1;var n=qc.parse(t,{isJipt:null!=this.translationIndex});if(this.props.linterContext.highlightLint){const e={content:this.props.content,widgets:this.props.widgets,...this.props.linterContext};Jc.runLinter(n,e,!0),this.state.notGorgon.applyLintErrors(n,[...this.state.notGorgonLintErrors,...this.props.legacyPerseusLint||[]])}var s=this.outputMarkdown(n,{baseElements:e.baseElements});const i=Lc({[Yc.RENDERER]:!0,[Yc.RESPONSIVE_RENDERER]:!0,[Yc.TWO_COLUMN_RENDERER]:this._isTwoColumn});return this.lastRenderedMarkdown=Object($t.jsx)("div",{className:i,children:s}),this.lastRenderedMarkdown}});Qc.exports=oh;var ah=Qc.exports,lh={exports:{}};lh.exports;lh.exports={xs:"@media screen and (max-width: 567px)",sm:"@media screen and (min-width: 568px) and (max-width: 767px)",md:"@media screen and (min-width: 768px) and (max-width: 1023px)",lg:"@media screen and (min-width: 1024px) and (max-width: 1279px)",xl:"@media screen and (min-width: 1280px)",smOrSmaller:"@media screen and (max-width: 767px)",mdOrSmaller:"@media screen and (max-width: 1023px)",lgOrSmaller:"@media screen and (max-width: 1279px)",smOrLarger:"@media screen and (min-width: 568px)",mdOrLarger:"@media screen and (min-width: 768px)",lgOrLarger:"@media screen and (min-width: 1024px)"};var ch=lh.exports,hh={exports:{}};hh.exports;const ph=ch;hh.exports=On.StyleSheet.create({perseusInteractive:{zIndex:"3",position:"relative"},aboveScratchpad:{position:"relative",zIndex:"2"},blankBackground:{backgroundColor:"#FDFDFD"},perseusSrOnly:{border:0,clip:"rect(0,0,0,0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",width:1},responsiveLabel:{[ph.smOrSmaller]:{fontSize:14,lineHeight:1.3},[ph.md]:{fontSize:17,lineHeight:1.4},[ph.lgOrLarger]:{fontSize:20,lineHeight:1.4}},responsiveInput:{display:"inline-block",WebkitAppearance:"none",appearance:"none","::-ms-check":{display:"none"},backgroundColor:"#fff",border:"2px solid #fff",boxShadow:"0 0px 0px 1px #BABEC2",outline:"none",boxSizing:"border-box",flexShrink:0,marginBottom:1,marginLeft:1,marginRight:1,marginTop:1,height:22,width:22},responsiveRadioInput:{borderRadius:"50%",":checked":{backgroundColor:wn,border:"none",borderRadius:"50%",boxShadow:"inset 0px 0px 0px 2px white, 0 0px 0px 2px #71B307",marginTop:2,marginBottom:2,marginLeft:2,marginRight:2,height:20,width:20}},responsiveRadioInputActive:{backgroundColor:"#fff",border:"2px solid #fff",borderRadius:"50%",boxShadow:"0 0px 0px 2px #71B307",marginTop:2,marginBottom:2,marginLeft:2,marginRight:2,height:20,width:20,":checked":{backgroundColor:"#fff"}},disableTextSelection:{userSelect:"none"}});var uh=hh.exports,dh={exports:{}};dh.exports;h.a;const gh=v.a,fh=window.i18n,mh=ah,bh=ch,vh=ts,xh=createReactClass({displayName:"HintRenderer",getDefaultProps:()=>({linterContext:je}),getSerializedState:function(){return this.refs.renderer.getSerializedState()},restoreSerializedState:function(e,t){this.refs.renderer.restoreSerializedState(e,t)},render:function(){const{apiOptions:e,className:t,hint:n,lastHint:s,lastRendered:i,pos:r,totalHints:o}=this.props,{isMobile:a}=e,l=gh(!a&&"perseus-hint-renderer",a&&Object(On.css)(yh.newHint),a&&i&&Object(On.css)(yh.lastRenderedNewHint),s&&"last-hint",i&&"last-rendered",t),c={...e,customKeypad:!1,staticRender:!1};return Object($t.jsxs)("div",{className:l,tabIndex:"-1",children:[!e.isMobile&&Object($t.jsx)("span",{className:"perseus-sr-only",children:fh._("Hint #%(pos)s",{pos:r+1})}),!e.isMobile&&!e.satStyling&&o&&null!=r&&Object($t.jsx)("span",{className:"perseus-hint-label",style:{display:"block",color:e.hintProgressColor},children:`${r+1} / ${o}`}),Object($t.jsx)(mh,{ref:"renderer",widgets:n.widgets,content:n.content||"",images:n.images,apiOptions:c,findExternalWidgets:this.props.findExternalWidgets,linterContext:vh.pushContextStack(this.props.linterContext,"hint")})]})}}),yh=On.StyleSheet.create({newHint:{marginBottom:24,borderLeftColor:"#F6F7F7",borderLeftStyle:"solid",borderLeftWidth:4,[bh.lgOrSmaller]:{paddingLeft:bn},[bh.smOrSmaller]:{paddingLeft:0},":focus":{outline:"none"}},lastRenderedNewHint:{marginBottom:0,borderLeftColor:Jt}});dh.exports=xh;var jh=dh.exports,wh={exports:{}};wh.exports;h.a;const Oh=i.a,Ch=v.a,Sh=x.b,kh=window.i18n,_h=jh,Th=Sc,Mh=Ms,Nh=ch,Ph=uh,Ih=ts,Eh=createReactClass({displayName:"HintsRenderer",getDefaultProps:function(){return{linterContext:je}},componentDidMount:function(){this._cacheHintImages()},componentDidUpdate:function(e,t){if(Sh.isEqual(e.hints,this.props.hints)&&e.hintsVisible===this.props.hintsVisible||this._cacheHintImages(),e.hintsVisible<this.props.hintsVisible){const e=this.props.hintsVisible-1;Oh.findDOMNode(this.refs["hintRenderer"+e]).focus()}},_hintsVisible:function(){return null==this.props.hintsVisible||-1===this.props.hintsVisible?this.props.hints.length:this.props.hintsVisible},_cacheImagesInHint:function(e){Sh.each(e.images,((e,t)=>{(new Image).src=Th.getRealImageUrl(t)}))},_cacheHintImages:function(){this._hintsVisible()>0?Sh.each(this.props.hints,this._cacheImagesInHint):this.props.hints.length>0&&this._cacheImagesInHint(this.props.hints[0])},getApiOptions(){return Mh.getApiOptions.call(this)},getSerializedState:function(){return Sh.times(this._hintsVisible(),(e=>this.refs["hintRenderer"+e].getSerializedState()))},restoreSerializedState:function(e,t){let n=1;const s=()=>{--n,t&&0===n&&t()};Sh.each(e,((e,t)=>{const i=this.refs["hintRenderer"+t];i&&(++n,i.restoreSerializedState(e,s))})),s()},render:function(){const e=this.getApiOptions(),t=this._hintsVisible(),n=[];this.props.hints.slice(0,t).forEach(((s,i)=>{const r=i===this.props.hints.length-1&&!/\*\*/.test(s.content),o=i===t-1,a=Object($t.jsx)(_h,{lastHint:r,lastRendered:o,hint:s,pos:i,totalHints:this.props.hints.length,ref:"hintRenderer"+i,apiOptions:e,findExternalWidgets:this.props.findExternalWidgets,linterContext:Ih.pushContextStack(this.props.linterContext,"hints["+i+"]")},"hintRenderer"+i);s.replace&&n.length>0?n[n.length-1]=a:n.push(a)}));const s=e.getAnotherHint&&t>0&&t<this.props.hints.length,i=`(${t}/${this.props.hints.length})`,r=Ch(this.props.className,e.isMobile&&t>0&&Object(On.css)(Ah.mobileHintStylesHintsRenderer));return Object($t.jsxs)("div",{className:r,children:[e.isMobile&&t>0&&Object($t.jsx)("div",{className:Object(On.css)(Ah.mobileHintStylesHintTitle,Ph.responsiveLabel),children:kh._("Hints")}),n,s&&Object($t.jsxs)("button",{rel:"button",className:Object(On.css)(Ah.linkButton,Ah.getAnotherHintButton,e.isMobile&&Ah.mobileHintStylesGetAnotherHintButton),onClick:t=>{t.preventDefault(),t.stopPropagation(),e.getAnotherHint()},children:[Object($t.jsx)("span",{className:Object(On.css)(Ah.plusText,e.isMobile&&Ah.mobileHintStylesPlusText),children:"+"}),Object($t.jsxs)("span",{className:Object(On.css)(Ah.getAnotherHintText),children:[kh._("Get another hint")," ",i]})]})]})}}),Ah=On.StyleSheet.create({rendererMargins:{marginTop:bn},linkButton:{cursor:"pointer",border:"none",backgroundColor:"transparent",fontSize:"100%",fontFamily:"inherit",fontWeight:"bold",color:Jt,padding:0,position:"relative"},plusText:{fontSize:20,position:"absolute",top:-3,left:0},getAnotherHintText:{marginLeft:16},mobileHintStylesHintsRenderer:{marginTop:64,border:"solid #D6D8DA",borderWidth:"1px 0 0 0",position:"relative",":before":{content:'""',display:"table",clear:"both"},":after":{content:'""',display:"table",clear:"both"}},mobileHintStylesHintTitle:{fontFamily:"inherit",fontStyle:"normal",fontWeight:"bold",color:an,paddingTop:bn,paddingBottom:24,[Nh.lgOrSmaller]:{paddingLeft:0},[Nh.smOrSmaller]:{paddingLeft:20}},getAnotherHintButton:{marginTop:24},mobileHintStylesGetAnotherHintButton:{[Nh.lgOrSmaller]:{paddingLeft:0},[Nh.smOrSmaller]:{paddingLeft:20}},mobileHintStylesPlusText:{[Nh.lgOrSmaller]:{left:0},[Nh.smOrSmaller]:{left:20}}});wh.exports=Eh;var Rh=wh.exports;const Dh=R;function Fh(e){if("content"===e.type)return{__type:"content",content:"",images:{},widgets:{}};if("hint"===e.type)return{__type:"hint",replace:!1,content:"",images:{},widgets:{}};if("tags"===e.type)return[];if("array"===e.type)return[];if("object"===e.type){const t=e.shape,n={};return Object.keys(t).forEach((e=>{n[e]=Fh(t[e])})),n}throw new Error(`unexpected shape type ${e.type}`)}function Lh(e){return Hh(Fh(e))}function zh(e,t,n){const s=Vh(e);de().setContentMapper(n).mapTree(s,t)}function qh(e,t,n){const s=Vh(e);de().setHintMapper(n).mapTree(s,t)}function Wh(e){return Bh(Vh(e))}function Bh(e){if(Array.isArray(e))return e.length?"string"===typeof e[0]?Dh.tags:Dh.arrayOf(Bh(e[0])):Dh.arrayOf(Dh.content);if("object"!==typeof e||"content"!==e.__type&&"item"!==e.__type){if("object"===typeof e&&"hint"===e.__type)return Dh.hint;if("object"===typeof e){const t={};return Object.keys(e).forEach((n=>{t[n]=Bh(e[n])})),Dh.shape(t)}throw new Error(`unexpected multi-item node ${JSON.stringify(e)}`)}return Dh.content}function Vh(e){return e._multi}function Hh(e){return{_multi:e}}var Uh=function(e){return e===Object(e)},Gh=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];if(n)for(var s in n)e[s]=n[s]}return e},$h=function(e){return Uh(e)?Array.isArray(e)?e.slice():Gh(e):e},Yh={get:function(e,t){return e[t]},set:function(e,t,n){var s=e.splice();return s[t]=n,s},mod:function(e,t,n){var s=e.slice();return s[t]=n(e[t]),s},del:function(e,t){var n=e.slice();return n.splice(t,1),n}},Kh={get:function(e,t){return e[t]},set:function(e,t,n){var s=$h(e);return s[t]=n,s},mod:function(e,t,n){var s=$h(e);return s[t]=n(e[t]),s},del:function(e,t){var n=$h(e);return delete n[t],n}},Xh={get:function(e,t){return e[t]},set:function(e,t,n){var s=e.splice();return s[t]=n,s},mod:function(e,t,n){var s=e.splice();return s[t]=n(e[t]),s},del:function(e,t){var n=e.slice();return n.splice(t),n}},Zh=function(e){return Array.isArray(e)?Yh:Uh(e)?Kh:"string"===typeof e?Xh:void 0},Jh=function(e){if(e instanceof Jh)return e;if(!(this instanceof Jh))return new Jh(e);var t=Zh(e);this._wrapped=t.thaw?t.thaw(e):e};Jh.prototype.freeze=function(){var e=this._wrapped,t=Zh(e);return t.freeze?t.freeze(e):e},Jh.prototype.zoom=function(e){return void 0===this._zoomStack&&(this._zoomStack=[]),this._zoomStack.push({zoom:e,wrapped:this._wrapped}),this._wrapped=Jh(this._wrapped).get(e),this},Jh.prototype.deZoom=function(){var e=this._zoomStack.pop();return this._wrapped=Jh(e.wrapped).set(e.zoom,this._wrapped).freeze(),this},Jh.prototype.get=function(e){for(var t=this._wrapped,n=0;n<e.length;n++)t=Zh(t).get(t,e[n]);return t},Jh.prototype.mod=function(e,t){var n=this._wrapped,s=$h(n),i=Zh(n);if(0===e.length)this._wrapped=t(this._wrapped);else if(1===e.length)this._wrapped=i.mod(s,e[0],t);else{var r=e[0],o=e.slice(1);s[r]=Jh(n[r]).mod(o,t).freeze(),this._wrapped=s}return this},Jh.prototype.merge=function(e,t){return this._wrapped=Jh(this._wrapped).mod(e,(function(e){return Gh(e,t)})).freeze(),this},Jh.prototype.del=function(e){var t=this._wrapped,n=Zh(t);if(1===e.length)this._wrapped=n.del(t,e[0]);else{var s=e[0],i=e.slice(1),r=$h(t);r[s]=Jh(t[s]).del(i).freeze(),this._wrapped=r}return this},Jh.prototype.set=function(e,t){return this.mod(e,(function(){return t}))};var Qh=Jh,ep={exports:{}};ep.exports;const tp=Qh,np=h.a,sp=Rh,ip=ah,rp=ce;class op extends np.Component{constructor(e){super(e),this._handleSerializedStateUpdated=(e,t)=>{const{onSerializedStateUpdated:n}=this.props;if(n){const s=this._getSerializedState(this.props.serializedState);n(tp(s).set(e,t).freeze())}},this.rendererDataTreeMapper=de().setContentMapper(((e,t,n)=>this._makeContentRendererData(e,n))).setHintMapper((e=>this._makeHintRendererData(e))).setTagsMapper((e=>null)),this.getRenderersMapper=de().setContentMapper((e=>e.makeRenderer())).setHintMapper((e=>e.makeRenderer())).setArrayMapper(this._annotateRendererArray.bind(this)),this.state=this._tryMakeRendererState(this.props)}componentWillReceiveProps(e){e.item!==this.props.item&&this.setState(this._tryMakeRendererState(e))}_tryMakeRendererState(e){try{return{rendererDataTree:this._makeRendererDataTree(e.item,e.shape),renderError:null}}catch(t){return console.error(t),{rendererDataTree:null,renderError:t}}}_getRendererProps(){const{item:e,children:t,shape:n,...s}=this.props;return s}_makeContentRendererData(e,t){const n={ref:null,makeRenderer:null},s=e=>n.ref=e,i=e=>this._findWidgets(n,e),r=e=>this._handleSerializedStateUpdated(t,e);return n.makeRenderer=()=>Object($t.jsx)(ip,{...this._getRendererProps(),...e,ref:s,findExternalWidgets:i,serializedState:this.props.serializedState?tp(this.props.serializedState).get(t):null,onSerializedStateUpdated:r}),n}_makeHintRendererData(e){const t=e=>this._findWidgets({},e);return{hint:e,findExternalWidgets:t,ref:null,makeRenderer:()=>Object($t.jsx)(sp,{...this._getRendererProps(),findExternalWidgets:t,hints:[e]})}}_makeRendererDataTree(e,t){const n=Vh(e);return this.rendererDataTreeMapper.mapTree(n,t)}_findWidgets(e,t){const n=[];return this._mapRenderers((s=>{e!==s&&s.ref&&n.push(...s.ref.findInternalWidgets(t))})),n}_mapRenderers(e){const{rendererDataTree:t}=this.state;if(!t)return null;return de().setContentMapper(e).setHintMapper(e).mapTree(t,this.props.shape)}_scoreFromRef(e){if(!e)return null;const[t,n]=e.guessAndScore();let s;return e.getSerializedState&&(s=e.getSerializedState()),rp.keScoreFromPerseusScore(n,t,s)}getScores(){return this._mapRenderers((e=>this._scoreFromRef(e.ref)))}score(){const e=[],t=[],n=this._mapRenderers((n=>n.ref?(n.ref.getSerializedState&&t.push(n.ref.getSerializedState()),e.push(n.ref.score()),n.ref.getUserInput()):null)),s=e.reduce(rp.combineScores);return rp.keScoreFromPerseusScore(s,n,t)}_getSerializedState(e){return this._mapRenderers(((t,n,s)=>t.ref?t.ref.getSerializedState():e?tp(e).get(s):null))}restoreSerializedState(e,t){let n=0;const s=()=>{n--,t&&0===n&&t()};this._mapRenderers(((t,i,r)=>{if(!t.ref)return;const o=tp(e).get(r);o&&(n++,t.ref.restoreSerializedState(o,s))}))}_annotateRendererArray(e,t,n){if("hint"===n.elementShape.type){const n=t;(e=[...e]).firstN=e=>Object($t.jsx)(sp,{...this._getRendererProps(),findExternalWidgets:n[0]?n[0].findExternalWidgets:void 0,hints:n.map((e=>e.hint)),hintsVisible:e})}return e}_getRenderers(){return this.getRenderersMapper.mapTree(this.state.rendererDataTree,this.props.shape)}render(){return this.state.renderError?Object($t.jsxs)("div",{className:Object(On.css)(ap.error),children:["Error rendering: ",String(this.state.renderError)]}):this.props.children({renderers:this._getRenderers()})}}const ap=On.StyleSheet.create({error:{color:"red"}});ep.exports=op;const lp=ep.exports,cp=R;var hp={MultiRenderer:lp,shapes:cp,buildPropTypeForShape:function(e){return PropTypes.oneOfType([PropTypes.shape({_multi:D(e)}),PropTypes.oneOf([null,void 0])])},buildEmptyItemForShape:Lh,findContentNodesInItem:zh,findHintNodesInItem:qh,inferItemShape:Wh},pp={exports:{}};pp.exports;h.a;const up=i.a,{Keypad:dp}=ye.a.components,gp={propTypes:{apiOptions:PropTypes.shape({customKeypad:PropTypes.bool}),keypadStyle:PropTypes.any},getInitialState:()=>({keypadElement:null}),componentDidMount(){this.props.apiOptions&&this.props.apiOptions.customKeypad&&(this._keypadContainer=document.createElement("div"),document.body.appendChild(this._keypadContainer),up.render(Object($t.jsx)(dp,{onElementMounted:e=>{this.setState({keypadElement:e})},onDismiss:()=>{this.blur&&this.blur()},style:this.props.keypadStyle}),this._keypadContainer))},componentWillUnmount(){this._keypadContainer&&(up.unmountComponentAtNode(this._keypadContainer),this._keypadContainer.parentNode&&this._keypadContainer.parentNode.removeChild(this._keypadContainer),this._keypadContainer=null)},keypadElement(){return this.state.keypadElement}};pp.exports=gp;var fp=pp.exports,mp={exports:{}};mp.exports;h.a;const bp=i.a,vp=x.b,xp=Ss.Options,yp=Rh,jp=fp,wp=ah,Op=ce,Cp=createReactClass({displayName:"ItemRenderer",getDefaultProps:function(){return{apiOptions:{}}},getInitialState:function(){return{...jp.getInitialState(),questionCompleted:!1,questionHighlightedWidgets:[]}},componentDidMount:function(){jp.componentDidMount.call(this),this._currentFocus=null},componentWillReceiveProps:function(e){this.setState({questionHighlightedWidgets:[]})},componentDidUpdate:function(){if(this.props.apiOptions.answerableCallback){const e=0===this.questionRenderer.emptyWidgets().length;this.props.apiOptions.answerableCallback(e)}},componentWillUnmount(){jp.componentWillUnmount.call(this)},keypadElement(){return jp.keypadElement.call(this)},_handleFocusChange:function(e,t){null!=e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus:function(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;const s=this.getInputPaths(),i=this._currentFocus&&s.some((e=>Op.inputPathsEqual(e,this._currentFocus)));null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,i&&t&&bp.findDOMNode(t)),t&&(i?t.activate():t.dismiss())},_onRendererBlur:function(e){const t=this._currentFocus;vp.isEqual(e,t)&&vp.defer((()=>{vp.isEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},_setWidgetProps:function(e,t,n){this.questionRenderer._setWidgetProps(e,t,n)},_handleAPICall:function(e,t){const n=vp.rest(arguments),s=this.questionRenderer;return s[e](...n)},setInputValue:function(e,t,n){return this._handleAPICall("setInputValue",e,t,n)},focusPath:function(e){return this._handleAPICall("focusPath",e)},blurPath:function(e){return this._handleAPICall("blurPath",e)},getDOMNodeForPath:function(e){return this._handleAPICall("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return this._handleAPICall("getGrammarTypeForPath",e)},getInputPaths:function(){return this.questionRenderer.getInputPaths()},handleInteractWithWidget:function(e){const t=vp.difference(this.state.questionHighlightedWidgets,[e]);this.setState({questionCompleted:!1,questionHighlightedWidgets:t}),this.props.apiOptions.interactionCallback&&this.props.apiOptions.interactionCallback()},focus:function(){return this.questionRenderer.focus()},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},getNumHints:function(){return this.props.item.hints.length},scoreInput:function(){const e=this.questionRenderer.guessAndScore(),t=e[0],n=e[1],s=[t,[]],i=Op.keScoreFromPerseusScore(n,s,this.questionRenderer.getSerializedState()),r=this.questionRenderer.emptyWidgets();return this.setState({questionCompleted:i.correct,questionHighlightedWidgets:r}),i},getWidgetIds:function(){return this.questionRenderer.getWidgetIds()},scoreWidgets:function(){const e=this.questionRenderer.scoreWidgets(),t=this.questionRenderer.getUserInputForWidgets(),n=this.questionRenderer.getSerializedState();return me(e,((e,s)=>Op.keScoreFromPerseusScore(e,t[s],n)))},getSerializedState:function(){return{question:this.questionRenderer.getSerializedState(),hints:this.hintsRenderer.getSerializedState()}},restoreSerializedState:function(e,t){let n=2;const s=()=>{--n,t&&0===n&&t()};this.questionRenderer.restoreSerializedState(e.question,s),this.hintsRenderer.restoreSerializedState(e.hints,s)},showRationalesForCurrentlySelectedChoices(){this.questionRenderer.showRationalesForCurrentlySelectedChoices()},deselectIncorrectSelectedChoices(){this.questionRenderer.deselectIncorrectSelectedChoices()},render:function(){const e={...xp.defaults,...this.props.apiOptions,onFocusChange:this._handleFocusChange},t=Object($t.jsx)(wp,{keypadElement:this.keypadElement(),problemNum:this.props.problemNum,onInteractWithWidget:this.handleInteractWithWidget,highlightedWidgets:this.state.questionHighlightedWidgets,apiOptions:e,questionCompleted:this.state.questionCompleted,reviewMode:this.props.reviewMode,ref:e=>this.questionRenderer=e,...this.props.item.question}),n=Object($t.jsx)(yp,{hints:this.props.item.hints,hintsVisible:this.props.hintsVisible,apiOptions:e,ref:e=>this.hintsRenderer=e});return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:t}),Object($t.jsx)("div",{className:!e.isMobile&&Object(On.css)(Sp.hintsContainer),children:n})]})}}),Sp=On.StyleSheet.create({hintsContainer:{marginLeft:50}});mp.exports=Cp;var kp=mp.exports,_p={exports:{}};_p.exports;h.a;const Tp=i.a,Mp=x.b,Np=Ss.Options,Pp=Rh,Ip=ah,Ep=fp,Ap=ce,Rp=ts,Dp=createReactClass({displayName:"ItemRenderer",getDefaultProps:function(){return{apiOptions:{},controlPeripherals:!0,hintsAreaSelector:"#hintsarea",initialHintsVisible:0,workAreaSelector:"#workarea",reviewMode:!1,linterContext:je}},getInitialState:function(){return{...Ep.getInitialState(),hintsVisible:this.props.initialHintsVisible,questionCompleted:!1,questionHighlightedWidgets:[]}},componentDidMount:function(){Ep.componentDidMount.call(this),this.props.controlPeripherals&&this.props.apiOptions.setDrawingAreaAvailable&&this.props.apiOptions.setDrawingAreaAvailable(!0),this._currentFocus=null,this.update()},componentWillReceiveProps:function(e){this.setState({questionHighlightedWidgets:[]})},componentDidUpdate:function(){this.update()},componentWillUnmount:function(){if(Ep.componentWillUnmount.call(this),Tp.unmountComponentAtNode(document.querySelector(this.props.workAreaSelector)),Tp.unmountComponentAtNode(document.querySelector(this.props.hintsAreaSelector)),this.props.controlPeripherals){var e=this.props.item.answerArea||{};e.calculator&&$("#calculator").hide(),e.periodicTable&&$(".periodic-table-info-box").hide(),e.zTable&&$(".z-table-info-box").hide(),e.tTable&&$(".t-table-info-box").hide(),e.chi2Table&&$(".chi2-table-info-box").hide()}},keypadElement(){return Ep.keypadElement.call(this)},update:function(){const e={...Np.defaults,...this.props.apiOptions,onFocusChange:this._handleFocusChange};this.questionRenderer=Tp.render(Object($t.jsx)(Ip,{keypadElement:this.keypadElement(),problemNum:this.props.problemNum,onInteractWithWidget:this.handleInteractWithWidget,highlightedWidgets:this.state.questionHighlightedWidgets,apiOptions:e,questionCompleted:this.state.questionCompleted,reviewMode:this.props.reviewMode,savedState:this.props.savedState,linterContext:Rp.pushContextStack(this.props.linterContext,"question"),...this.props.item.question,legacyPerseusLint:this.props.legacyPerseusLint}),document.querySelector(this.props.workAreaSelector)),this.hintsRenderer=Tp.render(Object($t.jsx)(Pp,{hints:this.props.item.hints,hintsVisible:this.state.hintsVisible,apiOptions:e,linterContext:Rp.pushContextStack(this.props.linterContext,"hints")}),document.querySelector(this.props.hintsAreaSelector));var t=this.props.item.answerArea||{};if(this.props.controlPeripherals?($("#calculator").toggle(t.calculator||!1),$(".periodic-table-info-box").toggle(t.periodicTable||!1),$(".z-table-info-box").toggle(t.zTable||!1),$(".t-table-info-box").toggle(t.tTable||!1),$(".chi2-table-info-box").toggle(t.chi2Table||!1)):(t.calculator&&this.props.onShowCalculator&&this.props.onShowCalculator(),t.periodicTable&&this.props.onShowPeriodicTable&&this.props.onShowPeriodicTable(),t.zTable&&this.props.onShowZTable&&this.props.onShowZTable(),t.tTable&&this.props.onShowTTable&&this.props.onShowTTable(),t.chi2Table&&this.props.onShowChi2Table&&this.props.onShowChi2Table()),e.answerableCallback){const t=0===this.questionRenderer.emptyWidgets().length;e.answerableCallback(t)}},_handleFocusChange:function(e,t){null!=e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus:function(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;const s=this.getInputPaths(),i=this._currentFocus&&s.some((e=>Ap.inputPathsEqual(e,this._currentFocus)));null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,i&&t&&Tp.findDOMNode(t)),t&&(i?t.activate():t.dismiss())},_onRendererBlur:function(e){var t=this._currentFocus;Ap.inputPathsEqual(e,t)&&setTimeout((()=>{Ap.inputPathsEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},_setWidgetProps:function(e,t,n){this.questionRenderer._setWidgetProps(e,t,n)},_handleAPICall:function(e,t){var n=Mp.rest(arguments),s=this.questionRenderer;return s[e].apply(s,n)},setInputValue:function(e,t,n){return this._handleAPICall("setInputValue",e,t,n)},focusPath:function(e){return this._handleAPICall("focusPath",e)},blurPath:function(e){return this._handleAPICall("blurPath",e)},getDOMNodeForPath:function(e){return this._handleAPICall("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return this._handleAPICall("getGrammarTypeForPath",e)},getInputPaths:function(){return this.questionRenderer.getInputPaths()},handleInteractWithWidget:function(e){var t=Mp.difference(this.state.questionHighlightedWidgets,[e]);this.setState({questionCompleted:!1,questionHighlightedWidgets:t}),this.props.apiOptions.interactionCallback&&this.props.apiOptions.interactionCallback()},focus:function(){return this.questionRenderer.focus()},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},showHint:function(){this.state.hintsVisible<this.getNumHints()&&this.setState({hintsVisible:this.state.hintsVisible+1})},getNumHints:function(){return this.props.item.hints.length},scoreInput:function(){var e=this.questionRenderer.guessAndScore(),t=e[0],n=e[1],s=[t,[]],i=Ap.keScoreFromPerseusScore(n,s,this.questionRenderer.getSerializedState()),r=this.questionRenderer.emptyWidgets();return this.setState({questionCompleted:i.correct,questionHighlightedWidgets:r}),i},getWidgetIds:function(){return this.questionRenderer.getWidgetIds()},scoreWidgets:function(){var e=this.questionRenderer.scoreWidgets(),t=this.questionRenderer.getUserInputForWidgets(),n=this.questionRenderer.getSerializedState();return me(e,((e,s)=>Ap.keScoreFromPerseusScore(e,t[s],n)))},getSerializedState:function(){return{question:this.questionRenderer.getSerializedState(),hints:this.hintsRenderer.getSerializedState()}},restoreSerializedState:function(e,t){var n=2,s=()=>{--n,t&&0===n&&t()};this.questionRenderer.restoreSerializedState(e.question,s),this.hintsRenderer.restoreSerializedState(e.hints,s)},showRationalesForCurrentlySelectedChoices(){this.questionRenderer.showRationalesForCurrentlySelectedChoices()},deselectIncorrectSelectedChoices(){this.questionRenderer.deselectIncorrectSelectedChoices()},render:function(){return Object($t.jsx)("div",{})}});_p.exports=Dp;var Fp=_p.exports;const Lp=On.StyleSheet.create({hintsContainer:{marginLeft:50},checkAnswerButton:{padding:10,color:"white",fontSize:14,borderRadius:5,display:"inline-grid",gridTemplateColumns:"1fr",gridTemplateRows:"1fr"},checkAnswerText:{gridArea:"1 / 1 / 2 / 2"}}),zp=createReactClass({displayName:"QuestionRenderer",getDefaultProps:function(){return{apiOptions:{},initialHintsVisible:0,problemNum:0,reviewMode:!1,onAnswer:()=>{},onHint:()=>{}}},getInitialState:function(){return{...fp.getInitialState(),hintsVisible:this.props.initialHintsVisible,answerState:"unanswered",questionHighlightedWidgets:[]}},componentDidMount:function(){fp.componentDidMount.call(this),this._currentFocus=null},componentWillReceiveProps:function(e){this.setState({questionHighlightedWidgets:[]})},componentDidUpdate:function(){if(this.props.apiOptions.answerableCallback){const e=0===this.questionRenderer.emptyWidgets().length;this.props.apiOptions.answerableCallback(e)}},componentWillUnmount(){fp.componentWillUnmount.call(this)},keypadElement(){return fp.keypadElement.call(this)},_handleFocusChange:function(e,t){null!=e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus:function(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;const s=this.getInputPaths(),r=this._currentFocus&&s.some((e=>ce.inputPathsEqual(e,this._currentFocus)));null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,r&&t&&i.a.findDOMNode(t)),t&&(r?t.activate():t.dismiss())},_onRendererBlur:function(e){const t=this._currentFocus;x.b.isEqual(e,t)&&x.b.defer((()=>{x.b.isEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},_setWidgetProps:function(e,t,n){this.questionRenderer._setWidgetProps(e,t,n)},_handleAPICall:function(e,t){const n=x.b.rest(arguments),s=this.questionRenderer;return s[e](...n)},setInputValue:function(e,t,n){return this._handleAPICall("setInputValue",e,t,n)},focusPath:function(e){return this._handleAPICall("focusPath",e)},blurPath:function(e){return this._handleAPICall("blurPath",e)},getDOMNodeForPath:function(e){return this._handleAPICall("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return this._handleAPICall("getGrammarTypeForPath",e)},getInputPaths:function(){return this.questionRenderer.getInputPaths()},handleInteractWithWidget:function(e){const t=x.b.difference(this.state.questionHighlightedWidgets,[e]);this.setState({answerState:"unanswered",questionHighlightedWidgets:t}),this.props.apiOptions.interactionCallback&&this.props.apiOptions.interactionCallback()},focus:function(){return this.questionRenderer.focus()},blur:function(){this._currentFocus&&this.blurPath(this._currentFocus)},showHint:function(){this.state.hintsVisible<this.getNumHints()&&(this.props.onHint(this.state.hintsVisible+1,this.getNumHints()),this.setState({hintsVisible:this.state.hintsVisible+1}))},getNumHints:function(){return this.props.item.hints.length},scoreInput:function(){const[e,t]=this.questionRenderer.guessAndScore(),n="points"===t.type&&t.earned>=t.total,s=this.questionRenderer.emptyWidgets();return this.setState({answerState:n?"correct":"incorrect",questionHighlightedWidgets:s}),[e,t]},checkAnswer:function(e){e.preventDefault();const[t,n]=this.scoreInput();this.props.onAnswer(t,n)},getWidgetIds:function(){return this.questionRenderer.getWidgetIds()},scoreWidgets:function(){const e=this.questionRenderer.scoreWidgets(),t=this.questionRenderer.getUserInputForWidgets(),n=this.questionRenderer.getSerializedState();return me(e,((e,s)=>ce.keScoreFromPerseusScore(e,t[s],n)))},getSerializedState:function(){return{question:this.questionRenderer.getSerializedState(),hints:this.hintsRenderer.getSerializedState()}},restoreSerializedState:function(e,t){let n=2;const s=()=>{--n,t&&0===n&&t()};this.questionRenderer.restoreSerializedState(e.question,s),this.hintsRenderer.restoreSerializedState(e.hints,s)},showRationalesForCurrentlySelectedChoices(){this.questionRenderer.showRationalesForCurrentlySelectedChoices()},deselectIncorrectSelectedChoices(){this.questionRenderer.deselectIncorrectSelectedChoices()},render:function(){const e={...Os.defaults,...this.props.apiOptions,onFocusChange:this._handleFocusChange},t=Object($t.jsx)(ah,{keypadElement:this.keypadElement(),problemNum:this.props.problemNum,onInteractWithWidget:this.handleInteractWithWidget,highlightedWidgets:this.state.questionHighlightedWidgets,apiOptions:e,questionCompleted:"correct"===this.state.answerState,reviewMode:this.props.reviewMode,ref:e=>this.questionRenderer=e,...this.props.item.question}),n=Object($t.jsx)(Rh,{hints:this.props.item.hints,hintsVisible:this.state.hintsVisible,apiOptions:e,ref:e=>this.hintsRenderer=e}),s=this.state.hintsVisible>=this.getNumHints();return Object($t.jsxs)("form",{className:"framework-perseus",onSubmit:this.checkAnswer,children:[Object($t.jsx)("div",{children:t}),Object($t.jsxs)("div",{style:{paddingTop:10,paddingBottom:10},children:[Object($t.jsxs)("button",{type:"submit",className:"check-answer-button "+Object(On.css)(Lp.checkAnswerButton),style:{backgroundColor:"incorrect"===this.state.answerState?"orange":"green"},disabled:"correct"===this.state.answerState,children:[Object($t.jsx)("span",{className:Object(On.css)(Lp.checkAnswerText),style:{visibility:"correct"===this.state.answerState?"visible":"hidden"},children:"\ud83c\udf1f Yes! You got it!"}),Object($t.jsx)("span",{className:Object(On.css)(Lp.checkAnswerText),style:{visibility:"incorrect"===this.state.answerState?"visible":"hidden"},children:"Try again"}),Object($t.jsx)("span",{className:Object(On.css)(Lp.checkAnswerText),style:{visibility:"unanswered"===this.state.answerState?"visible":"hidden"},children:"Check answer"})]}),Object($t.jsx)("div",{style:{display:"inline-block",width:10}}),Object($t.jsx)("button",{type:"button",style:{padding:10,backgroundColor:s?"darkgray":"orange",color:"white",fontSize:14,borderRadius:5},disabled:s,onClick:this.showHint,children:s?"We're out of hints!":"I'd like a hint!"})]}),Object($t.jsx)("div",{className:!e.isMobile&&Object(On.css)(Lp.hintsContainer),children:n})]})}});var qp=zp,Wp={exports:{}};Wp.exports;h.a;const Bp=i.a,Vp=v.a,Hp=ce,Up=Ss.Options,Gp=Ss.ClassNames,$p=ah,Yp=fp,Kp=ts,Xp=createReactClass({displayName:"ArticleRenderer",getDefaultProps:()=>({apiOptions:{},useNewStyles:!1,linterContext:je}),getInitialState:()=>Yp.getInitialState(),componentDidMount(){Yp.componentDidMount.call(this),this._currentFocus=null},shouldComponentUpdate(e,t){return e!==this.props||t!==this.state},componentWillUnmount(){Yp.componentWillUnmount.call(this)},keypadElement(){return Yp.keypadElement.call(this)},_handleFocusChange(e,t){e?this._setCurrentFocus(e):this._onRendererBlur(t)},_setCurrentFocus(e){const t=this.keypadElement(),n=this._currentFocus;this._currentFocus=e;let s=!1;if(this._currentFocus){const[e,...t]=this._currentFocus;s=this.refs[e].getInputPaths().some((e=>Hp.inputPathsEqual(e,t)))}null!=this.props.apiOptions.onFocusChange&&this.props.apiOptions.onFocusChange(this._currentFocus,n,s&&t&&Bp.findDOMNode(t)),t&&(s?t.activate():t.dismiss())},_onRendererBlur(e){const t=this._currentFocus;Hp.inputPathsEqual(e,t)&&setTimeout((()=>{Hp.inputPathsEqual(this._currentFocus,t)&&this._setCurrentFocus(null)}))},blur(){if(this._currentFocus){const[e,...t]=this._currentFocus;this.refs[e].blurPath(t)}},_sections(){return Array.isArray(this.props.json)?this.props.json:[this.props.json]},render(){const e={...Up.defaults,...this.props.apiOptions,isArticle:!0},t=Vp({"framework-perseus":!0,"perseus-article":!0,"bibliotron-article":this.props.useNewStyles,[Gp.MOBILE]:e.isMobile}),n=this._sections().map(((t,n)=>{const s=`section-${n}`;return Object($t.jsx)("div",{className:"clearfix",children:Object(c.createElement)($p,{...t,ref:s,key:n,key_:n,keypadElement:this.keypadElement(),apiOptions:{...e,onFocusChange:(e,t)=>{this._handleFocusChange(e&&[s].concat(e),t&&[s].concat(t))}},linterContext:Kp.pushContextStack(this.props.linterContext,"article"),legacyPerseusLint:this.props.legacyPerseusLint})},n)}));return Object($t.jsx)("div",{className:t,children:n})}});Wp.exports=Xp;var Zp=Wp.exports,Jp={exports:{}};Jp.exports;Jp.exports=["key","ref","containerSizeClass","widgetId","onChange","problemNum","apiOptions","questionCompleted","findWidgets","onRemove","id","onBlur","onFocus","trackInteraction","keypadElement"];var Qp=Jp.exports,eu={exports:{}},tu=(eu.exports,x.b),nu=Qp,su={serialize:function(){return tu.omit(this.props,nu)}};eu.exports=su;var iu=eu.exports;const ru='Usage:\n  this.change({propName: 5}, callback);\n  this.change("propName", 5, callback);\n  this.change("propName")',ou=function(e,t,n){const s=x.b.omit(e.props,Qp),i=x.b.extend(s,t);e.props.onChange(i,n)},au=function(e,t,n,s){if(void 0===n)return x.b.partial(au,e,t);{const i={};i[t]=n,ou(e,i,s)}},lu=function(e,t,n){if(x.b.isObject(e)&&void 0===n)return ou(this,e,n=t);if(x.b.isString(e))return au(this,e,t,n);throw new Error("Invalid types sent to this.change(): "+x.b.toArray(arguments).join()+"\n"+ru)},cu={onChange:g.a.func.isRequired};g.a.func.isRequired;var hu={change:lu,propTypes:cu},pu={exports:{}},uu=(pu.exports,h.a,hu),du=iu,gu=createReactClass({displayName:"TextArea",render:function(){return Object($t.jsx)("textarea",{ref:"input",value:this.props.value||"",onChange:this.changeValue})},focus:function(){return this.refs.input.focus(),!0},changeValue:function(e){this.props.onChange(e.target.value)}}),fu=createReactClass({displayName:"SimpleMarkdownTesterEditor",getDefaultProps:function(){return{value:""}},render:function(){return Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[Object($t.jsx)("div",{children:"Simple markdown contents:"}),Object($t.jsx)("div",{children:Object($t.jsx)(gu,{value:this.props.value,onChange:this.change("value"),ref:"input"})})]})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return uu.change.apply(this,t)},focus:function(){return this.refs.input.focus(),!0},serialize(){return du.serialize.call(this)}});pu.exports=fu;pu.exports;var mu={exports:{}},bu=(mu.exports,h.a,x.b),vu=hu,xu=Kn,yu=xu.parse,ju=xu.basicOutput,wu=createReactClass({displayName:"SimpleMarkdownTester",getDefaultProps:function(){return{value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vu.change.apply(this,t)},toJSON:function(){return{}},render:function(){var e=yu(this.props.value),t=ju(e);return Object($t.jsx)("div",{children:t})},focus:function(){return this.refs.input.focus(),!0},simpleValidate:function(e){return wu.validate(this.toJSON(),e)}});bu.extend(wu,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),mu.exports={name:"simple-markdown-tester",displayName:"Simple Markdown Tester",hidden:!0,widget:wu,transform:bu.identity};mu.exports;var Ou={exports:{}},Cu=(Ou.exports,h.a,hu),Su=iu,ku=createReactClass({displayName:"ExampleWidgetEditor",getDefaultProps:function(){return{correct:""}},handleAnswerChange:function(e){this.change({correct:e.target.value})},render:function(){return Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Correct answer:",Object($t.jsx)("input",{value:this.props.correct,onChange:this.handleAnswerChange,ref:"input"})]})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Cu.change.apply(this,t)},focus:function(){return this.refs.input.focus(),!0},serialize(){return Su.serialize.call(this)}});Ou.exports=ku;Ou.exports;var _u={exports:{}},Tu=(_u.exports,h.a,hu),Mu=x.b,Nu=createReactClass({displayName:"TextInput",render:function(){return Object($t.jsx)("input",{ref:"input",value:this.props.value||"",onChange:this.changeValue})},focus:function(){return this.refs.input.focus(),!0},changeValue:function(e){this.props.onChange(e.target.value)}}),Pu=createReactClass({displayName:"ExampleWidget",getDefaultProps:function(){return{value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Tu.change.apply(this,t)},render:function(){return Object($t.jsx)(Nu,{ref:"input",value:this.props.value,onChange:this.change("value")})},getUserInput:function(){return this.props.value},focus:function(){return this.refs.input.focus(),!0},simpleValidate:function(e){return Pu.validate(this.getUserInput(),e)}});Mu.extend(Pu,{validate:function(e,t){return""===e?{type:"invalid",message:"It looks like you haven't answered all of the question yet."}:e===t.correct?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}}),_u.exports={name:"example-widget",displayName:"Example Widget",defaultAlignment:"inline-block",hidden:!0,widget:Pu};_u.exports;var Iu={exports:{}},Eu=(Iu.exports,Qp);const Au=x.b;var Ru={getUserInput:function(){return Au.omit(this.props,Eu)}};Iu.exports=Ru;var Du=Iu.exports,Fu={exports:{}},Lu=(Fu.exports,h.a,x.b),zu=ce,qu=hu,Wu=Du,Bu=sc,Vu=Bu.MovablePoint,Hu=(G.a.number,G.a.point),Uu=createReactClass({displayName:"ExampleGraphieWidget",getDefaultProps:function(){return{coord:null,graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}}},getUserInput:function(){return Wu.getUserInput.call(this)},render:function(){return Object($t.jsx)(Bu,{ref:"graphie",box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this.setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,children:Object($t.jsx)(Vu,{pointSize:5,coord:this.props.coord||[0,0],constraints:[Vu.constraints.snap(),Vu.constraints.bound()],onMove:this.movePoint})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return qu.change.apply(this,t)},movePoint:function(e){this.change({coord:e})},_getGridConfig:function(e){return Lu.map(e.step,(function(t,n){return zu.gridDimensionConfig(t,e.range[n],e.box[n],e.gridStep[n])}))},setupGraphie:function(e,t){var n=this._getGridConfig(t);e.graphInit({range:t.range,scale:Lu.pluck(n,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:t.gridStep,tickStep:Lu.pluck(n,"tickStep"),labelStep:1,unityLabels:Lu.pluck(n,"unityLabel")}),e.label([0,t.range[1][1]],t.labels[1],"above")},simpleValidate:function(e){return Uu.validate(this.getUserInput(),e)}});Lu.extend(Uu,{validate:function(e,t){return null==e.coord?{type:"invalid",message:null}:Hu.equal(e.coord,t.correct)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}}}),Fu.exports={name:"example-graphie-widget",displayName:"Example Graphie Widget",hidden:!0,widget:Uu};var Gu=Fu.exports,$u={exports:{}},Yu=($u.exports,h.a,hu),Ku=iu,Xu=Gu.widget,Zu=createReactClass({displayName:"ExampleGraphieWidgetEditor",getDefaultProps:function(){return{correct:[4,4],graph:{box:[340,340],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],valid:!0,backgroundImage:null,markings:"grid",showProtractor:!1}}},render:function(){return Object($t.jsx)("div",{children:Object($t.jsx)(Xu,{graph:this.props.graph,coord:this.props.correct,onChange:this.handleChange,apiOptions:this.props.apiOptions})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Yu.change.apply(this,t)},handleChange:function(e){e.coord&&this.change({correct:e.coord})},serialize(){return Ku.serialize.call(this)}});$u.exports=Zu;$u.exports;var Ju=n(27),Qu=n(119),ed={exports:{}};ed.exports;h.a;const td=Qu.a,nd=createReactClass({displayName:"InfoTip",getInitialState:function(){return{didMount:!1}},componentDidMount:function(){this.setState({didMount:!0})},render:function(){return this.state.didMount?Object($t.jsx)(td,{...this.props}):Object($t.jsx)("div",{})}});ed.exports=nd;var sd=ed.exports,id={exports:{}};id.exports;h.a,x.b;const rd=hu,od=iu,ad=sd,ld=Ju.a,cd=/khanacademy\.org\/.*\/v\/(.*)$/;function hd(e){var t=cd.exec(e);return t?t[1]:e}const pd=createReactClass({displayName:"VideoEditor",getDefaultProps:function(){return{location:""}},_handleUrlChange:function(e){this.props.onChange({location:hd(e)})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rd.change.apply(this,t)},serialize(){return od.serialize.call(this)},render:function(){return Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["URL or KA Video Slug:"," ",Object($t.jsx)(ld,{name:"location",value:this.props.location,style:{width:290},onChange:this._handleUrlChange}),Object($t.jsx)(ad,{children:"You can paste any URL here. KA video URLs will be converted to just the slug."})]})})}});id.exports=pd;var ud=id.exports,dd={exports:{}},gd=(dd.exports,h.a,x.b),fd=hu,md=ac,bd="https://{hostname}/embed_video?slug={slug}&internal_video_only=1",vd=/^https?:\/\//,xd=/khanacademy\.org/,yd=createReactClass({displayName:"Video",getUserInput:function(){return null},simpleValidate:function(e){return yd.validate(null,e)},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return fd.change.apply(this,t)},render:function(){var e,t=this.props.location;if(!t)return Object($t.jsx)("div",{});if(vd.test(t))e=t;else{e=bd.replace("{slug}",t);var n=document.location.hostname,s="www.khanacademy.org";xd.test(n)&&(s=n),e=e.replace("{hostname}",s)}return Object($t.jsx)(md,{width:1280,height:720,children:Object($t.jsx)("iframe",{className:"perseus-video-widget",sandbox:"allow-same-origin allow-scripts",width:1280,height:720,src:e,allowFullScreen:!0})},t+this.props.alignment)}});gd.extend(yd,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),dd.exports={name:"video",displayName:"Video",defaultAlignment:"block",supportedAlignments:["block","float-left","float-right","full-width"],widget:yd};var jd=dd.exports;function wd(e){this.order=_d(e),this.mantissa=kd(e),this.positive=Sd(e),this.sigFigs=this.mantissa.length,this.sigDecs=this.order-this.mantissa.length}function Od(e,t,n,s){var i,r,o,a=""+e,l=_d(a),c=kd(a),h=Sd(a),p=!1;if(0==e||""==c||"0"==c){for(c="",b=0;b<t;b++)c+="0";l=t+n,n<0&&-n>=t&&(p=!0)}else{if(r=l-c.length-n,o=t-c.length,(i=Math.min(o,r))<0){var u=Td(c,-i);u.length>c.length+i&&(l++,r>o&&(u=Td(u,1))),c=u}else if(i>0)for(b=0;b<i;b++)c+="0";""!=c&&"0"!=c||(c="0",h=!0,0!=(l=1+n)&&(p=!0))}var d="";if(h||(d+="-"),s||c.length>20||l>4||l<-2||l-c.length>0&&Cd(c)>0||p)d+=c.charAt(0),c.length>1&&(d+="."+c.substring(1,c.length)),l-1!=0&&(d+=" x 10^"+(l-1));else{var g="",f="",m=!0;if(l>0)if(c.length>l)g=c.substring(0,l),f=c.substring(l,c.length);else{g=c,m=0!=Cd(c);for(var b=0;b<l-c.length;b++)g+="0"}else{for(b=0;b<-l;b++)f+="0";f+=c}d+=(""==g?"0":g)+(m?".":"")+f}return d}function Cd(e){for(var t=0,n=e.length-1;n>=0;n--){if("0"!=e.charAt(n))return t;t++}return t}function Sd(e){for(var t=!0,n=!1,s=!1,i="",r="",o=!0,a=0;a<e.length;a++){var l=e.charAt(a);if(l>="1"&&l<="9")r+=i+l,i="",s=!0,n||(0),t=!1;else if("0"==l)n?s?(r+=i+l,i=""):(l):(s?(l,i+=l):l),t=!1;else if(n||"."!=l)if("e"==l||"E"==l&&a+1<e.length){var c=parseInt(e.substring(a+1,e.length));c,c,a=e.length}else!t||"+"!=l&&"-"!=l||"-"==l&&(o=!o);else r+=i,i="",n=!0,t=!1}return""==r||o}function kd(e){for(var t=!0,n=!1,s=!1,i="",r="",o="",a=!0,l=0;l<e.length;l++){var c=e.charAt(l);if(c>="1"&&c<="9")o+=i+c,i="",s=!0,n||(0),t=!1;else if("0"==c)n?s?(o+=i+c,i=""):(r+=c):(s?(r+=c,i+=c):r+=c),t=!1;else if(n||"."!=c)if("e"==c||"E"==c&&l+1<e.length){var h=parseInt(e.substring(l+1,e.length));h,h,l=e.length}else!t||"+"!=c&&"-"!=c||"-"==c&&(a=!a);else o+=i,i="",n=!0,t=!1}return""==o?r:o}function _d(e){for(var t=!0,n=!1,s=!1,i="",r="",o=0,a=0,l=!0,c=0;c<e.length;c++){var h=e.charAt(c);if(h>="1"&&h<="9")r+=i+h,i="",s=!0,n||(a++,o++),t=!1;else if("0"==h)n?s?(r+=i+h,i=""):(h,o--):(a++,s?(h,o++,i+=h):h),t=!1;else if(n||"."!=h)if("e"==h||"E"==h&&c+1<e.length){var p=parseInt(e.substring(c+1,e.length));o+=p,a+=p,c=e.length}else!t||"+"!=h&&"-"!=h||"-"==h&&(l=!l);else r+=i,i="",n=!0,t=!1}return""==r?a:o}function Td(e,t){var n=e.length-t-1;if(n<0)return"";if(n>=e.length-1)return e;var s=e.charAt(n+1),i=e.charAt(n),r=!1;if(s>"5")r=!0;else if("5"==s){for(var o=n+2;o<e.length;o++)"0"!=e.charAt(o)&&(r=!0);i%2==1&&(r=!0)}for(var a="",l=n;l>=0;l--){var c=e.charAt(l);if(r){var h;if("9"==c)h="0";else{switch(c){case"0":h="1";break;case"1":h="2";break;case"2":h="3";break;case"3":h="4";break;case"4":h="5";break;case"5":h="6";break;case"6":h="7";break;case"7":h="8";break;case"8":h="9"}r=!1}a=h+a}else a=c+a}return r&&(a="1"+a),a}var Md={exports:{}};Md.exports;const Nd=v.a,Pd=(h.a,i.a),Id=x.b,Ed=ce.firstNumericalParse,Ad=ce.captureScratchpadTouchStart,Rd=G.a.number,Dd=Z,Fd=Dd.toNumericString,Ld=Dd.getNumericFormat,zd=createReactClass({displayName:"NumberInput",getDefaultProps:function(){return{value:null,placeholder:null,format:null,onFormatChange:()=>null,checkValidity:()=>!0,useArrowKeys:!1}},getInitialState:function(){return{format:this.props.format}},render:function(){let e=Nd({"number-input":!0,"invalid-input":!this._checkValidity(this.props.value),mini:"mini"===this.props.size,small:"small"===this.props.size,normal:"normal"===this.props.size});return null!=this.props.className&&(e=e+" "+this.props.className),Object($t.jsx)("input",{...this.props,className:e,type:"text",ref:"input",onChange:this._handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyPress:this._handleBlur,onKeyDown:this._onKeyDown,onTouchStart:Ad,defaultValue:Fd(this.props.value,this.state.format),value:void 0})},componentDidUpdate:function(e){Rd.equal(this.getValue(),this.props.value)||this._setValue(this.props.value,this.state.format)},getValue:function(){return this.parseInputValue(Pd.findDOMNode(this.refs.input).value)},getStringValue:function(){return Pd.findDOMNode(this.refs.input).value.toString()},parseInputValue:function(e){if(""===e){const e=this.props.placeholder;return Id.isFinite(e)?+e:null}{const t=Ed(e);return Id.isFinite(t)?t:this.props.value}},focus:function(){Pd.findDOMNode(this.refs.input).focus(),this._handleFocus()},blur:function(){Pd.findDOMNode(this.refs.input).blur(),this._handleBlur()},setSelectionRange:function(e,t){Pd.findDOMNode(this).setSelectionRange(e,t)},getSelectionStart:function(){return Pd.findDOMNode(this).selectionStart},getSelectionEnd:function(){return Pd.findDOMNode(this).selectionEnd},_checkValidity:function(e){if(null==e)return!0;const t=Ed(e),n=this.props.checkValidity;return Id.isFinite(t)&&n(t)},_handleChange:function(e){const t=e.target.value,n=this.parseInputValue(t),s=Ld(t);this.props.onChange(n),s&&(this.props.onFormatChange(n,s),this.setState({format:s}))},_handleFocus:function(){this.props.onFocus&&this.props.onFocus()},_handleBlur:function(e){e&&"keypress"===e.type&&13!==e.keyCode||(this._setValue(this.props.value,this.state.format),this.props.onBlur&&this.props.onBlur())},_onKeyDown:function(e){if(this.props.onKeyDown&&this.props.onKeyDown(e),!this.props.useArrowKeys||!Id.contains(["ArrowUp","ArrowDown"],e.key))return;let t=this.getValue();t===Math.floor(t)&&("ArrowUp"===e.key?t+=1:"ArrowDown"===e.key&&(t-=1),this._checkValidity(t)&&this.props.onChange(t))},_setValue:function(e,t){l()(Pd.findDOMNode(this.refs.input)).val(Fd(e,t))}});Md.exports=zd;var qd=Md.exports,Wd={exports:{}};Wd.exports;h.a;const Bd=x.b,Vd=hu,Hd=iu,Ud=Kt,Gd=qd,$d="all",Yd="some";var Kd=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()},Xd=createReactClass({displayName:"UnitExample",render:function(){var e;return e=this.state.valid?Object($t.jsxs)("span",{children:[Object($t.jsx)("span",{className:"unit-example-okay",children:Object($t.jsx)(Ud,{...ga})}),this.state.solvedExample]}):Object($t.jsx)("span",{className:"unit-example-not-okay",children:Object($t.jsx)(Ud,{...ma})}),Object($t.jsxs)("div",{children:[e," ",this.props.name]})},componentWillReceiveProps:function(e){this._checkValidity(e)},componentWillMount:function(){this._checkValidity(this.props)},_checkValidity:function(e){let{name:t,original:n,sigfigs:s}=e;var i=U.unitParse(t),r="",o=!0;if(i.parsed&&n){var a=new U.Var("x"),{unit:l}=i,c=new U.Eq(n,"=",new U.Mul(a,l));try{r=function(e,t){return Od(e,t,-10,!1)}(c.solveLinearEquationForVariable(a).eval(),s),o=U.compare(Kd(n),Kd(l)).equal}catch(h){o=!1}}else o=!1;this.setState({valid:o,solvedExample:r})}});const Zd=createReactClass({displayName:"UnitInputEditor",getDefaultProps:function(){return{value:"5x10^5 kg m / s^2",accepting:$d,sigfigs:3}},render:function(){var{acceptingUnits:e,accepting:t}=this.props;e=e||[];var n=null;if(t===Yd){var s=e.map(((e,t)=>Object($t.jsx)(Xd,{name:e,original:this.original||null,sigfigs:this.props.sigfigs},t)));n=Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"text",defaultValue:e.join(", "),onChange:this.handleAcceptingUnitsChange})," ","(comma-separated)",s]})}return Object($t.jsxs)("div",{className:"unit-editor",children:[Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{value:this.props.value,className:"unit-editor-canonical",onBlur:this._handleBlur,onKeyPress:this._handleBlur,onChange:this.onChange})," ",this.parsed?Object($t.jsx)("span",{className:"unit-example-okay",children:Object($t.jsx)(Ud,{...ga})}):Object($t.jsx)("span",{className:"unit-example-not-okay",children:Object($t.jsx)(Ud,{...ma})})]}),Object($t.jsxs)("div",{children:["Significant Figures:"," ",Object($t.jsx)(Gd,{value:this.props.sigfigs,onChange:this.handleSigfigChange,checkValidity:this._checkSigfigValidity,useArrowKeys:!0})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting($d),checked:this.props.accepting===$d})," Any equivalent unit "]}),Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:this.groupId,onChange:()=>this._setAccepting(Yd),checked:this.props.accepting===Yd})," Only these units "]})]}),n]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vd.change.apply(this,t)},handleAcceptingUnitsChange:function(e){var t=e.target.value.split(",").map((e=>e.trim())).filter((e=>""!==e));this.change({acceptingUnits:t})},handleSigfigChange:function(e){this.change({sigfigs:e})},_checkSigfigValidity:function(e){return e>0&&e<=10},_setAccepting:function(e){this.change({accepting:e})},componentWillMount:function(){this.groupId=Bd.uniqueId("accepting"),this._doOriginal(this.props)},componentWillReceiveProps:function(e){this._doOriginal(e)},_doOriginal:function(e){var t=U.unitParse(e.value);this.parsed=!1,t.parsed&&"unitMagnitude"===t.type&&(this.original=t.expr,this.parsed=!0)},onChange:function(e){this.props.onChange({value:e.target.value})},getSaveWarnings:function(){var{value:e,accepting:t,acceptingUnits:n}=this.props,s=[];return U.unitParse(e).parsed||s.push("Answer did not parse"),t===Yd&&0===n.length&&s.push("There are no accepted units"),s},serialize(){return Hd.serialize.call(this)}});Wd.exports=Zd;var Jd=Wd.exports,Qd={exports:{}};Qd.exports;function eg(e,t,n){var s=e.indexOf("{",t)+1,i=function(e,t){for(var n=0,s=t,i=e.length;s<i;s++){var r=e[s];if("{"===r?n++:"}"===r&&n--,n<0)return s}return e.length}(e,s);return{endpoint:i,expression:ng(e.substring(s,i),n)}}function tg(e,t){var n=e.indexOf("\\frac",t),s=e.indexOf("\\dfrac",t);return n>-1&&s>-1?Math.min(n,s):n>-1?n:s>-1?s:-1}function ng(e,t){for(var n="",s=0,i=tg(e,s);i>-1;){n+=e.substring(s,i);var r=eg(e,s=i,t),o=eg(e,s=r.endpoint+1,t);s=o.endpoint+1,n.length&&(n+=" "),n+=t(r.expression,o.expression),i=tg(e,s)}return n+=e.slice(s)}Qd.exports={parseTex:function(e){return ng(e,(function(e,t){return e+"/"+t})).replace("\\%","%")},modifyTex:function(e){function t(e){return e.indexOf("\\frac")>-1||e.indexOf("\\dfrac")>-1}return ng(e,(function(e,n){return(t(e)||t(n)?"\\dfrac":"\\frac")+" {"+e+"}{"+n+"}"}))}};var sg=Qd.exports,ig={exports:{}};ig.exports;h.a;const rg=i.a,og=x.b,ag=Nn.a,lg=Ss.ClassNames,cg=sg.modifyTex,hg=createReactClass({displayName:"MathOutput",getDefaultProps:function(){return{value:"",onFocus:function(){},onBlur:function(){}}},getInitialState:function(){return{focused:!1,selectorNamespace:og.uniqueId("math-output")}},_getInputClassName:function(){let e="math-output "+lg.INPUT+" "+lg.INTERACTIVE;return this.state.focused&&(e+=" "+lg.FOCUSED),this.props.className&&(e+=" "+this.props.className),e},_getDisplayValue:function(e){let t;return t=null!=e?""+e:"",cg(t)},render:function(){return Object($t.jsx)("span",{ref:"input",className:this._getInputClassName(),"aria-label":this.props.labelText,onMouseDown:this.focus,onTouchStart:this.focus,children:Object($t.jsx)("div",{style:{textAlign:"center"},children:Object($t.jsx)(ag,{children:this._getDisplayValue(this.props.value)})})})},getValue:function(){return this.props.value},focus:function(){this.state.focused||(this.props.onFocus(),this._bindBlurHandler(),this.setState({focused:!0}))},blur:function(){this.state.focused&&(this.props.onBlur(),this._unbindBlurHandler(),this.setState({focused:!1}))},_bindBlurHandler:function(){l()(document).bind("vclick."+this.state.selectorNamespace,(e=>{l()(e.target).closest(rg.findDOMNode(this)).length||this.blur()}))},_unbindBlurHandler:function(){l()(document).unbind("."+this.state.selectorNamespace)},componentWillUnmount:function(){this._unbindBlurHandler()}});ig.exports=hg;var pg=ig.exports,ug={exports:{}},dg=(ug.exports,Qh),gg=h.a,fg=i.a,mg=x.b,bg=Ss.ClassNames,vg=Ss.Options,xg=hu,yg=pg,jg=function(e){return new wd(e).sigFigs},wg=createReactClass({displayName:"OldUnitInput",getDefaultProps:function(){return{apiOptions:vg.defaults,value:""}},render:function(){var e=(this.props.apiOptions.staticRender?gg.createFactory(yg):ReactDOMtags.input)({onChange:this.handleChange,ref:"input",className:bg.INTERACTIVE,value:this.props.value,onFocus:this.handleFocus,onBlur:this.handleBlur});return Object($t.jsxs)("div",{className:"old-unit-input",children:[e,Object($t.jsx)("div",{ref:"error",className:"error",style:{display:"none"},children:i18n._("I don't understand that")})]})},_errorTimeout:null,_showError:function(){if(""!==this.props.value){var e=$(fg.findDOMNode(this.refs.error));e.is(":visible")||e.css({top:50,opacity:.1}).show().animate({top:0,opacity:1},300)}},_hideError:function(){var e=$(fg.findDOMNode(this.refs.error));e.is(":visible")&&e.animate({top:50,opacity:.1},300,(function(){$(this).hide()}))},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xg.change.apply(this,t)},componentDidUpdate:function(){clearTimeout(this._errorTimeout),U.unitParse(this.props.value).parsed?this._hideError():this._errorTimeout=setTimeout(this._showError,2e3)},componentWillUnmount:function(){clearTimeout(this._errorTimeout)},handleBlur:function(){this.props.onBlur([]),clearTimeout(this._errorTimeout),U.unitParse(this.props.value).parsed||this._showError()},handleChange:function(e){this._hideError(),this.props.onChange({value:e.target.value})},simpleValidate:function(e,t){return t=t||function(){},wg.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.value},getInputPaths:function(){return[[]]},focusInputPath:function(e){fg.findDOMNode(this.refs.input).focus()},handleFocus:function(){this.props.onFocus([])},blurInputPath:function(e){fg.findDOMNode(this.refs.input).blur()},setInputValue:function(e,t,n){this.props.onChange({value:t},n)},getDOMNodeForPath:function(){return fg.findDOMNode(this.refs.input)},getGrammarTypeForPath:function(e){return"unit"}}),Og=function(e){return e.simplify().asMul().partition()[1].flatten().simplify()};mg.extend(wg,{validate:function(e,t){var n=U.unitParse(t.value).expr,s=U.unitParse(e);if(!s.parsed)return{type:"invalid",message:i18n._("I couldn't understand those units.")};var i,r,o=null,a=t.sigfigs,l=jg(s.coefficient)===a;l||(o=i18n._("Check your significant figures."));try{var c=new U.Var("x"),h=new U.Eq(n.simplify(),"=",new U.Mul(c,s.expr.simplify())).solveLinearEquationForVariable(c);i=Number(h.eval()).toPrecision(a)===Number(1).toPrecision(a)}catch(d){i=!1}i||(o=i18n._("That answer is numerically incorrect."));var p=Og(s.expr.simplify()),u=Og(n.simplify());if(!(r="all"===t.accepting?U.compare(p,u).equal:t.acceptingUnits.some((e=>{var t=Og(U.unitParse(e).unit.simplify());return U.compare(t,p).equal}))))o=i18n._("Check your units.");return{type:"points",earned:r&&i&&l?1:0,total:1,message:o}}}),ug.exports={name:"unit-input",displayName:"Unit",defaultAlignment:"inline-block",widget:wg,transform:e=>dg(e).del(["value"]).freeze(),version:{major:0,minor:1},countSigfigs:jg,sigfigPrint:function(e,t){return Od(e,t,-10,!1)},hidden:!0};var Cg=ug.exports,Sg={exports:{}};Sg.exports;h.a;const{KeypadInput:kg}=ye.a.components,{KeypadTypes:_g}=ye.a.consts,{keypadElementPropType:Tg}=ye.a.propTypes,Mg=createReactClass({displayName:"SimpleKeypadInput",focus(){this.refs.input.focus()},blur(){this.refs.input.blur()},getValue:function(){return this.props.value},render(){const{keypadElement:e,onFocus:t,value:n,...s}=this.props;return Object($t.jsx)(kg,{ref:"input",keypadElement:e,onFocus:()=>{e?e.configure({keypadType:_g.FRACTION},(()=>{this.isMounted()&&t&&t()})):t&&t()},value:null==n?"":""+n,...s})}});Sg.exports=Mg;var Ng=Sg.exports,Pg={exports:{}};Pg.exports;h.a;const Ig=i.a,Eg=x.b,Ag=ce,Rg=Kr,Dg=Sc,Fg={url:null},Lg={fontStyle:"italic",fontWeight:"bold",fontSize:"32px",width:"100%",height:"100%",textAlign:"center",backgroundColor:"white",position:"absolute",zIndex:1,transition:"opacity .25s ease-in-out","-moz-transition":"opacity .25s ease-in-out","-webkit-transition":"opacity .25s ease-in-out"},zg={position:"relative",top:"25%"};const qg=createReactClass({displayName:"Graph",getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[.5,.5],markings:"graph",backgroundImage:Fg,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,instructions:null,onGraphieUpdated:null,onClick:null,onMouseDown:null,isMobile:!1}},render:function(){let e;const t=this.props.backgroundImage;if(t.url){const n=this.props.box[0]/vn;e=Object($t.jsx)(Dg,{src:t.url,width:t.width,height:t.height,scale:n,responsive:!1})}else e=null;return Object($t.jsxs)("div",{className:"graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]},onMouseOut:this.onMouseOut,onMouseOver:this.onMouseOver,onClick:this.onClick,children:[e,Object($t.jsx)("div",{className:"graphie",ref:"graphieDiv"})]})},componentDidMount:function(){this._setupGraphie(!0)},componentDidUpdate:function(){this._hasSetupGraphieThisUpdate=!1,this._shouldSetupGraphie&&(this._setupGraphie(!1),this._shouldSetupGraphie=!1)},componentWillReceiveProps:function(e){const t=this;Eg.each(["labels","range","step","markings","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep"],(function(n){Eg.isEqual(t.props[n],e[n])||(t._shouldSetupGraphie=!0)}))},reset:function(){this._setupGraphie(!1)},graphie:function(){return this._graphie},pointsFromNormalized:function(e,t){const n=this;return Eg.map(e,(function(e){return Eg.map(e,(function(e,s){const i=n.props.range[s];if(t)return i[0]+(i[1]-i[0])*e;{const t=n.props.step[s],r=function(e,t){return Math.floor((e[1]-e[0])/t)}(i,t),o=Math.round(e*r);return i[0]+t*o}}))}))},_setupGraphie:function(e){if(this._hasSetupGraphieThisUpdate)return;const t=Ig.findDOMNode(this.refs.graphieDiv);$(t).empty();const n=this.props.labels,s=this.props.range,i=this._graphie=Rg.createGraphie(t),r=this._getGridConfig();i.snap=this.props.snapStep,"graph"===this.props.markings?(i.graphInit({range:s,scale:Eg.pluck(r,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:this.props.gridStep,tickStep:Eg.pluck(r,"tickStep"),labelStep:1,unityLabels:Eg.pluck(r,"unityLabel"),isMobile:this.props.isMobile}),i.label([0,s[1][1]],n[1],this.props.isMobile?"below right":"above"),i.label([s[0][1],0],n[0],this.props.isMobile?"above left":"right")):"grid"===this.props.markings?i.graphInit({range:s,scale:Eg.pluck(r,"scale"),gridStep:this.props.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:this.props.isMobile}):"none"===this.props.markings&&i.init({range:s,scale:Eg.pluck(r,"scale"),isMobile:this.props.isMobile});let o;if(this.props.instructions){o=$("<div/>"),Eg.each(Lg,(function(e,t){o.css(t,e)})),o.css("opacity",.5);const e=$("<span/>",{text:this.props.instructions});Eg.each(zg,(function(t,n){e.css(n,t)})),o.append(e),$(t).append(o)}else o=void 0;const a=o||this.props.onMouseDown?Eg.bind((function(e){o&&(o.remove(),o=null),this.props.onMouseDown(e)}),this):null,l=o?function(){o&&o.css("opacity",0)}:null,c=o?function(){o&&o.css("opacity",.5)}:null;i.addMouseLayer({onClick:this.props.onClick,onMouseDown:a,onMouseOver:l,onMouseOut:c,onMouseUp:this.props.onMouseUp,onMouseMove:this.props.onMouseMove,allowScratchpad:!0,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable}),this._updateProtractor(),this._updateRuler(),this._hasSetupGraphieThisUpdate=!0,!e&&this.props.onGraphieUpdated&&this.props.onGraphieUpdated(i)},_getGridConfig:function(){const e=this;return Eg.map(e.props.step,(function(t,n){return Ag.gridDimensionConfig(t,e.props.range[n],e.props.box[n],e.props.gridStep[n])}))},_updateProtractor:function(){if(this.protractor&&this.protractor.remove(),this.props.showProtractor){const e=this.pointsFromNormalized([[.5,.05]])[0];this.protractor=this._graphie.protractor(e)}},_updateRuler:function(){if(this.ruler&&this.ruler.remove(),this.props.showRuler){const e=this.pointsFromNormalized([[.5,.25]])[0],t=this._graphie.range[0][1]-this._graphie.range[0][0];this.ruler=this._graphie.ruler({center:e,label:this.props.rulerLabel,pixelsPerUnit:this._graphie.scale[0],ticksPerUnit:this.props.rulerTicks,units:Math.round(.8*t)})}},toJSON:function(){return Eg.pick(this.props,"range","step","markings","labels","backgroundImage","showProtractor","showRuler","rulerLabel","rulerTicks","gridStep","snapStep")}});Pg.exports=qg;var Wg=Pg.exports,Bg={exports:{}},Vg=(Bg.exports,h.a,i.a),Hg=x.b,Ug=Wg;const Gg=Kt;var $g=qd,Yg=pg,Kg=Nn.a;const Xg=Ng;var Zg=Ss.Options;const{keypadElementPropType:Jg}=ye.a.propTypes;var Qg=ce.deepEq,ef=ce.getGridStep,tf=ce.captureScratchpadTouchStart,nf=G.a.number,sf=G.a.vector,rf=G.a.point,of=G.a.ray,af=G.a.line;const lf=Z,cf=Mi;var hf=ki.assert,pf={url:null};var uf={apiOptions:Zg.defaults,gradeEmpty:!1,graphMode:"interactive",listMode:"dynamic",graph:{},tools:{translation:{enabled:!0,required:!1,constraints:{}},rotation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[1,6]},reflection:{enabled:!0,required:!1,constraints:{fixed:!1},coords:[[2,-4],[2,2]]},dilation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[6,6]}},drawSolutionShape:!0,starting:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]},correct:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]}};function df(e){return e.constraints.fixed?cf.DYNAMIC:cf.INTERACTIVE}function gf(e){return String(lf.roundTo(9,e))}function ff(e){return[Object($t.jsx)(Kg,{children:"("}),gf(e[0]),Object($t.jsx)(Kg,{children:", {}"}),gf(e[1]),Object($t.jsx)(Kg,{children:")"})]}function mf(e,t){return e=Hg.clone(e).sort(rf.compare),t=Hg.clone(t).sort(rf.compare),Hg.all(Hg.map(e,(function(e,n){var s=t[n];return rf.equal(e,s)})))}const bf=e=>e.customKeypad?Xg:e.staticRender?Yg:$g;var vf={apply:function(e){return xf[e.type].isValid(e)?xf[e.type].apply(e):Hg.identity},append:function(e,t){var n=vf._appendAndCollapseLastTwo(e,t);return vf._collapseFinalNoOps(n)},_collapseFinalNoOps:function(e){return e.length&&vf.isNoOp(Hg.last(e))?Hg.initial(e):e},_appendAndCollapseLastTwo:function(e,t){if(e.length){var n=vf.collapse(Hg.last(e),t);return Hg.initial(e).concat(n)}return[t]},isNoOp:function(e){return xf[e.type].isNoOp(e)},collapse:function(e,t){return e.type!==t.type?[e,t]:vf.isEmpty(e)&&vf.isEmpty(t)?[]:vf.isValid(e)&&vf.isValid(t)?vf._collapseValidMonotypedTransforms(e,t):[e,t]},isValid:function(e){return xf[e.type].isValid(e)},isEmpty:function(e){return xf[e.type].isEmpty(e)},_collapseValidMonotypedTransforms:function(e,t){var n=xf[e.type].collapse(e,t);return n?(Hg.isArray(n)||(n=[n]),Hg.each(n,(function(t){t.type=e.type})),n):[e,t]},toTeX:function(e){return xf[e.type].toTeX(e)},ListItem:createReactClass({displayName:"ListItem",render:function(){if("dynamic"===this.props.mode)return Object($t.jsx)("div",{children:vf.toTeX(this.props.transform)});if("interactive"===this.props.mode){var e=xf[this.props.transform.type].Input;return Object($t.jsx)(e,{ref:"transform",onChange:this.handleChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions,...this.props.transform})}throw new Error("Invalid mode: "+this.props.mode)},value:function(){return"interactive"===this.props.mode?Hg.extend({type:this.props.transform.type},this.refs.transform.value()):this.props.transform},handleChange:Hg.debounce((function(e){this.props.onChange(this.value(),e)}),300),_getComponentAtPath:function(e){var t=this.refs.transform,n=Hg.head(e);return t.refs[n]},focus:function(){var e=this.refs.transform,t=Hg.head(e.getInputPaths());t&&this.focusInputPath(t)},focusInputPath:function(e){this._getComponentAtPath(e).focus()},blurInputPath:function(e){this._getComponentAtPath(e).blur()},getDOMNodeForPath:function(e){return Vg.findDOMNode(this._getComponentAtPath(e))},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){t.length&&(t=parseFloat(t),isNaN(t))||this.refs.transform.setInputValue(e,t,n)},getInputPaths:function(){return"dynamic"===this.props.mode?[]:this.refs.transform.getInputPaths()}})},xf={translation:{verbName:i18n._("Translate"),nounName:i18n._("Translation"),lowerNounName:i18n._("translation"),apply:function(e){return function(t){return sf.add(t,e.vector)}},isValid:function(e){return Hg.isFinite(e.vector[0])&&Hg.isFinite(e.vector[1])},isEmpty:function(e){return null===e.vector[0]&&null===e.vector[1]},isNoOp:function(e){return sf.equal(e.vector,[0,0])},collapse:function(e,t){return{vector:sf.add(e.vector,t.vector)}},toTeX:function(e){return $_({vector:(t=e.vector,[Object($t.jsx)(Kg,{children:"\\langle"}),gf(t[0]),Object($t.jsx)(Kg,{children:", {}"}),gf(t[1]),Object($t.jsx)(Kg,{children:"\\rangle"})])},"Translation by %(vector)s");var t},Input:createReactClass({displayName:"Input",getInitialState:function(){return{vector:this.props.vector||[null,null]}},componentDidUpdate:function(e){Qg(this.props,e)||this.setState({vector:this.props.vector})},render:function(){const e=bf(this.props.apiOptions);var t=[Object($t.jsx)(Kg,{children:"\\langle"}),Object($t.jsx)(e,{ref:"x",placeholder:0,value:this.state.vector[0],useArrowKeys:!0,onChange:e=>{var t=this.state.vector[1];this.setState({vector:[e,t]},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"x"),onBlur:Hg.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:", {}"}),Object($t.jsx)(e,{ref:"y",placeholder:0,value:this.state.vector[1],useArrowKeys:!0,onChange:e=>{var t=this.state.vector[0];this.setState({vector:[t,e]},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"y"),onBlur:Hg.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:"\\rangle"})];return Object($t.jsx)("div",{children:$_({vector:t},"Translation by %(vector)s")})},value:function(){return{vector:[this.refs.x.getValue(),this.refs.y.getValue()]}},setInputValue:function(e,t,n){var s=Hg.first(e),i=Hg.clone(this.state.vector);"x"===s?i[0]=t:"y"===s&&(i[1]=t),this.setState({vector:i},(()=>{this.props.onChange(n)}))},getInputPaths:function(){return[["x"],["y"]]}})},rotation:{verbName:i18n._("Rotate"),nounName:i18n._("Rotation"),lowerNounName:i18n._("rotation"),apply:function(e){return function(t){return rf.rotateDeg(t,e.angleDeg,e.center)}},isValid:function(e){return Hg.isFinite(e.angleDeg)&&Hg.isFinite(e.center[0])&&Hg.isFinite(e.center[1])},isEmpty:function(e){return null===e.angleDeg&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return nf.equal(e.angleDeg,0)},collapse:function(e,t){return!!rf.equal(e.center,t.center)&&{center:e.center,angleDeg:e.angleDeg+t.angleDeg}},toTeX:function(e){return $_({degrees:(t=e.angleDeg,gf(t)+"\xb0"),point:ff(e.center)},"Rotation by %(degrees)s about %(point)s");var t},Input:createReactClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],angleDeg:this.props.angleDeg||null}},componentDidUpdate:function(e){Qg(this.props,e)||this.setState({center:this.props.center,angleDeg:this.props.angleDeg})},render:function(){const e=bf(this.props.apiOptions);var t=[Object($t.jsx)(Kg,{children:"("}),Object($t.jsx)(e,{ref:"centerX",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:e=>{var t=this.state.center[1];this.setState({center:[e,t]},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"centerX"),onBlur:Hg.partial(this.props.onBlur,"centerX"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:", {}"}),Object($t.jsx)(e,{ref:"centerY",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:e=>{var t=this.state.center[0];this.setState({center:[t,e]},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"centerY"),onBlur:Hg.partial(this.props.onBlur,"centerY"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:")"})],n=[Object($t.jsx)(e,{ref:"angleDeg",placeholder:0,value:this.state.angleDeg,useArrowKeys:!0,onChange:e=>{this.setState({angleDeg:e},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"angleDeg"),onBlur:Hg.partial(this.props.onBlur,"angleDeg"),keypadElement:this.props.keypadElement}),"\xb0"],s=$_({point:t,degrees:n},"Rotation about %(point)s by %(degrees)s");return Object($t.jsx)("div",{children:s})},value:function(){return{angleDeg:this.refs.angleDeg.getValue(),center:[this.refs.centerX.getValue(),this.refs.centerY.getValue()]}},setInputValue:function(e,t,n){var s=Hg.first(e),i=Hg.clone(this.state.angleDeg),r=Hg.clone(this.state.center);"angleDeg"===s?i=t:"centerX"===s?r[0]=t:"centerY"===s&&(r[1]=t),this.setState({angleDeg:i,center:r},(()=>{this.props.onChange(n)}))},getInputPaths:function(){return[["centerX"],["centerY"],["angleDeg"]]}})},reflection:{verbName:i18n._("Reflect"),nounName:i18n._("Reflection"),lowerNounName:i18n._("reflection"),apply:function(e){return function(t){return rf.reflectOverLine(t,e.line)}},isValid:function(e){return Hg.all(Hg.flatten(e.line),Hg.isFinite)&&!rf.equal(e.line[0],e.line[1])},isEmpty:function(e){return Hg.all(Hg.flatten(e.line),Hg.isNull)},isNoOp:function(e){return!1},collapse:function(e,t){return!!af.equal(e.line,t.line)&&[]},toTeX:function(e){var t=e.line[0],n=e.line[1];return $_({point1:ff(t),point2:ff(n)},"Reflection over the line from %(point1)s to %(point2)s")},Input:createReactClass({displayName:"Input",getInitialState:function(){return{line:this.props.line||[[null,null],[null,null]]}},componentDidUpdate:function(e){Qg(this.props,e)||this.setState({line:this.props.line})},render:function(){const e=bf(this.props.apiOptions);var t=[Object($t.jsx)(Kg,{children:"("}),Object($t.jsx)(e,{ref:"x1",value:this.state.line[0][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,0),onFocus:Hg.partial(this.props.onFocus,"x1"),onBlur:Hg.partial(this.props.onBlur,"x1"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:", {}"}),Object($t.jsx)(e,{ref:"y1",value:this.state.line[0][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,0,1),onFocus:Hg.partial(this.props.onFocus,"y1"),onBlur:Hg.partial(this.props.onBlur,"y1"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:")"})],n=[Object($t.jsx)(Kg,{children:"("}),Object($t.jsx)(e,{ref:"x2",value:this.state.line[1][0],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,0),onFocus:Hg.partial(this.props.onFocus,"x2"),onBlur:Hg.partial(this.props.onBlur,"x2"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:", {}"}),Object($t.jsx)(e,{ref:"y2",value:this.state.line[1][1],useArrowKeys:!0,onChange:this.changePoint.bind(this,1,1),onFocus:Hg.partial(this.props.onFocus,"y2"),onBlur:Hg.partial(this.props.onBlur,"y2"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:")"})];return Object($t.jsx)("div",{children:$_({point1:t,point2:n},"Reflection over the line from %(point1)s to %(point2)s")})},changePoint:function(e,t,n,s){var i=Hg.map(this.state.line,Hg.clone);i[e][t]=n,this.setState({line:i},(()=>{this.props.onChange(s)}))},value:function(){return{line:[[this.refs.x1.getValue(),this.refs.y1.getValue()],[this.refs.x2.getValue(),this.refs.y2.getValue()]]}},setInputValue:function(e,t,n){var s,i,r=Hg.first(e);"x"===r[0]?s=0:"y"===r[0]&&(s=1),"1"===r[1]?i=0:"2"===r[1]&&(i=1),this.changePoint(i,s,t,n)},getInputPaths:function(){return[["x1"],["y1"],["x2"],["y2"]]}})},dilation:{verbName:i18n._("Dilate"),nounName:i18n._("Dilation"),lowerNounName:i18n._("dilation"),apply:function(e){return function(t){return function(e,t,n){var s=sf.subtract(e,t),i=sf.scale(s,n);return sf.add(t,i)}(t,e.center,e.scale)}},isValid:function(e){return Hg.isFinite(e.scale)&&Hg.isFinite(e.center[0])&&Hg.isFinite(e.center[1])},isEmpty:function(e){return null===e.scale&&null===e.center[0]&&null===e.center[1]},isNoOp:function(e){return nf.equal(e.scale,1)},collapse:function(e,t){return!!rf.equal(e.center,t.center)&&{center:e.center,scale:e.scale*t.scale}},toTeX:function(e){var t=function(e){var t=lf.toFraction(e,nf.DEFAULT_TOLERANCE);return 1===t[1]?gf(e):gf(t[0])+"/"+gf(t[1])}(e.scale);return $_({scale:t,point:ff(e.center)},"Dilation of scale %(scale)s about %(point)s")},Input:createReactClass({displayName:"Input",getInitialState:function(){return{center:this.props.center||[null,null],scale:this.props.scale||null}},componentDidUpdate:function(e){Qg(this.props,e)||this.setState({center:this.props.center,scale:this.props.scale})},render:function(){const e=bf(this.props.apiOptions);var t=[Object($t.jsx)(Kg,{children:"("}),Object($t.jsx)(e,{ref:"x",placeholder:0,value:this.state.center[0],useArrowKeys:!0,onChange:e=>{var t=this.state.center[1];this.setState({center:[e,t]},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"x"),onBlur:Hg.partial(this.props.onBlur,"x"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:", {}"}),Object($t.jsx)(e,{ref:"y",placeholder:0,value:this.state.center[1],useArrowKeys:!0,onChange:e=>{var t=this.state.center[0];this.setState({center:[t,e]},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"y"),onBlur:Hg.partial(this.props.onBlur,"y"),keypadElement:this.props.keypadElement}),Object($t.jsx)(Kg,{children:")"})],n=Object($t.jsx)(e,{ref:"scale",placeholder:1,value:this.state.scale,useArrowKeys:!0,onChange:e=>{this.setState({scale:e},(()=>{this.props.onChange()}))},onFocus:Hg.partial(this.props.onFocus,"scale"),onBlur:Hg.partial(this.props.onBlur,"scale"),keypadElement:this.props.keypadElement});return Object($t.jsx)("div",{children:$_({point:t,scale:n},"Dilation about %(point)s by %(scale)s")})},value:function(){return{scale:this.refs.scale.getValue(),center:[this.refs.x.getValue(),this.refs.y.getValue()]}},setInputValue:function(e,t,n){var s=Hg.first(e),i=this.state.scale,r=Hg.clone(this.state.center);"x"===s?r[0]=t:"y"===s?r[1]=t:"scale"===s&&(i=t),this.setState({scale:i,center:r},(()=>{this.props.onChange(n)}))},getInputPaths:function(){return[["x"],["y"],["scale"]]}})}},yf={getPointCountForType:function(e){var t=e.split("-");return"polygon"===t[0]?t[1]||3:"line"===t[0]||"lineSegment"===t[0]?2:"angle"===t[0]?3:"circle"===t[0]?2:"point"===t[0]?1:void 0},addMovableShape:function(e,t){if(t.editable&&t.translatable)throw new Error("It doesn't make sense to have a movable shape where you can stretch the points and translate them simultaneously. options: "+JSON.stringify(t));var n,s=Hg.map(t.shape.coords,(function(i){var r,o=!1,a=i;return r=e.addMovablePoint({coord:i,normalStyle:t.normalPointStyle,highlightStyle:t.highlightPointStyle,constraints:{fixed:!t.translatable&&!t.editable},visible:t.showPoints,snapX:t.snap&&t.snap[0]||0,snapY:t.snap&&t.snap[1]||0,bounded:!1,onMove:function(e,i){o||(a=r.coord,o=!0);var l=sf.subtract([e,i],r.coord);t.onMove&&(l=t.onMove(l[0],l[1])),t.translatable&&Hg.each(s,(function(e){e!==r&&e.setCoord(sf.add(e.coord,l))}));var c=r.coord,h=sf.add(r.coord,l);return r.coord=h,n.update(),r.coord=c,h},onMoveEnd:function(){if(t.onMoveEnd&&o){o=!1;var e=sf.subtract(r.coord,a);t.onMoveEnd(e[0],e[1])}n.update()}}),r.bounded=!0,r})),i=(n=yf.addShape(e,t,s)).remove;return n.remove=function(){i.apply(n),Hg.invoke(s,"remove")},n},addShape:function(e,t,n){n=n||t.shape.coords;var s=yf._typesOf(t.shape),i=t.shape.options||yf.defaultOptions(s),r=yf._mapTypes(s,n,(function(n,s,r){var o=Hg.extend({},t,i[r]);return yf._addType(e,n,s,o)})),o=Hg.filter(Hg.pluck(r,"update"),Hg.identity),a=Hg.filter(Hg.pluck(r,"remove"),Hg.identity),l=function(){return Hg.map(r,(function(e){return e.getOptions?e.getOptions():{}}))};return{type:s,points:n,update:function(){Hg.invoke(o,"call")},remove:function(){Hg.invoke(a,"call")},toJSON:function(){var e=Hg.map(n,(function(e){return Hg.isArray(e)?e:e.coord}));return{type:s,coords:e,options:l()}},getOptions:l}},equal:function(e,t){var n=yf._typesOf(e),s=yf._typesOf(t);if(n.length!==s.length)return!1;var i=yf._mapTypes(n,e.coords,yf._combine),r=yf._mapTypes(s,t.coords,yf._combine);return Hg.all(Hg.map(i,(function(e,t){var n=r[t];return e.type===n.type&&yf._forType(e.type).equal(e.coords,n.coords)})))},_typesOf:function(e){var t=e.type;return Hg.isArray(t)||(t=[t]),Hg.map(t,(function(e){return"polygon"===e?"polygon-3":e}))},defaultOptions:function(e){return Hg.map(e,(function(e){var t=yf._forType(e).defaultOptions;return Hg.extend({},t)}))},_forType:function(e){var t=e.split("-")[0];return yf[t]},_mapTypes:function(e,t,n,s){return Hg.map(e,(function(e,i){var r=yf.getPointCountForType(e),o=Hg.first(t,r);return t=Hg.rest(t,r),n.call(s,e,o,i)}))},_addType:function(e,t,n,s){var i=Hg.isArray(n[0])?{coordA:n[0],coordZ:n[1]}:{pointA:n[0],pointZ:n[1]};if("polygon"===(t=t.split("-")[0])){var r=e.addMovablePolygon(Hg.extend({},s,{fixed:!s.editable,snapX:s.snap&&s.snap[0]||0,snapY:s.snap&&s.snap[1]||0,points:n,constrainToGraph:!1}));return{update:r.transform.bind(r),remove:r.remove.bind(r)}}if("line"===t||"lineSegment"===t){var o=e.addMovableLineSegment(Hg.extend({},s,i,{movePointsWithLine:!0,fixed:!0,constraints:{fixed:!0},extendLine:"line"===t}));return{update:o.transform.bind(o,!0),remove:o.remove.bind(o)}}if("angle"===t){var a=!!s.editable&&null,l=e.addMovableAngle({angleLabel:"$deg0",fixed:!0,points:n,normalStyle:s.normalStyle,reflex:s.reflex});return Hg.isArray(n[0])||s.editable||(n[0].remove(),n[2].remove()),{update:l.update.bind(l,a),remove:l.remove.bind(l),getOptions:function(){return{reflex:l.isReflex()}}}}if("circle"===t){var c={remove:Hg.identity},h=function(){var t=n[0].coord||n[0],i=n[1].coord||n[1],r=rf.distanceToPoint(t,i);c.remove(),c=e.circle(t,r,Hg.extend({stroke:cf.DYNAMIC,"stroke-width":2},s.normalStyle))};return h(),n[1].remove&&!s.editable&&n[1].remove(),{update:h,remove:function(){c.remove()}}}if("point"===t)return{update:null,remove:null};throw new Error("Invalid shape type "+t)},_combine:function(e,t){return{type:e,coords:t}},polygon:{equal:mf},line:{equal:af.equal},lineSegment:{equal:mf},angle:{equal:function(e,t){if(!rf.equal(e[1],t[1]))return!1;var n=[e[1],e[0]],s=[e[1],e[2]],i=[t[1],t[0]],r=[t[1],t[2]],o=of.equal(n,i)&&of.equal(s,r),a=of.equal(n,r)&&of.equal(s,i);return o||a},defaultOptions:{reflex:!1}},circle:{equal:function(e,t){var n=rf.distanceToPoint(e[0],e[1]),s=rf.distanceToPoint(t[0],t[1]);return rf.equal(e[0],t[0])&&nf.equal(n,s)}},point:{equal:rf.equal}},jf=vf.ListItem,wf=createReactClass({displayName:"TransformationList",render:function(){if("static"===this.props.mode)return Object($t.jsx)("span",{});var e=Hg.map(this.props.transformations,(function(e,t){return Object($t.jsx)(jf,{ref:"transformation"+t,transform:e,mode:this.props.mode,onChange:this.handleChange,onFocus:Hg.partial(this.props.onFocus,""+t),onBlur:Hg.partial(this.props.onBlur,""+t),keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions},"transformation"+t)}),this);return Object($t.jsx)("div",{className:"perseus-transformation-list",children:e})},_transformationRefs:function(){return Hg.times(this.props.transformations.length,(e=>this.refs["transformation"+e]))},value:function(){return Hg.invoke(this._transformationRefs(),"value")},handleChange:function(e,t){this.props.onChange(this.value(),t)},focusLast:function(){var e=this._transformationRefs();0!==e.length&&Hg.last(e).focus()}}),Of=createReactClass({displayName:"ToolButton",render:function(){var e=this.props.toggled?"simple-button exercise-orange toggled highlighted-tool-button":"simple-button";return Object($t.jsx)("button",{type:"button",className:e,disabled:this.props.disabled,onClick:this.props.onClick,onTouchStart:tf,children:this.props.children})}}),Cf=createReactClass({displayName:"ToolsBar",getInitialState:function(){return{selected:null}},render:function(){var e=Hg.map(xf,(function(e,t){if(this.props.enabled[t])return Object($t.jsx)(Of,{disabled:this.props.apiOptions.readOnly,toggled:this.state.selected===t,onClick:this.changeSelected.bind(this,t),children:e.verbName},t)}),this);return Object($t.jsxs)("div",{className:"transformer-tools-bar",children:[Object($t.jsx)("span",{className:"simple-button-group",children:e}),Object($t.jsxs)("button",{className:"transformer-undo-button simple-button",type:"button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onUndoClick,onTouchStart:tf,children:[Object($t.jsx)(Gg,{...ja})," "+i18n._("Undo")]}),Object($t.jsx)("div",{className:"clear"})]})},changeSelected:function(e){this.props.removeTool(this.state.selected),e&&e!==this.state.selected?(this.props.addTool(e),this.setState({selected:e})):this.setState({selected:null})}}),Sf=createReactClass({displayName:"AddTransformBar",render:function(){var e=Hg.map(xf,(function(e,t){if(this.props.enabled[t])return Object($t.jsxs)(Of,{toggled:!1,disabled:this.props.apiOptions.readOnly,onClick:this.changeSelected.bind(this,t),children:[Object($t.jsx)(Gg,{...fa})," ",e.nounName]},t)}),this);return Object($t.jsxs)("div",{className:"transformer-tools-bar",children:[e,Object($t.jsxs)("button",{className:"transformer-undo-button simple-button",type:"button",onClick:this.props.onUndoClick,disabled:this.props.apiOptions.readOnly,onTouchStart:tf,children:[Object($t.jsx)(Gg,{...ja})," "+i18n._("Undo")]}),Object($t.jsx)("div",{className:"clear"})]})},changeSelected:function(e){e&&this.props.addTool(e)}}),kf=createReactClass({displayName:"Transformer",getDefaultProps:function(){return Hg.defaults({transformations:[]},uf)},render:function(){var e,t,n=Hg.extend(function(e,t){var n=(e=e||{}).labels||["x","y"],s=e.range||[[-10,10],[-10,10]],i=e.step||[1,1];return{box:[t,t],labels:n,range:s,step:i,gridStep:e.gridStep||ef(s,i,t),valid:!0,backgroundImage:pf,markings:"grid",showProtractor:!1}}(this.props.graph,400),this.props.graph),s="interactive"===this.props.graphMode,i=s?Cf:Sf,r=Object($t.jsx)("div",{style:{width:n.box[0]},children:Object($t.jsx)(i,{ref:"toolsBar",enabled:(e=this.props.tools,t="enabled",Hg.object(Hg.map(e,(function(e,n){return[n,e[t]]})))),apiOptions:this.props.apiOptions,addTool:this.addTool,removeTool:this.removeTool,onUndoClick:this.handleUndoClick})});return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-transformer",children:[Object($t.jsx)(Ug,{ref:"graph",box:n.box,range:n.range,labels:n.labels,step:n.step,gridStep:n.gridStep,markings:n.markings,backgroundImage:n.backgroundImage,showProtractor:n.showProtractor,onGraphieUpdated:this.setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!s&&"Add transformations below:","static"===this.props.graphMode&&[Object($t.jsx)("br",{},"static-br"),Object($t.jsxs)("em",{children:[" ","Note: For this question, the shape will not move."," "]},"static-nomove")],s&&r,Object($t.jsx)(wf,{ref:"transformationList",mode:this.props.listMode,transformations:this.props.transformations,onChange:this.setTransformationProps,onFocus:this._handleFocus,onBlur:this._handleBlur,keypadElement:this.props.keypadElement,apiOptions:this.props.apiOptions}),!s&&r]})},componentDidMount:function(){this.setupGraphie(this.graphie())},componentDidUpdate:function(e){this.shouldSetupGraphie(this.props,e)?this.refs.graph.reset():Qg(this.props.transformations,this.transformations)||this.setTransformations(this.props.transformations)},shouldSetupGraphie:function(e,t){return!Qg(t.starting,e.starting)||(t.graphMode!==e.graphMode||(t.listMode!==e.listMode||(t.drawSolutionShape!==e.drawSolutionShape||(!(!e.drawSolutionShape||Qg(t.correct.shape,e.correct.shape))||!Qg(this.tools,e.tools)))))},graphie:function(){return this.refs.graph.graphie()},setupGraphie:function(e){this.props.drawSolutionShape&&this.props.correct.shape&&this.props.correct.shape.coords&&yf.addShape(e,{fixed:!0,shape:this.props.correct.shape,normalStyle:{stroke:cf.GRAY,"stroke-dasharray":"","stroke-width":2}}),this.currentTool=null,this.refs.toolsBar.changeSelected(null),this.addTransformerShape(this.props.starting.shape,!1),this.setTransformations(this.props.transformations),this.tools={translation:Hg.clone(this.props.tools.translation),rotation:Hg.clone(this.props.tools.rotation),reflection:Hg.clone(this.props.tools.reflection),dilation:Hg.clone(this.props.tools.dilation)}},setTransformations:function(e){this.resetCoords(),this.transformations=Hg.clone(e),Hg.each(this.transformations,this.applyTransform)},addTransformerShape:function(e,t){var n=this,s=this.graphie();this.shape=yf.addMovableShape(s,{shape:e,editable:!1,showPoints:"static"!==this.props.graphMode,translatable:t,onMove:function(e,t){return e=lf.roundToNearest(s.snap[0],e),t=lf.roundToNearest(s.snap[1],t),n.addTransform({type:"translation",vector:[e,t]}),[e,t]},normalPointStyle:{fill:t?cf.INTERACTIVE:cf.DYNAMIC,stroke:t?cf.INTERACTIVE:cf.DYNAMIC},highlightPointStyle:{fill:cf.INTERACTING,stroke:cf.INTERACTING}})},addTool:function(e){var t=this;if("interactive"===this.props.graphMode)if("translation"===e)this.currentTool=this.addTranslationTool();else if("rotation"===e)this.currentTool=this.addRotationTool();else if("reflection"===e)this.currentTool=this.addReflectionTool();else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);this.currentTool=this.addDilationTool()}else{var n;if("translation"===e)n={type:e,vector:[null,null]};else if("rotation"===e)n={type:e,center:[null,null],angleDeg:null};else if("reflection"===e)n={type:e,line:[[null,null],[null,null]]};else{if("dilation"!==e)throw new Error("Invalid tool id: "+e);n={type:e,center:[null,null],scale:null}}this.doTransform(n,(function(){t.refs.transformationList.focusLast()}))}},removeTool:function(e){this.currentTool&&this.currentTool.remove(),this.currentTool=null},addTranslationTool:function(){var e=this;return this.shape.remove(),this.addTransformerShape(this.shape.toJSON(),!0),{remove:function(){e.shape.remove(),e.addTransformerShape(e.shape.toJSON(),!1)}}},snapCoord:function(e){var t=this.graphie();return Hg.map(e,(function(e,n){return lf.roundToNearest(t.snap[n],e)}))},normalizeReflectionCoords:function(e){var t=this.snapCoord(af.midpoint(e)),n=sf.polarDegFromCart(sf.subtract(e[0],e[1])),s=[1,lf.roundToNearest(45,n[1])],i=sf.cartFromPolarDeg(s);return Hg.map([-1,1],(function(e){var n=sf.add(t,sf.scale(i,e*this.scaleToCurrentRange(2)));return this.snapCoord(n)}),this)},addReflectionTool:function(){var e=this.props.tools.reflection;if(e.enabled){var t,n=this,s=this.refs.graph.graphie(),i=function(){n.changeTool("reflection",{coords:Hg.pluck(o,"coord")})},r=this.normalizeReflectionCoords(e.coords),o=Hg.map(r,(function(e){return s.addMovablePoint({coord:e,visible:!1})}),this),a=df(e);s.style({},(function(){t=s.addMovableLineSegment({fixed:e.constraints.fixed,constraints:e.constraints,pointA:o[0],pointZ:o[1],snapX:s.snap[0],snapY:s.snap[1],extendLine:!0,normalStyle:{stroke:a,"stroke-width":2,"stroke-dasharray":"- "},highlightStyle:{stroke:cf.INTERACTING,"stroke-width":2,"stroke-dasharray":"- "},movePointsWithLine:!0,onMoveEnd:i})}));var l=s.addReflectButton({fixed:e.constraints.fixed,line:t,size:this.scaleToCurrentRange(1),onClick:function(){n.doTransform({type:"reflection",line:Hg.pluck(o,"coord")}),c&&(c.setCoord(sf.add(l.coord,sf.subtract(l.coord,c.coord))),c.update())},normalStyle:{stroke:a,"stroke-width":2,fill:a},highlightStyle:{stroke:cf.INTERACTING,"stroke-width":3,fill:cf.INTERACTING},onMoveEnd:i}),c=null;if(!e.constraints.fixed){var h=sf.polarDegFromCart(sf.subtract(o[1].coord,o[0].coord))[1]+90;c=s.addRotateHandle({center:l,radius:this.scaleToCurrentRange(2),angleDeg:h,width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),lengthAngle:17,onMove:function(e){return lf.roundToNearest(45,e)},onMoveEnd:i})}return $(t).on("move",(function(){l.update(),$(l).trigger("move")})),c&&$(c).on("move",(function(){var e=n.snapCoord(c.coord),s=sf.subtract(e,l.coord),i=l.isFlipped()?1:0;o[i].setCoord(sf.add(l.coord,sf.rotateDeg(s,90))),o[1-i].setCoord(sf.add(l.coord,sf.rotateDeg(s,-90))),t.transform(!0),l.update()})),{remove:function(){l.remove(),c&&c.remove(),t.remove(),o[0].remove(),o[1].remove()}}}},scaleToCurrentRange:function(e){return function(e,t){var n=t[0][1]-t[0][0],s=t[1][1]-t[1][0];return e*Math.max(n,s)/20}(e,this.refs.graph.props.range)},addRotationTool:function(){var e=this.props.tools.rotation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),s=df(e);return this.rotatePoint=n.addMovablePoint({constraints:e.constraints,coord:e.coord,snapX:n.snap[0],snapY:n.snap[1],normalStyle:{"stroke-dasharray":"",stroke:s,fill:s},highlightStyle:{"stroke-dasharray":"",stroke:cf.INTERACTING,fill:cf.INTERACTING}}),this.rotateHandle=n.addRotateHandle({center:this.rotatePoint,radius:this.scaleToCurrentRange(1.5),width:this.scaleToCurrentRange(.24),hoverWidth:this.scaleToCurrentRange(.4),onMove:function(e,n){var s=t.getRotationTransformFromAngle(t.rotatePoint.coord,e-n);return t.doTransform(s),n+s.angleDeg}}),this.rotatePoint.onMoveEnd=function(e,n){t.changeTool("rotation",{coord:[e,n]})},{remove:function(){t.rotateHandle.remove(),t.rotatePoint.remove()}}}},addDilationTool:function(){var e=this.props.tools.dilation;if(e.enabled){var t=this,n=this.refs.graph.graphie(),s=df(e);t.dilationCircle=n.addCircleGraph({centerConstraints:e.constraints,center:e.coord,radius:t.scaleToCurrentRange(2),snapX:n.snap[0],snapY:n.snap[1],minRadius:t.scaleToCurrentRange(1),snapRadius:t.scaleToCurrentRange(.5),onResize:function(e,n){t.doTransform({type:"dilation",center:t.dilationCircle.centerPoint.coord,scale:e/n})},circleNormalStyle:{stroke:s,"stroke-width":2,"stroke-dasharray":"- ","fill-opacity":0},circleHighlightStyle:{stroke:cf.INTERACTING,"stroke-width":2,"stroke-dasharray":"",fill:cf.INTERACTING,"fill-opacity":.05},centerNormalStyle:{stroke:s,fill:s,"stroke-width":2,"stroke-dasharray":""},centerHighlightStyle:{stroke:s,fill:s,"stroke-width":2,"stroke-dasharray":""}});var i=this.dilationCircle.centerPoint.onMoveEnd;return this.dilationCircle.centerPoint.onMoveEnd=function(){i&&i.apply(this,Hg.toArray(arguments)),t.changeTool("dilation",{coord:t.dilationCircle.centerPoint.coord})},{remove:function(){t.dilationCircle.remove()}}}},getRotationTransformFromAngle:function(e,t){return(t=(t+360)%360)>180&&(t-=360),{type:"rotation",center:e,angleDeg:15*Math.round(t/15)}},doTransform:function(e,t){this.applyTransform(e),this.addTransform(e,t)},applyTransform:function(e){if("static"!==this.props.graphMode){var t=vf.apply(e);this.applyCoordTransformation(t)}},applyCoordTransformation:function(e){Hg.each(this.shape.points,(function(t){var n=e(t.coord);t.setCoord(n)})),this.shape.update()},resetCoords:function(){var e=this.props.starting.shape.coords;Hg.each(this.shape.points,(function(t,n){t.setCoord(e[n])})),this.shape.update()},handleUndoClick:function(){this.refs.toolsBar.changeSelected(null),this.props.transformations.length&&this.props.onChange({transformations:Hg.initial(this.props.transformations)})},setTransformationProps:function(e,t){this.props.onChange({transformations:e},t)},addTransform:function(e,t){this.transformations=vf.append(this.transformations,e),this.props.onChange({transformations:Hg.clone(this.transformations)},t)},changeTool:function(e,t){var n=Hg.clone(this.props.tools);n[e]=Hg.extend({},this.props.tools[e],t),this.tools[e]=Hg.clone(n[e]),this.props.onChange({tools:n}),this.props.trackInteraction()},simpleValidate:function(e){return kf.validate(this.getUserInput(),e)},getCoords:function(){var e=this.props.starting.shape.coords,t=this.props.transformations;return Hg.reduce(t,(function(e,t){return Hg.map(e,vf.apply(t))}),e)},getEditorJSON:function(){var e=Hg.pick(this.props,"grading","starting","graphMode","listMode","tools","drawSolutionShape","gradeEmpty");return e.graph=this.refs.graph.toJSON(),e.version=1.2,e.answer=this.getUserInput(),e},getUserInput:function(){return{transformations:this.props.transformations,shape:{type:this.shape.type,coords:this.getCoords(),options:this.shape.getOptions()}}},_handleFocus:function(){var e=Array.prototype.slice.call(arguments);this.props.onFocus(e)},_handleBlur:function(){var e=Array.prototype.slice.call(arguments);this.props.onBlur(e)},_getTransformationForID:function(e){var t=["transformationList","transformation"+e],n=this;return Hg.each(t,(e=>{n=n.refs[e]})),n},getInputPaths:function(){if("static"===this.props.listMode)return[];var e=[];return Hg.each(this.props.transformations,((t,n)=>{var s=this._getTransformationForID(n).getInputPaths(),i=Hg.map(s,(e=>[""+n].concat(e)));e=e.concat(i)})),e},_passToInner:function(e,t){if(t&&t.length){var n=Hg.rest(t),s=[n].concat(Hg.rest(arguments,2)),i=Hg.head(t),r=this._getTransformationForID(i);return r[e].apply(r,s)}},focus:function(){var e=this.getInputPaths();return e.length>0&&(this.focusInputPath(e[0]),!0)},focusInputPath:function(e){return 0!==e.length&&(hf(e.length>=2),this._passToInner("focusInputPath",e))},blurInputPath:function(e){return 0!==e.length&&(hf(e.length>=2),this._passToInner("blurInputPath",e))},setInputValue:function(e,t,n){return hf(e.length>=2),this._passToInner("setInputValue",e,t,n)},getDOMNodeForPath:function(e){return hf(e.length>=2),this._passToInner("getDOMNodeForPath",e)},getGrammarTypeForPath:function(e){return hf(e.length>=2),this._passToInner("getGrammarTypeForPath",e)}});Hg.extend(kf,{validate:function(e,t){for(var n in xf){if(t.tools[n].required)if(!Hg.any(Hg.map(e.transformations,(function(e){return e.type===n&&!vf.isEmpty(e)&&!vf.isNoOp(e)}))))return{type:"invalid",message:i18n._("Your transformation must use a %(type)s.",{type:xf[n].lowerNounName})}}return yf.equal(e.shape,t.correct.shape)?{type:"points",earned:1,total:1,message:null}:!t.gradeEmpty&&Qg(e.shape.coords,t.starting.shape.coords)?{type:"invalid",message:i18n._("Use the interactive graph to define a correct transformation.")}:{type:"points",earned:0,total:1,message:null}}}),Bg.exports={name:"transformer",displayName:"Transformer",widget:kf};var _f=Bg.exports,Tf={exports:{}};Tf.exports;h.a;const Mf=x.b,Nf=createReactClass({displayName:"PropCheckBox",DEFAULT_PROPS:{label:null,onChange:null,labelAlignment:"left"},getDefaultProps:function(){return this.DEFAULT_PROPS},propName:function(){const e=Mf.find(Mf.keys(this.props),(function(e){return!Mf.has(this.DEFAULT_PROPS,e)}),this);if(!e)throw new Error("Attempted to create a PropCheckBox with no prop!");return e},_labelAlignLeft:function(){return"left"===this.props.labelAlignment},render:function(){const e=this.propName();return Object($t.jsxs)("label",{children:[this._labelAlignLeft()&&this.props.label,Object($t.jsx)("input",{type:"checkbox",checked:this.props[e],onChange:this.toggle}),!this._labelAlignLeft()&&this.props.label]})},toggle:function(){const e=this.propName(),t={};t[e]=!this.props[e],this.props.onChange(t)}});Tf.exports=Nf;var Pf=Tf.exports,If={exports:{}};If.exports;h.a;const Ef=qd,Af=()=>!0,Rf=createReactClass({displayName:"RangeInput",getDefaultProps:function(){return{placeholder:[null,null]}},render:function(){const e=this.props.value,t=this.props.checkValidity||Af;return Object($t.jsxs)("div",{className:"range-input",children:[Object($t.jsx)(Ef,{...this.props,value:e[0],checkValidity:n=>t([n,e[1]]),onChange:this.onChange.bind(this,0),placeholder:this.props.placeholder[0]}),Object($t.jsx)(Ef,{...this.props,value:e[1],checkValidity:n=>t([e[0],n]),onChange:this.onChange.bind(this,1),placeholder:this.props.placeholder[1]})]})},onChange:function(e,t){const n=this.props.value;0===e?this.props.onChange([t,n[1]]):this.props.onChange([n[0],t])}});If.exports=Rf;var Df=If.exports,Ff=n(18),Lf={exports:{}};Lf.exports;h.a;const zf=i.a,qf=x.b,Wf=hu,Bf=Ff.a,Vf=sd,Hf=Pf,Uf=Df,Gf=Nn.a,$f=ce,Yf=Z,Kf={url:null,width:0,height:0};const Xf=createReactClass({displayName:"GraphSettings",getDefaultProps:function(){return{editableSettings:["graph","snap","image","measure"],box:[xn,xn],labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],gridStep:[1,1],snapStep:[1,1],valid:!0,backgroundImage:Kf,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10}},getInitialState:function(){return this.stateFromProps(this.props)},componentDidMount:function(){this.changeGraph=qf.debounce(this.changeGraph,300)},componentWillReceiveProps:function(e){qf.isEqual(this.props.labels,e.labels)&&qf.isEqual(this.props.gridStep,e.gridStep)&&qf.isEqual(this.props.snapStep,e.snapStep)&&qf.isEqual(this.props.step,e.step)&&qf.isEqual(this.props.range,e.range)&&qf.isEqual(this.props.backgroundImage,e.backgroundImage)||this.setState(this.stateFromProps(e))},stateFromProps:function(e){return{labelsTextbox:e.labels,gridStepTextbox:e.gridStep,snapStepTextbox:e.snapStep,stepTextbox:e.step,rangeTextbox:e.range,backgroundImage:qf.clone(e.backgroundImage)}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Wf.change.apply(this,t)},changeRulerLabel:function(e){this.change({rulerLabel:e.target.value})},changeRulerTicks:function(e){this.change({rulerTicks:+e.target.value})},changeBackgroundUrl:function(e){if("keypress"===e.type&&"Enter"!==e.key)return;const t=(e,t,n)=>{const s=qf.clone(this.props.backgroundImage);s.url=e,s.width=t,s.height=n,this.setState({backgroundImage:s},this.changeGraph)},n=zf.findDOMNode(this.refs["bg-url"]).value;n?$f.getImageSize(n,((e,s)=>{this.isMounted()&&t(n,e,s)})):t(null,0,0)},renderLabelChoices:function(e){return qf.map(e,(function(e){return Object($t.jsx)("option",{value:e[1],children:e[0]})}))},validRange:function(e){return qf.every(e,(function(e){return qf.isFinite(e)}))?!(e[0]>=e[1])||"Range must have a higher number on the right":"Range must be a valid number"},validateStepValue:function(e){const{step:t,range:n,name:s,minTicks:i,maxTicks:r}=e;if(!qf.isFinite(t))return s+" must be a valid number";const o=function(e,t){return Math.floor((e[1]-e[0])/t)}(n,t);return o<i?s+" is too large, there must be at least "+i+" ticks.":!(o>r)||s+" is too small, there can be at most "+r+" ticks."},validSnapStep:function(e,t){return this.validateStepValue({step:e,range:t,name:"Snap step",minTicks:5,maxTicks:60})},validGridStep:function(e,t){return this.validateStepValue({step:e,range:t,name:"Grid step",minTicks:3,maxTicks:60})},validStep:function(e,t){return this.validateStepValue({step:e,range:t,name:"Step",minTicks:3,maxTicks:20})},validBackgroundImageSize:function(e){if(!e.url)return!0;return!!(e.width<=450&&e.height<=450)||"Image must be smaller than 450px x 450px."},validateGraphSettings:function(e,t,n,s,i){const r=this;let o;const a=qf.every(e,(function(e){return o=r.validRange(e),!0===o}));if(!a)return o;const l=qf.every(t,(function(t,n){return o=r.validStep(t,e[n]),!0===o}));if(!l)return o;const c=qf.every(n,(function(t,n){return o=r.validGridStep(t,e[n]),!0===o}));if(!c)return o;const h=qf.every(s,(function(t,n){return o=r.validSnapStep(t,e[n]),!0===o}));if(!h)return o;const p=this.validBackgroundImageSize(i);return!0===p||(o=p,o)},changeLabel:function(e,t){const n=t.target.value,s=this.state.labelsTextbox.slice();s[e]=n,this.setState({labelsTextbox:s},this.changeGraph)},changeRange:function(e,t){const n=this.state.rangeTextbox.slice();n[e]=t;const s=this.state.stepTextbox.slice(),i=this.state.gridStepTextbox.slice(),r=this.state.snapStepTextbox.slice(),o=$f.scaleFromExtent(n[e],this.props.box[e]);!0===this.validRange(n[e])&&(s[e]=$f.tickStepFromExtent(n[e],this.props.box[e]),i[e]=$f.gridStepFromTickStep(s[e],o),r[e]=i[e]/2),this.setState({stepTextbox:s,gridStepTextbox:i,snapStepTextbox:r,rangeTextbox:n},this.changeGraph)},changeStep:function(e){this.setState({stepTextbox:e},this.changeGraph)},changeSnapStep:function(e){this.setState({snapStepTextbox:e},this.changeGraph)},changeGridStep:function(e){this.setState({gridStepTextbox:e,snapStepTextbox:qf.map(e,(function(e){return e/2}))},this.changeGraph)},changeGraph:function(){const e=this.state.labelsTextbox,t=qf.map(this.state.rangeTextbox,(function(e){return qf.map(e,Number)})),n=qf.map(this.state.stepTextbox,Number),s=this.state.gridStepTextbox,i=this.state.snapStepTextbox,r=this.state.backgroundImage,o=this.validateGraphSettings(t,n,s,i,r);!0===o?this.change({valid:!0,labels:e,range:t,step:n,gridStep:s,snapStep:i,backgroundImage:r}):this.change({valid:o})},render:function(){const e=[Yf.roundTo(2,$f.scaleFromExtent(this.props.range[0],this.props.box[0])),Yf.roundTo(2,$f.scaleFromExtent(this.props.range[1],this.props.box[1]))];return Object($t.jsxs)("div",{children:[qf.contains(this.props.editableSettings,"canvas")&&Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Canvas size (x,y pixels)",Object($t.jsx)(Uf,{value:this.props.box,onChange:e=>{this.change({box:e})}})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Scale (px per div):"," ",Object($t.jsx)(Gf,{children:"("+e[0]+", "+e[1]+")"})]})]}),qf.contains(this.props.editableSettings,"graph")&&Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:[" ","x Label",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",ref:"labels-0",onChange:e=>this.changeLabel(0,e),value:this.state.labelsTextbox[0]})]}),Object($t.jsxs)("div",{className:"perseus-widget-right-col",children:["y Label",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",ref:"labels-1",onChange:e=>this.changeLabel(1,e),value:this.state.labelsTextbox[1]})]})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["x Range",Object($t.jsx)(Uf,{value:this.state.rangeTextbox[0],onChange:e=>this.changeRange(0,e)})]}),Object($t.jsxs)("div",{className:"perseus-widget-right-col",children:["y Range",Object($t.jsx)(Uf,{value:this.state.rangeTextbox[1],onChange:e=>this.changeRange(1,e)})]})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Tick Step",Object($t.jsx)(Uf,{value:this.state.stepTextbox,onChange:this.changeStep})]}),Object($t.jsxs)("div",{className:"perseus-widget-right-col",children:["Grid Step",Object($t.jsx)(Uf,{value:this.state.gridStepTextbox,onChange:this.changeGridStep})]})]}),qf.contains(this.props.editableSettings,"snap")&&Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Snap Step",Object($t.jsx)(Uf,{value:this.state.snapStepTextbox,onChange:this.changeSnapStep})]})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Markings: "}),Object($t.jsx)(Bf,{value:this.props.markings,allowEmpty:!1,buttons:[{value:"graph",content:"Graph"},{value:"grid",content:"Grid"},{value:"none",content:"None"}],onChange:this.change("markings")})]}),Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(Hf,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.change})})]}),qf.contains(this.props.editableSettings,"image")&&Object($t.jsxs)("div",{className:"image-settings",children:[Object($t.jsx)("div",{children:"Background image:"}),Object($t.jsxs)("div",{children:["Url:"," ",Object($t.jsx)("input",{type:"text",className:"graph-settings-background-url",ref:"bg-url",value:this.state.backgroundImage.url,onChange:e=>{const t=qf.clone(this.props.backgroundImage);t.url=e.target.value,this.setState({backgroundImage:t})},onKeyPress:this.changeBackgroundUrl,onBlur:this.changeBackgroundUrl}),Object($t.jsx)(Vf,{children:Object($t.jsx)("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]})]}),qf.contains(this.props.editableSettings,"measure")&&Object($t.jsxs)("div",{className:"misc-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(Hf,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.change})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(Hf,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.change})})]}),this.props.showRuler&&Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler label:"," ",Object($t.jsxs)("select",{onChange:this.changeRulerLabel,value:this.props.rulerLabel,children:[Object($t.jsx)("option",{value:"",children:"None"}),Object($t.jsx)("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),Object($t.jsx)("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler ticks:"," ",Object($t.jsx)("select",{onChange:this.changeRulerTicks,value:this.props.rulerTicks,children:qf.map([1,2,4,8,10,16],(function(e){return Object($t.jsx)("option",{value:e,children:e})}))})]})})]})]})]})}});Lf.exports=Xf;var Zf=Lf.exports,Jf={exports:{}};Jf.exports;h.a;const Qf=x.b,em=Ss.Options,tm=Wg,nm=Zf,sm=sd,im=Pf,rm=_f.widget,om=ce.deepEq,am=ce.getGridStep,lm=G.a.line,cm=G.a.number,hm=G.a.point,pm=G.a.ray,um=G.a.vector,dm=Mi;var gm={url:null};function fm(e,t){return e=Qf.clone(e).sort(hm.compare),t=Qf.clone(t).sort(hm.compare),Qf.all(Qf.map(e,(function(e,n){var s=t[n];return hm.equal(e,s)})))}var mm={apiOptions:em.defaults,gradeEmpty:!1,graphMode:"interactive",listMode:"dynamic",graph:{},tools:{translation:{enabled:!0,required:!1,constraints:{}},rotation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[1,6]},reflection:{enabled:!0,required:!1,constraints:{fixed:!1},coords:[[2,-4],[2,2]]},dilation:{enabled:!0,required:!1,constraints:{fixed:!1},coord:[6,6]}},drawSolutionShape:!0,starting:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]},correct:{shape:{type:"polygon-3",coords:[[2,2],[2,6],[7,2]]},transformations:[]}};const bm=createReactClass({displayName:"ToolSettings",getDefaultProps:function(){return{allowFixed:!0}},render:function(){return Object($t.jsxs)("div",{children:[this.props.name,": "," ",Object($t.jsx)(im,{label:"enabled:",enabled:this.props.settings.enabled,onChange:this.props.onChange})," ",this.props.settings.enabled&&Object($t.jsx)(im,{label:"required:",required:this.props.settings.required,onChange:this.props.onChange}),this.props.settings.enabled&&Object($t.jsx)(sm,{children:"'Required' will only grade the answer as correct if the student has used at least one such transformation."})," ",this.props.allowFixed&&this.props.settings.enabled&&Object($t.jsx)(im,{label:"fixed:",fixed:this.props.settings.constraints.fixed,onChange:this.changeConstraints}),this.props.allowFixed&&this.props.settings.enabled&&Object($t.jsx)(sm,{children:"Enable 'fixed' to prevent the student from repositioning the tool. The tool will appear in the position at which it is placed in the editor below."})]})},changeConstraints:function(e){var t=Qf.extend({},this.props.constraints,e);this.props.onChange({constraints:t})}});var vm=createReactClass({displayName:"TransformationExplorerSettings",render:function(){return Object($t.jsxs)("div",{className:"transformer-settings",children:[Object($t.jsxs)("div",{children:[" ","Mode:"," ",Object($t.jsxs)("select",{value:this.getMode(),onChange:this.changeMode,children:[Object($t.jsxs)("option",{value:"interactive,dynamic",children:[" ","Exploration with text"," "]}),Object($t.jsxs)("option",{value:"interactive,static",children:[" ","Exploration without text"," "]}),Object($t.jsxs)("option",{value:"dynamic,interactive",children:[" ","Formal with movement"," "]}),Object($t.jsxs)("option",{value:"static,interactive",children:[" ","Formal without movement"," "]})]}),Object($t.jsx)(sm,{children:Object($t.jsxs)("ul",{children:[Object($t.jsxs)("li",{children:[Object($t.jsx)("b",{children:"Exploration:"})," Students create transformations with tools on the graph."," "]}),Object($t.jsxs)("li",{children:[Object($t.jsx)("b",{children:"Formal with movement:"})," Students specify transformations mathematically in the transformation list. Graph shows the results of these transformations."," "]}),Object($t.jsxs)("li",{children:[Object($t.jsx)("b",{children:"Formal without movement:"})," Students specify transformations mathematically in the transformation list. Graph does not update."," "]})]})})]}),Object($t.jsx)(bm,{name:"Translations",settings:this.props.tools.translation,allowFixed:!1,onChange:this.changeHandlerFor("translation")}),Object($t.jsx)(bm,{name:"Rotations",settings:this.props.tools.rotation,onChange:this.changeHandlerFor("rotation")}),Object($t.jsx)(bm,{name:"Reflections",settings:this.props.tools.reflection,onChange:this.changeHandlerFor("reflection")}),Object($t.jsx)(bm,{name:"Dilations",settings:this.props.tools.dilation,onChange:this.changeHandlerFor("dilation")}),Object($t.jsx)(im,{label:"Draw Solution:",drawSolutionShape:this.props.drawSolutionShape,onChange:this.props.onChange})]})},getMode:function(){return this.props.graphMode+","+this.props.listMode},changeMode:function(e){var t=e.target.value.split(",");this.props.onChange({graphMode:t[0],listMode:t[1]})},changeHandlerFor:function(e){return t=>{var n=Qf.clone(this.props.tools);n[e]=Qf.extend({},this.props.tools[e],t),this.props.onChange({tools:n})}}}),xm={getPointCountForType:function(e){var t=e.split("-");return"polygon"===t[0]?t[1]||3:"line"===t[0]||"lineSegment"===t[0]?2:"angle"===t[0]?3:"circle"===t[0]?2:"point"===t[0]?1:void 0},addMovableShape:function(e,t){if(t.editable&&t.translatable)throw new Error("It doesn't make sense to have a movable shape where you can stretch the points and translate them simultaneously. options: "+JSON.stringify(t));var n,s=Qf.map(t.shape.coords,(function(i){var r,o=!1,a=i;return r=e.addMovablePoint({coord:i,normalStyle:t.normalPointStyle,highlightStyle:t.highlightPointStyle,constraints:{fixed:!t.translatable&&!t.editable},visible:t.showPoints,snapX:t.snap&&t.snap[0]||0,snapY:t.snap&&t.snap[1]||0,bounded:!1,onMove:function(e,i){o||(a=r.coord,o=!0);var l=um.subtract([e,i],r.coord);t.onMove&&(l=t.onMove(l[0],l[1])),t.translatable&&Qf.each(s,(function(e){e!==r&&e.setCoord(um.add(e.coord,l))}));var c=r.coord,h=um.add(r.coord,l);return r.coord=h,n.update(),r.coord=c,h},onMoveEnd:function(){if(t.onMoveEnd&&o){o=!1;var e=um.subtract(r.coord,a);t.onMoveEnd(e[0],e[1])}n.update()}}),r.bounded=!0,r})),i=(n=xm.addShape(e,t,s)).remove;return n.remove=function(){i.apply(n),Qf.invoke(s,"remove")},n},addShape:function(e,t,n){n=n||t.shape.coords;var s=xm._typesOf(t.shape),i=t.shape.options||xm.defaultOptions(s),r=xm._mapTypes(s,n,(function(n,s,r){var o=Qf.extend({},t,i[r]);return xm._addType(e,n,s,o)})),o=Qf.filter(Qf.pluck(r,"update"),Qf.identity),a=Qf.filter(Qf.pluck(r,"remove"),Qf.identity),l=function(){return Qf.map(r,(function(e){return e.getOptions?e.getOptions():{}}))};return{type:s,points:n,update:function(){Qf.invoke(o,"call")},remove:function(){Qf.invoke(a,"call")},toJSON:function(){var e=Qf.map(n,(function(e){return Qf.isArray(e)?e:e.coord}));return{type:s,coords:e,options:l()}},getOptions:l}},equal:function(e,t){var n=xm._typesOf(e),s=xm._typesOf(t);if(n.length!==s.length)return!1;var i=xm._mapTypes(n,e.coords,xm._combine),r=xm._mapTypes(s,t.coords,xm._combine);return Qf.all(Qf.map(i,(function(e,t){var n=r[t];return e.type===n.type&&xm._forType(e.type).equal(e.coords,n.coords)})))},_typesOf:function(e){var t=e.type;return Qf.isArray(t)||(t=[t]),Qf.map(t,(function(e){return"polygon"===e?"polygon-3":e}))},defaultOptions:function(e){return Qf.map(e,(function(e){var t=xm._forType(e).defaultOptions;return Qf.extend({},t)}))},_forType:function(e){var t=e.split("-")[0];return xm[t]},_mapTypes:function(e,t,n,s){return Qf.map(e,(function(e,i){var r=xm.getPointCountForType(e),o=Qf.first(t,r);return t=Qf.rest(t,r),n.call(s,e,o,i)}))},_addType:function(e,t,n,s){var i=Qf.isArray(n[0])?{coordA:n[0],coordZ:n[1]}:{pointA:n[0],pointZ:n[1]};if("polygon"===(t=t.split("-")[0])){var r=e.addMovablePolygon(Qf.extend({},s,{fixed:!s.editable,snapX:s.snap&&s.snap[0]||0,snapY:s.snap&&s.snap[1]||0,points:n,constrainToGraph:!1}));return{update:r.transform.bind(r),remove:r.remove.bind(r)}}if("line"===t||"lineSegment"===t){var o=e.addMovableLineSegment(Qf.extend({},s,i,{movePointsWithLine:!0,fixed:!0,constraints:{fixed:!0},extendLine:"line"===t}));return{update:o.transform.bind(o,!0),remove:o.remove.bind(o)}}if("angle"===t){var a=!!s.editable&&null,l=e.addMovableAngle({angleLabel:"$deg0",fixed:!0,points:n,normalStyle:s.normalStyle,reflex:s.reflex});return Qf.isArray(n[0])||s.editable||(n[0].remove(),n[2].remove()),{update:l.update.bind(l,a),remove:l.remove.bind(l),getOptions:function(){return{reflex:l.isReflex()}}}}if("circle"===t){var c={remove:Qf.identity},h=function(){var t=n[0].coord||n[0],i=n[1].coord||n[1],r=hm.distanceToPoint(t,i);c.remove(),c=e.circle(t,r,Qf.extend({stroke:dm.DYNAMIC,"stroke-width":2},s.normalStyle))};return h(),n[1].remove&&!s.editable&&n[1].remove(),{update:h,remove:function(){c.remove()}}}if("point"===t)return{update:null,remove:null};throw new Error("Invalid shape type "+t)},_combine:function(e,t){return{type:e,coords:t}},polygon:{equal:fm},line:{equal:lm.equal},lineSegment:{equal:fm},angle:{equal:function(e,t){if(!hm.equal(e[1],t[1]))return!1;var n=[e[1],e[0]],s=[e[1],e[2]],i=[t[1],t[0]],r=[t[1],t[2]],o=pm.equal(n,i)&&pm.equal(s,r),a=pm.equal(n,r)&&pm.equal(s,i);return o||a},defaultOptions:{reflex:!1}},circle:{equal:function(e,t){var n=hm.distanceToPoint(e[0],e[1]),s=hm.distanceToPoint(t[0],t[1]);return hm.equal(e[0],t[0])&&cm.equal(n,s)}},point:{equal:hm.equal}},ym=createReactClass({displayName:"TransformationsShapeEditor",render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)(tm,{ref:"graph",box:this.props.graph.box,range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,markings:this.props.graph.markings,backgroundImage:this.props.graph.backgroundImage,onGraphieUpdated:this.setupGraphie}),Object($t.jsxs)("select",{value:this.getTypeString(this.props.shape.type),onChange:this.changeType,children:[Object($t.jsx)("option",{value:"polygon-3",children:"Triangle"}),Object($t.jsx)("option",{value:"polygon-4",children:"Quadrilateral"}),Object($t.jsx)("option",{value:"polygon-5",children:"Pentagon"}),Object($t.jsx)("option",{value:"polygon-6",children:"Hexagon"}),Object($t.jsx)("option",{value:"line",children:"Line"}),Object($t.jsx)("option",{value:"line,line",children:"2 lines"}),Object($t.jsx)("option",{value:"lineSegment",children:"Line segment"}),Object($t.jsxs)("option",{value:"lineSegment,lineSegment",children:[" ","2 line segments"," "]}),Object($t.jsx)("option",{value:"angle",children:"Angle"}),Object($t.jsx)("option",{value:"circle",children:"Circle"})]},"type-select")]})},getTypeString:function(e){return Qf.isArray(e)?Qf.map(e,this.getTypeString).join(","):"polygon"===e?"polygon-"+this.props.shape.coords.length:e},changeType:function(e){var t,n=String(e.target.value).split(","),s=(t=Qf.map(n,xm.getPointCountForType),Qf.reduce(t,(function(e,t){return e+t}),0)),i=function(e,t){var n=t[0][1]-t[0][0],s=t[1][1]-t[1][0];return e*Math.max(n,s)/20}(4,this.refs.graph.props.range),r=180*(.5-1/s),o=Qf.times(s,(function(e){return hm.rotateDeg([i,0],360*e/s+r)}));this.props.onChange({shape:{type:n,coords:o,options:xm.defaultOptions(n)}})},componentDidMount:function(){this.setupGraphie(this.refs.graph.graphie())},componentDidUpdate:function(e){om(e.shape,this.props.shape)||this.refs.graph.reset()},updateCoords:function(){this.props.onChange({shape:this.shape.toJSON()})},setupGraphie:function(e){this.shape=xm.addMovableShape(e,{editable:!0,snap:e.snap,shape:this.props.shape,onMoveEnd:this.updateCoords})}}),jm=createReactClass({displayName:"TransformerEditor",getDefaultProps:function(){return mm},render:function(){var e=Qf.extend(function(e,t){var n=(e=e||{}).labels||["x","y"],s=e.range||[[-10,10],[-10,10]],i=e.step||[1,1];return{box:[t,t],labels:n,range:s,step:i,gridStep:e.gridStep||am(s,i,t),valid:!0,backgroundImage:gm,markings:"grid",showProtractor:!1}}(this.props.graph,340),this.props.graph);return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:[Object($t.jsx)(im,{label:"Grade empty answers as wrong:",gradeEmpty:this.props.gradeEmpty,onChange:this.props.onChange}),Object($t.jsxs)(sm,{children:[Object($t.jsx)("p",{children:"We generally do not grade empty answers. This usually works well, but sometimes can result in giving away part of an answer in a multi-part question."}),Object($t.jsx)("p",{children:"If this is a multi-part question (there is another widget), you probably want to enable this option. Otherwise, you should leave it disabled."}),Object($t.jsx)("p",{children:"Confused? Talk to Elizabeth."})]})]}),Object($t.jsx)("div",{children:"Graph settings:"}),Object($t.jsx)(nm,{box:e.box,labels:e.labels,range:e.range,step:e.step,gridStep:e.gridStep,valid:e.valid,backgroundImage:e.backgroundImage,markings:e.markings,showProtractor:e.showProtractor,onChange:this.changeGraph}),Object($t.jsx)("div",{children:"Transformation settings:"}),Object($t.jsx)(vm,{ref:"transformationSettings",graphMode:this.props.graphMode,listMode:this.props.listMode,tools:this.props.tools,drawSolutionShape:this.props.drawSolutionShape,onChange:this.props.onChange}),Object($t.jsx)("div",{children:"Starting location:"}),Object($t.jsx)(ym,{ref:"shapeEditor",graph:e,shape:this.props.starting.shape,onChange:this.changeStarting,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),Object($t.jsx)("div",{children:"Solution transformations:"}),Object($t.jsx)(rm,{ref:"explorer",graph:e,graphMode:this.props.graphMode,listMode:this.props.listMode,gradeEmpty:this.props.gradeEmpty,tools:this.props.tools,drawSolutionShape:this.props.drawSolutionShape,starting:this.props.starting,correct:this.props.starting,transformations:this.props.correct.transformations,onChange:this.changeTransformer,trackInteraction:()=>{}})]})},changeGraph:function(e,t){var n=Qf.extend({},this.props.graph,e);this.props.onChange({graph:n},t)},changeStarting:function(e){var t=Qf.extend({},this.props.starting,e);this.props.onChange({starting:t})},changeTransformer:function(e,t){e.transformations&&(e.correct={...this.props.correct,transformations:e.transformations},delete e.transformations),this.props.onChange(e,t)},serialize:function(){var e=this.refs.explorer.getEditorJSON();return e.correct=e.answer,delete e.answer,e}});Jf.exports=jm;var wm=Jf.exports,Om={exports:{}},Cm=(Om.exports,h.a,i.a),Sm=x.b,km=pg;const _m=Ng;var Tm=ah,Mm=ce;const{keypadElementPropType:Nm}=ye.a.propTypes;var Pm=Ss.Options;const Im=ie;var Em=ki.assert,Am=function(e,t){return[""+e,""+t]},Rm=function(e){return Em(Sm.isArray(e)&&2===e.length),+e[0]},Dm=function(e){return Em(Sm.isArray(e)&&2===e.length),+e[1]},Fm=function(e){return"answer"+Rm(e)+","+Dm(e)},Lm=createReactClass({displayName:"Table",getDefaultProps:function(){var e=Sm.times(4,(function(){return Mm.stringArrayOfSize(1)}));return{apiOptions:Pm.defaults,headers:[""],editableHeaders:!1,rows:4,columns:1,answers:e,linterContext:je}},_getRows:function(){return this.props.answers.length},_getColumns:function(){return this.props.answers[0].length},render:function(){var e=this._getRows(),t=this._getColumns(),n=this.props.headers;let s,i;return this.props.apiOptions.customKeypad?(s=_m,i={width:80}):this.props.apiOptions.staticRender?(s=km,i={}):(s="input",i={}),Object($t.jsxs)("table",{className:"perseus-widget-table-of-values non-markdown",children:[Object($t.jsx)("thead",{children:Object($t.jsx)("tr",{children:Sm.map(n,((e,t)=>this.props.editableHeaders?Object($t.jsx)("th",{children:Object($t.jsx)(this.props.Editor,{ref:"columnHeader"+t,apiOptions:this.props.apiOptions,content:e,widgetEnabled:!1,onChange:Sm.partial(this.onHeaderChange,t)})},t):Object($t.jsx)("th",{children:Object($t.jsx)(Tm,{content:e,linterContext:this.props.linterContext})},t)))})}),Object($t.jsx)("tbody",{children:Sm.times(e,(e=>Object($t.jsx)("tr",{children:Sm.times(t,(t=>Object($t.jsx)("td",{children:Object($t.jsx)(s,{ref:Fm(Am(e,t)),type:"text",value:this.props.answers[e][t],keypadElement:this.props.keypadElement,disabled:this.props.apiOptions.readOnly,onFocus:Sm.partial(this._handleFocus,Am(e,t)),onBlur:Sm.partial(this._handleBlur,Am(e,t)),onChange:Sm.partial(this.onValueChange,e,t),style:i})},t)))},e)))})]})},getUserInput:function(){return Sm.map(this.props.answers,Sm.clone)},onValueChange:function(e,t,n){var s=Sm.map(this.props.answers,Sm.clone);s[e][t]=n.target?n.target.value:n,this.props.onChange({answers:s}),this.props.trackInteraction()},onHeaderChange:function(e,t){var n=this.props.headers.slice();n[e]=t.content,this.props.onChange({headers:n})},simpleValidate:function(e){return Lm.validate(this.getUserInput(),e)},_handleFocus:function(e){this.props.onFocus(e)},_handleBlur:function(e){this.props.onBlur(e)},focus:function(){return this.focusInputPath(Am(0,0)),!0},focusInputPath:function(e){var t=Fm(e),n=this.refs[t];this.props.apiOptions.customKeypad||this.props.apiOptions.staticRender?n.focus():Cm.findDOMNode(n).focus()},blurInputPath:function(e){var t=Fm(e),n=this.refs[t];this.props.apiOptions.customKeypad||this.props.apiOptions.staticRender?n.blur():Cm.findDOMNode(n).blur()},getDOMNodeForPath:function(e){var t=Fm(e);return Cm.findDOMNode(this.refs[t])},getInputPaths:function(){var e=this._getRows(),t=this._getColumns(),n=[];return Sm.times(e,(e=>{Sm.times(t,(t=>{var s=Am(e,t);n.push(s)}))})),n},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){var s=Rm(e),i=Dm(e),r=Sm.map(this.props.answers,Sm.clone);r[s][i]=t,this.props.onChange({answers:r},n)}});Sm.extend(Lm,{validate:function(e,t){var n=function(e){return Sm.filter(e,(function(e){return Sm.some(e,Sm.identity)}))},s=n(t.answers),i=n(e);if(Sm.some(i,(function(e){return Sm.some(e,(function(e){return""===e}))}))||!i.length)return{type:"invalid",message:null};if(i.length!==s.length)return{type:"points",earned:0,total:1,message:null};var r=Im.number.createValidatorFunctional,o=null;return{type:"points",earned:Sm.every(s,(function(e){var t;for(t=0;t<i.length;t++){var n=i[t],s=Sm.every(n,(function(t,n){var s=e[n],i=r(s,{simplify:!0})(t);return i.message&&(o=i.message),i.correct}));if(s)return i.splice(t,1),!0}return!1}))?1:0,total:1,message:o}}});Om.exports={name:"table",displayName:"Table of values",accessible:!0,widget:Lm,transform:e=>{var t=e.answers.length,n=e.answers[0].length,s=Sm.times(t,(function(){return Mm.stringArrayOfSize(n)}));return Sm.extend({},e,{answers:s})},hidden:!0,isLintable:!0};var zm=Om.exports,qm=n(10),Wm=n(8),Bm={exports:{}};Bm.exports;const Vm=e=>{const{editorState:t,contentState:n,selection:s}=e,i={};return i.editorState=t||null,i.contentState=n||t&&t.getCurrentContent()||null,i.selection=s||t&&t.getSelection()||n&&n.getSelectionAfter()||null,i},Hm=e=>Wm.SelectionState.createEmpty(e.getKey()).set("hasFocus",!0);const Um=(e,t)=>{const n=[],s=t.getStartKey(),i=t.getEndKey(),r=e.getKeyAfter(i);for(let o=s;o!==r;o=e.getKeyAfter(o))n.push(e.getBlockForKey(o));return n};const Gm=/\r\n?|\n/g;const $m=(e,t)=>{if(0===t||t===e.getLength())return!0;const n=e.getEntityAt(t-1),s=e.getEntityAt(t);return!(!!s&&"IMMUTABLE"===Wm.Entity.get(s).mutability&&n===s)},Ym=(e,t,n)=>{let s=t;for(;s>0&&s<e.getLength()&&!$m(e,s);)s+=n;return s};Bm.exports={regexStrategy:function(e,t,n,s){const i=e.getText();let r;for(;null!==(r=n.exec(i));)if(s){const{start:e,end:n}=s(r);t(e,n)}else{const e=r.index;t(e,e+r[0].length)}},findPattern:function(e,t){const n=e.getBlockMap().values();for(const s of n){const e=t.exec(s.getText());if(null!==e){return Hm(s).merge({anchorOffset:e.index,focusOffset:e.index+e[0].length})}}},replaceSelection:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=Vm(e),i={};return i.contentState=Wm.Modifier.replaceText(s.contentState,s.selection,t,null,n),s.editorState&&(i.editorState=Wm.EditorState.push(s.editorState,i.contentState,"insert-characters")),i},deleteSelection:function(e){const t=Vm(e),n={};return n.contentState=Wm.Modifier.removeRange(t.contentState,t.selection,"backward"),t.editorState&&(n.editorState=Wm.EditorState.push(t.editorState,n.contentState,"remove-range")),n},getEntities:function(e,t){let n=null,s=()=>!0;if(t){const i=Um(e,t);n=Wm.BlockMapBuilder.createFromArray(i);const r=t.getStartKey(),o=t.getEndKey();s=(e,n,s)=>!(e===r&&n<t.getStartOffset())&&!(e===o&&s>t.getEndOffset())}else n=e.getBlockMap();const i=[];return n.forEach(((e,t)=>{e.findEntityRanges((e=>null!==e.getEntity()),((n,r)=>{s(t,n,r)&&i.push(Wm.Entity.get(e.getEntityAt(n)))}))})),i},findEntity:function(e,t){const n=e.getBlocksAsArray();let s=null;return n.some((e=>(e.findEntityRanges((e=>null!==e.getEntity()&&t(Wm.Entity.get(e.getEntity()))),((t,n)=>{const i=Hm(e);s=i.merge({anchorOffset:t,focusOffset:n,isBackward:!1})})),!!s))),s},insertText:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>null;const s=Vm(e),i={},r=t.split(Gm),o=Wm.CharacterMetadata.create(),a=r.map((e=>{let t=e,s=Array(e.length).fill(o);const i=n(t,s);return null!==i&&(t=i.text,s=i.characterList),new Wm.ContentBlock({key:Object(Wm.genKey)(),text:t,type:"unstyled",characterList:Object(qm.List)(s)})})),l=Wm.BlockMapBuilder.createFromArray(a);return i.contentState=Wm.Modifier.replaceWithFragment(s.contentState,s.selection,l),s.editorState&&(i.editorState=Wm.EditorState.push(s.editorState,i.contentState,"insert-fragment")),i},selectEnd:function(e){return Hm(e).merge({focusOffset:e.getCharacterList().size,anchorOffset:e.getCharacterList().size})},snapSelectionOutsideEntities:function(e,t){const n=Vm(e),{contentState:s,selection:i,editorState:r}=n,o=s.getBlockForKey(i.getAnchorKey()),a=s.getBlockForKey(i.getFocusKey());let l=i.getAnchorOffset(),c=i.getFocusOffset();const h=i.getIsBackward()?-1:1,p=c-t.getFocusOffset();i.getFocusKey()===t.getFocusKey()&&1===Math.abs(p)&&!$m(a,c)&&(c=Ym(a,c,p)),c=Ym(a,c,h),l=Ym(o,l,-h),i.isCollapsed()&&(l=c);const u={contentState:s};return u.selection=i.merge({focusOffset:c,anchorOffset:l}),r&&(u.editorState=Wm.EditorState.set(r,{selection:u.selection,forceSelection:!0})),u},toggleDecoration:function(e,t){const n=Vm(e),s={},{contentState:i,selection:r}=n,o=Um(i,r);let a=!0,l=n.contentState,c=n.contentState;if(o.forEach((e=>{let n=0,s=e.getLength();if(e.getKey()===r.getStartKey()&&(n=r.getStartOffset()),e.getKey()===r.getEndKey()&&(s=r.getEndOffset()),n===s)return;const i=e.getText().substring(n,s);a&&i.endsWith(t)&&i.startsWith(t)?c=((e,t,n,s,i)=>{let r=Hm(t),o=e;return r=r.merge({anchorOffset:s-i.length,focusOffset:s}),o=Wm.Modifier.removeRange(o,r),r=r.merge({anchorOffset:n,focusOffset:n+i.length}),o=Wm.Modifier.removeRange(o,r),o})(c,e,n,s,t):a=!1,l=((e,t,n,s,i)=>{let r=Hm(t),o=e;return r=r.merge({anchorOffset:s,focusOffset:s}),o=Wm.Modifier.insertText(o,r,i),r=r.merge({anchorOffset:n,focusOffset:n}),o=Wm.Modifier.insertText(o,r,i),o})(l,e,n,s,t)})),s.contentState=a?c:l,n.editorState){s.editorState=Wm.EditorState.push(n.editorState,s.contentState,a?"remove-range":"insert-characters");let e=r.getEndOffset();if(e>0){e+=(a?-2:2)*t.length}let i=null;i=r.getIsBackward()?r.merge({anchorOffset:e}):r.merge({focusOFfset:e}),s.editorState=Wm.EditorState.forceSelection(s.editorState,i)}return s}};var Km=Bm.exports,Xm={exports:{}};Xm.exports;const Zm=h.a,Jm=Fs,Qm=Km,eb="[[\u2603 {id}]]",tb=/\[\[\u2603 [a-z-]+ [0-9]+\]\]/g,nb=/^\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]$/,sb=e=>new RegExp(`(\\[\\[\u2603 ${e}\\]\\])`,"gm"),ib=/\[\[([a-z-]+)$/,rb=/\*\*([\s\S]+?)\*\*(?!\*)/g,ob=/\**(?:^|[^*])((\*|_)(\w+(\s\w+)*)\2)/g,ab=/(\*\*\*\w+(\s\w+)*\*\*\*)/g,lb=/__([\s\S]+?)__(?!_)/g,cb=/^ *(#{1,6})([^\n]+)$/g,hb=(e,t,n)=>e.findEntityRanges((e=>e.getEntity()&&Wm.Entity.get(e.getEntity()).type===n),t),pb=(e,t)=>Object($t.jsx)("span",{...e,style:t,children:e.children}),ub=(e,t)=>pb(e,{backgroundColor:t}),db=(e,t)=>({strategy:function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return hb(...n,e)},component:e=>ub(e,t)}),gb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qm.regexStrategy(...t,rb)},component:e=>pb(e,{fontWeight:"bold"})},fb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qm.regexStrategy(...t,ob,(e=>{const t=e.index+e[0].length-e[1].length;return{start:t,end:t+e[1].length}}))},component:e=>pb(e,{fontStyle:"italic"})},mb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qm.regexStrategy(...t,lb)},component:e=>pb(e,{textDecoration:"underline"})},bb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qm.regexStrategy(...t,ab)},component:e=>pb(e,{fontWeight:"bold",fontStyle:"italic"})},vb={strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qm.regexStrategy(...t,cb)},component:e=>{const t=e.decoratedText.split(cb)[1].length;return Zm.createElement(`h${t}`,{style:{marginBottom:0}},e.children)}},xb=new Wm.CompositeDecorator([db("WIDGET","#DFD"),db("TEMP_IMAGE","#fdffdd"),(yb=/!\[[^\]]*?\]\([^\)].*?\)/g,jb="#dffdfa",{strategy:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Qm.regexStrategy(...t,yb)},component:e=>ub(e,jb)}),bb,gb,mb,fb,vb]);var yb,jb;const wb=e=>{const t=Wm.KeyBindingUtil.hasCommandModifier(e);return t&&66===e.keyCode?"perseus-bold":t&&73===e.keyCode?"perseus-italics":t&&85===e.keyCode?"perseus-underline":t&&219===e.keyCode?"perseus-decrease-font-size":t&&221===e.keyCode?"perseus-increase-font-size":t&&220===e.keyCode?"perseus-reset-font-size":Object(Wm.getDefaultKeyBinding)(e)},Ob=createReactClass({displayName:"PerseusEditor",getDefaultProps:()=>({onChange:()=>{},content:"",initialWidgets:{},widgetEnabled:!0,placeholder:"Type here"}),getInitialState(){const{content:e,initialWidgets:t,widgetEnabled:n}=this.props,s=Wm.ContentState.createFromText(e);let i=Wm.EditorState.createWithContent(s,xb);return n&&(i=this._insertWidgetsAsEntities(i,t)),{editorState:i,widgets:t,fontSizePercentage:100}},componentDidUpdate(e){this.props.content!==this.lastContentUpdate&&(this.lastContentUpdate=this.props.content,this.setState(this.getInitialState()))},_insertWidgetsAsEntities(e,t){let n=e.getCurrentContent();Object.keys(t).forEach((e=>{const t=Qm.findPattern(n,sb(e));if(t){const s=Wm.Entity.create("WIDGET","IMMUTABLE",{id:e});n=Wm.Modifier.applyEntity(n,t,s)}}));return Wm.EditorState.set(e,{currentContent:n})},_getDraftData(){const e=this.state.editorState,t=e.getCurrentContent(),n=e.getSelection();return{editorState:e,contentState:t,selection:n}},_getNextWidgetId(e){const t=this.state.widgets;return Object.keys(t).filter((n=>t[n].type===e)).map((e=>+e.split(" ")[1])).reduce(((e,t)=>Math.max(e,t)),0)},_createInitialWidget(e){return[e+" "+(this._getNextWidgetId(e)+1),{options:Jm.getEditor(e).defaultProps,type:e,version:Jm.getVersion(e)}]},addWidget(e){this.focus((()=>this._handleChange(this._insertNewWidget(e))))},_insertNewWidget(e,t){const n={...this._getDraftData(),...t},[s,i]=this._createInitialWidget(e),r={...this.state.widgets,[s]:i};return{editorState:this._insertWidgetText(n,s).editorState,widgets:r}},_insertWidgetText(e,t){const n=eb.replace("{id}",t),s=Wm.Entity.create("WIDGET","IMMUTABLE",{id:t});return Qm.replaceSelection(e,n,s)},updateWidget(e,t){this.setState({widgets:{...this.state.widgets,[e]:t}})},removeWidget(e){this.focus((()=>{const{editorState:t,contentState:n}=this._getDraftData(),s=Qm.findPattern(n,sb(e)),i=Qm.deleteSelection({editorState:t,selection:s});this._handleChange({editorState:i.editorState})}))},addTemplate(e){this.focus((()=>{this._addTemplate(e)}))},_addTemplate(e){let{editorState:t,contentState:n,selection:s}=this._getDraftData();const i={...this.state.widgets},r=n.getBlockForKey(s.getEndKey());if(s=Qm.selectEnd(r),r.getText().length>0&&(n=Wm.Modifier.splitBlock(n,s),s=n.getSelectionAfter()),"allWidgets"===e){const e=Jm.getAllWidgetTypes().sort();n=Wm.Modifier.splitBlock(n,s),n=e.reduce(((e,t)=>{const[n,s]=this._createInitialWidget(t);return i[n]=s,e=this._insertWidgetText({contentState:e,selection:e.getSelectionAfter()},n).contentState,Wm.Modifier.splitBlock(e,e.getSelectionAfter())}),n),t=Wm.EditorState.push(t,n,"insert-fragment")}else{let i="";"table"===e?i="header 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9":"titledTable"===e?i="|| **Table title** ||\nheader 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9":"alignment"===e?i="$\\begin{align} x+5 &= 30 \\\\\nx+5-5 &= 30-5 \\\\\nx &= 25 \\end{align}$":"piecewise"===e&&(i="$f(x) = \\begin{cases}\n7 & \\text{if }x=1 \\\\\nf(x-1)+5 & \\text{if }x > 1\n\\end{cases}$"),t=Qm.insertText({editorState:t,contentState:n,selection:s},`\n${i}\n`).editorState}this._handleChange({editorState:t,widgets:i})},_handleCopy(){const{contentState:e,selection:t}=this._getDraftData(),n=Qm.getEntities(e,t).reduce(((e,t)=>{const n=t.getData().id;return e[n]=this.state.widgets[n],e}),{});return localStorage.perseusLastCopiedWidgets=JSON.stringify(n),!1},_createSafeWidgetMapping(e,t){const n=Object.keys(t).reduce(((e,t)=>{const[n,s]=t.split(" ");return e[n]=e[n]?Math.max(e[n],+s):+s,e}),{});return Object.keys(e).reduce(((e,t)=>{const s=t.split(" ")[0];return n[s]=n[s]?n[s]+1:1,e[t]=s+" "+n[s],e}),{})},_handlePaste(e,t,n){const s=localStorage.perseusLastCopiedWidgets;if(!s)return!1;const i=JSON.parse(s),r={...this.state.widgets},o=this._createSafeWidgetMapping(i,r),a=Wm.CharacterMetadata.create(),l=this._getDraftData();l.selection=n||l.selection;const{editorState:c}=Qm.insertText(l,e,(e=>{const t=e.replace(new RegExp("\r","g"),""),n=Array(t.length).fill(a);return{text:t.replace(tb,((e,t)=>{const s=nb.exec(e),l=s[0],c=s[1],h=o[c],p=eb.replace("{id}",h),u=Wm.Entity.create("WIDGET","IMMUTABLE",{id:h}),d=Wm.CharacterMetadata.applyEntity(a,u),g=Array(p.length).fill(d);return n.splice(t,l.length,...g),r[h]=i[c],l.replace(c,h)})),characterList:n}}));return this._handleChange({editorState:c,widgets:r}),!0},_handleDrop(e,t){const n=this.state.editorState.getCurrentContent(),s=e.getEndKey(),i=n.getBlockForKey(s),r=Qm.selectEnd(i),o=t.getLink();if(!o){const e=t.getText();return this._handlePaste(e,null,r)}{const{editorState:e}=Qm.insertText({...this._getDraftData(),selection:r},`\n![](${o})`);this._handleChange({editorState:e})}return!0},_handleDroppedFiles(e,t){const n=t.filter((e=>e.type.match("image.*")));let s=this.state.editorState.getCurrentContent();n.forEach((t=>{const n=`![](${t.name}...)`,i=Object(Wm.genKey)(),r=Wm.Entity.create("TEMP_IMAGE","IMMUTABLE",{id:i}),o=Wm.CharacterMetadata.create().merge({entity:r}),a=Array(n.length).fill(o),l=e.getEndKey(),c=s.getBlockForKey(l),h=Qm.selectEnd(c);s=Qm.insertText({contentState:s,selection:h},`\n${n}\n`,(e=>e===n?{text:n,characterList:a}:null)).contentState,this.props.imageUploader(t,(e=>{const t=this.state.editorState,n=t.getCurrentContent(),s=Qm.findEntity(n,(e=>e.getData().id===i)),r=Qm.replaceSelection({editorState:t,contentState:n,selection:s},`![](${e})`);this._handleChange({editorState:r.editorState})}))}));const i=Wm.EditorState.push(this.state.editorState,s,"insert-fragment");return this._handleChange({editorState:i}),!0},_handleTab(e){const{contentState:t,selection:n}=this._getDraftData();if(!n.isCollapsed()||!this.props.widgetEnabled)return;e.preventDefault();const s=t.getBlockForKey(n.getEndKey()).getText().substring(0,n.getEndOffset()).match(ib);if(s){const e=s[1],t=Jm.getAllWidgetTypes().filter((t=>t.substring(0,e.length)===e));if(1===t.length){const e=t[0],i=n.merge({anchorOffset:s.index});this._handleChange(this._insertNewWidget(e,{selection:i}))}}return!0},_getDecorationForStyle(e){switch(e){case"perseus-bold":return"**";case"perseus-italics":return"*";case"perseus-underline":return"__";default:return null}},_handleKeyCommand(e){const{fontSizePercentage:t}=this.state;if("perseus-increase-font-size"===e)return this.setState({fontSizePercentage:t+10}),!0;if("perseus-decrease-font-size"===e)return this.setState({fontSizePercentage:t-10}),!0;if("perseus-reset-font-size"===e)return this.setState({fontSizePercentage:100}),!0;const n=this._getDecorationForStyle(e);if(null!==n){const e=this._getDraftData(),{editorState:t}=Qm.toggleDecoration(e,n);return this._handleChange({editorState:t}),!0}return!1},lastContentUpdate:"",_updateParent(e,t){const n=Qm.getEntities(e).reduce(((e,n)=>{const s=n.getData().id;return e[s]=t[s],e}),{});this.lastContentUpdate=e.getPlainText("\n"),this.props.onChange({content:this.lastContentUpdate,widgets:n})},pastContentState:null,lastIdleCallback:null,_handleChange(e){const t={...this.state,...e},n=t.widgets;let s=t.editorState;s=Qm.snapSelectionOutsideEntities({editorState:s},this.state.editorState.getSelection()).editorState;const i=s.getCurrentContent();i!==this.pastContentState&&(clearTimeout(this.lastIdleCallback),this.lastIdleCallback=setTimeout((()=>this._updateParent(i,n)),100)),this.pastContentState=i,this.setState({editorState:s,widgets:n})},focus(e){this.editor.focus();let t=this.state.editorState;t=Wm.EditorState.set(t,{selection:t.getSelection().set("hasFocus",!0),forceSelection:!0}),this.setState({editorState:t},e)},render(){return Object($t.jsx)("div",{onCopy:this._handleCopy,onCut:this._handleCopy,onDragStart:this._handleCopy,style:{fontSize:`${this.state.fontSizePercentage}%`},children:Object($t.jsx)(Wm.Editor,{ref:e=>this.editor=e,editorState:this.state.editorState,onChange:e=>this._handleChange({editorState:e}),spellCheck:!0,stripPastedStyles:!0,placeholder:this.props.placeholder,handlePastedText:this._handlePaste,handleDroppedFiles:this._handleDroppedFiles,handleDrop:this._handleDrop,keyBindingFn:wb,handleKeyCommand:this._handleKeyCommand,onTab:this._handleTab})})}});Xm.exports=Ob;var Cb=Xm.exports,Sb={exports:{}};Sb.exports;h.a;const kb=createReactClass({displayName:"KatexErrorView",getInitialState:()=>({showErrors:!1}),handleToggleKatexErrors(e){this.setState({showErrors:!this.state.showErrors})},render(){const{errorList:e}=this.props,{showErrors:t}=this.state,n=t?"icon-chevron-down":"icon-chevron-right";return Object($t.jsxs)("div",{className:Object(On.css)(_b.errorContainer),children:[Object($t.jsxs)("div",{className:Object(On.css)(_b.title),onClick:this.handleToggleKatexErrors,children:[Object($t.jsx)("i",{className:n,style:{fontSize:14}}),"\xa0 KaTeX Errors (",e.length,")"]}),t&&Object($t.jsx)("div",{className:Object(On.css)(_b.errorExplanation),children:"These errors will cause your LaTeX to load really slowly for the student. Please fix them if you can. If you can\u2019t because KaTeX doesn\u2019t support the feature you need, please message Cam."}),t&&e.map(((e,t)=>Object($t.jsxs)("div",{className:Object(On.css)(_b.error),children:[Object($t.jsx)("div",{style:{color:"red"},children:e.math}),Object($t.jsx)("div",{children:e.message})]},t)))]})}}),_b=On.StyleSheet.create({title:{backgroundColor:"#eee",fontSize:"1.25em",padding:"4px 10px"},errorContainer:{border:"1px solid #ddd",borderTop:"none"},errorExplanation:{padding:"4px 10px",backgroundColor:"pink"},error:{padding:"4px 10px"}});Sb.exports=kb;var Tb=Sb.exports,Mb=n(120),Nb=n(121),Pb={exports:{}},Ib=(Pb.exports,h.a,i.a),Eb=Nb.a,Ab=l.a,Rb=x.b,Db=Mb.a,Fb=Kt,Lb=Tb,zb=Kn,qb=Pf,Wb=ce,Bb=Fs,Vb=ss,Hb=Cb,Ub=Qp,Gb="(\\[\\[\u2603 {id}\\]\\])",$b=new RegExp(Gb.replace("{id}","[a-z-]+ [0-9]+"),"g"),Yb=/^\[\[([a-z\-]+)$/,Kb=/(?:\n{2,}|^\n*)$/,Xb=/(\n*)$/,Zb=/^(\n*)/,Jb=e=>{var t=e.toString();return t.length>=5&&(t=t.replace(/(\d)(?=(\d{3})+$)/g,"$1{,}")),t},Qb=createReactClass({displayName:"WidgetSelect",shouldComponentUpdate:function(){return!1},handleChange:function(e){var t=e.target.value;""!==t&&this.props.onChange&&this.props.onChange(t)},render:function(){var e=Bb.getPublicWidgets(),t=Rb.sortBy(Rb.keys(e),(t=>e[t].displayName));return Object($t.jsxs)("select",{value:"",onChange:this.handleChange,children:[Object($t.jsx)("option",{value:"",children:"Add a widget\u2026"}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Rb.map(t,(t=>Object($t.jsx)("option",{value:t,children:e[t].displayName},t)))]})}}),ev=createReactClass({displayName:"WidgetEditor",getInitialState:function(){return{showWidget:!1}},componentWillMount:function(){this._upgradeWidgetInfo(this.props)},componentWillReceiveProps:function(e){this._upgradeWidgetInfo(e)},_upgradeWidgetInfo:function(e){var t=Rb.omit(e,Ub),n=Bb.upgradeWidgetInfoToLatestVersion(t);this.setState({widgetInfo:n})},_toggleWidget:function(e){e.preventDefault(),this.setState({showWidget:!this.state.showWidget})},_handleWidgetChange:function(e,t,n){var s=Rb.clone(this.state.widgetInfo);s.options=Rb.extend(this.refs.widget.serialize(),e),this.props.onChange(s,t,n)},_toggleStatic:function(e){e.preventDefault();var t=Rb.extend({},this.state.widgetInfo,{static:!this.state.widgetInfo.static});this.props.onChange(t)},_handleAlignmentChange:function(e){var t=e.target.value,n=Rb.clone(this.state.widgetInfo);n.alignment=t,this.props.onChange(n)},render:function(){var e,t=this.state.widgetInfo,n=Bb.getEditor(t.type);e=this.props.apiOptions.showAlignmentOptions?Bb.getSupportedAlignments(t.type):["default"];var s=Bb.supportsStaticMode(t.type),i="transformer"===t.type,r=Object($t.jsx)(qb,{label:"Graded:",graded:t.graded,onChange:this.props.onChange});return Object($t.jsxs)("div",{className:"perseus-widget-editor",children:[Object($t.jsxs)("div",{className:"perseus-widget-editor-title "+(this.state.showWidget?"open":"closed"),children:[Object($t.jsxs)("a",{className:"perseus-widget-editor-title-id",href:"#",onClick:this._toggleWidget,children:[this.props.id,this.state.showWidget?Object($t.jsx)(Fb,{...sa}):Object($t.jsx)(Fb,{...ia})]}),s&&Object($t.jsx)("input",{type:"button",onClick:this._toggleStatic,className:"simple-button--small",value:t.static?"Unset as static":"Set as static"}),e.length>1&&Object($t.jsx)("select",{className:"alignment",value:t.alignment,onChange:this._handleAlignmentChange,children:e.map((e=>Object($t.jsx)("option",{children:e},e)))}),Object($t.jsx)("a",{href:"#",className:"remove-widget simple-button simple-button--small orange",onClick:e=>{e.preventDefault(),this.props.onRemove()},children:Object($t.jsx)(Fb,{...ya})})]}),Object($t.jsxs)("div",{className:"perseus-widget-editor-content "+(this.state.showWidget?"enter":"leave"),children:[i&&r,Object($t.jsx)(n,{ref:"widget",onChange:this._handleWidgetChange,static:t.static,apiOptions:this.props.apiOptions,...t.options})]})]})},getSaveWarnings:function(){var e=this.refs.widget.getSaveWarnings;return e?e():[]},serialize:function(){var e=this.state.widgetInfo;return{type:e.type,alignment:e.alignment,static:e.static,graded:e.graded,options:this.refs.widget.serialize(),version:e.version}}}),tv=/!\[[^\]]*\]\(([^\s\)]+)[^\)]*\)/g,nv=createReactClass({displayName:"Editor",getDefaultProps:function(){return{content:"",placeholder:"",widgets:{},images:{},disabled:!1,widgetEnabled:!0,immutableWidgets:!1,showWordCount:!1,warnNoPrompt:!1,warnNoWidgets:!1}},getInitialState:function(){return{showKatexErrors:!1}},getWidgetEditor:function(e,t){if(Bb.getEditor(t))return Object($t.jsx)(ev,{ref:e,id:e,type:t,onChange:this._handleWidgetEditorChange.bind(this,e),onRemove:this._handleWidgetEditorRemove.bind(this,e),apiOptions:this.props.apiOptions,...this.props.widgets[e]})},_handleWidgetEditorChange:function(e,t,n,s){var i=Rb.clone(this.props.widgets);i[e]=Rb.extend({},i[e],t),this.props.apiOptions.useDraftEditor&&this.refs.textarea.updateWidget(e,t),this.props.onChange({widgets:i},n,s)},_handleWidgetEditorRemove:function(e){const t=this.refs.textarea;if(this.props.apiOptions.useDraftEditor)t.removeWidget(e);else{const n=new RegExp(Gb.replace("{id}",e),"gm");this.props.onChange({content:t.value.replace(n,"")})}},_sizeImages:function(e){var t,n=(t=e.content,Rb.map(function(e,t){for(var n=[];;){var s=e.exec(t);if(!s)break;n.push(s)}return n}(tv,t),(e=>e[1]))),s=Rb.pick(e.images,n),i=Rb.filter(n,(e=>!s[e]));Rb.each(i,(t=>{Wb.getImageSize(t,((n,i)=>{s[t]={width:n,height:i},e.onChange({images:Rb.clone(s)},null,!0)}))}))},componentDidMount:function(){this._sizeImages(this.props),this.props.apiOptions.useDraftEditor||Ab(Ib.findDOMNode(this.refs.textarea)).on("copy cut",this._maybeCopyWidgets).on("paste",this._maybePasteWidgets)},componentDidUpdate:function(e){Ib.findDOMNode(this.refs.textarea).value=this.props.content,this.props.content!==e.content&&this._sizeImages(this.props)},handleDrop:function(e){if(!this.props.apiOptions.useDraftEditor){var t=this.props.content,n=e.nativeEvent.dataTransfer,s=n.files;if(0!==s.length)Rb.chain(s).map((function(e){if(!e.type.match("image.*"))return null;var n="\u2603 "+Rb.uniqueId("image_");return t+="\n\n![]("+n+")",{file:e,sentinel:n}})).reject(Rb.isNull).tap((()=>{this.props.onChange({content:t})})).each((e=>{this.props.imageUploader(e.file,(t=>{this.props.onChange({content:this.props.content.replace(e.sentinel,t)})}))}));else{var i=n.getData("URL");if(i){var r=t+"\n\n![]("+i+")";this.props.onChange({content:r})}}}},handleChange:function(){var e=Ib.findDOMNode(this.refs.textarea);this.props.onChange({content:e.value})},_handleKeyDown:function(e){if("Tab"===e.key){var t=Ib.findDOMNode(this.refs.textarea),n=Wb.textarea.getWordBeforeCursor(t),s=n.string.toLowerCase().match(Yb);if(null!=s){var i=s[1],r=Bb.getAllWidgetTypes(),o=Rb.filter(r,(e=>e.substring(0,i.length)===i));if(1===o.length){var a=o[0];this._addWidgetToContent(this.props.content,[n.pos.start,n.pos.end+1],a)}e.preventDefault()}}},_maybeCopyWidgets:function(e){var t=e.target,n=t.value.substring(t.selectionStart,t.selectionEnd),s=Rb.map(n.match($b),(e=>Wb.rWidgetParts.exec(e)[1])),i=Rb.pick(this.serialize().widgets,s);localStorage.perseusLastCopiedText=n,localStorage.perseusLastCopiedWidgets=JSON.stringify(i),console.log(`Widgets copied: ${localStorage.perseusLastCopiedWidgets}`)},_maybePasteWidgets:function(e){var t=localStorage.perseusLastCopiedWidgets,n=localStorage.perseusLastCopiedText,s=e.originalEvent.clipboardData.getData("text");if(t&&n===s){e.preventDefault();var i=JSON.parse(t),r=this._safeWidgetNameMapping(i),o={};for(const[e,t]of Object.entries(i))o[r[e]]=t;var a=Rb.extend(o,this.props.widgets),l=n.replace($b,(e=>{var t=Wb.rWidgetParts.exec(e),n=t[0],s=t[1];return n.replace(s,r[s])})),c=e.target,h=c.selectionStart,p=this.props.content.substr(0,h)+l+this.props.content.substr(c.selectionEnd);this.props.onChange({content:p,widgets:a},(()=>{var e=h+l.length;Wb.textarea.moveCursor(c,e)}))}},_safeWidgetNameMapping:function(e){var t=Rb.keys(e).map((e=>e.split(" "))),n=Rb.uniq(t.map((e=>e[0]))),s=Rb.keys(this.props.widgets).map((e=>e.split(" "))),i={};Rb.each(n,(e=>{i[e]=Rb.chain(s).filter((t=>t[0]===e)).map((e=>+e[1]+1)).max().value(),i[e]=Math.max(i[e],1)}));var r={};return Rb.each(t,(e=>{var t=e.join(" "),n=e[0];r[t]=`${n} ${i[n]}`,i[n]++})),r},_addWidgetToContent:function(e,t,n){var s=Ib.findDOMNode(this.refs.textarea),i=Rb.map(e.match($b),(e=>{var t=Wb.rWidgetParts.exec(e);return[t[2],+t[3]]})),r=Rb.reduce(i,((e,t)=>{var[s,i]=t;return s===n?Math.max(i+1,e):e}),1),o=n+" "+r,a="[[\u2603 {id}]]".replace("{id}",o),l="block"===Bb.getDefaultAlignment(n),c=e.slice(0,t[0]),h=e.slice(t[1]),p=(l?(e=>{if(Kb.test(e))return e;var t=Xb.exec(e)[1];return e+"\n\n".slice(0,2-t.length)})(c):c)+a+(l?(e=>{var t=Zb.exec(e)[1];return"\n\n".slice(0,2-t.length)+e})(h):h),u=Rb.clone(this.props.widgets);u[o]={options:Bb.getEditor(n).defaultProps,type:n,version:Bb.getVersion(n)},this.props.onChange({content:p,widgets:u},(function(){Wb.textarea.moveCursor(s,p.length-h.length)}))},_addWidget:function(e){var t=this.refs.textarea;this.props.apiOptions.useDraftEditor?t.addWidget(e):(this._addWidgetToContent(this.props.content,[t.selectionStart,t.selectionEnd],e),t.focus())},addTemplate:function(e){var t=e.target.value;if(""!==t)if(e.target.value="",this.props.apiOptions.useDraftEditor)this.refs.textarea.addTemplate(t);else{var n,s=this.props.content;if(s=s.replace(/\n*$/,"\n\n"),"table"===t)n="header 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9";else if("titledTable"===t)n="|| **Table title** ||\nheader 1 | header 2 | header 3\n- | - | -\ndata 1 | data 2 | data 3\ndata 4 | data 5 | data 6\ndata 7 | data 8 | data 9";else if("alignment"===t)n="$\\begin{align} x+5 &= 30 \\\\\nx+5-5 &= 30-5 \\\\\nx &= 25 \\end{align}$";else if("piecewise"===t)n="$f(x) = \\begin{cases}\n7 & \\text{if }x=1 \\\\\nf(x-1)+5 & \\text{if }x > 1\n\\end{cases}$";else{if("allWidgets"!==t)throw new Error("Invalid template type: "+t);n=Bb.getAllWidgetTypes().map((e=>`[[${Wb.snowman} ${e} 1]]`)).join("\n\n")}var i=s+n;this.props.onChange({content:i},this.focusAndMoveToEnd)}},getSaveWarnings:function(){var e=Rb.intersection(this.widgetIds,Rb.keys(this.refs));return Rb.chain(e).map((e=>{var t=this.refs[e].getSaveWarnings,n=t?t():[];return Rb.map(n,(t=>e+": "+t))})).flatten(!0).value()},focus:function(){Ib.findDOMNode(this.refs.textarea).focus()},focusAndMoveToEnd:function(){this.focus();var e=Ib.findDOMNode(this.refs.textarea);e.selectionStart=e.value.length,e.selectionEnd=e.value.length},render:function(){var e,t,n,s,i,r,o,a=[];if(this.props.showWordCount){var l=zb.characterCount(this.props.content),c=Math.floor(l/6);o=Object($t.jsx)("span",{className:"perseus-editor-word-count",title:"~"+Jb(c)+" words ("+Jb(l)+" characters)",children:Jb(c)})}if(this.props.widgetEnabled){e=Wb.split(this.props.content,$b),t={},n=[];for(var h=0;h<e.length;h++)if(h%2===0){n.push(e[h]);const t=zb.parse(e[h]);zb.traverseContent(t,(e=>{if("math"===e.type||"blockMath"===e.type){const n=Vb(e.content);try{katex.renderToString(n)}catch(t){a.push({math:n,message:t.message})}}}))}else{var p=Wb.rWidgetParts.exec(e[h]),u=p[1],d=p[2],g=u in t;t[u]=this.getWidgetEditor(u,d);var f=g||!t[u]?"error ":"",m=g?h:u;n.push(Object($t.jsx)("b",{className:f,children:e[h]},m))}this.widgetIds=Rb.keys(t),s=Object($t.jsx)(Qb,{ref:"widgetSelect",onChange:this._addWidget});i=Object($t.jsxs)("select",{onChange:this.addTemplate,children:[Object($t.jsx)("option",{value:"",children:"Insert template\u2026"}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Object($t.jsx)("option",{value:"table",children:"Table"}),Object($t.jsx)("option",{value:"titledTable",children:"Titled table"}),Object($t.jsx)("option",{value:"alignment",children:"Aligned equations"}),Object($t.jsx)("option",{value:"piecewise",children:"Piecewise function"}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Object($t.jsx)("option",{value:"allWidgets",children:"All widgets (for testing)"})]}),this.props.immutableWidgets||(r=Object($t.jsxs)("div",{className:"perseus-editor-widgets",children:[Object($t.jsxs)("div",{className:"perseus-editor-widgets-selectors",children:[s,i,o]}),Eb(t)]}),o=null)}else n=[this.props.content];n.push(Object($t.jsx)("br",{},"end"));var b,v=[Object($t.jsx)("div",{className:"perseus-textarea-underlay",ref:"underlay",children:n},"underlay"),Object($t.jsx)("textarea",{ref:"textarea",onChange:this.handleChange,onKeyDown:this._handleKeyDown,placeholder:this.props.placeholder,disabled:this.props.disabled,value:this.props.content},"textarea")];this.props.apiOptions.useDraftEditor&&(v=Object($t.jsx)(Hb,{ref:"textarea",onChange:this.props.onChange,content:this.props.content,placeholder:this.props.placeholder,initialWidgets:this.props.widgets,imageUploader:this.props.imageUploader,widgetEnabled:this.props.widgetEnabled})),b=this.props.imageUploader?Object($t.jsx)(Db,{onDrop:this.handleDrop,className:"perseus-textarea-pair",children:v}):Object($t.jsx)("div",{className:"perseus-textarea-pair",children:v});var x=0===this.props.content.replace(/\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/g,"").trim().length,y=!/\[\[\u2603 (([a-z-]+) ([0-9]+))\]\]/g.test(this.props.content),j={borderTop:"none",padding:4,backgroundColor:"pink"};return Object($t.jsxs)("div",{className:"perseus-single-editor "+(this.props.className||""),children:[b,a.length>0&&Object($t.jsx)(Lb,{errorList:a}),this.props.warnNoPrompt&&x&&Object($t.jsx)("div",{style:j,children:"Graded Groups should contain a prompt"}),this.props.warnNoWidgets&&y&&Object($t.jsx)("div",{style:j,children:"Graded Groups should contain at least one widget"}),o,r]})},serialize:function(e){var t={},n=Rb.intersection(this.widgetIds,Rb.keys(this.refs));return Rb.each(n,(e=>{t[e]=this.refs[e].serialize()})),e&&e.keepDeletedWidgets&&Rb.chain(this.props.widgets).keys().reject((e=>Rb.contains(n,e))).each((e=>{t[e]=this.props.widgets[e]})),{replace:this.props.replace,content:this.props.content,images:this.props.images,widgets:t}}});Pb.exports=nv;var sv=Pb.exports,iv={exports:{}};iv.exports;h.a;const rv=i.a,ov=x.b,av=ce,lv=sd,cv=qd,hv=sv,pv=zm.widget,uv=createReactClass({displayName:"TableEditor",getDefaultProps:function(){return{headers:[""],rows:4,columns:1,answers:ov.times(4,(function(){return av.stringArrayOfSize(1)}))}},focus:function(){rv.findDOMNode(this.refs.numberOfColumns).focus()},render:function(){var e=ov.pick(this.props,"headers","answers","onChange","apiOptions");return ov.extend(e,{editableHeaders:!0,Editor:hv,onFocus:()=>{},onBlur:()=>{},trackInteraction:()=>{}}),Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Number of columns:"," ",Object($t.jsx)(cv,{ref:"numberOfColumns",value:this.props.columns,onChange:e=>{e&&this.onSizeInput(this.props.rows,e)},useArrowKeys:!0})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Number of rows:"," ",Object($t.jsx)(cv,{ref:"numberOfRows",value:this.props.rows,onChange:e=>{e&&this.onSizeInput(e,this.props.columns)},useArrowKeys:!0})]})}),Object($t.jsxs)("div",{children:[" ","Table of answers:"," ",Object($t.jsx)(lv,{children:Object($t.jsx)("p",{children:"The student has to fill out all cells in the table. For partially filled tables create a table using the template, and insert text input boxes as desired."})})]}),Object($t.jsx)("div",{children:Object($t.jsx)(pv,{...e})})]})},onSizeInput:function(e,t){var n=+e||0,s=+t||0;n=Math.min(Math.max(1,n),30),s=Math.min(Math.max(1,s),6);var i=this.props.columns,r=this.props.rows,o=this.props.answers;function a(e){s<=i?e.length=s:ov.times(s-i,(function(){e.push("")}))}n<=r?o.length=n:ov.times(n-r,(function(){o.push(av.stringArrayOfSize(i))}));var l=this.props.headers;a(l),ov.each(o,a),this.props.onChange({rows:n,columns:s,answers:o,headers:l})},serialize:function(){var e=ov.pick(this.props,"headers","rows","columns");return ov.extend({},e,{answers:ov.map(this.props.answers,ov.clone)})}});iv.exports=uv;var dv=iv.exports,gv={exports:{}};gv.exports;h.a;const fv=x.b,mv=sd,bv=Pf,vv=bs,xv="horizontal",yv=createReactClass({displayName:"SorterEditor",getDefaultProps:function(){return{correct:["$x$","$y$","$z$"],layout:xv,padding:!0}},render:function(){var e=this;return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:[" ","Correct answer:"," ",Object($t.jsx)(mv,{children:Object($t.jsx)("p",{children:"Enter the correct answer (in the correct order) here. The preview on the right will have the cards in a randomized order, which is how the student will see them."})})]}),Object($t.jsx)(vv,{options:this.props.correct,onChange:function(t,n){e.props.onChange({correct:t},n)},layout:this.props.layout}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Layout:"," ",Object($t.jsxs)("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[Object($t.jsx)("option",{value:xv,children:"Horizontal"}),Object($t.jsx)("option",{value:"vertical",children:"Vertical"})]})]}),Object($t.jsx)(mv,{children:Object($t.jsx)("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text and larger images."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)(bv,{label:"Padding:",padding:this.props.padding,onChange:this.props.onChange}),Object($t.jsx)(mv,{children:Object($t.jsx)("p",{children:"Padding is good for text, but not needed for images."})})]})]})},onLayoutChange:function(e){this.props.onChange({layout:e.target.value})},serialize:function(){return fv.pick(this.props,"correct","layout","padding")}});gv.exports=yv;var jv=gv.exports,wv={exports:{}};wv.exports;h.a;const Ov=i.a,Cv=x.b,Sv=ce,kv=ah,_v=Ss.ClassNames,Tv=ts,Mv="horizontal",Nv="vertical",Pv="static",Iv="dragging",Ev="animating",Av="disabled",Rv=createReactClass({displayName:"Placeholder",render:function(){const{layout:e}=this.props,t=Object(On.css)(Lv.card,Lv.placeholder,e===Mv&&Lv.horizontalCard),n={width:this.props.width,height:this.props.height};return null!=this.props.margin&&(n.margin=this.props.margin),Object($t.jsx)("li",{className:t,style:n})}}),Dv=createReactClass({displayName:"Draggable",getDefaultProps:function(){return{includePadding:!0,type:Pv,linterContext:je}},getInitialState:function(){return{startPosition:{left:0,top:0},startMouse:{left:0,top:0},mouse:{left:0,top:0}}},componentDidMount:function(){this.isMouseMoveUpBound=!1},componentWillUnmount:function(){this.isMouseMoveUpBound&&this.unbindMouseMoveUp()},getCurrentPosition:function(){return{left:this.state.startPosition.left+this.state.mouse.left-this.state.startMouse.left,top:this.state.startPosition.top+this.state.mouse.top-this.state.startMouse.top}},render:function(){const{includePadding:e,layout:t,type:n}=this.props;let s=Object(On.css)(Lv.card,Lv.draggable,t===Mv&&Lv.horizontalCard,t===Nv&&Lv.verticalCard,n===Iv&&Lv.dragging,n===Ev&&Lv.animating,n===Av&&Lv.disabled,!e&&Lv.unpaddedCard)+" "+_v.INTERACTIVE+" perseus-sortable-draggable";e||(s+=" perseus-sortable-draggable-unpadded");const i={position:"static"};return this.props.type!==Iv&&this.props.type!==Ev||Cv.extend(i,{position:"absolute"},this.getCurrentPosition()),this.props.width&&(i.width=this.props.width+1),this.props.height&&(i.height=this.props.height),null!=this.props.margin&&(i.margin=this.props.margin),Object($t.jsx)("li",{className:s,style:i,onMouseDown:this.onMouseDown,onTouchStart:this.onMouseDown,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp,children:Object($t.jsx)(kv,{content:this.props.content,linterContext:Tv.pushContextStack(this.props.linterContext,"draggable"),onRender:this.props.onRender})})},componentDidUpdate:function(e){if(this.props.type!==e.type)if(this.props.type===Ev){const e=this.getCurrentPosition(),t=15*Math.sqrt(Math.sqrt(Math.pow(this.props.endPosition.left-e.left,2)+Math.pow(this.props.endPosition.top-e.top,2)));$(Ov.findDOMNode(this)).animate(this.props.endPosition,{duration:Math.max(t,1),complete:this.props.onAnimationEnd})}else this.props.type===Pv&&$(Ov.findDOMNode(this)).finish()},bindMouseMoveUp:function(){this.isMouseMoveUpBound=!0,$(document).on("mousemove",this.onMouseMove),$(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.isMouseMoveUpBound=!1,$(document).off("mousemove",this.onMouseMove),$(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){if(this.props.type!==Pv)return;if(0!==e.button&&(null==e.touches||1!==e.touches.length))return;e.preventDefault();const t=Sv.extractPointerLocation(e);t&&this.setState({startPosition:$(Ov.findDOMNode(this)).position(),startMouse:t,mouse:t},(function(){this.bindMouseMoveUp(),this.props.onMouseDown()}))},onMouseMove:function(e){if(this.props.type!==Iv)return;e.preventDefault();const t=Sv.extractPointerLocation(e);t&&this.setState({mouse:t},this.props.onMouseMove)},onMouseUp:function(e){if(this.props.type!==Iv)return;e.preventDefault();Sv.extractPointerLocation(e)&&(this.unbindMouseMoveUp(),this.props.onMouseUp())}}),Fv=createReactClass({displayName:"Sortable",getDefaultProps:function(){return{layout:Mv,padding:!0,disabled:!1,constraints:{},onMeasure:function(){},margin:5,onChange:function(){},linterContext:je}},getInitialState:function(){return{items:this.itemsFromProps(this.props)}},componentWillReceiveProps:function(e){const t=this.props;Cv.isEqual(e.options,t.options)?e.layout===t.layout&&e.padding===t.padding&&e.disabled===t.disabled&&Cv.isEqual(e.constraints,t.constraints)||this.setState({items:this.clearItemMeasurements(this.state.items)}):this.setState({items:this.itemsFromProps(e)})},componentDidUpdate:function(e){this.state.items.length&&!this.state.items[0].width&&this.measureItems()},itemsFromProps:function(e){const t=e.disabled?Av:Pv;return Cv.map(e.options,(function(e,n){return{option:e,key:n,type:t,endPosition:{},width:0,height:0}}))},clearItemMeasurements:function(e){return Cv.map(e,(function(e){return Cv.extend(e,{width:0,height:0})}))},measureItems:function(){let e=Cv.clone(this.state.items);const t=Cv.map(e,(function(e){return $(Ov.findDOMNode(this.refs[e.key]))}),this),n=Cv.invoke(t,"outerWidth"),s=Cv.invoke(t,"outerHeight"),i=this.props.constraints,r=this.props.layout;let o,a;i.width?o=Cv.max(n.concat(i.width)):r===Nv&&(o=Cv.max(n)),i.height?a=Cv.max(s.concat(i.height)):r===Mv&&(a=Cv.max(s)),e=Cv.map(e,(function(e,t){return e.width=o||n[t],e.height=a||s[t],e})),this.setState({items:e},(()=>{this.props.onMeasure({widths:n,heights:s})}))},remeasureItems:Cv.debounce((function(){this.setState({items:this.clearItemMeasurements(this.state.items)})}),20),render:function(){const e=[],{layout:t}=this.props,n=Object(On.css)(Lv.sortable)+" perseus-sortable";return Cv.each(this.state.items,(function(n,s,i){const r=s===i.length-1,o=n.type===Pv||n.type===Av;let a;this.props.layout===Mv?a="0 "+this.props.margin+"px 0 0":this.props.layout===Nv&&(a="0 0 "+this.props.margin+"px 0"),e.push(Object($t.jsx)(Dv,{content:n.option,type:n.type,ref:n.key,width:n.width,height:n.height,layout:t,includePadding:this.props.padding,margin:r&&o?0:a,endPosition:n.endPosition,linterContext:Tv.pushContextStack(this.props.linterContext,"sortable"),onRender:this.remeasureItems,onMouseDown:this.onMouseDown.bind(this,n.key),onMouseMove:this.onMouseMove.bind(this,n.key),onMouseUp:this.onMouseUp.bind(this,n.key),onTouchMove:this.onMouseMove.bind(this,n.key),onTouchEnd:this.onMouseUp.bind(this,n.key),onTouchCancel:this.onMouseUp.bind(this,n.key),onAnimationEnd:this.onAnimationEnd.bind(this,n.key)},n.key)),n.type!==Iv&&n.type!==Ev||e.push(Object($t.jsx)(Rv,{ref:"placeholder_"+n.key,width:n.width,height:n.height,layout:t,margin:r?0:a},"placeholder_"+n.key))}),this),Object($t.jsx)("ul",{className:n,children:e})},onMouseDown:function(e){const t=Cv.map(this.state.items,(function(t){return t.key===e&&(t.type=Iv),t}));this.setState({items:t})},onMouseMove:function(e){const t=$(Ov.findDOMNode(this.refs[e])),n=$(Ov.findDOMNode(this)),s=Cv.clone(this.state.items),i=Cv.findWhere(this.state.items,{key:e}),r=this.props.margin,o=Cv.indexOf(s,i);let a=0;if(s.splice(o,1),this.props.layout===Mv){const e=t.offset().left-n.offset().left;let i,o=0;Cv.each(s,(function(t){i=t.width,e>o+i/2&&(a+=1),o+=i+r}))}else{const e=t.offset().top-n.offset().top;let i,o=0;Cv.each(s,(function(t){i=t.height,e>o+i/2&&(a+=1),o+=i+r}))}a!==o&&(s.splice(a,0,i),this.setState({items:s}))},onMouseUp:function(e){const t=Cv.map(this.state.items,(function(t){return t.key===e&&(t.type=Ev,t.endPosition=$(Ov.findDOMNode(this.refs["placeholder_"+e])).position()),t}),this);this.setState({items:t}),this.props.onChange({})},onAnimationEnd:function(e){const t=Cv.map(this.state.items,(function(t){return t.key===e&&(t.type=Pv),t}));this.setState({items:t})},getOptions:function(){return Cv.pluck(this.state.items,"option")}}),Lv=On.StyleSheet.create({sortable:{boxSizing:"border-box",float:"left",padding:0,margin:0},card:{boxSizing:"border-box",background:"#fff",border:"1px solid #ddd",borderRadius:4,cursor:"pointer",minWidth:25,minHeight:44,padding:10,listStyleType:"none",userSelect:"none",touchAction:"none"},placeholder:{background:"#ddd",border:"1px solid #ccc"},draggable:{textAlign:"center"},horizontalCard:{float:"left",cursor:"ew-resize"},verticalCard:{maxWidth:"100%",cursor:"ns-resize"},unpaddedCard:{padding:0},dragging:{background:"#ffedcd",opacity:"0.8"},disabled:{backgroundColor:"inherit",border:"1px solid transparent",cursor:"default"}});wv.exports=Fv;var zv=wv.exports,qv={exports:{}},Wv=(qv.exports,h.a,x.b),Bv=zv,Vv=ce.shuffle,Hv=createReactClass({displayName:"Sorter",getDefaultProps:function(){return{correct:[],layout:"horizontal",padding:!0,problemNum:0,onChange:function(){},linterContext:je}},render:function(){var e=Vv(this.props.correct,this.props.problemNum,!0);const t=this.props.apiOptions.isMobile?8:5;return Object($t.jsx)("div",{className:"perseus-widget-sorter perseus-clearfix",children:Object($t.jsx)(Bv,{options:e,layout:this.props.layout,margin:t,padding:this.props.padding,onChange:this.handleChange,linterContext:this.props.linterContext,ref:"sortable"})})},handleChange:function(e){this.props.onChange(e),this.props.trackInteraction()},getUserInput:function(){return{options:this.refs.sortable.getOptions()}},simpleValidate:function(e){return Hv.validate(this.getUserInput(),e)}});Wv.extend(Hv,{validate:function(e,t){return{type:"points",earned:Wv.isEqual(e.options,t.correct)?1:0,total:1,message:null}}}),qv.exports={name:"sorter",displayName:"Sorter",widget:Hv,isLintable:!0};var Uv=qv.exports,Gv={exports:{}};Gv.exports;h.a;const $v=x.b,Yv=hu,Kv=iu,Xv=sd,Zv=qd,Jv=createReactClass({displayName:"SimulatorEditor",getDefaultProps:function(){return{xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",numTrials:100,proportionLabel:"Underlying proportion",proportionOrPercentage:"proportion"}},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-simulator",children:[Object($t.jsxs)("div",{children:[i18n._("X-Axis Label"),":",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:this.props.xAxisLabel,onChange:$v.partial(this.handleTargetValueChange,"xAxisLabel")})]}),Object($t.jsxs)("div",{children:[i18n._("Y-Axis Label"),":",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:this.props.yAxisLabel,onChange:$v.partial(this.handleTargetValueChange,"yAxisLabel")})]}),Object($t.jsxs)("div",{children:[i18n._('"True Proportion" Label'),":",Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:this.props.proportionLabel,onChange:$v.partial(this.handleTargetValueChange,"proportionLabel")}),Object($t.jsx)(Xv,{children:Object($t.jsx)("p",{children:'This text will be displayed next to the box in which the user enters the sample proportion for their simulation. For example, if your question is about surveying for approval ratings, you might want this to say "Sample approval rating".'})})]}),Object($t.jsxs)("div",{children:[i18n._("Proportion or Percentage"),":",Object($t.jsxs)("select",{className:"perseus-widget-dropdown",value:this.props.proportionOrPercentage,onChange:$v.partial(this.handleTargetValueChange,"proportionOrPercentage"),children:[Object($t.jsx)("option",{value:"proportion",children:"Proportion"},"proportion"),Object($t.jsx)("option",{value:"percentage",children:"Percentage"},"percentage")]}),Object($t.jsx)(Xv,{children:Object($t.jsx)("p",{children:"Do you want the user to describe their simulation in terms of a proportion or a percentage?"})})]}),Object($t.jsxs)("div",{children:[i18n._("Number of trials"),":",Object($t.jsx)(Zv,{value:this.props.numTrials,checkValidity:e=>e>=0&&e<=5e3,onChange:this.change("numTrials")}),Object($t.jsx)(Xv,{children:Object($t.jsx)("p",{children:"This controls the number of trials used in the simulation. For example, if you set this to 50, then the survey will be conducted 50 times. Warning: setting this too high (i.e., greater than 5000 or so) will freeze the page."})})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Yv.change.apply(this,t)},handleTargetValueChange:function(e,t){this.change(e,t.target.value)},serialize(){return Kv.serialize.call(this)}});Gv.exports=Jv;var Qv=Gv.exports,ex={exports:{}},tx=(ex.exports,sd),nx=(h.a,i.a),sx=x.b,ix=hu,rx=Ss.Options,ox=ki.assert,ax=sc,{Path:lx,Arc:cx,Circle:hx,Label:px,Line:ux,MovablePoint:dx,MovableLine:gx}=ax,fx=qd,mx=pg,bx=(ce.seededRNG,ce),vx=G.a.number;const xx=Mi,yx=Z;var jx=createReactClass({displayName:"Histogram",getDefaultProps:function(){return{data:null,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",box:[400,400]}},getInitialState:function(){return{threshold:this._getInitialThreshold(this._range())}},componentWillReceiveProps:function(e){var t=this._range(),n=this._range(e);bx.deepEq(t,n)||this.setState({threshold:this._getInitialThreshold(n)})},_renderThresholdLine:function(){var e=[0,this._range()[1][1]],t=sx.map(e,(e=>[this.state.threshold,e]));return Object($t.jsx)(gx,{onMove:this.handleMouseInteraction,children:sx.map(t,((e,t)=>Object($t.jsx)(dx,{static:!0,coord:e,normalStyle:{stroke:"none",fill:"none"}},t)))})},_renderCircle:function(){var e=this.props.data,t=sx.reduce(e,((e,t)=>e+t),0),n=sx.reduce(e,((e,t,n)=>null!=this.state.threshold&&n<=this.state.threshold?e+t:e),0),s=n/t,i=1e-5,r=[this.props.box[0]-30,30],o=this._range()[0],a=Math.min(Math.max(this.state.threshold,o[0]),o[1]).toFixed(2);return[s>0&&(()=>{var e={key:"below",center:r,radius:20,startAngle:0,endAngle:s<1?360*s:359.99999,sector:1!==s,unscaled:!0,style:{fill:xx.LIGHT_RED,stroke:xx.RED}};return Object($t.jsx)(cx,{...e})})(),s<1&&(()=>{var e={key:"above",center:r,radius:20,startAngle:s>0?360*s:i,endAngle:360,sector:0!==s,unscaled:!0,style:{fill:xx.LIGHT_BLUE,stroke:xx.BLUE}};return Object($t.jsx)(cx,{...e})})(),(()=>{var e={key:"label",coord:[r[0],r[1]+30],text:n+" of "+t+" results below "+a+"%",direction:"center",tex:!1,unscaled:!0,style:{fontSize:"12px"}};return Object($t.jsx)(px,{...e})})()]},_renderData:function(){var e=this.props.data;this._range();return sx.map(e,((e,t)=>{if(e){var n=null!=this.state.threshold&&t<=this.state.threshold,s={fill:n?xx.LIGHT_RED:xx.LIGHT_BLUE,stroke:n?xx.RED:xx.BLUE},i=[[t,0],[t,e],[t+1,e],[t+1,0]];return Object($t.jsx)(lx,{coords:i,style:s},t)}}))},render:function(){var e=this.props.data,t=this._range(),n={xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,box:this.props.box,range:t,data:e,scale:[bx.scaleFromExtent(t[0],this.props.box[0]),bx.scaleFromExtent(t[1],this.props.box[1])]},s=[t[0][0],0],i=[t[0][1],0];return Object($t.jsxs)(ax,{box:n.box,range:n.range,options:n,setup:this._setupGraphie,onMouseMove:this.handleMouseInteraction,onMouseDown:this.handleMouseInteraction,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable,children:[Object($t.jsx)(ux,{start:s,end:i,style:{stroke:"#000",strokeWidth:1,opacity:1}}),e&&this._renderData(),e&&this._renderCircle(),e&&this._renderThresholdLine()]})},_setupGraphie:function(e,t){var n=t.data,s=t.range,i=t.scale,r=s[0][1]-s[0][0],o=s[1][1]-0,a=Math.ceil(o/20);if(sx.each(sx.range(0,s[1][1],a),(t=>{n&&e.label([s[0][0],t],yx.roundToApprox(t,2),"left",!0),e.line([s[0][0],t],[s[0][1],t],{stroke:"#000",strokeWidth:1,opacity:.3})})),n){var l=Math.ceil(r/15);sx.each(sx.range(s[0][0],s[0][1],l),(t=>{e.label([t,0],vx.round(t,2),"below",!0);e.line([t,0],[t,-8/i[1]],{stroke:"#000",strokeWidth:1})}))}var c=[s[0][0],0],h=[s[0][0],s[1][1]];e.line(c,h,{stroke:"#000",strokeWidth:2,opacity:1});var p=s[0][0]+r/2,u=n?25:0;e.label([p,-u/i[1]],t.xAxisLabel,"below",!1).css("font-weight","bold");var d=0+o/2,g=n?55:28;e.label([s[0][0]-g/i[0],d],t.yAxisLabel,"center",!1).css("font-weight","bold").css("-webkit-transform","rotate(-90deg)")},handleMouseInteraction:function(e){this.setState({threshold:e[0]})},_range:function(e){return(e=e||this.props).data?this._getRangeForData(e.data):[[0,100],[-1,10]]},_getRangeForData:function(e){var t=sx.indexOf(e,sx.find(e,(e=>e>0))),n=Math.max(0,t-10),s=sx.lastIndexOf(e,sx.last(sx.filter(e,(e=>e>0))));return[[n,Math.min(101,s+1+10)],[-1,sx.max(e)]]},_getInitialThreshold:function(e){var t=e[0];return t[0]+(t[1]-t[0])/3}}),wx=createReactClass({displayName:"Simulator",getInitialState:function(){return{invalidInput:!1}},getDefaultProps:function(){return{data:null,userProportion:null,sampleSize:null,numTrials:null,randomSeed:0,xAxisLabel:"Proportion (%)",yAxisLabel:"Number of times seen",proportionLabel:"Underlying proportion",proportionOrPercentage:"proportion",apiOptions:rx.defaults}},componentWillMount:function(){null!=this.props.randomSeed&&(this.generateNumber=bx.seededRNG(this.props.randomSeed))},componentWillReceiveProps:function(e){e.randomSeed!==this.props.randomSeed&&(this.generateNumber=bx.seededRNG(e.randomSeed))},render:function(){var e={marginLeft:"5px"},t="0px 0px 0px 2px rgba(255, 165, 0, 1)",n=sx.extend({},e,{WebkitBoxShadow:t,MozBoxShadow:t,boxShadow:t,transition:"all 0.15s"}),s=sx.extend({},e,{transition:"all 0.15s"}),i=this.state.invalidInput?n:s,r=this.props.apiOptions.staticRender?mx:fx,o=Object($t.jsxs)("div",{children:[Object($t.jsx)(r,{ref:"userProportion",style:i,value:this.calculateDisplayProportion(),checkValidity:this.checkProportionValidity,disabled:this.props.apiOptions.readOnly,onChange:this.handleUserProportionChange,onFocus:()=>this.props.onFocus(["userProportion"]),onBlur:()=>this.props.onBlur(["userProportion"])}),Object($t.jsx)(tx,{children:Object($t.jsx)("p",{children:"This controls the proportion or percentage that will be used in your simulation."})})]}),a=Object($t.jsxs)("div",{children:[Object($t.jsx)(r,{ref:"sampleSize",style:i,value:this.props.sampleSize,checkValidity:e=>e>=0,disabled:this.props.apiOptions.readOnly,onChange:this.handleSampleSizeChange,onFocus:()=>this.props.onFocus(["sampleSize"]),onBlur:()=>this.props.onBlur(["sampleSize"])}),Object($t.jsx)(tx,{children:Object($t.jsx)("p",{children:"This controls the sample size that will be used in your simulation. For example, if you set this to 100, then for each trial, responses from 100 participants will be simulated."})})]}),l=Object($t.jsxs)("div",{style:{textAlign:"right"},children:[Object($t.jsx)("b",{children:this.props.numTrials}),Object($t.jsx)(tx,{children:Object($t.jsx)("p",{children:"This is the number of trials used in the simulation. For example, if set to 50, then the survey will be conducted 50 times."})})]}),c=[{title:this.props.proportionLabel+":",value:o},{title:"Sample size:",value:a},{title:"Number of trials:",value:l}],h=Object($t.jsx)("button",{className:"simple-button",style:{margin:"20px 0"},disabled:this.props.apiOptions.readOnly,onClick:this.handleRunSimulation,children:i18n._("Run simulation")}),p={paddingBottom:this.props.data?40:0},u=Object($t.jsx)("div",{style:p,children:Object($t.jsx)(jx,{data:this.props.data,xAxisLabel:this.props.xAxisLabel,yAxisLabel:this.props.yAxisLabel,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable})});return Object($t.jsxs)("div",{children:[(e=>{var t=Object($t.jsx)("thead",{children:Object($t.jsxs)("tr",{children:[Object($t.jsx)("th",{children:"Parameter"}),Object($t.jsx)("th",{children:"Value"})]})}),n=Object($t.jsx)("tbody",{children:sx.map(e,((e,t)=>Object($t.jsxs)("tr",{children:[Object($t.jsx)("td",{children:e.title}),Object($t.jsx)("td",{children:e.value})]},t)))});return Object($t.jsxs)("table",{children:[t,n]})})(c),h,u]})},calculateDisplayProportion:function(){var e=this.props.userProportion;return"percentage"===this.props.proportionOrPercentage?Math.round(100*e):e},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ix.change.apply(this,t)},checkProportionValidity:function(e){return e>=0&&"proportion"===this.props.proportionOrPercentage&&e<=1||"percentage"===this.props.proportionOrPercentage&&e<=100},handleUserProportionChange:function(e,t){var n;null!=(n="percentage"===this.props.proportionOrPercentage?e/100:e)&&(n=Math.min(1,Math.max(0,n))),this.props.onChange({userProportion:n},t)},handleSampleSizeChange:function(e,t){null!=e&&(e=Math.min(1e3,Math.max(0,Math.floor(e)))),this.props.onChange({sampleSize:e},t)},handleRunSimulation:function(){null!=this.props.numTrials&&null!=this.props.userProportion&&null!=this.props.sampleSize?(this.setState({invalidInput:!1}),this.props.onChange({data:this.generateData()}),this.props.trackInteraction()):this.setState({invalidInput:!0})},generateData:function(e){return((e,t,n)=>{var s=()=>this.generateNumber()<n,i=sx.times(101,(()=>0));return sx.times(t,(()=>{var t=sx.times(e,s),n=sx.filter(t,sx.identity).length,r=Math.floor(100*n/e);i[r]++})),i})((e=e||this.props).sampleSize,e.numTrials,e.userProportion)},getInputPaths:function(){return[["userProportion"],["sampleSize"]]},focus:function(){var e=sx.head(this.getInputPaths());return this.focusInputPath(e),!0},focusInputPath:function(e){ox(e.length>0);var t=sx.head(e);this.refs[t].focus()},blurInputPath:function(e){ox(e.length>0);var t=sx.head(e);this.refs[t].blur()},getDOMNodeForPath:function(e){ox(e.length>0);var t=sx.head(e);return nx.findDOMNode(this.refs[t])},getGrammarTypeForPath:function(e){return ox(e.length>0),"number"},setInputValue:function(e,t,n){ox(e.length>0);var s=sx.head(e);this["handle"+(s.charAt(0).toUpperCase()+s.slice(1))+"Change"](t,n)},getUserInput:function(){return null},simpleValidate:function(e){return wx.validate(this.getUserInput(),e)}});sx.extend(wx,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}});ex.exports={name:"simulator",displayName:"Simulator",widget:wx,transform:e=>{var t=sx.clone(e);return t.randomSeed=e.problemNum,t},hidden:!0};var Ox=ex.exports,Cx={exports:{}};Cx.exports;h.a;const Sx=x.b,kx=sv,_x=Kt;var Tx=createReactClass({displayName:"StepControlButton",render:function(){return Object($t.jsx)("a",{href:"#",className:"step-control-button simple-button simple-button--small orange",onClick:e=>{e.preventDefault(),this.props.onClick()},children:Object($t.jsx)(_x,{...this.props.icon})})}});const Mx=createReactClass({displayName:"SequenceEditor",getDefaultProps:function(){return{json:[{content:"",widgets:{},images:{}}]}},render:function(){return Object($t.jsx)("div",{className:"perseus-sequence-editor",children:Sx.map(this.props.json,((e,t)=>Object($t.jsxs)("div",{children:["Step ",t+1,Object($t.jsxs)("div",{style:{display:"inline-block",float:"right"},children:[t+1<this.props.json.length&&Object($t.jsx)(Tx,{icon:oa,onClick:()=>{this._handleMoveStepLater(t)}}),t>0&&Object($t.jsx)(Tx,{icon:aa,onClick:()=>{this._handleMoveStepEarlier(t)}}),Object($t.jsx)(Tx,{icon:ya,onClick:()=>{confirm("Are you sure you want to remove step "+(t+1)+"?")&&this._handleRemoveStep(t)}}),Object($t.jsx)(Tx,{icon:fa,onClick:()=>{this._handleAddStepAfter(t)}})]}),Object($t.jsx)(kx,{ref:"editor"+t,apiOptions:this.props.apiOptions,content:e.content,widgets:e.widgets,images:e.images,widgetEnabled:!0,immutableWidgets:!1,onChange:Sx.partial(this._handleEditorChange,t)})]},t)))})},_handleEditorChange:function(e,t){var n=Sx.clone(this.props.json);n[e]=Sx.extend({},n[e],t),this.props.onChange({json:n})},serialize:function(){return{json:Sx.times(this.props.json.length,(e=>this.refs["editor"+e].serialize()))}},_handleMoveStepEarlier:function(e){if(0!==e){var t=Sx.clone(this.props.json),n=t[e];t.splice(e,1),t.splice(e-1,0,n),this.props.onChange({json:t})}},_handleMoveStepLater:function(e){var t=Sx.clone(this.props.json);if(e+1!==t.length){var n=t[e];t.splice(e,1),t.splice(e+1,0,n),this.props.onChange({json:t})}},_handleAddStepAfter:function(e){var t=Sx.clone(this.props.json),n=e>=0?{widgets:t[e].widgets}:{};t.splice(e+1,0,n),this.props.onChange({json:t})},_handleRemoveStep:function(e){var t=Sx.clone(this.props.json);t.splice(e,1),this.props.onChange({json:t})}});Cx.exports=Mx;var Nx=Cx.exports,Px={exports:{}},Ix=(Px.exports,h.a,x.b),Ex=hu;const Ax=Kt;var Rx=ah,Dx=ce,Fx=createReactClass({displayName:"Sequence",getDefaultProps:function(){return{json:[{content:"",widgets:{},images:{}}],linterContext:je}},getInitialState:function(){return{visible:1}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},render:function(){var e=Object($t.jsx)(Ax,{...ga,style:{color:"green"}}),t=Ix.chain(this.props.json).first(this.state.visible).map(((e,t)=>`[[${Dx.snowman} group ${t}]]`)).join("\n\n").value(),n={};return Ix.each(this.props.json,((t,s)=>{n[`group ${s}`]={type:"group",graded:!0,version:{major:0,minor:0},options:Ix.extend({},t,{icon:s<this.state.visible-1?e:null})}})),Object($t.jsx)("div",{className:"perseus-sequence",children:Object($t.jsx)(Rx,{ref:"renderer",content:t,widgets:n,onInteractWithWidget:this._handleInteraction,apiOptions:this.props.apiOptions,linterContext:this.props.linterContext})})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ex.change.apply(this,t)},_handleInteraction:function(e){var t=parseInt(e.split(" ")[1]);if(t===this.state.visible-1){var n=this.refs.renderer.getWidgetInstance("group "+t);n.showRationalesForCurrentlySelectedChoices();var s=n.simpleValidate();"points"===s.type&&s.total===s.earned&&(this.setState({visible:this.state.visible+1}),this.props.trackInteraction({visible:this.state.visible+1}))}}});Px.exports={name:"sequence",displayName:"Graded Sequence",widget:Fx,traverseChildWidgets:function(e,t){var n=e.json;Ix.isArray(n)||(n=[n]);var s=Ix.map(n,(e=>t(e)));return Ix.extend({},e,{json:s})},tracking:"all",hidden:!0,isLintable:!0};var Lx=Px.exports,zx={exports:{}};zx.exports;h.a;const qx=i.a,Wx=createReactClass({displayName:"TextInput",getDefaultProps:function(){return{value:"",disabled:!1}},render:function(){const{labelText:e,...t}=this.props;return Object($t.jsx)("input",{...t,type:"text","aria-label":e,onChange:e=>this.props.onChange(e.target.value)})},focus:function(){qx.findDOMNode(this).focus()},blur:function(){qx.findDOMNode(this).blur()},getValue:function(){return qx.findDOMNode(this).value},getStringValue:function(){return qx.findDOMNode(this).value.toString()},setSelectionRange:function(e,t){qx.findDOMNode(this).setSelectionRange(e,t)},getSelectionStart:function(){return qx.findDOMNode(this).selectionStart},getSelectionEnd:function(){return qx.findDOMNode(this).selectionEnd}});zx.exports=Wx;var Bx=zx.exports,Vx={exports:{}};Vx.exports;h.a;const Hx=hu,Ux=iu,Gx=qd,$x=Bx;var Yx=createReactClass({displayName:"ReactionDiagramWidgetEditor",getDefaultProps:function(){return{smiles:["",""],rotationAngle:[0,0],separators:[{type:"right",topText:"",bottomText:""}]}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Hx.change.apply(this,t)},updateMolecule:function(e){return function(t){const n=[...this.props.smiles];n[e]=t,this.change({smiles:n})}.bind(this)},updateRotation:function(e){return function(t){const n=[...this.props.rotationAngle];n[e]=t,this.change({rotationAngle:n})}.bind(this)},updateSeparators:function(e,t){return n=>{const s=this.props.separators.map((e=>({...e})));s[e][t]=n,this.change({separators:s})}},serialize(){return Ux.serialize.call(this)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["LHS SMILES:\xa0",Object($t.jsx)($x,{onChange:this.updateMolecule(0),value:this.props.smiles[0]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["LHS Rotation (deg):\xa0",Object($t.jsx)(Gx,{onChange:this.updateRotation(0),value:this.props.rotationAngle[0]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["RHS SMILES:\xa0",Object($t.jsx)($x,{onChange:this.updateMolecule(1),value:this.props.smiles[1]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["RHS Rotation (deg):\xa0",Object($t.jsx)(Gx,{onChange:this.updateRotation(1),value:this.props.rotationAngle[1]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Top of arrow text:\xa0",Object($t.jsx)($x,{onChange:this.updateSeparators(0,"topText"),value:this.props.separators[0].topText})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Bottom of arrow text:\xa0",Object($t.jsx)($x,{onChange:this.updateSeparators(0,"bottomText"),value:this.props.separators[0].bottomText})]})})]})}});Vx.exports=Yx;var Kx=Vx.exports,Xx={exports:{}};Xx.exports;const Zx=new RegExp("^[A-Za-z\\[\\]()=#+-]*$"),Jx=new RegExp("^(Cl|Br|[CONPSFBI]|\\[)");function Qx(e){this.message=e}function ey(e,t,n){const s=t[0],i=t.slice(1);let r;r=Array.isArray(e)?[...e]:{...e||{}};let o=n;return i.length>0&&(o=ey(r[s],i,n)),r[s]=o,r}function ty(e,t){if(0===t.length)return e;if(""===e)throw new Qx("Mismatched parentheses");const n=e[0],s=e.slice(1);return ty(s,"("===n?t.concat(n):")"===n?t.slice(1):t)}function ny(e,t){const n=e[0],s=e.slice(1);if("("===n){let e={...t,parens:t.parens+"("};e=function(e,t){const n=t.reduce((function(e,t){return e[t]}),e);return ey(e,t,n+1)}(t,["idx",t.idx.length-1,1]);let n=-1;t.idx[t.idx.length-1][0]%2===0&&(n=0);const i=iy(s,{...e,idx:e.idx.concat([[n,0]]),parens:e.parens.concat("(")}),r=iy(ty(s,["("]),e);return[i].concat(r)}if(")"===n){if("("!==t.parens[t.parens.length-1])throw new Qx("Mismatched parentheses");return null}throw new Qx("Invalid bare character: "+n)}function sy(e,t){const n=function(e,t){let n=null,s=null;if("["===e[0]){const t=e.indexOf("]");if(-1===t)return["",e];n=e.slice(1,t),s=e.slice(t+1)}else n=Jx.exec(e)[1],s=e.slice(n.length);return[n,s]}(e),s=n[0];if(""===s)return["error","Unable to parse bracketed atom."];const i=n[1],r=ey(t,["idx",t.idx.length-1],[1+t.idx[t.idx.length-1][0],0]);let o=iy(i,ey(r,["bond","bondType"],"single"));!Array.isArray(o)&&o&&(o=[o]);const a={type:"atom",symbol:s,bonds:o,idx:r.idx};return t.bond?{type:"bond",bondType:t.bond.bondType,to:a}:a}function iy(e,t){if(!function(e){return Zx.test(e)}(e))throw new Qx("Invalid input.");return e&&0!==e.length?(n=e,Jx.test(n)?sy(e,t||{idx:[[0,0]],parens:[],stack:[],bondModifiers:[]}):function(e){return"="===e||"#"===e}(e[0])?function(e,t){const n=e[0],s=e.slice(1);if("="===n)return iy(s,ey(t,["bond","bondType"],"double"));if("#"===n)return iy(s,ey(t,["bond","bondType"],"triple"));throw new Qx("Invalid character: "+n)}(e,t):ny(e,t)):null;var n}Xx.exports={parse:iy,ParseError:Qx};var ry=Xx.exports,oy={exports:{}};oy.exports;function ay(e,t,n,s){let i=e.symbol;if("C"===i&&1!==Object.keys(t).length&&(i=null),"1,0"===e.idx){const t=[0,0];return e.pos=t,e.baseAngle=-30+s,{type:"text",value:i,pos:t,idx:e.idx}}const r=t[e.connections.find((function(e){return t[e].pos}))],o=r.connections.indexOf(e.idx);let a=60,l=120;4===r.connections.length?(l=90,a=90):(n.find((t=>"triple"===t.bondType&&t.to===e.idx))||n.find((e=>"triple"===e.bondType&&e.to===r.idx)))&&(l=0,a=0);let c=0;const h=r.idx.split(":"),p=h[h.length-1].split(",")[0];c=parseInt(p)%2!==0?r.baseAngle-(a-l*o):r.baseAngle+(a-l*o);const u=function(e,t,n){const s=e[0],i=e[1];return[s+Math.cos(2*t*Math.PI/360)*n,i+-1*Math.sin(2*t*Math.PI/360)*n]}(r.pos,c,30);return e.pos=u,e.baseAngle=c,{type:"text",value:i,pos:u,idx:e.idx}}function ly(e,t){const n=function(e,t){let n=[e.pos[0],e.pos[1]],s=[t.pos[0],t.pos[1]];return"C"!==e.symbol&&(n=[t.pos[0]-.75*(t.pos[0]-e.pos[0]),t.pos[1]-.75*(t.pos[1]-e.pos[1])]),"C"!==t.symbol&&(s=[e.pos[0]-.75*(e.pos[0]-t.pos[0]),e.pos[1]-.75*(e.pos[1]-t.pos[1])]),[n,s]}(t[e.from],t[e.to]);return{type:"line:"+e.bondType,startPos:n[0],endPos:n[1]}}function cy(e){return e.join(":")}function hy(e,t,n){if(null===n)return[e,t];if("atom"===n.type){const s=cy(n.idx);e[s]={idx:s,symbol:n.symbol,connections:[]},n.bonds&&n.bonds.forEach((function(n){const i=cy(n.to.idx);e[s].connections.push(i),t.push({from:s,to:i,bondType:n.bondType}),hy(e,t,n.to),e[i].connections.push(s)}))}return[e,t]}function py(e,t,n,s,i){if(0===t.length)return e;const r=t.shift(),o=n[r];return o.connections.forEach((function(e){n[e].pos||t.push(e)})),py(e.concat(ay(o,n,s,i)),t,n,s,i)}function uy(e,t,n){return 0===n.length?e:uy(e.concat(ly(n[0],t)),t,n.slice(1))}function dy(e,t){const n=hy({},[],e),s=n[0],i=n[1];return uy(py([],["1,0"],s,i,t),s,i)}oy.exports={layout:dy,_atomLayout:ay,_bondLayout:ly,_bondLength:30,_convertTree:hy};oy.exports;var gy={exports:{}};gy.exports;function fy(e,t){const n=new Path2D;e.lineWidth=xy.lineWidth,e.strokeStyle=xy.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)}const my={text:function(e,t){null!==t.value&&(e.fillStyle=xy.fgColor,e.font=xy.font,e.fillText(t.value,t.pos[0]-xy.fontSizePx/2+1,t.pos[1]+xy.fontSizePx/2))},"line:single":fy,"line:double":function(e,t){let n=new Path2D;e.lineWidth=5*xy.lineWidth,e.strokeStyle=xy.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=3*xy.lineWidth,e.strokeStyle=xy.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n)},"line:triple":function(e,t){let n=new Path2D;e.lineWidth=7*xy.lineWidth,e.strokeStyle=xy.fgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),n=new Path2D,e.lineWidth=5*xy.lineWidth,e.strokeStyle=xy.bgColor,n.moveTo(t.startPos[0],t.startPos[1]),n.lineTo(t.endPos[0],t.endPos[1]),e.stroke(n),fy(e,t)}};const by={"line:single":0,"line:double":0,"line:triple":0,text:1};function vy(e,t){return by[e.type]-by[t.type]}const xy={bgColor:"rgb(255, 255, 255)",fgColor:"rgb(0, 0, 0)",fontSizePx:12,lineWidth:1};xy.font=xy.fontSizePx+"px sans",gy.exports=function(e,t){t.sort(vy).forEach(function(e){return function(t){my[t.type](e,t)}}(e))};var yy=gy.exports,jy={exports:{}};jy.exports;h.a;const wy=yy,Oy=ry,Cy=Oy.parse,Sy=Oy.ParseError,ky=createReactClass({displayName:"Molecule",getInitialState:function(){return{parsedSmiles:null,error:null}},componentWillMount:function(){this.stateFromSmiles(this.props.smiles)},componentDidMount:function(){this.canvasRender()},componentWillReceiveProps:function(e){this.stateFromSmiles(e.smiles)},componentDidUpdate:function(){this.canvasRender()},stateFromSmiles:function(e){try{this.setState({parsedSmiles:Cy(e),error:null})}catch(t){if(!(t instanceof Sy))throw t;this.setState({error:t.message})}},setCanvasBounds:function(e,t){const n=Math.max(...t.map((e=>e.pos?e.pos[0]:-1/0))),s=Math.max(...t.map((e=>e.pos?e.pos[1]:-1/0))),i=Math.min(...t.map((e=>e.pos?e.pos[0]:1/0))),r=Math.min(...t.map((e=>e.pos?e.pos[1]:1/0))),o=n-i+60,a=s-r+60;return e.width=o,e.height=a,[30-i,30-r]},canvasRender:function(){if(this.state.error||!this.state.parsedSmiles)return;const e=dy(this.state.parsedSmiles,this.props.rotationAngle),t=this.refs.canvas,n=this.setCanvasBounds(t,e),s=t.getContext("2d");s.clearRect(0,0,t.width,t.height),s.save(),s.translate(n[0],n[1]),wy(s,e),s.restore()},render:function(){let e=Object($t.jsxs)("canvas",{className:"molecule-canvas",id:this.props.id+"-molecule",ref:"canvas",children:["A molecular structure drawing. SMILES notation:",this.props.smiles,"."]});return this.state.error&&(e=Object($t.jsx)("div",{className:"error",children:this.state.error})),Object($t.jsx)("div",{className:"molecule-canvas",children:e})}}),_y=createReactClass({displayName:"MoleculeWidget",getDefaultProps:function(){return{rotationAngle:0}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},render:function(){return Object($t.jsx)(ky,{id:this.props.widgetId,smiles:this.props.smiles,rotationAngle:this.props.rotationAngle})}});jy.exports={name:"molecule-renderer",displayName:"Molecule renderer",hidden:!0,widget:_y,molecule:ky};var Ty=jy.exports,My={exports:{}};My.exports;h.a;const Ny=Ty.molecule,Py=createReactClass({displayName:"Separator",componentDidMount:function(){this.drawArrow()},componentDidUpdate:function(){this.drawArrow()},arrowLength:100,drawArrow:function(){const e=this.refs["arrowCanvas"+this.props.index],t=e.getContext("2d");t.clearRect(0,0,e.width,e.height);const n=new Path2D;t.strokeStyle="rgb(0,0,0)",t.lineWidth=1.2,t.lineCap="round";n.moveTo(5,e.height/2),n.lineTo(e.width-5,e.height/2),n.moveTo(e.width-10,e.height/2-5),n.lineTo(e.width-5,e.height/2),n.moveTo(e.width-10,e.height/2+5),n.lineTo(e.width-5,e.height/2),t.stroke(n)},render:function(){return Object($t.jsxs)("div",{className:"arrow-container",children:[Object($t.jsx)("div",{className:"above-text",children:this.props.data.topText}),Object($t.jsx)("canvas",{height:"30",id:"arrowCanvas"+this.props.index,ref:"arrowCanvas"+this.props.index,width:this.arrowLength,children:"Reaction arrow pointing to the right."}),Object($t.jsx)("div",{className:"below-text",children:this.props.data.bottomText})]})}}),Iy=createReactClass({displayName:"ReactionDiagramWidget",getDefaultProps:function(){return{smiles:[],rotationAngle:[],separators:[]}},simpleValidate:function(){return{type:"points",earned:0,total:0,message:null}},getUserInput:function(){return[]},validate:function(e,t){return{type:"points",earned:0,total:0,message:null}},focus:function(){return!0},render:function(){return Object($t.jsx)("div",{className:"reaction",ref:"reaction",children:this.props.smiles.map(((e,t)=>{const n=this.props.widgetId+"-"+t;return Object($t.jsxs)("div",{className:"molecule-container",children:[Object($t.jsx)(Ny,{id:n,rotationAngle:this.props.rotationAngle[t],smiles:e}),t===this.props.smiles.length-1?null:Object($t.jsx)(Py,{data:this.props.separators[t],index:t})]},n)}))})}});My.exports={name:"reaction-diagram",displayName:"Chemical reaction",hidden:!0,widget:Iy};var Ey=My.exports,Ay={exports:{}},Ry=(Ay.exports,h.a,i.a),Dy=x.b,Fy=Ss.ClassNames,Ly=ce.deepEq;const zy=Z,qy=Mi,Wy=Kr,By=bl,Vy=Ji;var Hy="bar",Uy="line",Gy="pic",$y="histogram",Yy="dotplot";PropTypes.oneOf([Hy,Uy,Gy,$y,Yy]),PropTypes.arrayOf(PropTypes.string),PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number,PropTypes.string])),PropTypes.number,PropTypes.number,PropTypes.number,PropTypes.number,PropTypes.number,PropTypes.string,PropTypes.arrayOf(PropTypes.number),PropTypes.number,PropTypes.arrayOf(PropTypes.number),PropTypes.bool;var Ky=createReactClass({displayName:"Plotter",getDefaultProps:function(){return{type:Hy,labels:["",""],categories:[""],scaleY:1,maxY:10,snapsPerLine:2,picSize:40,picBoxHeight:48,picUrl:"",plotDimensions:[380,300],labelInterval:1}},getInitialState:function(){return{values:this.props.starting||[1]}},DOT_PLOT_POINT_SIZE:function(){return this.props.apiOptions.isMobile?6:4},DOT_PLOT_POINT_PADDING:function(){return 8},DOT_TICK_POINT_SIZE:function(){return 2},render:function(){const e={marginBottom:this.props.labels[0]?75:0};return Object($t.jsx)("div",{className:"perseus-widget-plotter graphie "+Fy.INTERACTIVE,ref:"graphieDiv",style:e})},componentDidUpdate:function(e,t){this.shouldSetupGraphie&&this.setupGraphie(t)},componentDidMount:function(){this.setupGraphie(this.state)},componentWillReceiveProps:function(e){this.shouldSetupGraphie=Dy.any(["type","labels","categories","scaleY","maxY","snapsPerLine","picUrl","labelInterval","static"],(function(t){return!Dy.isEqual(this.props[t],e[t])}),this),Dy.isEqual(this.props.starting,e.starting)||Dy.isEqual(this.state.values,e.starting)||(this.shouldSetupGraphie=!0,this.setState({values:e.starting}))},setupGraphie:function(e){var t=this;t.shouldSetupGraphie=!1;var n=Ry.findDOMNode(t.refs.graphieDiv);$(n).empty();var s=Wy.createGraphie(n);t.graphie=s,t.graphie.pics=[],t.graphie.dotTicks=[];var i=t.props.type===Hy,r=t.props.type===Uy,o=t.props.type===Gy,a=t.props.type===$y,l=t.props.type===Yy,c=o||l,h={},p=h;const u=this.props.apiOptions.isMobile;p.graph={lines:[],bars:[],points:[],dividers:[]},p.scaleY=t.props.scaleY,p.dimX=t.props.categories.length;var d=u?[288,336]:t.props.plotDimensions;if(r)p.dimX+=u?-.2:1;else if(a)p.barPad=0,p.barWidth=1;else if(i)p.barPad=u?.08:.15,p.barWidth=1-2*p.barPad,p.dimX+=(u?-2:2)*p.barPad;else if(c){p.picBoxHeight=t.props.picBoxHeight,p.picBoxWidthPx=d[0]/t.props.categories.length;var g=d[0]-p.dimX*p.picBoxWidthPx;p.picPad=g/(2*p.dimX+2);var f=p.picBoxWidthPx+2*p.picPad;p.picPad=p.picPad/f,p.picBoxWidth=p.picBoxWidthPx/f,p.dimX+=2*p.picPad}l&&(p.picBoxHeight=2*this.DOT_PLOT_POINT_SIZE()+this.DOT_PLOT_POINT_PADDING()),p.dimY=Math.ceil(t.props.maxY/p.scaleY)*p.scaleY;var m=25,b=25;if((i||r)&&u&&(m=0!==t.props.labels[1].length?17:11),l&&(m/=2),u&&c&&0===t.props.labels[1].length&&(m=0),p.scale=u?Dy.map([[p.dimX,m],[p.dimY,b]],((e,t)=>{let[n,s]=e;return(d[t]-4*s)/n})):Dy.map([p.dimX,p.dimY],(function(e,t){return d[t]/e})),m/=p.scale[0],b/=p.scale[1],c&&(p.scale[1]=p.picBoxHeight/p.scaleY),s.init({range:[[-3*m,p.dimX+m],[-3*b,p.dimY+b]],scale:p.scale,isMobile:this.props.apiOptions.isMobile}),s.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),!c){for(var v=u?p.scaleY:0;v<=p.dimY;v+=p.scaleY)s.label([0,v],zy.roundToApprox(v,2),"left",!0),s.style({stroke:u?"#e9ebec":"#000",strokeWidth:1,opacity:u?1:.3},(function(){s.line([0,v],[p.dimX,v])}))}(i||r)&&u&&(t.graphie.dragPrompt=s.label([p.dimX/2,p.dimY/2],"Drag handles to make graph","center",!1).css("font-weight","bold").css("color",qy.KA_GREEN).css("display","none")),t.setupCategories(h),c&&u&&(t.graphie.dotPrompt=s.label([p.dimX/2,p.dimY/2],"Tap to add points","center",!1).css("font-weight","bold").css("color",qy.KA_GREEN).css("display","none")),c&&t.drawPicHeights(t.state.values,e.values),s.style({stroke:"#000",strokeWidth:2,opacity:1},(function(){c?l?s.style({stroke:u?qy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([u?0:.5,0],[p.dimX-(u?0:.5),0]))):(s.line([0,0],[p.dimX,0]),0===t.props.labels[1].length&&u||s.style({stroke:u?qy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([0,0],[0,p.dimY])))):(s.style({stroke:u?qy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([u?3*-m:0,0],[p.dimX+(u?m:0),0]))),(i||r)&&u||s.style({stroke:u?qy.GRAY_G:"#000",strokeWidth:u?1:2},(()=>s.line([0,0],[0,p.dimY]))))})),s.label([p.dimX/2,u?3*-b:-35/p.scale[1]],t.props.labels[0],u?"above":"below",!1).css("font-weight","bold").css("color",u&&qy.GRAY_F),s.label([(u?-35:-60)/p.scale[0],p.dimY/2],t.props.labels[1],"center",!1).css("font-weight","bold").css("color",u&&qy.GRAY_F).addClass("rotate"),this.props.apiOptions.isMobile&&(this.horizHairline=new Vy(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:qy.INTERACTIVE}),this.horizHairline.hide(),this.hairlineRange=[[0,p.dimX],[0,p.dimY]])},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.hairlineRange[0][0],e[1]],[this.hairlineRange[0][1],e[1]]),this.horizHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&this.horizHairline.hide()},labelCategory:function(e,t){const n=this.props.apiOptions.isMobile;var s=this.graphie,i=!1,r=(t+="").match(/^\$(.*)\$$/);r&&(t=r[1],i=!0);this.props.labels[0].length;s.style({color:n?qy.GRAY_G:"inherit",transform:n&&!r?"translateX(-50%) translateX(5px) translateY(-50%) rotate(-45deg)":"none",transformOrigin:"100%"},(()=>s.label([e,n?-.5:0],t,"below",i)))},setupCategories:function(e){var t=this,n=e,s=t.graphie;const i=this.props.apiOptions.isMobile;t.props.type===$y?(Dy.times(t.props.categories.length-1,(function(n){t.setupBar({index:n,startHeight:t.state.values[n],config:e,isHistogram:!0})})),Dy.each(t.props.categories,(function(e,r){var o=.5+r*n.barWidth;t.labelCategory(o,e);var a=6/n.scale[1];s.style({stroke:"#000",strokeWidth:i?1:2,opacity:1},(function(){s.line([o,-a],[o,0])}))}))):Dy.each(t.props.categories,(function(r,o){var a,l=t.state.values[o];t.props.type===Hy?a=t.setupBar({index:o,startHeight:l,config:e,isHistogram:!1}):t.props.type===Uy?a=t.setupLine(o,l,e):t.props.type===Gy?a=t.setupPic(o,e):t.props.type===Yy&&(a=t.setupDotplot(o,e));var c=0,h=-6/n.scale[1];t.props.type!==Yy||i||(c=-h),t.props.type===Yy?o%t.props.labelInterval!==0&&o!==t.props.categories.length-1||(t.labelCategory(a,r),c*=1.5,h*=1.5):t.labelCategory(a,r),s.style({stroke:i?qy.GRAY_G:"#000",strokeWidth:i?1:2,opacity:1},(function(){s.line([a,c],[a,h])}))}))},_clampValue:function(e,t,n){return Math.max(Math.min(e,n),t)},_maybeShowDragPrompt:function(){null!=this.graphie.dragPrompt&&(this.graphie.dragPrompt[0].style.display="inline")},_maybeHideDragPrompt:function(){null!=this.graphie.dragPrompt&&(this.graphie.dragPrompt[0].style.display="none")},setupBar:function(e){const t=this.props.apiOptions.isMobile;var n,s=e.index,i=e.startHeight,r=e.config,o=e.isHistogram,a=this,l=a.graphie,c=r.barWidth/2;n=o?.5+s*r.barWidth+c:(t?c:.5+r.barPad)+s;var h=function(e,n){var s=l.scalePoint(0);if(r.graph.bars[e].scale(1,Math.max(t?.2:.01,n/r.scaleY),s[0],s[1]),o){var i=r.graph.dividers[e-1],c=r.graph.dividers[e];if(i){var h=Math.min(a.state.values[e-1],n);i.scale(1,Math.max(.01,h/r.scaleY),s[0],s[1])}if(c){h=Math.min(a.state.values[e+1],n);c.scale(1,Math.max(.01,h/r.scaleY),s[0],s[1])}}};if(l.style({stroke:"none",fill:t?qy.BLUE_C:qy.LIGHT_BLUE,opacity:1},(function(){r.graph.bars[s]=l.path([[n-c,0],[n-c,r.scaleY],[n+c,r.scaleY],[n+c,0],[n-c,0]])})),o&&s>0&&l.style({stroke:"#000",strokeWidth:1,opacity:.3},(function(){r.graph.dividers.push(l.path([[n-c,0],[n-c,r.scaleY]]))})),t){const e=r.scaleY/a.props.snapsPerLine;r.graph.lines[s]=By.addMaybeMobileMovablePoint(this,{coord:[n,i],constraints:[(t,s,i)=>[n,this._clampValue(Math.round(t[1]/e)*e,0,r.dimY)]],onMoveStart:function(){r.graph.bars[s].attr({fill:qy.INTERACTIVE})},onMove:function(){const e=r.graph.lines[s].coord()[1];var t=Dy.clone(a.state.values);t[s]=e,a.setState({values:t}),a.changeAndTrack({values:t}),a._maybeHideDragPrompt(),h(s,e)},onMoveEnd:function(){r.graph.bars[s].attr({fill:qy.BLUE_C})}}),r.graph.lines[s].state.visibleShape.wrapper.style.zIndex="1",a._maybeShowDragPrompt()}else r.graph.lines[s]=l.addMovableLineSegment({coordA:[n-c,i],coordZ:[n+c,i],snapY:r.scaleY/a.props.snapsPerLine,constraints:{constrainX:!0},normalStyle:{stroke:qy.INTERACTIVE,"stroke-width":this.props.static?0:4}}),r.graph.lines[s].onMove=function(e,t){var n=this.coordA[1];(n<0||n>r.dimY)&&(n=Math.min(Math.max(n,0),r.dimY),this.coordA[1]=this.coordZ[1]=n,this.transform());var i=Dy.clone(a.state.values);i[s]=n,a.setState({values:i}),a.changeAndTrack({values:i}),h(s,n)};return h(s,i),n},setupLine:function(e,t,n){const s=this.props.apiOptions.isMobile;var i=this,r=n,o=i.graphie,a=e+(s?.4:1);if(s){const s=n.scaleY/i.props.snapsPerLine;r.graph.points[e]=By.addMaybeMobileMovablePoint(this,{coord:[a,t],constraints:[(e,t,i)=>[a,this._clampValue(Math.round(e[1]/s)*s,0,n.dimY)]],onMove:function(){const t=r.graph.points[e].coord()[1];var n=Dy.clone(i.state.values);n[e]=t,i.setState({values:n}),i.changeAndTrack({values:n}),i._maybeHideDragPrompt()}}),i._maybeShowDragPrompt(),e>0&&(r.graph.lines[e]=By.addMovableLine(o,{points:[r.graph.points[e-1],r.graph.points[e]],constraints:By.MovablePoint.constraints.fixed(),normalStyle:{stroke:qy.BLUE_C,"stroke-width":2},highlightStyle:{stroke:qy.BLUE_C,"stroke-width":2}}))}else r.graph.points[e]=o.addMovablePoint({coord:[a,t],constraints:{constrainX:!0},normalStyle:{fill:qy.INTERACTIVE,stroke:qy.INTERACTIVE},snapY:r.scaleY/i.props.snapsPerLine}),r.graph.points[e].onMove=function(t,n){n=Math.min(Math.max(n,0),r.dimY);var s=Dy.clone(i.state.values);return s[e]=n,i.setState({values:s}),i.changeAndTrack({values:s}),[t,n]},e>0&&(r.graph.lines[e]=o.addMovableLineSegment({pointA:r.graph.points[e-1],pointZ:r.graph.points[e],constraints:{fixed:!0},normalStyle:{stroke:"#9ab8ed","stroke-width":2}}));return a},setupDotplot:function(e,t){var n=this.graphie;const s=this.props.apiOptions.isMobile;return this.setupTiledPlot(e,s?.5:1,t,((e,t)=>n.ellipse([e,t],[this.DOT_PLOT_POINT_SIZE()/n.scale[0],this.DOT_PLOT_POINT_SIZE()/n.scale[1]],{fill:qy.INTERACTIVE,stroke:qy.INTERACTIVE})))},setupPic:function(e,t){var n=this.graphie;return this.setupTiledPlot(e,0,t,((e,t)=>{var s=n.scalePoint([e,t]),i=this.props.picSize;return n.raphael.image(this.props.picUrl,s[0]-i/2,s[1]-i/2,i,i)}))},setupTiledPlot:function(e,t,n,s){var i=this,r=n,o=i.graphie,a=o.pics,l=o.dotTicks,c=e+.5+r.picPad;o.mouselayer.canvas.style.touchAction="none",a[e]=[],l[e]=[];var h=Math.round(r.dimY/r.scaleY)+1;return Dy.times(h,(function(n){var h=((n-=1)+.5)*r.scaleY,p=c-r.picBoxWidth/2,u=h+.5*r.scaleY,d=o.scalePoint([p,u+t]),g=o.mouselayer.rect(d[0],d[1],r.picBoxWidthPx,r.picBoxHeight);$(g[0]).css({fill:"#000",opacity:0,cursor:"pointer"}).on("vmousedown",(function(n){n.preventDefault(),i.whichPicClicked=e,i.setPicHeight(e,u),$(document).on("vmouseup.plotTile",(function(e){$(document).unbind(".plotTile")})),$(document).on("vmousemove.plotTile",(function(e){e.preventDefault();var n=o.getMouseCoord(e)[1],s=Math.floor(n-t),a=(Math.max(-1,Math.floor(s/r.scaleY))+.5)*r.scaleY+.5*r.scaleY;i.setPicHeight(i.whichPicClicked,a)}))})),n<0||(a[e][n]=s(c,h+t),l[e][n]=o.ellipse([c,h+t],[i.DOT_TICK_POINT_SIZE()/o.scale[0],i.DOT_TICK_POINT_SIZE()/o.scale[1]],{fill:"#dee1e3",stroke:"#dee1e3"}))})),c},setPicHeight:function(e,t){var n=Dy.clone(this.state.values);n[e]=t,this.drawPicHeights(n,this.state.values),this.setState({values:n}),this.changeAndTrack({values:n})},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},drawPicHeights:function(e,t){var n=this,s=n.graphie,i=s.pics;const r=this.props.apiOptions.isMobile;if(r){const t=e.every((e=>0===e));s.dotPrompt[0].style.display=t?"inline":"none"}Dy.each(i,(function(i,o){Dy.each(i,(function(i,a){var l=(a+1)*n.props.scaleY,c=l<=e[o];if(n.props.type===Yy){var h=l<=t[o];c&&!h&&i.animate({"stroke-width":8},75,(()=>i.animate({"stroke-width":2},75)))}$(i[0]).css({display:c?"inline":"none"}),s.dotTicks[o][a][0].style.display=c||!r?"none":"inline"}))}))},getUserInput:function(){return this.state.values},simpleValidate:function(e){return Ky.validate(this.getUserInput(),e)}});Dy.extend(Ky,{validate:function(e,t){return Ly(e,t.starting)?{type:"invalid",message:null}:{type:"points",earned:Ly(e,t.correct)?1:0,total:1,message:null}}});var Xy=Dy.identity;Ay.exports={name:"plotter",displayName:"Plotter",widget:Ky,staticTransform:Xy};var Zy=Ay.exports,Jy={exports:{}};Jy.exports;h.a;const Qy=i.a,ej=x.b,tj=Ju.a,nj=sd,sj=qd,ij=Df,rj=Sc,oj=bs,aj=Zy.widget,lj=G.a.number,cj="line",hj="pic",pj="histogram",uj="dotplot";function dj(e,t,n){var s=ej.clone(e);s.length=t;for(var i=e.length;i<t;i++)s[i]=n;return s}const gj={scaleY:1,maxY:10,snapsPerLine:2};var fj=e=>"$"+lj.round(e,2)+"$";const mj=createReactClass({displayName:"PlotterEditor",getDefaultProps:function(){return ej.extend({},gj,{correct:[1],starting:[1],type:"bar",labels:["",""],categories:[""],picSize:30,picBoxHeight:36,picUrl:Khan.imageBase+"badges/earth-small.png",plotDimensions:[275,200],labelInterval:1})},getInitialState:function(){return{editing:"correct",pic:null,loadedUrl:null,minX:null,maxX:null,tickStep:null}},componentWillMount:function(){this.fetchPic(this.props.picUrl)},componentWillReceiveProps:function(e){this.fetchPic(e.picUrl)},fetchPic:function(e){if(this.state.loadedUrl!==e){var t=new Image;t.src=e,t.onload=()=>{this.setState({pic:t,loadedUrl:e})}}},render:function(){var e=ej.contains([cj,pj,uj],this.props.type),t=!ej.contains([hj,uj],this.props.type),n={trackInteraction:()=>{},...this.props};return Object($t.jsxs)("div",{className:"perseus-widget-plotter-editor",children:[Object($t.jsxs)("div",{children:["Chart type:"," ",ej.map(["bar",cj,hj,pj,uj],(function(e){return Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:"chart-type",checked:this.props.type===e,onChange:ej.partial(this.changeType,e)}),e]},e)}),this)]}),Object($t.jsxs)("div",{children:["Labels:"," ",ej.map(["x","y"],(function(e,t){return Object($t.jsxs)("label",{children:[e+":",Object($t.jsx)("input",{type:"text",onChange:ej.partial(this.changeLabel,t),defaultValue:this.props.labels[t]})]},e)}),this)]}),e&&Object($t.jsxs)("div",{className:"set-from-scale-box",children:[Object($t.jsx)("span",{className:"categories-title",children:"Set Categories From Scale"}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Tick Step:"," ",Object($t.jsx)(sj,{placeholder:1,useArrowKeys:!0,value:this.state.tickStep,onChange:this.handleChangeTickStep})]}),Object($t.jsx)(nj,{children:Object($t.jsx)("p",{children:"The difference between adjacent ticks."})})]}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Range:"," ",Object($t.jsx)(ij,{placeholder:[0,10],useArrowKeys:!0,value:[this.state.minX,this.state.maxX],onChange:this.handleChangeRange})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("button",{onClick:this.setCategoriesFromScale,children:["Set Categories"," "]})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Label Interval:"," ",Object($t.jsx)(sj,{useArrowKeys:!0,value:this.props.labelInterval,onChange:this.changeLabelInterval})]}),Object($t.jsx)(nj,{children:Object($t.jsx)("p",{children:'Which ticks to display the labels for. For instance, setting this to "4" will only show every 4th label (plus the last one)'})})]}),this.props.type===hj&&Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Picture:"," ",Object($t.jsx)(tj,{className:"pic-url",value:this.props.picUrl,onChange:this.changePicUrl}),Object($t.jsx)(nj,{children:Object($t.jsx)("p",{children:'Use the default picture of Earth, or insert the URL for a different picture using the "Add image" function.'})})]}),this.state.pic&&this.state.pic.width!==this.state.pic.height&&Object($t.jsxs)("p",{className:"warning",children:[Object($t.jsx)("b",{children:"Warning"}),": You are using a picture which is not square. This means the image will get distorted. You should probably crop it to be square."]})]}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Categories:"," ",Object($t.jsx)(oj,{ref:"categories",layout:"horizontal",options:this.props.categories,onChange:this.changeCategories})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Scale (y):"," ",Object($t.jsx)("input",{type:"text",onChange:this.changeScale,defaultValue:this.props.scaleY})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Max y:"," ",Object($t.jsx)("input",{type:"text",ref:"maxY",onChange:this.changeMax,defaultValue:this.props.maxY})]})}),t&&Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Snaps per line:"," ",Object($t.jsx)("input",{type:"text",onChange:this.changeSnaps,defaultValue:this.props.snapsPerLine})]}),Object($t.jsx)(nj,{children:Object($t.jsx)("p",{children:"Creates the specified number of divisions between the horizontal lines. Fewer snaps between lines makes the graph easier for the student to create correctly."})})]}),Object($t.jsxs)("div",{children:["Editing values:"," ",ej.map(["correct","starting"],(function(e){return Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"radio",name:"editing",checked:this.state.editing===e,onChange:ej.partial(this.changeEditing,e)}),e]},e)}),this),Object($t.jsxs)(nj,{children:[Object($t.jsx)("p",{children:"Use this toggle to switch between editing the correct answer (what the student will be graded on) and the starting values (what the student will see plotted when they start the problem). Note: These cannot be the same."}),Object($t.jsx)("p",{children:"In static mode, the starting values are rendered out to the displayed widget."})]})]}),Object($t.jsx)(aj,{...n,starting:this.props[this.state.editing],onChange:this.handlePlotterChange})]})},handleChangeTickStep:function(e){this.setState({tickStep:e})},handleChangeRange:function(e){this.setState({minX:e[0],maxX:e[1]})},changeLabelInterval:function(e){this.props.onChange({labelInterval:e})},handlePlotterChange:function(e){var t={};t[this.state.editing]=e.values,this.props.onChange(t)},changeType:function(e){var t;e===pj?(t=[fj(0)].concat(this.props.categories),this.props.onChange({type:e,categories:t})):this.props.type===pj?(t=this.props.categories.slice(1),this.props.onChange({type:e,categories:t})):this.props.onChange({type:e}),t&&(Qy.findDOMNode(this.refs.categories).value=t.join(", "))},changeLabel:function(e,t){var n=ej.clone(this.props.labels);n[e]=t.target.value,this.props.onChange({labels:n})},changePicUrl:function(e){var t=rj.getRealImageUrl(e);this.props.onChange({picUrl:t})},changeCategories:function(e){var t=e.length;this.props.type===pj&&t--;var n=this.props.scaleY;this.props.onChange({categories:e,correct:dj(this.props.correct,t,n),starting:dj(this.props.starting,t,n)})},changeScale:function(e){var t=this.props.scaleY,n=+e.target.value||gj.scaleY,s=function(e){return e*n/t},i=s(this.props.maxY);this.props.onChange({scaleY:n,maxY:i,correct:ej.map(this.props.correct,s),starting:ej.map(this.props.starting,s)}),Qy.findDOMNode(this.refs.maxY).value=i},changeMax:function(e){this.props.onChange({maxY:+e.target.value||gj.maxY})},changeSnaps:function(e){this.props.onChange({snapsPerLine:+e.target.value||gj.snapsPerLine})},changeEditing:function(e){this.setState({editing:e})},setCategoriesFromScale:function(){var e,t=this.state.tickStep||1,n=this.state.minX||0,s=this.state.maxX||0,i=Math.floor((s-n)/t)*t;e=this.props.type===pj||this.props.type===uj?ej.range(0,i+t,t):ej.range(t,i+t,t),e=ej.map(e,(e=>e+n)),e=ej.map(e,fj),this.changeCategories(e),Qy.findDOMNode(this.refs.categories).value=e.join(", ")},serialize:function(){var e=ej.pick(this.props,"correct","starting","type","labels","categories","scaleY","maxY","snapsPerLine","labelInterval");return this.props.type===hj&&(e.picUrl=this.props.picUrl),e}});Jy.exports=mj;var bj=Jy.exports,vj={exports:{}};vj.exports;h.a,x.b;const xj=hu,yj=iu,jj=createReactClass({displayName:"PassageRefTargetEditor",getDefaultProps:function(){return{content:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return xj.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:["Content:",Object($t.jsx)("input",{type:"text",value:this.props.content,onChange:this.handleContentChange})]})},handleContentChange:function(e){this.change({content:e.target.value})},serialize(){return yj.serialize.call(this)}});vj.exports=jj;var wj=vj.exports,Oj={exports:{}},Cj=(Oj.exports,h.a,x.b),Sj=hu,kj=Du,_j=ah,Tj=createReactClass({displayName:"PassageRefTarget",getDefaultProps:function(){return{content:"",linterContext:je}},getUserInput:function(){return kj.getUserInput.call(this)},render:function(){return Object($t.jsx)(_j,{content:this.props.content,inline:!0,apiOptions:this.props.apiOptions,linterContext:this.props.linterContext})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Sj.change.apply(this,t)},simpleValidate:function(e){return Tj.validate(this.getUserInput(),e)}});Cj.extend(Tj,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),Oj.exports={name:"passage-ref-target",displayName:"PassageRefTarget",defaultAlignment:"inline",widget:Tj,hidden:!0,transform:e=>Cj.pick(e,"content"),version:{major:0,minor:0},isLintable:!0};var Mj=Oj.exports,Nj={exports:{}};Nj.exports;h.a;const Pj=hu,Ij=iu,Ej=sd,Aj=qd,Rj=Bx,Dj=createReactClass({displayName:"PassageRefEditor",getDefaultProps:function(){return{passageNumber:1,referenceNumber:1,summaryText:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Pj.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Passage Number: ",Object($t.jsx)(Aj,{value:this.props.passageNumber,onChange:this.change("passageNumber")})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Reference Number: ",Object($t.jsx)(Aj,{value:this.props.referenceNumber,onChange:this.change("referenceNumber")})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Summary Text: ",Object($t.jsx)(Rj,{value:this.props.summaryText,onChange:this.change("summaryText")}),Object($t.jsxs)(Ej,{children:[Object($t.jsx)("p",{children:"Short summary of the referenced section. This will be included in parentheses and quotes automatically."}),Object($t.jsx)("p",{children:"Ex: The start ... the end"})]})]})})]})},serialize(){return Ij.serialize.call(this)}});Nj.exports=Dj;var Fj=Nj.exports,Lj={exports:{}},zj=(Lj.exports,h.a,x.b),qj=hu,Wj=Kn,Bj=Du,Vj=createReactClass({displayName:"PassageRef",getDefaultProps:function(){return{passageNumber:1,referenceNumber:1,summaryText:""}},getInitialState:function(){return{lineRange:null,content:null}},shouldComponentUpdate:function(e,t){return!zj.isEqual(this.props,e)||!zj.isEqual(this.state,t)},getUserInput:function(){return Bj.getUserInput.call(this)},render:function(){var e,t,n=this.state.lineRange;if(e=n?n[0]===n[1]?$_({lineNumber:n[0]},"line %(lineNumber)s"):$_({lineRange:n[0]+"\u2013"+n[1]},"lines %(lineRange)s"):$_({lineRange:"?\u2013?"},"lines %(lineRange)s"),this.props.summaryText){var s=Wj.parseInline(this.props.summaryText);t=Object($t.jsxs)("span",{"aria-hidden":!0,children:[" ","(\u201c",Wj.basicOutput(s),"\u201d)"]})}else t=null;return Object($t.jsxs)("span",{children:[e,t,n&&Object($t.jsx)("div",{className:"perseus-sr-only",children:this.state.content})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return qj.change.apply(this,t)},componentDidMount:function(){this._deferredUpdateRange(),this._throttledUpdateRange=zj.throttle(this._deferredUpdateRange,500),window.addEventListener("resize",this._throttledUpdateRange)},componentDidUpdate:function(){this._deferredUpdateRange()},componentWillUnmount:function(){window.removeEventListener("resize",this._throttledUpdateRange)},_deferredUpdateRange:function(){zj.defer(this._updateRange)},_updateRange:function(){var e=this.props.findWidgets("passage "+this.props.passageNumber)[0],t=null;e&&(t=e.getReference(this.props.referenceNumber)),this.isMounted()&&(t?this.setState({lineRange:[t.startLine,t.endLine],content:t.content}):this.setState({lineRange:null,content:null}))},simpleValidate:function(e){return Vj.validate(this.getUserInput(),e)}});zj.extend(Vj,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),Lj.exports={name:"passage-ref",displayName:"PassageRef (SAT only)",defaultAlignment:"inline",widget:Vj,transform:e=>zj.pick(e,"passageNumber","referenceNumber","summaryText"),version:{major:0,minor:1}};var Hj=Lj.exports,Uj={exports:{}};Uj.exports;h.a,x.b;const Gj=hu,$j=iu,Yj=sv,Kj=sd,Xj=Pf,Zj=createReactClass({displayName:"PassageEditor",getDefaultProps:function(){return{passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Gj.change.apply(this,t)},render:function(){var e=Object($t.jsx)(Yj,{ref:"passage-editor",apiOptions:this.props.apiOptions,content:this.props.passageText,widgetEnabled:!1,placeholder:"Type passage here...",onChange:e=>{this.change({passageText:e.content})},showWordCount:!0}),t=Object($t.jsx)(Yj,{ref:"passage-footnotes-editor",apiOptions:this.props.apiOptions,content:this.props.footnotes,widgetEnabled:!1,placeholder:"Type footnotes here...",onChange:e=>{this.change({footnotes:e.content})}});return Object($t.jsxs)("div",{className:"perseus-widget-passage-editor",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(Xj,{label:"Show line numbers",labelAlignment:"right",showLineNumbers:this.props.showLineNumbers,onChange:this.props.onChange})}),Object($t.jsxs)("div",{children:["Passage title:",Object($t.jsx)(Kj,{children:Object($t.jsx)("p",{children:"An optional title that will appear directly above the passage in the same font style. (E.g. Passage 1)"})}),Object($t.jsx)("div",{children:Object($t.jsx)("input",{type:"text",defaultValue:this.props.passageTitle,onChange:e=>{this.change({passageTitle:e.target.value})}})})]}),Object($t.jsxs)("div",{children:["Passage Text:",e]}),Object($t.jsxs)("div",{children:["Footnotes:",Object($t.jsx)(Kj,{children:Object($t.jsx)("p",{children:"To add footnotes, add ^ characters where they belong in the passage. Then, add ^ in the footnotes area to reference the footnotes in the passage."})}),t]})]})},serialize(){return $j.serialize.call(this)}});Uj.exports=Zj;var Jj=Uj.exports,Qj={exports:{}},ew=(Qj.exports,h.a,In.a),tw=x.b,nw="start-ref-",sw="end-ref-",iw={display:"inline-block",width:0,visibility:"hidden"},rw={display:"inline",whiteSpace:"nowrap"},ow={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",paddingLeft:10,paddingRight:10,userSelect:"none",WebkitUserSelect:"none"},aw={display:"inline-block",color:"rgb(255, 255, 255)",backgroundColor:"rgb(90, 90, 90)",userSelect:"none",WebkitUserSelect:"none",width:22,height:22,borderRadius:"50%",textAlign:"center"},lw=createReactClass({displayName:"RefStart",render:function(){return Object($t.jsx)("span",{style:iw,children:"_"})},getRefContent:function(){return this.props.refContent}}),cw=createReactClass({displayName:"RefEnd",render:function(){return Object($t.jsx)("span",{style:iw,children:"_"})}}),hw={newline:ew.defaultRules.newline,paragraph:ew.defaultRules.paragraph,escape:ew.defaultRules.escape,passageFootnote:{order:ew.defaultRules.escape.order+.1,match:ew.inlineRegex(/^\^/),parse:(e,t,n)=>{var s=n.lastFootnote.id+1,i={id:s,text:1===s?"*":""+s};return"*"===n.lastFootnote.text&&(n.lastFootnote.text=""+n.lastFootnote.id),n.lastFootnote=i,i},react:(e,t,n)=>Object($t.jsx)("sup",{children:e.text},n.key)},refStart:{order:ew.defaultRules.escape.order+.2,match:function(e,t){var n=/^\{\{/.exec(e);if(n){for(var s=2,i=0;s<e.length;){var r=e.slice(s,s+2);if("{{"===r)i++,s++;else if("}}"===r){if(!(i>0))break;i--,s++}s++}var o=e.slice(2,s);return[n[0],o]}return null},parse:(e,t,n)=>{if(!n.useRefs)return{ref:null,refContent:null};var s=n.lastRef+1;return n.lastRef=s,n.currentRef.push(s),{ref:s,refContent:t("(\u201c"+e[1]+"\u201d)\n\n",tw.defaults({useRefs:!1},pw))}},react:(e,t,n)=>{if(null==e.ref)return null;var s=t(e.refContent,{});return Object($t.jsx)(lw,{ref:nw+e.ref,refContent:s},nw+e.ref)}},refEnd:{order:ew.defaultRules.escape.order+.3,match:ew.inlineRegex(/^\}\}/),parse:(e,t,n)=>n.useRefs?{ref:n.currentRef.pop()||null}:{ref:null},react:(e,t,n)=>null!=e.ref?Object($t.jsx)(cw,{ref:sw+e.ref},sw+e.ref):null},squareLabel:{order:ew.defaultRules.escape.order+.4,match:ew.inlineRegex(/^\[\[(\w+)\]\]( *)/),parse:(e,t,n)=>(n.firstQuestionRef||(n.firstQuestionRef=e[1]),{content:e[1],space:e[2].length>0}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-passage-square-label",style:rw,"aria-hidden":"true",children:Object($t.jsx)("span",{style:ow,children:e.content})},"visual-square"),Object($t.jsx)("span",{className:"perseus-sr-only",children:$_({number:e.content},"[Marker for question %(number)s]")},"alt-text"),e.space?"\xa0":null]},circleLabel:{order:ew.defaultRules.escape.order+.5,match:ew.inlineRegex(/^\(\((\w+)\)\)( *)/),parse:(e,t,n)=>({content:e[1],space:e[2].length>0}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-passage-circle-label",style:rw,"aria-hidden":!0,children:Object($t.jsx)("span",{style:aw,children:e.content})},"visual-circle"),Object($t.jsx)("span",{className:"perseus-sr-only",children:$_({number:e.content},"[Circle marker %(number)s]")},"alt-text"),e.space?"\xa0":null]},squareBracketRef:{order:ew.defaultRules.escape.order+.6,match:ew.inlineRegex(/^\[(\d+)\]( *)/),parse:(e,t,n)=>(n.firstSentenceRef||(n.firstSentenceRef=e[1]),{content:e[1],space:e[2].length>0}),react:(e,t,n)=>[Object($t.jsxs)("span",{className:"perseus-passage-bracket-label","aria-hidden":"true",children:["[",e.content,"]"]},"visual-brackets"),Object($t.jsx)("span",{className:"perseus-sr-only",children:$_({number:e.content},"[Sentence %(number)s]")},"alt-text"),e.space?"\xa0":null]},highlight:{order:ew.defaultRules.escape.order+.7,match:ew.inlineRegex(/^{highlighting.start}(.+?){highlighting.end}/),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-highlight",children:e.content})]},reviewHighlight:{order:ew.defaultRules.escape.order+.7,match:ew.inlineRegex(/^{review-highlighting.start}(.+?){review-highlighting.end}/),parse:(e,t,n)=>({content:e[1]}),react:(e,t,n)=>[Object($t.jsx)("span",{className:"perseus-review-highlight",children:e.content})]},strong:ew.defaultRules.strong,u:ew.defaultRules.u,em:ew.defaultRules.em,del:ew.defaultRules.del,text:{...ew.defaultRules.text,react:(e,t,n)=>Object($t.jsx)("span",{children:e.content},n.key)}},pw={currentRef:[],useRefs:!0,lastRef:0,lastFootnote:{id:0,text:""}},uw=ew.parserFor(hw);Qj.exports={parse:(e,t)=>(t=t||{},uw(e+"\n\n",tw.extend(t,pw))),output:ew.reactFor(ew.ruleOutput(hw,"react")),START_REF_PREFIX:nw,END_REF_PREFIX:sw,_rulesForTesting:hw};var dw=Qj.exports;function gw(e,t,n,s){let i;return i="start"===t&&"start"===s?Range.START_TO_START:"start"===t&&"end"===s?Range.END_TO_START:"end"===t&&"start"===s?Range.START_TO_END:Range.END_TO_END,e.compareBoundaryPoints(i,n)}function fw(e,t){const n=e.cloneRange();return n.setEnd(t.endContainer,t.endOffset),n}function mw(e,t){return!(gw(e,"end",t,"start")<0||gw(t,"end",e,"start")<0)}function bw(e,t){return gw(e,"start",t,"start")<=0&&gw(e,"end",t,"end")>=0}function vw(e,t){if(!mw(e,t))return null;return fw(gw(e,"start",t,"start")>0?e:t,gw(e,"end",t,"end")<0?e:t)}function xw(e,t){if(!mw(e,t))return null;return fw(gw(e,"start",t,"start")<0?e:t,gw(e,"end",t,"end")>0?e:t)}function yw(e,t,n,s,i){let r=-1,o=s,a=i,l=0;for(;o<=a;){if(l++,l>2*t.length)throw new Error(`Assertion error: Binary search isn't terminating? lower=${o}, upper=${a}`);const s=Math.floor((o+a)/2);if("first"===n){gw(t[s],"end",e,"start")<=0?o=s+1:(r=s,a=s-1)}else{gw(t[s],"start",e,"end")>=0?a=s-1:(r=s,o=s+1)}}return r}function jw(e,t){const n=yw(e,t,"first",0,t.length-1);if(n<0)return null;const s=yw(e,t,"last",n,t.length-1);return s<0?null:[n,s]}function ww(e,t){const n={};let s=t.domRange,i=t.firstWordIndex,r=t.lastWordIndex;for(const l of Object.keys(e)){const t=e[l],o=xw(t.domRange,s);o?(s=o,i=Math.min(t.firstWordIndex,i),r=Math.max(t.lastWordIndex,r)):n[l]=t}const o={firstWordIndex:i,lastWordIndex:r,domRange:s},a=function(e){const t=`${(new Date).getTime()}`;if(!e.includes(t))return t;let n,s=0;do{n=`${t}-${s}`,s++}while(e.includes(n));return n}(Object.keys(n));return n[a]=o,n}function Ow(e,t,n){for(const o of Object.keys(e)){if(bw(e[o].domRange,n))return null}const s=jw(n,t);if(!s)return null;const[i,r]=s;return{firstWordIndex:i,lastWordIndex:r,domRange:fw(t[i],t[r])}}function Cw(e,t){const{firstWordIndex:n,lastWordIndex:s}=e.range,i=t[n];if(!i)throw new Error(`first word index ${i} is out of bounds: must be 0\u2013${t.length-1} inclusive`);const r=t[s];if(!r)throw new Error(`last word index ${r} is out of bounds: must be 0\u2013${t.length-1} inclusive`);return{firstWordIndex:n,lastWordIndex:s,domRange:fw(i,r)}}function Sw(e){const{firstWordIndex:t,lastWordIndex:n}=e;return{range:{type:"word-indexes",firstWordIndex:t,lastWordIndex:n}}}var kw={exports:{}};kw.exports;const _w=h.a;class Tw extends _w.PureComponent{componentDidMount(){this._sendWordsUpdate()}componentDidUpdate(){this._sendWordsUpdate()}_sendWordsUpdate(){this.props.onWordsUpdate(this._getWordRanges())}_getWordRanges(){const e=this._container;if(!e)throw new Error("invariant violation: `this._container` is not defined, but this method is only called after mount/update");const t=e.ownerDocument.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,(()=>NodeFilter.FILTER_ACCEPT),!1),n=[];let s=null;for(;t.nextNode();){const e=t.currentNode;if(e.nodeType===Node.ELEMENT_NODE){"inline"!==getComputedStyle(e).display&&(s=null)}else if(e.nodeType===Node.TEXT_NODE){const t=e.nodeValue,i=/\S+/g;let r,o=null;for(;null!==(r=i.exec(t));){const i=r.index,a=r.index+r[0].length;let l;0===i&&s?(l=s,l.setEnd(e,a)):(l=e.ownerDocument.createRange(),l.setStart(e,i),l.setEnd(e,a),n.push(l)),a===t.length&&(o=l)}s=o}}return n}render(){return Object($t.jsx)("div",{ref:e=>this._container=e,children:this.props.children})}}kw.exports=Tw;var Mw=kw.exports,Nw={exports:{}};Nw.exports;const Pw=h.a;class Iw extends Pw.PureComponent{constructor(){super(...arguments),this.state={mouseState:"up",trackedSelection:null},this._handleSelectionChange=()=>{this._updateTrackedSelection(this.props.buildHighlight),"down"===this.state.mouseState&&this.setState({mouseState:"down-and-selecting"})},this._handleMouseDown=()=>{this.setState({mouseState:"down"})},this._handleMouseUp=()=>{this.setState({mouseState:"up"})}}componentDidMount(){this._updateListeners(!1,this.props.enabled)}componentWillReceiveProps(e){this.props.buildHighlight!==e.buildHighlight&&this._updateTrackedSelection(e.buildHighlight),this._updateListeners(this.props.enabled,e.enabled)}componentWillUnmount(){this._updateListeners(this.props.enabled,!1)}_updateListeners(e,t){!e&&t?(window.addEventListener("mousedown",this._handleMouseDown),window.addEventListener("mouseup",this._handleMouseUp),document.addEventListener("selectionchange",this._handleSelectionChange)):e&&!t&&(window.removeEventListener("mousedown",this._handleMouseDown),window.removeEventListener("mouseup",this._handleMouseUp),document.removeEventListener("selectionchange",this._handleSelectionChange),this.setState({mouseState:"up",trackedSelection:null}))}_computeFocusAndRange(){const e=document.getSelection();if(!e||0===e.rangeCount)return null;const t=e.getRangeAt(0);if(t.collapsed)return null;return{focusNode:e.focusNode,focusOffset:e.focusOffset,range:t}}_computeTrackedSelection(e){const t=this._computeFocusAndRange();if(!t)return null;const{focusNode:n,focusOffset:s,range:i}=t,r=e(i);return r?{focusNode:n,focusOffset:s,proposedHighlight:r}:null}_updateTrackedSelection(e){const t=this._computeTrackedSelection(e);this.setState({trackedSelection:t})}render(){const{mouseState:e,trackedSelection:t}=this.state,n="down-and-selecting"===e;return this.props.children&&Object($t.jsx)("div",{children:this.props.children(t,n)})}}Nw.exports=Iw;var Ew=Nw.exports;function Aw(e,t){return{left:e.left-t.left,top:e.top-t.top}}function Rw(e,t){return{...Aw(e,t),width:e.width,height:e.height}}function Dw(e){const t=[];return Fw(e.commonAncestorContainer,e,t),t}function Fw(e,t,n){const s=new Range;if(s.selectNodeContents(e),e.nodeType===Node.TEXT_NODE){const i=vw(t,s);i&&function(e,t,n){const s=e.parentElement,i=window.getComputedStyle(s);let r=null;if("string"===typeof i.lineHeight&&i.lineHeight.endsWith("px")){const e=parseFloat(i.lineHeight);isNaN(e)||(r=e)}const o=Array.from(t.getClientRects());for(const a of o){const e={left:a.left,top:a.top,height:a.height,width:a.width};if(null!==r){const t=r-e.height;e.top-=t,e.height=r}n.push(e)}}(e,i,n)}else if(e.nodeType===Node.ELEMENT_NODE){if(!mw(t,s))return;for(const s of Array.from(e.childNodes))Fw(s,t,n)}}var Lw={exports:{}};Lw.exports;const zw=h.a;class qw extends zw.PureComponent{_getPosition(){const{focusNode:e,focusOffset:t,offsetParent:n}=this.props,s=document.createRange();s.setStart(e,t),s.setEnd(e,t);const i=s.getClientRects()[0];if(!i)return console.warn('[Highlighting] Known bug: Could not determine the focus position, so did not show an "Add Highlight" tooltip. https://app.asana.com/0/329800276300868/413878480039713'),null;return Aw(i,n.getBoundingClientRect())}render(){const e=this._getPosition();return e?Object($t.jsxs)("div",{className:Object(On.css)(Ww.tooltip),onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,style:{left:e.left,top:e.top,zIndex:this.props.zIndex},children:[Object($t.jsx)("div",{className:Object(On.css)(Ww.label),children:this.props.label}),Object($t.jsx)("div",{className:Object(On.css)(Ww.arrow)})]}):null}}const Ww=On.StyleSheet.create({tooltip:{position:"absolute",transform:"translate(-50%, -100%)",cursor:"pointer",userSelect:"none"},label:{background:"#314453",borderRadius:2,boxShadow:"0 1px 4px 0 rgba(97, 101, 105, 0.42)",padding:"8px 11px",color:"white",fontSize:12,lineHeight:1.5,textAlign:"center"},arrow:{height:0,width:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderTop:"6px solid #314453",margin:"0 auto"}});Lw.exports=qw;var Bw=Lw.exports,Vw={exports:{}};Vw.exports;(function(){const e=h.a;class t extends e.PureComponent{constructor(){super(...arguments),this.state={cachedHighlightRects:this._computeRects(this.props),tooltipIsHovered:!1}}componentWillReceiveProps(e){this.props.highlight===e.highlight&&this.props.offsetParent===e.offsetParent||this.setState({cachedHighlightRects:this._computeRects(e)})}_computeRects(e){const{highlight:t,offsetParent:n}=e,s=Dw(t.domRange),i=n.getBoundingClientRect();return s.map((e=>Rw(e,i)))}_rectIsHovered(e,t){const n=Aw(t,e);return 0<=n.left&&n.left<e.width&&0<=n.top&&n.top<e.height}isHovered(e){if(!e)return!1;const{offsetParent:t}=this.props,{cachedHighlightRects:n}=this.state,s=Aw(e,t.getBoundingClientRect());return n.some((e=>this._rectIsHovered(e,s)))}render(){const e=this.state.cachedHighlightRects;return Object($t.jsx)("div",{children:e.map(((e,t)=>Object($t.jsx)("div",{className:Object(On.css)(n.highlightRect),style:{position:"absolute",width:e.width,height:e.height,top:e.top,left:e.left,zIndex:this.props.zIndexes.belowContent}},t)))})}}const n=On.StyleSheet.create({highlightRect:{background:"#fffabe"}});Vw.exports=t}).call(Vw.exports);var Hw=Vw.exports,Uw={exports:{}};Uw.exports;const Gw=h.a,$w=Hw,Yw=Bw;class Kw extends Gw.PureComponent{constructor(){super(...arguments),this.state={mouseClientPosition:null,hoveringTooltipFor:null},this._highlightRenderers={},this._handleMouseMove=e=>{this.setState({mouseClientPosition:{left:e.clientX,top:e.clientY}})}}componentDidMount(){this._updateEditListeners(!1,this.props.editable)}componentWillReceiveProps(e){this._updateEditListeners(this.props.editable,e.editable),"string"!==typeof this.state.hoveringTooltipFor||this.state.hoveringTooltipFor in e.highlights||this.setState({hoveringTooltipFor:null})}componentWillUnmount(){this._updateEditListeners(this.props.editable,!1)}_updateEditListeners(e,t){!e&&t?window.addEventListener("mousemove",this._handleMouseMove):e&&!t&&(window.removeEventListener("mousemove",this._handleMouseMove),this.setState({mouseClientPosition:null}))}_getHoveredHighlightKey(){const{hoveringTooltipFor:e}=this.state;if("string"===typeof e)return e;return Object.keys(this.props.highlights).find((e=>{const t=this._highlightRenderers[e];return t&&t.isHovered(this.state.mouseClientPosition)}))}_renderTooltip(){const e=this._getHoveredHighlightKey();if("string"!==typeof e)return null;const t=this.props.highlights[e];return Object($t.jsx)(Yw,{label:i18n._("Remove highlight"),focusNode:t.domRange.endContainer,focusOffset:t.domRange.endOffset,offsetParent:this.props.offsetParent,zIndex:this.props.zIndexes.aboveContent,onClick:()=>this.props.onRemoveHighlight(e),onMouseEnter:()=>this.setState({hoveringTooltipFor:e}),onMouseLeave:()=>this.setState({hoveringTooltipFor:null})})}render(){return Object($t.jsxs)("div",{children:[Object.keys(this.props.highlights).map((e=>Object($t.jsx)($w,{ref:t=>{t?this._highlightRenderers[e]=t:delete this._highlightRenderers[e]},editable:this.props.editable,highlight:this.props.highlights[e],highlightKey:e,mouseClientPosition:this.state.mouseClientPosition,offsetParent:this.props.offsetParent,onRemoveHighlight:this.props.onRemoveHighlight,zIndexes:this.props.zIndexes},e))),this.props.editable&&this._renderTooltip()]})}}Uw.exports=Kw;var Xw=Uw.exports,Zw={exports:{}};Zw.exports;const Jw=h.a,Qw=Xw,eO=Bw,tO=Ew;class nO extends Jw.PureComponent{_handleAddHighlight(e){this.props.onAddHighlight(e);const t=document.getSelection();t&&t.collapseToEnd()}_selectionIsValid(e){if(!e)return!1;const{contentNode:t}=this.props,n=new Range;n.selectNodeContents(t);const s=new Range;s.setStart(e.focusNode,e.focusOffset),s.collapse(!0);return mw(n,s)}render(){return Object($t.jsx)(tO,{buildHighlight:this.props.buildHighlight,enabled:this.props.editable,children:(e,t)=>Object($t.jsxs)("div",{children:[Object($t.jsx)(Qw,{editable:this.props.editable&&!this._selectionIsValid(e),highlights:this.props.highlights,offsetParent:this.props.offsetParent,onRemoveHighlight:this.props.onRemoveHighlight,zIndexes:this.props.zIndexes}),this._selectionIsValid(e)&&!t&&Object($t.jsx)(eO,{label:i18n._("Add highlight"),onClick:()=>this._handleAddHighlight(e.proposedHighlight),focusNode:e.focusNode,focusOffset:e.focusOffset,offsetParent:this.props.offsetParent,zIndex:this.props.zIndexes.aboveContent})]})})}}Zw.exports=nO;var sO=Zw.exports,iO={exports:{}};iO.exports;const rO=h.a,oO=sO,aO=Mw;class lO extends rO.PureComponent{constructor(){super(...arguments),this.state={wordRanges:[]},this._handleAddHighlight=e=>{const t=ww(this._getDOMHighlights(),e),n={};for(const s of Object.keys(t))n[s]=Sw(t[s]);this.props.onSerializedHighlightsUpdate(n)},this._handleRemoveHighlight=e=>{const{serializedHighlights:t}=this.props,n={...t};delete n[e],this.props.onSerializedHighlightsUpdate(n)},this._handleWordsUpdate=e=>{this.setState({wordRanges:e})}}_buildHighlight(e){return Ow(this._getDOMHighlights(),this.state.wordRanges,e)}_getDOMHighlights(){const{serializedHighlights:e}=this.props,{wordRanges:t}=this.state,n={};for(const s of Object.keys(e))n[s]=Cw(e[s],t);return n}render(){const e=this._getDOMHighlights();return Object($t.jsxs)("div",{className:Object(On.css)(cO.container),ref:e=>this._container=e,children:[Object($t.jsx)("div",{children:this.props.enabled&&this._container&&this._content&&Object($t.jsx)(oO,{buildHighlight:e=>this._buildHighlight(e),contentNode:this._content,editable:this.props.editable,highlights:e,offsetParent:this._container,zIndexes:{aboveContent:2,belowContent:0},onAddHighlight:this._handleAddHighlight,onRemoveHighlight:this._handleRemoveHighlight})}),Object($t.jsx)("div",{className:Object(On.css)(cO.content),ref:e=>this._content=e,children:Object($t.jsx)(aO,{onWordsUpdate:this._handleWordsUpdate,children:this.props.children})})]})}}const cO=On.StyleSheet.create({container:{position:"relative",zIndex:0},content:{position:"relative",zIndex:1}});iO.exports=lO;var hO=iO.exports,pO={exports:{}};pO.exports;const uO=h.a,dO=i.a,gO=x.b,fO=l.a,mO=hO,bO=ah,vO=dw;class xO extends uO.Component{measureLineHeight(){return"number"!==typeof this._cachedLineHeight&&this.forceMeasureLineHeight(),this._cachedLineHeight}forceMeasureLineHeight(){this.$body.text(" \x80"),this._cachedLineHeight=this.$end.offset().top-this.$body.offset().top,this.$body.text("")}render(){return Object($t.jsx)("div",{className:Object(On.css)(yO.measurer),children:Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{ref:e=>this.$body=fO(e),className:"paragraph"}),Object($t.jsx)("div",{ref:e=>this.$end=fO(e)})]})})}}const yO=On.StyleSheet.create({measurer:{position:"absolute",width:"100%",top:0,left:0}});class jO extends uO.Component{constructor(){super(...arguments),this.state={nLines:null,startLineNumbersAfter:0,stylesAreApplied:!1},this._handleSerializedHighlightsUpdate=e=>{this.props.onChange({highlights:e})}}componentDidMount(){this._updateState(),this._onResize=gO.throttle((()=>{this.shouldRenderJipt()||(this._lineHeightMeasurer.forceMeasureLineHeight(),this._updateState())}),500),window.addEventListener("resize",this._onResize),window.setTimeout((()=>{this.setState({stylesAreApplied:!0})}),0)}shouldComponentUpdate(e,t){return!gO.isEqual(this.props,e)||!gO.isEqual(this.state,t)}componentDidUpdate(){this._updateState()}componentWillUnmount(){window.removeEventListener("resize",this._onResize)}_updateState(){this.shouldRenderJipt()||this.setState({nLines:this._measureLines(),startLineNumbersAfter:this._getInitialLineNumber()})}_measureLines(){const e=fO(dO.findDOMNode(this.refs.content)).height(),t=this._getLineHeight();return Math.round(e/t)}_getInitialLineNumber(){let e=!0;return this.props.findWidgets(((t,n)=>"passage"===n.type&&(t===this.props.widgetId&&(e=!1),e))).map((e=>e.getLineCount())).reduce(((e,t)=>e+t),0)}_getLineHeight(){return this._lineHeightMeasurer.measureLineHeight()}getLineCount(){return null!=this.state.nLines?this.state.nLines:this._measureLines()}_getStartRefLineNumber(e){const t=vO.START_REF_PREFIX+e,n=this.refs[t];if(!n)return null;const s=fO(dO.findDOMNode(n));let i=s.next();0===i.length&&(i=s);const r=i.offset().top;return this.state.startLineNumbersAfter+1+this._convertPosToLineNumber(r)}_getEndRefLineNumber(e){const t=vO.END_REF_PREFIX+e,n=this.refs[t];if(!n)return null;const s=fO(dO.findDOMNode(n));let i=s.prev();0===i.length&&(i=s);const r=i.height(),o=i.offset().top;let a=this._convertPosToLineNumber(o+r);return 0===r&&(a+=1),this.state.startLineNumbersAfter+a}_convertPosToLineNumber(e){const t=e-fO(dO.findDOMNode(this.refs.content)).offset().top,n=this._getLineHeight();return Math.round(t/n)}_getRefContent(e){const t=vO.START_REF_PREFIX+e,n=this.refs[t];return n?n.getRefContent():null}getReference(e){const t=this._getStartRefLineNumber(e),n=this._getEndRefLineNumber(e);if(null==t||null==n)return null;return{startLine:t,endLine:n,content:this._getRefContent(e)}}getUserInput(){return null}simpleValidate(e){return jO.validate(this.getUserInput(),e)}static validate(e,t){return{type:"points",earned:0,total:0,message:null}}_renderInstructions(e){const t=e.firstQuestionRef,n=e.firstSentenceRef;let s="";t&&(s+=i18n._("The symbol %(questionSymbol)s indicates that question %(questionNumber)s references this portion of the passage.",{questionSymbol:"[["+t+"]]",questionNumber:t})),n&&(s+=i18n._(" The symbol %(sentenceSymbol)s indicates that the following sentence is referenced in a question.",{sentenceSymbol:"["+n+"]"}));const i=vO.parse(s);return Object($t.jsx)("div",{className:"perseus-widget-passage-instructions",children:vO.output(i)})}shouldRenderJipt(){return"undefined"!==typeof KA&&"en-pt"===KA.language&&-1!==this.props.passageText.indexOf("crwdns")}_renderContent(e){const t=this.state.stylesAreApplied,n=!this.props.reviewModeRubric;return Object($t.jsx)(mO,{editable:n,enabled:t,onSerializedHighlightsUpdate:this._handleSerializedHighlightsUpdate,serializedHighlights:this.props.highlights,children:Object($t.jsxs)("div",{ref:"content",children:[Object($t.jsx)(xO,{ref:e=>this._lineHeightMeasurer=e}),vO.output(e)]})})}_hasFootnotes(){const e=this.props.footnotes;return!/^\s*$/.test(e)}_renderFootnotes(){const e=this.props.footnotes,t=vO.parse(e);return vO.output(t)}render(){let e;const t=this.state.nLines;this.props.showLineNumbers&&t&&(e=gO.range(1,t+1).map((e=>4===e&&t>4?Object($t.jsx)("span",{className:"line-marker",children:"Line"},"line-marker"):Object($t.jsx)("span",{children:e+this.state.startLineNumbersAfter},e))));const n={firstSentenceRef:null,firstQuestionRef:null},s=vO.parse(this.props.passageText,n),i=/\S/.test(this.props.passageTitle);return Object($t.jsx)("div",{children:Object($t.jsxs)("div",{className:"perseus-widget-passage-container",children:[this._renderInstructions(n),Object($t.jsxs)("div",{className:"perseus-widget-passage",children:[i&&Object($t.jsx)("h3",{className:"passage-title",children:Object($t.jsx)(bO,{content:this.props.passageTitle,linterContext:this.props.linterContext})}),e&&Object($t.jsx)("div",{className:"line-numbers","aria-hidden":!0,children:e}),!i&&Object($t.jsx)("h3",{className:"perseus-sr-only",children:i18n._("Beginning of reading passage.")}),Object($t.jsx)("div",{className:"passage-text",children:this.shouldRenderJipt()?Object($t.jsx)(bO,{content:this.props.passageText}):this._renderContent(s)}),this._hasFootnotes()&&[Object($t.jsx)("h4",{className:"perseus-sr-only",children:i18n._("Beginning of reading passage footnotes.")},"footnote-start"),Object($t.jsx)("div",{className:"footnotes",children:this._renderFootnotes()},"footnotes")],Object($t.jsx)("div",{className:"perseus-sr-only",children:i18n._("End of reading passage.")})]})]})})}}jO.defaultProps={passageTitle:"",passageText:"",footnotes:"",showLineNumbers:!0,highlights:{},linterContext:je},pO.exports={name:"passage",displayName:"Passage (SAT only)",widget:jO,transform:e=>gO.pick(e,"passageTitle","passageText","footnotes","showLineNumbers"),isLintable:!0};var wO=pO.exports,OO={exports:{}};OO.exports;h.a;const CO=x.b,SO=sd,kO=bs;var _O="normal",TO="horizontal";const MO=createReactClass({displayName:"OrdererEditor",getDefaultProps:function(){return{correctOptions:[{content:"$x$"}],otherOptions:[{content:"$y$"}],height:_O,layout:TO}},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-orderer",children:[Object($t.jsxs)("div",{children:[" ","Correct answer:"," ",Object($t.jsx)(SO,{children:Object($t.jsx)("p",{children:"Place the cards in the correct order. The same card can be used more than once in the answer but will only be displayed once at the top of a stack of identical cards."})})]}),Object($t.jsx)(kO,{options:CO.pluck(this.props.correctOptions,"content"),onChange:this.onOptionsChange.bind(this,"correctOptions"),layout:this.props.layout}),Object($t.jsxs)("div",{children:[" ","Other cards:"," ",Object($t.jsx)(SO,{children:Object($t.jsx)("p",{children:"Create cards that are not part of the answer."})})]}),Object($t.jsx)(kO,{options:CO.pluck(this.props.otherOptions,"content"),onChange:this.onOptionsChange.bind(this,"otherOptions"),layout:this.props.layout}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Layout:"," ",Object($t.jsxs)("select",{value:this.props.layout,onChange:this.onLayoutChange,children:[Object($t.jsx)("option",{value:TO,children:"Horizontal"}),Object($t.jsx)("option",{value:"vertical",children:"Vertical"})]})]}),Object($t.jsx)(SO,{children:Object($t.jsx)("p",{children:"Use the horizontal layout for short text and small images. The vertical layout is best for longer text (e.g. proofs)."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Height:"," ",Object($t.jsxs)("select",{value:this.props.height,onChange:this.onHeightChange,children:[Object($t.jsx)("option",{value:_O,children:"Normal"}),Object($t.jsx)("option",{value:"auto",children:"Automatic"})]})]}),Object($t.jsx)(SO,{children:Object($t.jsx)("p",{children:'Use "Normal" for text, "Automatic" for images.'})})]})]})},onOptionsChange:function(e,t,n){var s={};s[e]=CO.map(t,(function(e){return{content:e}})),this.props.onChange(s,n)},onLayoutChange:function(e){this.props.onChange({layout:e.target.value})},onHeightChange:function(e){this.props.onChange({height:e.target.value})},serialize:function(){return{options:CO.chain(CO.pluck(this.props.correctOptions,"content")).union(CO.pluck(this.props.otherOptions,"content")).uniq().reject((function(e){return""===e})).sort().sortBy((function(e){return/\d/.test(e)?0:/^\$?[a-zA-Z]+\$?$/.test(e)?2:1})).map((function(e){return{content:e}})).value(),correctOptions:this.props.correctOptions,otherOptions:this.props.otherOptions,height:this.props.height,layout:this.props.layout}}});OO.exports=MO;var NO=OO.exports,PO={exports:{}},IO=(PO.exports,h.a,i.a),EO=x.b,AO=ah,RO=ce,DO=Ss.ClassNames,FO=createReactClass({displayName:"PlaceholderCard",render:function(){return Object($t.jsx)("div",{className:"card-wrap "+DO.INTERACTIVE,style:{width:this.props.width},children:Object($t.jsx)("div",{className:"card placeholder",style:{height:this.props.height}})})}}),LO=createReactClass({displayName:"DragHintCard",render:function(){return Object($t.jsx)("div",{className:"card-wrap "+DO.INTERACTIVE,children:Object($t.jsx)("div",{className:"card drag-hint"})})}}),zO=createReactClass({displayName:"Card",getDefaultProps:function(){return{stack:!1,animating:!1,linterContext:je}},render:function(){var e={};this.props.floating&&(e={position:"absolute",left:this.props.startOffset.left,top:this.props.startOffset.top}),this.props.width&&(e.width=this.props.width);var t=["card"];this.props.stack&&t.push("stack"),this.props.floating&&!this.props.animating&&(t.push("dragging"),e.left+=this.props.mouse.left-this.props.startMouse.left,e.top+=this.props.mouse.top-this.props.startMouse.top);var n=EO.pick(this.props,"content"),s=this.props.animating?$.noop:this.onMouseDown;return Object($t.jsx)("div",{className:"card-wrap "+DO.INTERACTIVE,style:e,onMouseDown:s,onTouchStart:s,onTouchMove:this.onMouseMove,onTouchEnd:this.onMouseUp,onTouchCancel:this.onMouseUp,children:Object($t.jsx)("div",{className:t.join(" "),children:Object($t.jsx)(AO,{...n,linterContext:this.props.linterContext})})})},shouldComponentUpdate:function(e,t){return this.props.floating||e.floating||this.props.content!==e.content||this.props.fakeRef!==e.fakeRef},componentDidMount:function(){this.mouseMoveUpBound=!1},componentDidUpdate:function(e,t){if(this.props.animating&&!e.animating){var n=15*Math.sqrt(Math.sqrt(Math.pow(this.props.animateTo.left-this.props.startOffset.left,2)+Math.pow(this.props.animateTo.top-this.props.startOffset.top,2)));$(IO.findDOMNode(this)).animate(this.props.animateTo,Math.max(n,1),this.props.onAnimationEnd)}},componentWillUnmount:function(){this.mouseMoveUpBound&&(console.warn("Removing an element with bound event handlers."),this.unbindMouseMoveUp(),RO.resetTouchHandlers())},bindMouseMoveUp:function(){this.mouseMoveUpBound=!0,$(document).on("mousemove",this.onMouseMove),$(document).on("mouseup",this.onMouseUp)},unbindMouseMoveUp:function(){this.mouseMoveUpBound=!1,$(document).off("mousemove",this.onMouseMove),$(document).off("mouseup",this.onMouseUp)},onMouseDown:function(e){e.preventDefault();var t=RO.extractPointerLocation(e);t&&(this.bindMouseMoveUp(),this.props.onMouseDown&&this.props.onMouseDown(t,this))},onMouseMove:function(e){e.preventDefault();var t=RO.extractPointerLocation(e);t&&this.props.onMouseMove&&this.props.onMouseMove(t)},onMouseUp:function(e){e.preventDefault();var t=RO.extractPointerLocation(e);t&&(this.unbindMouseMoveUp(),this.props.onMouseUp&&this.props.onMouseUp(t))}}),qO="horizontal",WO=createReactClass({displayName:"Orderer",getDefaultProps:function(){return{current:[],options:[],correctOptions:[],height:"normal",layout:qO,linterContext:je}},getInitialState:function(){return{current:[],dragging:!1,placeholderIndex:null}},componentWillReceiveProps:function(e){EO.isEqual(this.props.current,e.current)||this.setState({current:e.current})},render:function(){var e=this.state.dragging&&Object($t.jsx)(zO,{ref:"dragging",floating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,startMouse:this.state.grabPos,mouse:this.state.mousePos,width:this.state.dragWidth,onMouseUp:this.onRelease,onMouseMove:this.onMouseMove,linterContext:this.props.linterContext},this.state.dragKey||"draggingCard"),t=this.state.animating&&Object($t.jsx)(zO,{floating:!0,animating:!0,content:this.state.dragContent,startOffset:this.state.offsetPos,width:this.state.dragWidth,animateTo:this.state.animateTo,onAnimationEnd:this.state.onAnimationEnd,linterContext:this.props.linterContext},this.state.dragKey||"draggingCard"),n=EO.map(this.state.current,(function(e,t){return Object($t.jsx)(zO,{ref:"sortable"+t,fakeRef:"sortable"+t,floating:!1,content:e.content,width:e.width,linterContext:this.props.linterContext,onMouseDown:this.state.animating?$.noop:this.onClick.bind(null,"current",t)},e.key)}),this);if(null!=this.state.placeholderIndex){var s=Object($t.jsx)(FO,{ref:"placeholder",width:this.state.dragWidth,height:this.state.dragHeight},"placeholder");n.splice(this.state.placeholderIndex,0,s)}var i=n.length>0;n.push(e,t);var r=Object($t.jsxs)("div",{className:"perseus-clearfix draggable-box",children:[!i&&Object($t.jsx)(LO,{}),Object($t.jsx)("div",{ref:"dragList",children:n})]}),o=Object($t.jsx)("div",{ref:"bank",className:"bank perseus-clearfix",children:EO.map(this.props.options,((e,t)=>Object($t.jsx)(zO,{ref:"bank"+t,floating:!1,content:e.content,stack:!0,linterContext:this.props.linterContext,onMouseDown:this.state.animating?$.noop:this.onClick.bind(null,"bank",t),onMouseMove:this.onMouseMove,onMouseUp:this.onRelease},t)),this)});return Object($t.jsxs)("div",{className:"draggy-boxy-thing orderer height-"+this.props.height+" layout-"+this.props.layout+" above-scratchpad blank-background perseus-clearfix "+DO.INTERACTIVE,ref:"orderer",children:[o,r]})},onClick:function(e,t,n,s){var i,r=$(IO.findDOMNode(s)),o=this.state.current.slice(),a=null;"current"===e?(o.splice(t,1),i=this.state.current[t],a=t):"bank"===e&&(i=this.props.options[t]),this.setState({current:o,dragging:!0,placeholderIndex:a,dragKey:i.key,dragContent:i.content,dragWidth:r.width(),dragHeight:r.height(),grabPos:n,mousePos:n,offsetPos:r.position()})},onRelease:function(e){var t=this.refs.dragging;if(null!=t){var n=this.isCardInBank(t),s=this.state.placeholderIndex,i=()=>{var e=this.state.current.slice();if(!n){var t={content:this.state.dragContent,key:EO.uniqueId("perseus_draggable_card_"),width:this.state.dragWidth};e.splice(s,0,t)}this.props.onChange({current:e}),this.setState({current:e,dragging:!1,placeholderIndex:null,animating:!1}),this.props.trackInteraction()},r=$(IO.findDOMNode(t)).position(),o=null;n?EO.each(this.props.options,(function(e,t){if(e.content===this.state.dragContent){var n=IO.findDOMNode(this.refs["bank"+t]);o=$(n).position()}}),this):null!=this.refs.placeholder&&(o=$(IO.findDOMNode(this.refs.placeholder)).position()),null==o?i():this.setState({offsetPos:r,animateTo:o,onAnimationEnd:i,animating:!0,dragging:!1})}},onMouseMove:function(e){var t,n=this.refs.dragging;null!=n&&(t=this.isCardInBank(n)?null:this.findCorrectIndex(n,this.state.current),this.setState({mousePos:e,placeholderIndex:t}))},findCorrectIndex:function(e,t){var n=this.props.layout===qO,s=$(IO.findDOMNode(this.refs.dragList)),i=s.offset().left,r=s.offset().top,o=$(IO.findDOMNode(e)).offset().left-i,a=$(IO.findDOMNode(e)).offset().top-r,l=0,c=0,h=0;return n?EO.each(t,(function(e,t){var n=IO.findDOMNode(this.refs["sortable"+t]),s=$(n).outerWidth(!0);o>c+s/2&&(l+=1),c+=s}),this):EO.each(t,(function(e,t){var n=IO.findDOMNode(this.refs["sortable"+t]),s=$(n).outerHeight(!0);a>h+s/2&&(l+=1),h+=s}),this),l},isCardInBank:function(e){if(null==e)return!1;var t=this.props.layout===qO,n=$(IO.findDOMNode(e)),s=$(IO.findDOMNode(this.refs.bank)),i=n.offset(),r=s.offset(),o=n.outerHeight(!0),a=s.outerHeight(!0),l=s.outerWidth(!0),c=IO.findDOMNode(this.refs.dragList),h=($(c).width(),n.outerWidth(!0));return t?i.top+o/2<r.top+a:i.left+h/2<r.left+l},getUserInput:function(){return{current:EO.map(this.props.current,(function(e){return e.content}))}},simpleValidate:function(e){return WO.validate(this.getUserInput(),e)}});EO.extend(WO,{validate:function(e,t){return 0===e.current.length?{type:"invalid",message:null}:{type:"points",earned:EO.isEqual(e.current,EO.pluck(t.correctOptions,"content"))?1:0,total:1,message:null}}}),PO.exports={name:"orderer",displayName:"Orderer",widget:WO,isLintable:!0};var BO=PO.exports,VO={exports:{}},HO=(VO.exports,h.a,x.b),UO=iu,GO=Ff.a,$O=sd,YO=qd,KO=Pf,XO=Df,ZO=G.a.number,JO=createReactClass({displayName:"NumberLineEditor",getDefaultProps:function(){return{range:[0,10],labelRange:[null,null],labelStyle:"decimal",labelTicks:!0,divisionRange:[1,12],numDivisions:5,snapDivisions:2,tickStep:null,correctRel:"eq",correctX:null,initialX:null,showTooltips:!1}},onRangeChange:function(e){this.props.onChange({range:e})},onLabelRangeChange:function(e,t){var n=this.props.labelRange.slice(),s=n[1-e];null==t||null==s?n[e]=t:n=[Math.min(t,s),Math.max(t,s)],this.props.onChange({labelRange:n})},onDivisionRangeChange:function(e){var t,n,s,i=this.props.numDivisions;t=i,n=e[0],s=e[1],i=Math.min(Math.max(t,n),s),this.props.onChange({divisionRange:e,numDivisions:i})},onNumChange:function(e,t){var n={};n[e]=t,this.props.onChange(n)},onNumDivisionsChange:function(e){var t=this.props.divisionRange.slice();HO.isFinite(e)||(e=null),(e=(e=Math.round(e))<0?-1*e:e)&&(e=Math.min(t[1],Math.max(t[0],e)),this.props.onChange({tickStep:null,divisionRange:t,numDivisions:e}))},onTickStepChange:function(e){this.props.onChange({numDivisions:null,tickStep:e})},onChangeRelation:function(e){const t=e.target.value;this.props.onChange({correctRel:t,isInequality:"eq"!==t})},onLabelStyleChange:function(e){this.props.onChange({labelStyle:e})},serialize(){return UO.serialize.call(this)},render:function(){var e=this.props.range,t=this.props.labelRange,n=this.props.divisionRange;e[0]=+e[0],e[1]=+e[1];var s=e[1]-e[0],i=this.props.numDivisions,r=this.props.snapDivisions,o=this.props.tickStep,a=this.props.isTickCtrl;let l;l=a?null:o?o/r:s/i/r;return Object($t.jsxs)("div",{className:"perseus-widget-number-line-editor",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Correct x"," ",Object($t.jsxs)("select",{value:this.props.correctRel,onChange:this.onChangeRelation,children:[Object($t.jsx)("option",{value:"eq",children:" = "}),Object($t.jsx)("option",{value:"lt",children:" < "}),Object($t.jsx)("option",{value:"gt",children:" > "}),Object($t.jsx)("option",{value:"le",children:" \u2264 "}),Object($t.jsx)("option",{value:"ge",children:" \u2265 "})]})," ",Object($t.jsx)(YO,{value:this.props.correctX,format:this.props.labelStyle,onChange:this.onNumChange.bind(this,"correctX"),checkValidity:t=>t>=e[0]&&t<=e[1]&&(!l||ZO.isInteger((t-e[0])/l)),placeholder:"answer",size:"normal",useArrowKeys:!0}),Object($t.jsx)($O,{children:Object($t.jsx)("p",{children:"This is the correct answer. The answer is validated (as right or wrong) by using only the end position of the point and the relation (=, <, >, \u2264, \u2265)."})})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[this.props.static?Object($t.jsx)("label",{children:"Range:"}):Object($t.jsxs)("label",{children:["Position:"," ",Object($t.jsx)(YO,{value:this.props.initialX,format:this.props.labelStyle,onChange:this.onNumChange.bind(this,"initialX"),placeholder:e[0],checkValidity:t=>t>=e[0]&&t<=e[1],useArrowKeys:!0})," \u2208 "]}),Object($t.jsx)(XO,{value:e,onChange:this.onRangeChange,format:this.props.labelStyle,useArrowKeys:!0}),Object($t.jsxs)($O,{children:[Object($t.jsxs)("p",{children:["This controls the initial position of the point along the number line and the",Object($t.jsx)("strong",{children:"range"}),", the position of the endpoints of the number line. Setting the range constrains the position of the answer and the labels."]}),Object($t.jsx)("p",{children:"In static mode, the initial position of the point is determined by Correct x instead of position."})]})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Labels:"," ",Object($t.jsx)(YO,{value:t[0],placeholder:e[0],format:this.props.labelStyle,checkValidity:t=>t>=e[0]&&t<=e[1],onChange:this.onLabelRangeChange.bind(this,0),useArrowKeys:!0}),Object($t.jsx)("span",{children:" & "}),Object($t.jsx)(YO,{value:t[1],placeholder:e[1],format:this.props.labelStyle,checkValidity:t=>t>=e[0]&&t<=e[1],onChange:this.onLabelRangeChange.bind(this,1),useArrowKeys:!0}),Object($t.jsx)($O,{children:Object($t.jsxs)("p",{children:["This controls the position of the left / right labels. By default, the labels are set by the range ",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"})," Ensure that the labels line up with the tick marks, or it may be confusing for users."]})})]})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Style:"," ",Object($t.jsx)(GO,{allowEmpty:!1,value:this.props.labelStyle,buttons:[{value:"decimal",content:"0.75",title:"Decimals"},{value:"improper",content:"\u2077\u2044\u2084",title:"Improper fractions"},{value:"mixed",content:"1\xbe",title:"Mixed numbers"},{value:"non-reduced",content:"\u2078\u2044\u2084",title:"Non-reduced"}],onChange:this.onLabelStyleChange}),Object($t.jsx)($O,{children:Object($t.jsx)("p",{children:"This controls the styling of the labels for the two main labels as well as all the tick mark labels, if applicable. Your choices are decimal, improper fractions, mixed fractions, and non-reduced fractions."})})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[!this.props.static&&Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(KO,{label:"Show tick controller",isTickCtrl:this.props.isTickCtrl,onChange:this.props.onChange})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(KO,{label:"Show label ticks",labelTicks:this.props.labelTicks,onChange:this.props.onChange})})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:!this.props.static&&Object($t.jsx)(KO,{label:"Show tooltips",showTooltips:this.props.showTooltips,onChange:this.props.onChange})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[a&&Object($t.jsxs)("span",{children:[Object($t.jsxs)("label",{children:["Start num divisions at"," ",Object($t.jsx)(YO,{value:this.props.numDivisions||null,format:"decimal",onChange:this.onNumDivisionsChange,checkValidity:e=>e>=n[0]&&e<=n[1],placeholder:s/this.props.tickStep,useArrowKeys:!0})]}),Object($t.jsx)($O,{children:Object($t.jsxs)("p",{children:["This controls the number (and position) of the tick marks. The number of divisions is constrained to"," "+n[0]+"\u2013"+n[1],".",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"})," The user will be able to specify the number of divisions in a number input."]})})]}),!a&&Object($t.jsxs)("span",{children:[Object($t.jsxs)("label",{children:["Num divisions:"," ",Object($t.jsx)(YO,{value:this.props.numDivisions||null,format:"decimal",onChange:this.onNumDivisionsChange,checkValidity:e=>e>=n[0]&&e<=n[1],placeholder:s/this.props.tickStep,useArrowKeys:!0})]})," ",Object($t.jsxs)("label",{children:["or tick step:"," ",Object($t.jsx)(YO,{value:this.props.tickStep||null,format:this.props.labelStyle,onChange:this.onTickStepChange,checkValidity:e=>e>0&&e<=s,placeholder:s/this.props.numDivisions,useArrowKeys:!0})]}),Object($t.jsx)($O,{children:Object($t.jsxs)("p",{children:["This controls the number (and position) of the tick marks; you can either set the number of divisions (2 divisions would split the entire range in two halves), or the tick step (the distance between ticks) and the other value will be updated accordingly."," ",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"})," There is no check to see if labels coordinate with the tick marks, which may be confusing for users if the blue labels and black ticks are off-step."]})})]})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("label",{children:["Snap increments per tick:"," ",Object($t.jsx)(YO,{value:r,checkValidity:e=>e>0,format:this.props.labelStyle,onChange:this.onNumChange.bind(this,"snapDivisions"),useArrowKeys:!0})]}),Object($t.jsx)($O,{children:Object($t.jsxs)("p",{children:["This determines the number of different places the point will snap between two adjacent tick marks."," ",Object($t.jsx)("br",{}),Object($t.jsx)("strong",{children:"Note:"}),"Ensure the required number of snap increments is provided to answer the question."]})})]})]})}});VO.exports=JO;var QO=VO.exports,eC={exports:{}},tC=(eC.exports,h.a,i.a),nC=x.b,sC=hu,iC=qd,rC=pg;const oC=Ng;var aC=Ss.Options;const{keypadElementPropType:lC}=ye.a.propTypes;var cC=sc,hC=cC.MovablePoint,pC=cC.Line,uC=G.a.number;const dC=Z,gC=Mi;var fC=ki.assert;var mC={ge:"le",gt:"lt",le:"ge",lt:"gt"},bC={ge:"gt",gt:"ge",le:"lt",lt:"le"};function vC(e,t){return 1===t?""+e:`\\dfrac{${e}}{${t}}`}function xC(e,t){if(e<0)return"-"+xC(-e,t);var n=Math.floor(e/t);return 0===n?vC(e,t):e-n*t===0?""+n:n+vC(e-n*t,t)}var yC=(e,t,n,s,i)=>{if(s=s||n,"decimal"===t||"decimal ticks"===t)return e.label([n,-.53],Math.round(100*s)/100,"center");if("improper"===t){const t=dC.toFraction(s);return e.label([n,-.17],vC(t[0],t[1]),"below")}if("mixed"===t){const t=dC.toFraction(s);return e.label([n,-.17],xC(t[0],t[1]),"below")}if("non-reduced"===t){const t=dC.toFraction(s);return e.label([n,-.17],function(e,t,n){return vC(e*Math.floor(n/t),n)}(t[0],t[1],i),"below")}},jC=cC.createSimpleClass(((e,t)=>{if(!nC.isFinite(t.tickStep)||t.tickStep<=0)return[];var n,s=[],i=t.range,r=t.labelRange,o=null==r[0]?i[0]:r[0],a=null==r[1]?i[1]:r[1];if("non-reduced"===t.labelStyle){var l=[o,a];for(let e=0;e<=t.numDivisions;e++){const n=i[0]+e*t.tickStep;l.push(n)}var c=nC.map(l,(e=>uC.toFraction(e)[1]));n=nC.reduce(c,((e,t)=>dC.getLCM(e,t)))}else n=void 0;for(let h=0;h<=t.numDivisions;h++){const r=i[0]+h*t.tickStep;s.push(e.line([r,-.2],[r,.2])),(t.labelTicks||"decimal ticks"===t.labelStyle)&&s.push(yC(e,t.labelStyle,r,r,n))}return s.push(e.style(t.isMobile?{color:gC.BLUE_D}:{},(()=>yC(e,t.labelStyle,o,o,n)))),s.push(e.style(t.isMobile?{color:gC.BLUE_D}:{},(()=>yC(e,t.labelStyle,a,a,n)))),e.style({stroke:t.isMobile?gC.BLUE_D:gC.DYNAMIC,strokeWidth:3.5},(()=>{s.push(e.line([o,-.2],[o,.2])),s.push(e.line([a,-.2],[a,.2]))})),s})),wC=createReactClass({displayName:"NumberLine",getDefaultProps:function(){return{range:[0,10],labelStyle:"decimal",labelRange:[null,null],divisionRange:[1,12],labelTicks:!0,isTickCtrl:!1,isInequality:!1,numLinePosition:0,snapDivisions:2,showTooltips:!1,rel:"ge",apiOptions:aC.defaults}},getInitialState:()=>({numDivisionsEmpty:!1}),change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return sC.change.apply(this,t)},isValid:function(){var e=this.props.range,t=this.props.numLinePosition,n=this.props.divisionRange;return t=null==t?e[0]:t,e[0]<e[1]&&uC.sign(t-e[0])>=0&&uC.sign(t-e[1])<=0&&n[0]<n[1]&&0<this.props.numDivisions&&0<this.props.snapDivisions},onNumDivisionsChange:function(e,t){var n=this.props.divisionRange.slice(),s=this.props.range[1]-this.props.range[0];if(e=(e=Math.round(e))<0?-1*e:e){var i=nC.extend({},this.props,{tickStep:s/e}),r=this.snapNumLinePosition(i,this.props.numLinePosition);this.setState({numDivisionsEmpty:!1},(()=>{this.props.onChange({divisionRange:n,numDivisions:e,numLinePosition:r},t)}))}else this.setState({numDivisionsEmpty:!0},t)},_handleTickCtrlFocus:function(){this.props.onFocus(["tick-ctrl"])},_handleTickCtrlBlur:function(){this.props.onBlur(["tick-ctrl"])},focus:function(){if(this.props.isTickCtrl)return this.refs["tick-ctrl"].focus(),!0},focusInputPath:function(e){1===e.length&&this.refs[e[0]].focus()},blurInputPath:function(e){1===e.length&&this.refs[e[0]].blur()},getInputPaths:function(){return this.props.isTickCtrl?[["tick-ctrl"]]:[]},getDOMNodeForPath:function(e){if(1===e.length)return tC.findDOMNode(this.refs[e[0]])},getGrammarTypeForPath:function(e){if(1===e.length&&"tick-ctrl"===e[0])return"number"},setInputValue:function(e,t,n){1===e.length&&"tick-ctrl"===e[0]&&this.onNumDivisionsChange(t,n)},_renderGraphie:function(){var e=this.props.range,t=e[1]-e[0],n=nC.pick(this.props,["range","isTickCtrl"]),s=nC.extend({},this.props,{tickStep:t/this.props.numDivisions});return Object($t.jsxs)(cC,{ref:"graphie",box:[this.props.apiOptions.isMobile?288:460,80],options:n,onMouseDown:e=>{this.refs.graphie.movables.numberLinePoint.grab(e)},setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile,children:[Object($t.jsx)(jC,{...nC.pick(s,["range","numDivisions","labelTicks","labelStyle","labelRange","tickStep"]),isMobile:this.props.apiOptions.isMobile}),this._renderInequality(s),this._renderNumberLinePoint(s)]},this.props.labelStyle)},snapNumLinePosition:function(e,t){var n=e.range[0],s=e.range[1],i=e.tickStep/e.snapDivisions;let r=((e,t,n)=>Math.min(Math.max(e,t),n))(t,n,s);return r=n+uC.roundTo(r-n,i),fC(nC.isFinite(r)),r},_renderNumberLinePoint:function(e){var t=["lt","gt"].includes(e.rel),n={fill:t?gC._BACKGROUND:e.static?gC.DYNAMIC:gC.INTERACTIVE,stroke:e.static?gC.DYNAMIC:gC.INTERACTIVE,"stroke-width":t?3:1},s={fill:t?gC._BACKGROUND:gC.INTERACTING,"stroke-width":t?3:1};const i=e.isInequality?{stroke:gC.INTERACTIVE,"fill-opacity":t?0:1}:{};return Object($t.jsx)(hC,{ref:"numberLinePoint",pointSize:6,coord:[e.numLinePosition,0],constraints:[(e,t)=>[e[0],t[1]],(t,n)=>[this.snapNumLinePosition(e,t[0]),t[1]]],normalStyle:n,highlightStyle:s,onMove:e=>{this.change({numLinePosition:e[0]}),this.props.trackInteraction()},isMobile:this.props.apiOptions.isMobile,mobileStyleOverride:i,showTooltips:this.props.showTooltips,xOnlyTooltip:!0})},handleReverse:function(){var e=mC[this.props.rel];this.props.onChange({rel:e})},handleToggleStrict:function(){var e=bC[this.props.rel];this.props.onChange({rel:e})},_getInequalityEndpoint:function(e){var t=["ge","gt"].includes(e.rel),n=e.range,s=30*((n[1]-n[0])/400),i=n[0]-s,r=n[1]+s;return t?[r,0]:[i,0]},_renderInequality:function(e){if(e.isInequality){var t=this._getInequalityEndpoint(e),n={arrows:"->",stroke:this.props.apiOptions.isMobile?gC.INTERACTIVE:gC.DYNAMIC,strokeWidth:3.5};const s=["ge","gt"].includes(e.rel);return Object($t.jsx)(pC,{start:[(s?.4:-.4)+e.numLinePosition,0],end:t,style:n})}return null},_setupGraphie:function(e,t){if(!this.isValid())return;var n=this.props.apiOptions.isMobile?228:400,s=t.range,i=(s[1]-s[0])/n,r=30*i,o=s[0]-r,a=s[1]+r;var l="improper"===this.props.labelStyle||"mixed"===this.props.labelStyle||"non-reduced"===this.props.labelStyle?-1.5:-1;e.init({range:[[o,a],[l,1]],scale:[1/i,40],isMobile:this.props.apiOptions.isMobile});var c=(s[0]+s[1])/2;e.line([c,0],[a,0],{arrows:"->"}),e.line([c,0],[o,0],{arrows:"->"})},getUserInput:function(){return{numLinePosition:this.props.numLinePosition,rel:this.props.isInequality?this.props.rel:"eq",numDivisions:this.props.numDivisions,divisionRange:this.props.divisionRange}},simpleValidate:function(e){return wC.validate(this.getUserInput(),e)},render:function(){var e,t,n=this.props.divisionRange,s=n[0]+"\u2013"+n[1],i=this.props.numDivisions<n[0]||this.props.numDivisions>n[1],r=Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"button",className:"simple-button",value:i18n._("Switch direction"),onClick:this.handleReverse}),Object($t.jsx)("input",{type:"button",className:"simple-button",value:["le","ge"].includes(this.props.rel)?i18n._("Make circle open"):i18n._("Make circle filled"),onClick:this.handleToggleStrict})]});this.props.isTickCtrl&&(t=this.props.apiOptions.customKeypad?oC:this.props.apiOptions.staticRender?rC:iC,e=Object($t.jsxs)("label",{children:[i18n._("Number of divisions:")," ",Object($t.jsx)(t,{ref:"tick-ctrl",value:this.state.numDivisionsEmpty?null:this.props.numDivisions||n[0],checkValidity:e=>e>=n[0]&&e<=n[1],onChange:this.onNumDivisionsChange,onFocus:this._handleTickCtrlFocus,onBlur:this._handleTickCtrlBlur,useArrowKeys:!0,keypadElement:this.props.keypadElement})]}));return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-interactive-number-line",children:[e,this.isValid()?this.props.isTickCtrl&&i?Object($t.jsx)("div",{className:"perseus-error",children:$_({divRangeString:s},"Please make sure the number of divisions is in the range %(divRangeString)s.")}):this._renderGraphie():Object($t.jsx)("div",{className:"perseus-error",children:"Invalid number line configuration."}),!this.props.static&&this.props.isInequality&&r]})}});nC.extend(wC,{validate:function(e,t){var n=t.range,s=e.divisionRange,i=null!=t.initialX?t.initialX:n[0],r=t.isInequality?"ge":"eq",o=t.correctRel||"eq",a=uC.equal(e.numLinePosition,t.correctX||0),l=e.numDivisions>s[1]||e.numDivisions<s[0];return e.isTickCrtl&&l?{type:"invalid",message:"Number of divisions is outside the allowed range."}:a&&o===e.rel?{type:"points",earned:1,total:1,message:null}:e.numLinePosition===i&&e.rel===r?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}});eC.exports={name:"number-line",displayName:"Number line",widget:wC,transform:e=>{var t,n=nC.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isTickCtrl","isInequality","showTooltips"]),s=null!=e.initialX?e.initialX:e.range[0],i=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?i/e.tickStep:void 0,nC.extend(n,{numLinePosition:s,numDivisions:t,snapDivisions:n.snapDivisions||void 0}),n},staticTransform:e=>{var t,n=nC.pick(e,["range","labelRange","labelStyle","labelTicks","divisionRange","snapDivisions","isInequality"]),s=null!=e.correctX?e.correctX:e.range[0],i=e.range[1]-e.range[0];return t=null!=e.numDivisions?e.numDivisions:null!=e.tickStep?i/e.tickStep:void 0,nC.extend(n,{numLinePosition:s,numDivisions:t,rel:e.isInequality?e.correctRel:null,snapDivisions:n.snapDivisions||void 0}),n}};var OC=eC.exports,CC={exports:{}};CC.exports;h.a;const SC=iu,kC=hu,_C=qd,TC=Bx,MC=createReactClass({displayName:"MoleculeWidgetEditor",change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kC.change.apply(this,t)},updateMolecule:function(e){this.change({smiles:e})},updateRotation:function(e){this.change({rotationAngle:e})},serialize(){return SC.serialize.call(this)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["SMILES:\xa0",Object($t.jsx)(TC,{onChange:this.updateMolecule,value:this.props.smiles})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Rotation (deg):\xa0",Object($t.jsx)(_C,{onChange:this.updateRotation,value:this.props.rotationAngle})]})})]})}});CC.exports=MC;var NC=CC.exports,PC={exports:{}};PC.exports;h.a;const IC=x.b,EC=hu,AC=iu,RC=sd,DC=qd,FC=Pf,LC=Df,zC={url:null,top:0,left:0},qC=createReactClass({displayName:"MeasurerEditor",className:"perseus-widget-measurer",getDefaultProps:function(){return{box:[480,480],image:{},showProtractor:!0,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10}},render:function(){var e=IC.extend({},zC,this.props.image);return Object($t.jsxs)("div",{className:"perseus-widget-measurer",children:[Object($t.jsx)("div",{children:"Image displayed under protractor and/or ruler:"}),Object($t.jsxs)("div",{children:["URL:"," ",Object($t.jsx)("input",{type:"text",className:"perseus-widget-measurer-url",ref:"image-url",defaultValue:e.url,onChange:this._changeUrl}),Object($t.jsx)(RC,{children:Object($t.jsx)("p",{children:'Create an image in graphie, or use the "Add image" function to create a background.'})})]}),e.url&&Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("label",{className:"perseus-widget-left-col",children:["Pixels from top:"," ",Object($t.jsx)(DC,{placeholder:0,onChange:this._changeTop,value:e.top,useArrowKeys:!0})]}),Object($t.jsxs)("label",{className:"perseus-widget-right-col",children:["Pixels from left:"," ",Object($t.jsx)(DC,{placeholder:0,onChange:this._changeLeft,value:e.left,useArrowKeys:!0})]})]}),Object($t.jsxs)("div",{children:["Containing area [width, height]:"," ",Object($t.jsx)(LC,{onChange:this.change("box"),value:this.props.box,useArrowKeys:!0})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(FC,{label:"Show ruler",showRuler:this.props.showRuler,onChange:this.props.onChange})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(FC,{label:"Show protractor",showProtractor:this.props.showProtractor,onChange:this.props.onChange})})]}),this.props.showRuler&&Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler label:"," ",Object($t.jsxs)("select",{onChange:e=>this.change("rulerLabel",e.target.value),value:this.props.rulerLabel,children:[Object($t.jsx)("option",{value:"",children:"None"}),Object($t.jsx)("optgroup",{label:"Metric",children:this.renderLabelChoices([["milimeters","mm"],["centimeters","cm"],["meters","m"],["kilometers","km"]])}),Object($t.jsx)("optgroup",{label:"Imperial",children:this.renderLabelChoices([["inches","in"],["feet","ft"],["yards","yd"],["miles","mi"]])})]})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","Ruler ticks:"," ",Object($t.jsx)("select",{onChange:e=>this.change("rulerTicks",+e.target.value),value:this.props.rulerTicks,children:IC.map([1,2,4,8,10,16],(function(e){return Object($t.jsx)("option",{value:e,children:e},e)}))})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Ruler pixels per unit:"," ",Object($t.jsx)(DC,{placeholder:40,onChange:this.change("rulerPixels"),value:this.props.rulerPixels,useArrowKeys:!0})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Ruler length in units:"," ",Object($t.jsx)(DC,{placeholder:10,onChange:this.change("rulerLength"),value:this.props.rulerLength,useArrowKeys:!0})]})})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return EC.change.apply(this,t)},_changeUrl:function(e){this._changeImage("url",e.target.value)},_changeTop:function(e){this._changeImage("top",e)},_changeLeft:function(e){this._changeImage("left",e)},_changeImage:function(e,t){var n=IC.clone(this.props.image);n[e]=t,this.change("image",n)},renderLabelChoices:function(e){return IC.map(e,(function(e){var[t,n]=e;return Object($t.jsx)("option",{value:n,children:t},n)}))},serialize(){return AC.serialize.call(this)}});PC.exports=qC;var WC=PC.exports,BC={exports:{}},VC=(BC.exports,h.a,i.a),HC=x.b;const UC=Kr;var GC={url:null,top:0,left:0},$C=createReactClass({displayName:"Measurer",getDefaultProps:function(){return{box:[480,480],image:{},showProtractor:!0,protractorX:7.5,protractorY:.5,showRuler:!1,rulerLabel:"",rulerTicks:10,rulerPixels:40,rulerLength:10}},getInitialState:function(){return{}},render:function(){var e=HC.extend({},GC,this.props.image);return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-measurer graphie-container above-scratchpad",style:{width:this.props.box[0],height:this.props.box[1]},children:[e.url&&Object($t.jsx)("img",{src:e.url,style:{top:e.top,left:e.left}}),Object($t.jsx)("div",{className:"graphie",ref:"graphieDiv"})]})},componentDidMount:function(){this.setupGraphie()},componentDidUpdate:function(e){HC.any(["box","showProtractor","showRuler","rulerLabel","rulerTicks","rulerPixels","rulerLength"],(function(t){return e[t]!==this.props[t]}),this)&&this.setupGraphie()},setupGraphie:function(){var e=VC.findDOMNode(this.refs.graphieDiv);$(e).empty();var t=this.graphie=UC.createGraphie(e),n=[40,40],s=[[0,this.props.box[0]/n[0]],[0,this.props.box[1]/n[1]]];t.init({range:s,scale:n}),t.addMouseLayer({allowScratchpad:!0,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable}),this.protractor&&this.protractor.remove(),this.props.showProtractor&&(this.protractor=t.protractor([this.props.protractorX,this.props.protractorY])),this.ruler&&this.ruler.remove(),this.props.showRuler&&(this.ruler=t.ruler({center:[(s[0][0]+s[0][1])/2,(s[1][0]+s[1][1])/2],label:this.props.rulerLabel,pixelsPerUnit:this.props.rulerPixels,ticksPerUnit:this.props.rulerTicks,units:this.props.rulerLength}))},getUserInput:function(){return{}},simpleValidate:function(e){return $C.validate(this.getUserInput(),e)},focus:$.noop});HC.extend($C,{validate:function(e,t){return{type:"points",earned:1,total:1,message:null}}});var YC={1:e=>HC.chain(e).omit("imageUrl","imageTop","imageLeft").extend({image:{url:e.imageUrl,top:e.imageTop,left:e.imageLeft}}).value()};BC.exports={name:"measurer",displayName:"Measurer",widget:$C,version:{major:1,minor:0},propUpgrades:YC};var KC=BC.exports,XC={exports:{}},ZC=(XC.exports,h.a,x.b),JC=sd,QC=Pf,eS=bs,tS=createReactClass({displayName:"MatcherEditor",getDefaultProps:function(){return{left:["$x$","$y$","$z$"],right:["$1$","$2$","$3$"],labels:["test","label"],orderMatters:!1,padding:!0}},render:function(){return Object($t.jsxs)("div",{className:"perseus-matcher-editor",children:[Object($t.jsxs)("div",{children:[" ","Correct answer:"," ",Object($t.jsx)(JC,{children:Object($t.jsx)("p",{children:"Enter the correct answers here. The preview on the right will show the cards in a randomized order, which is how the student will see them."})})]}),Object($t.jsxs)("div",{className:"perseus-clearfix",children:[Object($t.jsx)(eS,{options:this.props.left,onChange:(e,t)=>{this.props.onChange({left:e},t)},layout:"vertical"}),Object($t.jsx)(eS,{options:this.props.right,onChange:(e,t)=>{this.props.onChange({right:e},t)},layout:"vertical"})]}),Object($t.jsxs)("span",{children:[" ","Labels:"," ",Object($t.jsx)(JC,{children:Object($t.jsx)("p",{children:"These are entirely optional."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"text",defaultValue:this.props.labels[0],onChange:this.onLabelChange.bind(this,0)}),Object($t.jsx)("input",{type:"text",defaultValue:this.props.labels[1],onChange:this.onLabelChange.bind(this,1)})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)(QC,{label:"Order of the matched pairs matters:",orderMatters:this.props.orderMatters,onChange:this.props.onChange}),Object($t.jsxs)(JC,{children:[Object($t.jsx)("p",{children:"With this option enabled, only the order provided above will be treated as correct. This is useful when ordering is significant, such as in the context of a proof."}),Object($t.jsx)("p",{children:"If disabled, pairwise matching is sufficient. To make this clear, the left column becomes fixed in the provided order and only the cards in the right column can be moved."})]})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)(QC,{label:"Padding:",padding:this.props.padding,onChange:this.props.onChange}),Object($t.jsx)(JC,{children:Object($t.jsx)("p",{children:"Padding is good for text, but not needed for images."})})]})]})},onLabelChange:function(e,t){var n=ZC.clone(this.props.labels);n[e]=t.target.value,this.props.onChange({labels:n})},getSaveWarnings:function(){return this.props.left.length!==this.props.right.length?["The two halves of the matcher have different numbers of cards."]:[]},serialize:function(){return ZC.pick(this.props,"left","right","labels","orderMatters","padding")}});XC.exports=tS;var nS=XC.exports,sS={exports:{}};sS.exports;h.a;const iS=x.b,rS=ah,oS=zv,aS=ce.shuffle,lS=ce.seededRNG,cS=createReactClass({displayName:"Matcher",getDefaultProps:function(){return{left:[],right:[],labels:["",""],orderMatters:!1,padding:!0,problemNum:0,onChange:function(){},linterContext:je}},getInitialState:function(){return{leftHeight:0,rightHeight:0}},render:function(){var e,t=lS(this.props.problemNum);e=this.props.orderMatters?aS(this.props.left,t,!0):this.props.left;var n=aS(this.props.right,t,!0),s=iS.any(this.props.labels),i={height:iS.max([this.state.leftHeight,this.state.rightHeight])};const r=this.props.apiOptions.isMobile?8:5;return Object($t.jsx)("table",{className:Object(On.css)(pS.widget)+" perseus-widget-matcher",children:Object($t.jsxs)("tbody",{children:[s&&Object($t.jsxs)("tr",{className:Object(On.css)(pS.row),children:[Object($t.jsx)("th",{className:Object(On.css)(pS.column,pS.columnLabel),children:Object($t.jsx)(rS,{content:this.props.labels[0]||"...",linterContext:this.props.linterContext})}),Object($t.jsx)("th",{className:Object(On.css)(pS.column,pS.columnRight,pS.columnLabel),children:Object($t.jsx)(rS,{content:this.props.labels[1]||"...",linterContext:this.props.linterContext})})]}),Object($t.jsxs)("tr",{className:Object(On.css)(pS.row),children:[Object($t.jsx)("td",{className:Object(On.css)(pS.column),children:Object($t.jsx)(oS,{options:e,layout:"vertical",padding:this.props.padding,disabled:!this.props.orderMatters,constraints:i,onMeasure:this.onMeasureLeft,onChange:this.changeAndTrack,margin:r,linterContext:this.props.linterContext,ref:"left"})}),Object($t.jsx)("td",{className:Object(On.css)(pS.column,pS.columnRight),children:Object($t.jsx)(oS,{options:n,layout:"vertical",padding:this.props.padding,constraints:i,onMeasure:this.onMeasureRight,onChange:this.changeAndTrack,margin:r,linterContext:this.props.linterContext,ref:"right"})})]})]})})},changeAndTrack:function(e){this.props.onChange(e),this.props.trackInteraction()},onMeasureLeft:function(e){var t=iS.max(e.heights);this.setState({leftHeight:t})},onMeasureRight:function(e){var t=iS.max(e.heights);this.setState({rightHeight:t})},getUserInput:function(){return{left:this.refs.left.getOptions(),right:this.refs.right.getOptions()}},simpleValidate:function(e){return cS.validate(this.getUserInput(),e)}});iS.extend(cS,{validate:function(e,t){return{type:"points",earned:iS.isEqual(e.left,t.left)&&iS.isEqual(e.right,t.right)?1:0,total:1,message:null}}});const hS="1px solid #444",pS=On.StyleSheet.create({widget:{paddingTop:5,maxWidth:"100%",minWidth:"auto"},row:{border:0},column:{padding:0,border:0},columnRight:{borderLeft:hS},columnLabel:{fontWeight:"inherit",borderBottom:hS,padding:"0 5px 5px 5px",textAlign:"center"}});sS.exports={name:"matcher",displayName:"Two column matcher",widget:cS,isLintable:!0};var uS=sS.exports,dS={exports:{}},gS=(dS.exports,v.a),fS=(h.a,i.a),mS=x.b,bS=qd,vS=ah,xS=Bx,yS=pg;const jS=Ng;var wS=Ss.Options;const OS=ie,{keypadElementPropType:CS}=ye.a.propTypes;var SS=ki.assert,kS=ce.stringArrayOfSize,_S={INPUT_MARGIN:4,INPUT_HEIGHT:38,INPUT_WIDTH:82},TS={INPUT_MARGIN:3,INPUT_HEIGHT:30,INPUT_WIDTH:40};const MS={INPUT_MARGIN:4,INPUT_HEIGHT:36,INPUT_WIDTH:64};var NS=function(e,t){return[""+e,""+t]},PS=function(){return NS(0,0)},IS=function(e){return SS(mS.isArray(e)&&2===e.length),+e[0]},ES=function(e){return SS(mS.isArray(e)&&2===e.length),+e[1]},AS=function(e){return"answer"+IS(e)+","+ES(e)},RS=function(e){var t=[1,1];return mS.each(e,((e,n)=>{var s=0;mS.each(e,((e,t)=>{null!=e&&e.toString().length&&(s=t+1)})),t[1]=Math.max(t[1],s),s>0&&(t[0]=Math.max(t[0],n+1))})),t},DS=createReactClass({displayName:"Matrix",getDefaultProps:function(){return{matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0],apiOptions:wS.defaults,linterContext:je}},getInitialState:function(){return{enterTheMatrix:0}},componentDidMount:function(){this.cursorPosition=[0,0]},render:function(){let e;e=this.props.apiOptions.customKeypad?MS:this.props.apiOptions.staticRender?_S:TS;const{INPUT_MARGIN:t,INPUT_HEIGHT:n,INPUT_WIDTH:s}=e;var i=RS(this.props.answers),r=this.props.matrixBoardSize[0],o=this.props.matrixBoardSize[1],a=this.props.cursorPosition[0],l=this.props.cursorPosition[1],c=Math.max(a,i[0]-1),h=Math.max(l,i[1]-1),p=(c+1)*(n+2*t),u=(h+1)*(s+2*t),d=gS({"perseus-matrix":!0,"static-mode":this.props.static,"the-matrix":this.state.enterTheMatrix>=5});return Object($t.jsxs)("div",{className:d,children:[this.props.prefix&&Object($t.jsx)("div",{className:"matrix-prefix",children:Object($t.jsx)(vS,{content:this.props.prefix,linterContext:this.props.linterContext})}),Object($t.jsxs)("div",{className:"matrix-input",children:[Object($t.jsx)("div",{className:"matrix-bracket bracket-left",style:{height:p}}),Object($t.jsx)("div",{className:"matrix-bracket bracket-right",style:{height:p,left:u}}),mS.times(r,(e=>{var i=this.props.answers[e];return Object($t.jsx)("div",{className:"matrix-row",children:mS.times(o,(r=>{var o=e>c||r>h,a={className:o?"outside":"inside",ref:AS(NS(e,r)),value:i?i[r]:null,style:{height:n,width:s,margin:t},disabled:this.props.apiOptions.readOnly,onFocus:()=>{this.cursorPosition=[e,r],this.props.onChange({cursorPosition:[e,r]},(()=>!1)),this._handleFocus(e,r)},onBlur:()=>{e===this.cursorPosition[0]&&r===this.cursorPosition[1]&&this.props.onChange({cursorPosition:[0,0]},(()=>!1)),this._handleBlur(e,r)},onKeyDown:t=>{this.handleKeyDown(e,r,t)},onChange:(t,n)=>{this.onValueChange(e,r,t,n)}};let l;if(this.props.apiOptions.customKeypad){const e={margin:t,minWidth:s,minHeight:n,boxSizing:"border-box",backgroundColor:o?"#f3f3f3":"#fff"};l=Object($t.jsx)(jS,{...a,style:e,scrollable:!0,keypadElement:this.props.keypadElement})}else l=this.props.apiOptions.staticRender?Object($t.jsx)(yS,{...a}):this.props.numericInput?Object($t.jsx)(bS,{...a}):Object($t.jsx)(xS,{...a});return Object($t.jsx)("span",{className:"matrix-input-field",children:l},r)}))},e)}))]}),this.props.suffix&&Object($t.jsx)("div",{className:"matrix-suffix",children:Object($t.jsx)(vS,{content:this.props.suffix,linterContext:this.props.linterContext})})]})},getInputPaths:function(){var e=[],t=this.props.matrixBoardSize[0],n=this.props.matrixBoardSize[1];return mS.times(t,(t=>{mS.times(n,(n=>{var s=NS(t,n);e.push(s)}))})),e},getGrammarTypeForPath:function(e){return"number"},_handleFocus:function(e,t){this.props.onFocus(NS(e,t))},_handleBlur:function(e,t){this.props.onBlur(NS(e,t))},focus:function(){return this.focusInputPath(PS()),!0},focusInputPath:function(e){var t=AS(e);this.refs[t].focus()},blurInputPath:function(e){0===e.length&&(e=PS());var t=AS(e);this.refs[t].blur()},getDOMNodeForPath:function(e){var t=AS(e);return fS.findDOMNode(this.refs[t])},setInputValue:function(e,t,n){var s=IS(e),i=ES(e);this.onValueChange(s,i,t,n)},handleKeyDown:function(e,t,n){var s=this.props.matrixBoardSize[0],i=this.props.matrixBoardSize[1],r=null,o=this.refs[AS(NS(e,t))],a=o.getStringValue(),l=o.getSelectionStart(),c=o.getSelectionEnd(),h=null;if("ArrowUp"===n.key&&e>0?h=NS(e-1,t):"ArrowDown"===n.key&&e+1<s?h=NS(e+1,t):"ArrowLeft"===n.key&&t>0?0===l&&0===c&&(h=NS(e,t-1)):"ArrowRight"===n.key&&t+1<i?l===a.length&&(h=NS(e,t+1)):"Enter"===n.key?r=this.state.enterTheMatrix+1:"Escape"===n.key&&(r=0),h){n.preventDefault();var p=this.refs[AS(h)],u=2*p.getStringValue().length;p.focus(),"ArrowRight"===n.key?p.setSelectionRange(0,0):p.setSelectionRange(u,u)}null!=r&&this.setState({enterTheMatrix:r})},onValueChange:function(e,t,n,s){var i=mS.map(this.props.answers,mS.clone);i[e]||(i[e]=[]),i[e][t]=n,this.props.onChange({answers:i},s),this.props.trackInteraction()},getUserInput:function(){return{answers:this.props.answers}},simpleValidate:function(e){return DS.validate(this.getUserInput(),e)}});mS.extend(DS,{validate:function(e,t){var n=t.answers,s=e.answers,i=RS(n),r=RS(s),o=i[0]!==r[0]||i[1]!==r[1],a=OS.number.createValidatorFunctional,l=null,c=!1,h=!1;return mS.times(r[0],(e=>{mS.times(r[1],(t=>{null!=s[e][t]&&0!==s[e][t].toString().length||(c=!0);var i=a(n[e][t],{simplify:!0})(s[e][t]);i.message&&(l=i.message),i.correct||(h=!0)}))})),c?{type:"invalid",message:i18n._("Make sure you fill in all cells in the matrix.")}:o?{type:"points",earned:0,total:1,message:null}:{type:"points",earned:h?0:1,total:1,message:l}}});dS.exports={name:"matrix",displayName:"Matrix",widget:DS,transform:e=>{var t=mS.times(e.matrixBoardSize[0],(function(){return kS(e.matrixBoardSize[1])}));return e=mS.pick(e,"matrixBoardSize","prefix","suffix"),mS.extend(e,{answers:t})},staticTransform:e=>{var t=mS.pick(e,"matrixBoardSize","prefix","suffix");return t.answers=mS.map(e.answers,(e=>mS.map(e,(e=>null!=e?String(e):"")))),t},isLintable:!0};var FS=dS.exports,LS={exports:{}},zS=(LS.exports,h.a,x.b),qS=hu,WS=iu,BS=sv,VS=Df,HS=FS.widget,US=createReactClass({displayName:"MatrixEditor",getDefaultProps:function(){return{matrixBoardSize:[3,3],answers:[[]],prefix:"",suffix:"",cursorPosition:[0,0]}},render:function(){var e=zS.extend({numericInput:!0,onBlur:()=>{},onFocus:()=>{},trackInteraction:()=>{}},this.props);return Object($t.jsxs)("div",{className:"perseus-matrix-editor",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[" ","Max matrix size:"," ",Object($t.jsx)(VS,{value:this.props.matrixBoardSize,onChange:this.onMatrixBoardSizeChange,format:this.props.labelStyle,useArrowKeys:!0})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(HS,{...e})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[" ","Matrix prefix:"," ",Object($t.jsx)(BS,{ref:"prefix",apiOptions:this.props.apiOptions,content:this.props.prefix,widgetEnabled:!1,onChange:e=>{this.change({prefix:e.content})}})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[" ","Matrix suffix:"," ",Object($t.jsx)(BS,{ref:"suffix",apiOptions:this.props.apiOptions,content:this.props.suffix,widgetEnabled:!1,onChange:e=>{this.change({suffix:e.content})}})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return qS.change.apply(this,t)},onMatrixBoardSizeChange:function(e){var t=function(e){var t=[1,1];return zS.each(e,((e,n)=>{var s=0;zS.each(e,((e,t)=>{null!=e&&e.toString().length&&(s=t+1)})),t[1]=Math.max(t[1],s),s>0&&(t[0]=Math.max(t[0],n+1))})),t}(this.props.answers);if(null!==e[0]&&null!==e[1]){e=[Math.round(Math.min(Math.max(e[0],1),6)),Math.round(Math.min(Math.max(e[1],1),6))];var n=zS.times(Math.min(e[0],t[0]),(n=>zS.times(Math.min(e[1],t[1]),(e=>this.props.answers[n][e]))));this.props.onChange({matrixBoardSize:e,answers:n})}},serialize(){return WS.serialize.call(this)}});LS.exports=US;var GS=LS.exports,$S={exports:{}};$S.exports;h.a;const YS=x.b,KS=hu,XS=iu,ZS=qd,JS=Pf,QS=sd;var ek={display:"table",tableLayout:"fixed"},tk={display:"table-row"},nk={display:"table-cell",padding:5},sk={borderRadius:10,cursor:"pointer"},ik={plus:()=>[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]],x:()=>[[!0,!1,!0],[!1,!0,!1],[!0,!1,!0]],"plus/x":e=>e%2?ik.x():ik.plus()},rk=function(e,t,n){return e=Math.floor(e),e=Math.max(e,t),e=Math.min(e,n)},ok=createReactClass({displayName:"Tile",render:function(){var e=this.props.value?"#55dd55":"#115511",t=YS.extend({},sk,{width:this.props.size,height:this.props.size,backgroundColor:e});return Object($t.jsx)("div",{style:t,onClick:this._flip})},_flip:function(){this.props.onChange(!this.props.value)}}),ak=createReactClass({displayName:"TileGrid",render:function(){return Object($t.jsx)("div",{style:ek,className:"no-select",children:YS.map(this.props.cells,((e,t)=>Object($t.jsx)("div",{style:tk,children:YS.map(e,((e,n)=>Object($t.jsx)("div",{style:nk,children:Object($t.jsx)(ok,{value:e,size:this.props.size,onChange:YS.partial(this.props.onChange,t,n)})},n)))},t)))})}});const lk=createReactClass({displayName:"LightsPuzzleEditor",getDefaultProps:function(){return{startCells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],flipPattern:"plus",gradeIncompleteAsWrong:!1}},_height:function(){return this.props.startCells.length},_width:function(){return 0!==this.props.startCells.length?this.props.startCells[0].length:0},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return KS.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:["Width:",Object($t.jsx)(ZS,{value:this._width(),placeholder:5,onChange:this._changeWidth}),", ","Height:",Object($t.jsx)(ZS,{value:this._height(),placeholder:5,onChange:this._changeHeight})]}),Object($t.jsxs)("div",{children:["Flip pattern:",Object($t.jsx)("select",{value:this.props.flipPattern,onChange:this._handlePatternChange,children:YS.map(YS.keys(ik),((e,t)=>Object($t.jsx)("option",{value:e,children:e},t)))})]}),Object($t.jsxs)("div",{children:["Grade incomplete puzzles as wrong:"," ",Object($t.jsx)(JS,{gradeIncompleteAsWrong:this.props.gradeIncompleteAsWrong,onChange:this.props.onChange}),Object($t.jsx)(QS,{children:"By default, incomplete puzzles are graded as empty."})]}),Object($t.jsx)("div",{children:"Starting configuration:"}),Object($t.jsx)("div",{style:{overflowX:"auto"},children:Object($t.jsx)(ak,{cells:this.props.startCells,size:50,onChange:this._switchTile})})]})},_handlePatternChange:function(e){this.change("flipPattern",e.target.value)},_changeWidth:function(e){e=rk(e,1,8),this._truncateCells(e,this._height())},_changeHeight:function(e){e=rk(e,1,8),this._truncateCells(this._width(),e)},_truncateCells:function(e,t){var n=YS.times(t,(t=>YS.times(e,(e=>!(!this.props.startCells[t]||!this.props.startCells[t][e])))));this.change({startCells:n})},_switchTile:function(e,t){var n,s,i=(n=this.props.startCells,s=(n,s)=>n===e&&s===t,YS.map(n,((e,t)=>YS.map(e,((e,n)=>s(t,n)?!e:e)))));this.change({startCells:i})},serialize(){return XS.serialize.call(this)}});$S.exports=lk;var ck=$S.exports,hk={exports:{}},pk=(hk.exports,h.a,x.b),uk=hu,dk=Du,gk={display:"table",tableLayout:"fixed"},fk={display:"table-row"},mk={display:"table-cell",padding:5},bk={borderRadius:10,cursor:"pointer"},vk={padding:5,display:"inline-block"},xk={float:"right",paddingRight:5},yk={plus:()=>[[!1,!0,!1],[!0,!0,!0],[!1,!0,!1]],x:()=>[[!0,!1,!0],[!1,!0,!1],[!0,!1,!0]],"plus/x":e=>e%2?yk.x():yk.plus()},jk=createReactClass({displayName:"Tile",render:function(){var e=this.props.value?"#55dd55":"#115511",t=pk.extend({},bk,{width:this.props.size,height:this.props.size,backgroundColor:e});return Object($t.jsx)("div",{style:t,onClick:this._flip})},_flip:function(){this.props.onChange(!this.props.value)}}),wk=createReactClass({displayName:"TileGrid",render:function(){return Object($t.jsx)("div",{style:gk,className:"no-select",children:pk.map(this.props.cells,((e,t)=>Object($t.jsx)("div",{style:fk,children:pk.map(e,((e,n)=>Object($t.jsx)("div",{style:mk,children:Object($t.jsx)(jk,{value:e,size:this.props.size,onChange:pk.partial(this.props.onChange,t,n)})},n)))},t)))})}}),Ok=(e,t,n,s)=>((e,t)=>pk.map(e,((e,n)=>pk.map(e,((e,s)=>t(n,s)?!e:e)))))(e,((e,i)=>{var r=e-t,o=i-n;return Math.abs(r)<=1&&Math.abs(o)<=1&&s[r+1][o+1]})),Ck=createReactClass({displayName:"LightsPuzzle",getDefaultProps:function(){return{cells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],startCells:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],flipPattern:"plus",moveCount:0}},getUserInput:function(){return dk.getUserInput.call(this)},render:function(){var e=60*this._width();return Object($t.jsxs)("div",{children:[Object($t.jsx)(wk,{cells:this.props.cells,size:50,onChange:this._flipTile}),Object($t.jsxs)("div",{style:{width:e},children:[Object($t.jsxs)("div",{style:vk,children:["Moves: ",this.props.moveCount]}),Object($t.jsx)("div",{style:xk,children:Object($t.jsx)("input",{type:"button",value:"Reset",onClick:this._reset,className:"simple-button"})})]}),Object($t.jsx)("div",{className:"clearfix"})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return uk.change.apply(this,t)},_width:function(){return 0!==this.props.cells.length?this.props.cells[0].length:0},componentDidMount:function(){this._initNextPatterns()},componentDidUpdate:function(e){e.flipPattern!==this.props.flipPattern&&this._initNextPatterns()},_initNextPatterns:function(){this._currPattern=yk[this.props.flipPattern](0),this._nextPattern=yk[this.props.flipPattern](1),this._patternIndex=2},_shiftPatterns:function(){this._currPattern=this._nextPattern,this._nextPattern=yk[this.props.flipPattern](this._patternIndex),this._patternIndex++},_flipTile:function(e,t){var n=Ok(this.props.cells,e,t,this._currPattern);this._shiftPatterns(),this.change({cells:n,moveCount:this.props.moveCount+1})},_reset:function(){this.change({cells:this.props.startCells,moveCount:0})},simpleValidate:function(e){return Sk(e,this.getUserInput())}}),Sk=function(e,t){return pk.all(t.cells,((t,n)=>pk.all(t,((t,s)=>t===e.startCells[n][s]))))?{type:"invalid",message:i18n._("Click on the tiles to change the lights.")}:pk.all(t.cells,(e=>pk.all(e,(e=>e))))?{type:"points",earned:1,total:1,message:null}:e.gradeIncompleteAsWrong?{type:"points",earned:0,total:1,message:null}:{type:"invalid",message:i18n._("You must turn on all of the lights to continue.")}};hk.exports={name:"lights-puzzle",displayName:"Lights Puzzle",hidden:!0,widget:Ck,transform:function(e){return{cells:e.startCells,startCells:e.startCells,flipPattern:e.flipPattern}}};var kk=hk.exports,_k={exports:{}},Tk=(_k.exports,h.a,x.b),Mk=Wg,Nk=sd,Pk=bl,Ik=qd,Ek=ce,Ak=G.a.number,Rk=G.a.point;const Dk=Mi,Fk=Kr,Lk=Ji;var zk=Ek.DeprecationMixin,qk={url:null},Wk=Ek.eq,Bk=Ek.deepEq,Vk="unlimited";function Hk(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function Uk(e,t,n){return Wk(Hk(e,t,n),0)}function Gk(e){return Wk(e,0)?0:e>0?1:-1}function $k(e,t){return null==e?t:e}function Yk(e,t,n){return n[0]<=Math.max(e[0],t[0])&&n[0]>=Math.min(e[0],t[0])&&n[1]<=Math.max(e[1],t[1])&&n[1]>=Math.min(e[1],t[1])}function Kk(e,t){var n=[[e[0],e[1],t[0]],[e[0],e[1],t[1]],[t[0],t[1],e[0]],[t[0],t[1],e[1]]],s=Tk.map(n,(function(e){return Gk(Hk.apply(null,e))}));if(s[0]!==s[1]&&s[2]!==s[3])return!0;for(var i=0;i<4;i++)if(0===s[i]&&Yk.apply(null,n[i]))return!0;return!1}function Xk(e,t){return Tk.map(Tk.zip(e,t),(function(e){return e[0]-e[1]}))}function Zk(e){return Math.sqrt(Tk.reduce(e,(function(e,t){return e+Math.pow(t,2)}),0))}function Jk(e){var t=Tk.zip(e,s_(e));return Tk.map(t,(function(e){return Zk(Xk.apply(null,e))}))}function Qk(e){var t=Tk.zip(s_(e,-1),e,s_(e,1)),n=Tk.map(t,(function(e){var t,n,s=Xk(e[1],e[0]),i=Xk(e[2],e[1]),r=Math.acos((t=s,n=i,Tk.reduce(Tk.zip(t,n),(function(e,t){return e+t[0]*t[1]}),0)/(Zk(s)*Zk(i))));return Gk(Hk.apply(null,e))>0?r:-r})),s=Tk.reduce(n,(function(e,t){return e+t}),0);return Tk.map(n,(function(e){return s>0?Math.PI-e:Math.PI+e}))}function e_(e,t,n){if(e.length!==t.length)return!1;for(var s=e.length,i=Qk(e),r=Qk(t),o=Jk(e),a=Jk(t),l=0;l<2*s;l++){var c=r.slice(),h=a.slice();if(l>=s&&(c.reverse(),h.reverse(),h=s_(h,1)),c=s_(c,l),h=s_(h,l),Bk(i,c)){var p=Tk.zip(o,h),u=Tk.map(p,(function(e){return e[0]/e[1]})),d=Tk.all(u,(function(e){return Wk(u[0],e)})),g=Tk.all(p,(function(e){return Ak.equal(e[0],e[1],n)}));if(d&&g)return!0}}return!1}function t_(e,t){return e<t||Wk(e,t)}function n_(e){var t=e[0],n=e[1],s=e[2],i=e[3];t<0&&(t*=-1,n*=-1,s*=-1);var r=2*Math.PI;for(n<0&&(n*=-1,s*=-1,s+=r/2);s>0;)s-=r;for(;s<0;)s+=r;return[t,n,s,i]}function s_(e,t){return t="undefined"===typeof t?1:t%e.length,e.slice(t).concat(e.slice(0,t))}function i_(e){return e.replace(/(?:^|-)(.)/g,(function(e,t){return t.toUpperCase()}))}function r_(e,t){if(Wk(e[0],t[0]))return"x = "+e[0].toFixed(3);var n=(t[1]-e[1])/(t[0]-e[0]),s=e[1]-n*e[0];return"y = "+n.toFixed(3)+"x + "+s.toFixed(3)}var o_=createReactClass({displayName:"InteractiveGraph",getInitialState:function(){return{shouldShowInstructions:this._getShouldShowInstructions()}},getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:qk,markings:"graph",showTooltips:!1,showProtractor:!1,showRuler:!1,rulerLabel:"",rulerTicks:10,graph:{type:"linear"}}},deprecatedProps:{showGraph:function(e){return{markings:e.showGraph?"graph":"none"}}},componentWillMount(){zk.componentWillMount.call(this)},_getShouldShowInstructions:function(e){return e=e||this.props,this.isClickToAddPoints(e)&&(null==e.graph.coords||0===e.graph.coords.length)},componentDidUpdate:function(e,t){var n=e.graph.type,s=this.props.graph.type;n===s&&e.graph.allowReflexAngles===this.props.graph.allowReflexAngles&&e.graph.angleOffsetDeg===this.props.graph.angleOffsetDeg&&e.graph.numPoints===this.props.graph.numPoints&&e.graph.numSides===this.props.graph.numSides&&e.graph.numSegments===this.props.graph.numSegments&&e.graph.showAngles===this.props.graph.showAngles&&e.graph.showSides===this.props.graph.showSides&&e.graph.snapTo===this.props.graph.snapTo&&e.graph.snapDegrees===this.props.graph.snapDegrees||(this["remove"+i_(n)+"Controls"](),this["add"+i_(s)+"Controls"]()),this.shouldResetGraphie&&this.resetGraphie()},render:function(){var e,t;if(this.props.flexibleType)if(e=Object($t.jsxs)("select",{value:this.props.graph.type,onChange:e=>{var t=e.target.value;this.onChange({graph:{type:t}})},children:[Object($t.jsx)("option",{value:"linear",children:"Linear function"}),Object($t.jsx)("option",{value:"quadratic",children:"Quadratic function"}),Object($t.jsx)("option",{value:"sinusoid",children:"Sinusoid function"}),Object($t.jsx)("option",{value:"circle",children:"Circle"}),Object($t.jsx)("option",{value:"point",children:"Point(s)"}),Object($t.jsx)("option",{value:"linear-system",children:"Linear System"}),Object($t.jsx)("option",{value:"polygon",children:"Polygon"}),Object($t.jsx)("option",{value:"segment",children:"Line Segment(s)"}),Object($t.jsx)("option",{value:"ray",children:"Ray"}),Object($t.jsx)("option",{value:"angle",children:"Angle"})]}),"point"===this.props.graph.type)t=Object($t.jsxs)("select",{value:this.props.graph.numPoints||1,onChange:e=>{var t=+e.target.value||e.target.value;this.onChange({graph:{type:"point",numPoints:t,coords:null}})},children:[Tk.map(Tk.range(1,7),(function(e){return Object($t.jsxs)("option",{value:e,children:[e," point",e>1&&"s"]})})),Object($t.jsx)("option",{value:Vk,children:"unlimited"})]},"point-select");else if("polygon"===this.props.graph.type)t=Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("select",{value:this.props.graph.numSides||3,onChange:e=>{var t=+e.target.value||e.target.value,n=Tk.extend({},this.props.graph,{numSides:t,coords:null,snapTo:"grid"});this.onChange({graph:n})},children:[Tk.map(Tk.range(3,13),(function(e){return Object($t.jsxs)("option",{value:e,children:[e," sides"]})})),Object($t.jsx)("option",{value:Vk,children:"unlimited sides"})]},"polygon-select")}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Snap to"," ",Object($t.jsxs)("select",{value:this.props.graph.snapTo,onChange:e=>{var t=Tk.extend({},this.props.graph,{snapTo:e.target.value,coords:null});this.onChange({graph:t})},children:[Object($t.jsx)("option",{value:"grid",children:"grid"}),this.props.graph.numSides!==Vk&&[Object($t.jsxs)("option",{value:"angles",children:[" ","interior angles"," "]}),Object($t.jsxs)("option",{value:"sides",children:[" ","side measures"," "]})]]},"polygon-snap")]}),Object($t.jsxs)(Nk,{children:[Object($t.jsx)("p",{children:"These options affect the movement of the vertex points. The grid option will guide the points to the nearest half step along the grid."}),Object($t.jsx)("p",{children:"The interior angle and side measure options guide the points to the nearest whole angle or side"})," ","measure respectively."," "]})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show angle measures:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles})]}),Object($t.jsx)(Nk,{children:Object($t.jsx)("p",{children:"Displays the interior angle measures."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show side measures:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.graph.showSides,onChange:this.toggleShowSides})]}),Object($t.jsx)(Nk,{children:Object($t.jsx)("p",{children:"Displays the side lengths."})})]})]});else if("segment"===this.props.graph.type)t=Object($t.jsx)("select",{value:this.props.graph.numSegments||1,onChange:e=>{var t=+e.target.value;this.onChange({graph:{type:"segment",numSegments:t,coords:null}})},children:Tk.map(Tk.range(1,7),(function(e){return Object($t.jsxs)("option",{value:e,children:[e," segment",e>1&&"s"]})}))},"segment-select");else if("angle"===this.props.graph.type){var n=$k(this.props.graph.allowReflexAngles,!0);t=Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Show angle measure:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.graph.showAngles,onChange:this.toggleShowAngles})]})}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Allow reflex angles:"," ",Object($t.jsx)("input",{type:"checkbox",checked:n,onChange:e=>{this.onChange({graph:Tk.extend({},this.props.graph,{allowReflexAngles:!n,coords:null})})}})]}),Object($t.jsxs)(Nk,{children:[Object($t.jsx)("p",{children:"Reflex angles are angles with a measure greater than 180 degrees."}),Object($t.jsx)("p",{children:"By default, these should remain enabled."})]})]}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Snap to increments of"," ",Object($t.jsx)(Ik,{placeholder:1,value:this.props.graph.snapDegrees,onChange:e=>{this.onChange({graph:Tk.extend({},this.props.graph,{snapDegrees:Math.abs(e),coords:null})})}},"degree-snap")," ","degrees"," "]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[" ","With an offset of"," ",Object($t.jsx)(Ik,{placeholder:0,value:this.props.graph.angleOffsetDeg,onChange:e=>{this.onChange({graph:Tk.extend({},this.props.graph,{angleOffsetDeg:e,coords:null})})}},"angle-offset")," ","degrees"," "]})})]})}const s=zs(this.props.containerSizeClass);var i;this.isClickToAddPoints()&&this.state.shouldShowInstructions?"point"===this.props.graph.type?i=i18n._("Click to add points"):"polygon"===this.props.graph.type&&(i=i18n._("Click to add vertices")):i=void 0;var r=this.isClickToAddPoints()?this.handleAddPointsMouseDown:null,o=this.props.gridStep||Ek.getGridStep(this.props.range,this.props.step,s[0]),a=this.props.snapStep||Ek.snapStepFromGridStep(o);const l=this.props.apiOptions.isMobile;return Object($t.jsxs)("div",{className:"perseus-widget perseus-widget-interactive-graph",style:{width:s[0],height:this.props.flexibleType?"auto":s[1]},children:[Object($t.jsx)(Mk,{instructions:i,ref:"graph",box:s,labels:this.props.labels,range:this.props.range,step:l?Ek.constrainedTickStepsFromTickSteps(this.props.step,this.props.range):this.props.step,gridStep:o,snapStep:a,markings:this.props.markings,backgroundImage:this.props.backgroundImage,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,onMouseDown:r,onGraphieUpdated:this.setGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:l}),e,t]})},componentDidMount:function(){this.setGraphie(this.refs.graph.graphie())},setGraphie:function(e){this.graphie=e,this.setupGraphie()},handleAddPointsMouseDown:function(e){if(!this.isClickToAddPoints())throw new Error("handleAddPointsClick should not be registeredwhen isClickToAddPoints() is false");if(!this.isCoordInTrash(e)){var t;if("point"===this.props.graph.type){if(!(t=this.createPointForPointsType(e,this.points.length)).constrain())return void t.remove();this.points.push(t);var n=this.points.length-1;this.points[n].grab(e),this.updateCoordsFromPoints()}else if("polygon"===this.props.graph.type){if(this.polygon.closed())return;t=this.createPointForPolygonType(e,this.points.length),this.points.push(t);n=this.points.length-1;this.points[n].grab(e),this.updatePolygon()}this.setState({shouldShowInstructions:!1})}},resetGraphie:function(){this.shouldResetGraphie=!1,this.parabola=null,this.sinusoid=null,this.refs.graph.reset()},setupGraphie:function(){this.setTrashCanVisibility(0),this.isClickToAddPoints()&&this.setTrashCanVisibility(.5),this.props.apiOptions.isMobile&&(this.horizHairline=new Lk(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.horizHairline.attr({stroke:Dk.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new Lk(this.graphie,[0,0],[0,0],{normalStyle:{strokeWidth:1}}),this.vertHairline.attr({stroke:Dk.INTERACTIVE}),this.vertHairline.hide()),this["add"+i_(this.props.graph.type)+"Controls"]()},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.range[0][0],e[1]],[this.props.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.range[1][0]],[e[0],this.props.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},setTrashCanVisibility:function(e){var t=this.graphie;Ak.equal(e,0)?this.trashCan&&(this.trashCan.remove(),this.trashCan=null):this.props.apiOptions.isMobile||(this.trashCan||(this.trashCan=t.raphael.image("https://ka-perseus-graphie.s3.amazonaws.com/b1452c0d79fd0f7ff4c3af9488474a0a0decb361.png",t.xpixels-40,t.ypixels-40,40,40)),this.trashCan.attr({opacity:e}))},componentWillReceiveProps:function(e){this.isClickToAddPoints()!==this.isClickToAddPoints(e)&&(this.shouldResetGraphie=!0,this.setState({shouldShowInstructions:this._getShouldShowInstructions(e)})),this.props.backgroundImage.url===e.backgroundImage.url&&this.props.backgroundImage===e.backgroundImage&&this.props.containerSizeClass===e.containerSizeClass||(this.shouldResetGraphie=!0)},isClickToAddPoints:function(e){return"point"===(e=e||this.props).graph.type&&e.graph.numPoints===Vk||"polygon"===e.graph.type&&e.graph.numSides===Vk},_lineStroke:function(){return this.props.isMobile?{"stroke-width":3}:{}},addLine:function(e){var t=this,n=t.graphie,s=o_.getLineCoords(t.props.graph,t.props),i=t.points=Tk.map(s,(e=>Pk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap()],onMove:()=>{var e=Tk.extend({},t.props.graph,{coords:Tk.invoke(i,"coord")});t.onChange({graph:e})}}))),r={points:i,static:!0,normalStyle:{stroke:this.props.apiOptions.isMobile?Dk.BLUE_C:Dk.INTERACTIVE,...this._lineStroke()}};"line"===e?r.extendLine=!0:"ray"===e&&(r.extendRay=!0);t.line=Pk.addMovableLine(n,r);i[0].listen("constraints","isLine",(e=>!Rk.equal(e,i[1].coord()))),i[1].listen("constraints","isLine",(e=>!Rk.equal(e,i[0].coord())))},removeLine:function(){Tk.invoke(this.points,"remove"),this.line.remove()},addLinearControls:function(){this.addLine("line")},removeLinearControls:function(){this.removeLine()},addQuadraticControls:function(){this.graphie;var e,t,n,s=this.props.graph.coords;s||(s=o_.defaultQuadraticCoords(this.props));var i=()=>{var s=Tk.extend({},this.props.graph,{coords:[e.coord(),t.coord(),n.coord()]});this.onChange({graph:s}),this.updateQuadratic()};e=this.pointA=Pk.addMaybeMobileMovablePoint(this,{coord:s[0],constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),s=>!e||s[0]!==t.coord()[0]&&s[0]!==n.coord()[0]],onMove:i}),t=this.pointB=Pk.addMaybeMobileMovablePoint(this,{coord:s[1],constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),s=>!t||s[0]!==e.coord()[0]&&s[0]!==n.coord()[0]],onMove:i}),n=this.pointC=Pk.addMaybeMobileMovablePoint(this,{coord:s[2],constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),s=>!n||s[0]!==e.coord()[0]&&s[0]!==t.coord()[0]],onMove:i}),this.updateQuadratic()},updateQuadratic:function(){var e=o_.getCurrentQuadraticCoefficients(this.props);if(e){var t=e[0],n=e[1],s=e[2];if(this.parabola){var i=this.graphie.svgParabolaPath(t,n,s);this.parabola.attr({path:i})}else this.parabola=this.graphie.parabola(t,n,s),this.parabola.attr({stroke:this.props.apiOptions.isMobile?Dk.BLUE_C:Dk.DYNAMIC,...this._lineStroke()}),this.parabola.toBack()}},removeQuadraticControls:function(){this.pointA.remove(),this.pointB.remove(),this.pointC.remove(),this.parabola&&(this.parabola.remove(),this.parabola=null)},addSinusoidControls:function(){this.graphie;var e,t,n=this.props.graph.coords;n||(n=o_.defaultSinusoidCoords(this.props));var s=()=>{var n=Tk.extend({},this.props.graph,{coords:[e.coord(),t.coord()]});this.onChange({graph:n}),this.updateSinusoid()};e=this.pointA=Pk.addMaybeMobileMovablePoint(this,{coord:n[0],constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),n=>!e||n[0]!==t.coord()[0]],onMove:s}),t=this.pointB=Pk.addMaybeMobileMovablePoint(this,{coord:n[1],constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),t=>!e||t[0]!==e.coord()[0]],onMove:s}),this.updateSinusoid()},updateSinusoid:function(){var e=o_.getCurrentSinusoidCoefficients(this.props);if(e){var t=e[0],n=e[1],s=e[2],i=e[3];if(this.sinusoid){var r=this.graphie.svgSinusoidPath(t,n,s,i);this.sinusoid.attr({path:r})}else this.sinusoid=this.graphie.sinusoid(t,n,s,i),this.sinusoid.attr({stroke:this.props.apiOptions.isMobile?Dk.BLUE_C:Dk.DYNAMIC,...this._lineStroke()}),this.sinusoid.toBack()}},removeSinusoidControls:function(){this.pointA.remove(),this.pointB.remove(),this.sinusoid&&(this.sinusoid.remove(),this.sinusoid=null)},addCircleControls:function(){var e=this.graphie,t=Tk.min(e.snap),n=this.circle=e.addCircleGraph({center:this.props.graph.center||[0,0],radius:this.props.graph.radius||Tk.min(this.props.step),snapX:e.snap[0],snapY:e.snap[1],minRadius:t,snapRadius:t});$(n).on("move",(()=>{var e=Tk.extend({},this.props.graph,{center:n.center,radius:n.radius});this.onChange({graph:e})}))},removeCircleControls:function(){this.circle.remove()},addLinearSystemControls:function(){var e=this.graphie,t=o_.getLinearSystemCoords(this.props.graph,this.props),n=[Dk.INTERACTIVE,Dk.GREEN],s=this.points=Tk.map(t,((e,t)=>{var s=Tk.map(e,((e,i)=>Pk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),e=>{if(s)return!Rk.equal(e,s[1-i].coord())}],onMove:()=>{var e=Tk.extend({},this.props.graph,{coords:Tk.map(this.points,(e=>Tk.invoke(e,"coord")))});this.onChange({graph:e})},normalStyle:{fill:n[t]},highlightStyle:{fill:n[t]}})));return s}));this.lines=Tk.map(s,((t,s)=>Pk.addMovableLine(e,{points:t,static:!0,extendLine:!0,normalStyle:{stroke:n[s]}})))},removeLinearSystemControls:function(){Tk.invoke(this.lines,"remove"),Tk.map(this.points,(e=>Tk.invoke(e,"remove")))},isCoordInTrash:function(e){if(this.props.apiOptions.isMobile)return!1;var t=this.graphie,n=t.scalePoint(e);return n[0]>=t.xpixels-40&&n[1]>=t.ypixels-40},createPointForPointsType:function(e,t){var n=this;n.graphie;const s=()=>{n.points=Tk.filter(n.points,(function(e){return e!==i})),n.updateCoordsFromPoints(),setTimeout(i.remove.bind(i),0)};var i=Pk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),function(e){return Tk.all(n.points,(function(t){return i===t||!Rk.equal(e,t.coord())}))}],onMoveStart:function(){n.isClickToAddPoints()&&n.setTrashCanVisibility(1)},onMove:n.updateCoordsFromPoints,onMoveEnd:function(e){n.isClickToAddPoints()&&(n.isCoordInTrash(e)&&s(),n.setTrashCanVisibility(.5))},...this.props.apiOptions.isMobile&&n.isClickToAddPoints()?{onRemove:s}:{}});return i},removePoint:function(e){var t=null;return this.points=Tk.filter(this.points,(function(n,s){return n!==e||(t=s,!1)})),t},createPointForPolygonType:function(e,t){this.graphie;var n=!Tk.contains(["angles","sides"],this.props.graph.snapTo),s=e=>(t+e+this.points.length)%this.points.length;const i=()=>{var e=this.removePoint(r);this.polygon.closed()&&(this.points=s_(this.points,e),this.polygon.update({closed:!1})),this.updatePolygon(),this.clearCoords(),setTimeout(r.remove.bind(r),0)};var r=Pk.addMaybeMobileMovablePoint(this,{coord:e,constraints:[Pk.MovablePoint.constraints.bound(),n?Pk.MovablePoint.constraints.snap():null,e=>{if(null==this.points||0===this.points.length)return!0;var n,i,r,o=Tk.invoke(this.points,"coord");if(o[t]=e,!this.isClickToAddPoints()){if(Uk(o[s(-2)],o[s(-1)],o[t])||Uk(o[s(-1)],o[t],o[s(1)])||Uk(o[t],o[s(1)],o[s(2)]))return!1;var a=Tk.zip(o,s_(o));if(this.points.length>3)for(var l=-1;l<=0;l++)for(var c=a[s(l)],h=Tk.without(a,c,a[s(l-1)],a[s(l+1)]),p=0;p<h.length;p++){if(Kk(c,h[p]))return!1}}if("angles"===this.props.graph.snapTo&&this.points.length>2){var u=Tk.map(Qk(o),(function(e){return 180*e/Math.PI}));Tk.each([-1,1],(function(e){u[s(e)]=Math.round(u[s(e)])}));var d=function(e,t,n){return(Fk.findAngle(o[s(e)],o[s(n)],o[s(t)])+360)%360},g=[u[s(-1)]-d(-2,-1,1),u[s(1)]-d(-1,1,2)];if(g[2]=180-(g[0]+g[1]),Tk.any(g,(function(e){return t_(e,1)})))return!1;var f=Zk(Xk(o[s(-1)],o[s(1)])),m=1===Gk(Hk(o[s(-1)],o[s(1)],o[t])),b=Math.sin(g[1]*Math.PI/180)/Math.sin(g[2]*Math.PI/180)*f,v=Fk.findAngle(o[s(1)],o[s(-1)]),x=this.graphie.polar(b,v+(m?1:-1)*g[0]);return this.graphie.addPoints(o[s(-1)],x)}if("sides"===this.props.graph.snapTo&&this.points.length>1){var y=Tk.map([[o[s(-1)],o[t]],[o[t],o[s(1)]],[o[s(-1)],o[s(1)]]],(function(e){return Zk(Xk.apply(null,e))}));if(Tk.each([0,1],(function(e){y[e]=Math.round(y[e])})),t_(y[1]+y[2],y[0])||t_(y[0]+y[2],y[1])||t_(y[0]+y[1],y[2]))return!1;var j=(n=y[0],i=y[2],r=y[1],180*Math.acos((n*n+i*i-r*r)/(2*n*i))/Math.PI);v=Fk.findAngle(o[s(1)],o[s(-1)]),m=1===Gk(Hk(o[s(-1)],o[s(1)],o[t])),x=this.graphie.polar(y[0],v+(m?1:-1)*j);return this.graphie.addPoints(o[s(-1)],x)}return!0}],onMoveStart:()=>{this.isClickToAddPoints()&&this.setTrashCanVisibility(1)},onMove:()=>{this.polygon.closed()&&this.updateCoordsFromPoints()},onMoveEnd:e=>{if(this.isClickToAddPoints()){if(this.isCoordInTrash(e))i();else if(this.points.length>1&&(r===this.points[0]&&Rk.equal(e,Tk.last(this.points).coord())||r===Tk.last(this.points)&&Rk.equal(e,this.points[0].coord()))){var t=this.points.pop();this.points.length>2?(this.polygon.update({closed:!0}),this.updateCoordsFromPoints()):(this.polygon.update({closed:!1}),this.clearCoords()),this.updatePolygon(),setTimeout(t.remove.bind(t),0)}else{Tk.any(this.points,(function(t){return t!==r&&Rk.equal(t.coord(),e)}))?(this.removePoint(r),this.points.length<3?(this.polygon.update({closed:!1}),this.clearCoords()):this.polygon.closed()&&this.updateCoordsFromPoints(),this.updatePolygon(),setTimeout(r.remove.bind(r),0)):r!==this.points[0]&&r!==Tk.last(this.points)||r.hasMoved()||r.state.isInitialMove||this.polygon.closed()||!(this.points.length>2)||(this.polygon.update({closed:!0}),this.updatePolygon(),this.updateCoordsFromPoints())}this.setTrashCanVisibility(.5)}r.state.isInitialMove=!1},...this.props.apiOptions.isMobile&&this.isClickToAddPoints()?{onRemove:i}:{}});return r.state.isInitialMove=!0,r},updateCoordsFromPoints:function(){var e=Tk.extend({},this.props.graph,{coords:Tk.map(this.points,(function(e){return Tk.result(e,"coord")}))});this.onChange({graph:e})},clearCoords:function(){var e=Tk.extend({},this.props.graph,{coords:null});this.onChange({graph:e})},onChange:function(e){this.props.onChange(e),this.props.trackInteraction()},addPointControls:function(){var e=o_.getPointCoords(this.props.graph,this.props);this.points=[],this.points=Tk.map(e,this.createPointForPointsType,this)},removePointControls:function(){Tk.invoke(this.points,"remove")},addSegmentControls:function(){var e=this,t=this.graphie,n=o_.getSegmentCoords(this.props.graph,this.props);const s=e=>Pk.addMaybeMobileMovablePoint(this,e);this.points=[],this.lines=Tk.map(n,(function(n,i){var r=function(){var t=Tk.extend({},e.props.graph,{coords:Tk.invoke(e.lines,"coords")});e.onChange({graph:t})},o=Tk.map(n,(function(e,t){return s({coord:e,constraints:[Pk.MovablePoint.constraints.bound(),Pk.MovablePoint.constraints.snap(),e=>{if(o)return!Rk.equal(e,o[1-t].coord())}],onMove:r})}));e.points=e.points.concat(o);var a=Pk.addMovableLine(t,{points:o,static:!1,constraints:[Pk.MovableLine.constraints.bound(),Pk.MovableLine.constraints.snap()],onMove:[Pk.MovableLine.onMove.updatePoints,r],normalStyle:{stroke:this.props.apiOptions.isMobile?Dk.BLUE_C:Dk.INTERACTIVE,...this._lineStroke()},highlightStyle:{stroke:this.props.apiOptions.isMobile?Dk.BLUE_C:Dk.INTERACTING,...this._lineStroke()}});return Tk.invoke(o,"toFront"),a}),this)},removeSegmentControls:function(){Tk.invoke(this.points,"remove"),Tk.invoke(this.lines,"remove")},addRayControls:function(){this.addLine("ray")},removeRayControls:function(){this.removeLine()},addPolygonControls:function(){this.polygon=null;var e=o_.getPolygonCoords(this.props.graph,this.props);this.points=[],this.points=Tk.map(e,this.createPointForPolygonType,this),this.updatePolygon()},updatePolygon:function(){var e;e=this.polygon?this.polygon.closed():this.points.length>=3;var t=this.graphie,n=this.points.length,s=!Tk.contains(["angles","sides"],this.props.graph.snapTo),i=Tk.times(n,(function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?"angles"===this.props.graph.snapTo?"$deg0":"$deg1":""}),this),r=Tk.times(n,(function(t){return e||0!==t&&t!==n-1}),this),o=Tk.times(n,(function(t){return this.props.graph.showAngles&&(e||0!==t&&t!==n-1)?1:0}),this),a=Tk.times(n,(function(t){return!this.props.graph.showSides||!e&&t===n-1?"":"sides"===this.props.graph.snapTo?"$len0":"$len1"}),this);if(null==this.polygon){var l=this;l.polygon=Pk.addMovablePolygon(t,{constraints:[Pk.MovablePolygon.constraints.bound(),s?Pk.MovablePolygon.constraints.snap():null],closed:e,points:l.points,angleLabels:i,showRightAngleMarkers:r,numArcs:o,sideLabels:a,onMove:[Pk.MovablePolygon.onMove.updatePoints,function(){this.closed()&&l.updateCoordsFromPoints()}],normalStyle:{stroke:this.props.apiOptions.isMobile?Dk.BLUE_C:Dk.INTERACTIVE,...this._lineStroke()}})}else this.polygon.update({closed:e,points:this.points,angleLabels:i,showRightAngleMarkers:r,numArcs:o,sideLabels:a})},removePolygonControls:function(){Tk.invoke(this.points,"remove"),this.polygon.remove()},addAngleControls:function(){var e=this.graphie,t=o_.getAngleCoords(this.props.graph,this.props);this.points=Tk.map(t,(function(t,n){return e.addMovablePoint(Tk.extend({coord:t,normalStyle:{stroke:Dk.INTERACTIVE,fill:Dk.INTERACTIVE}},1===n?{snapX:e.snap[0],snapY:e.snap[1]}:{}))})),this.angle=e.addMovableAngle({points:this.points,snapDegrees:this.props.graph.snapDegrees||1,snapOffsetDeg:this.props.graph.angleOffsetDeg||0,angleLabel:this.props.graph.showAngles?"$deg0":"",pushOut:2,allowReflex:$k(this.props.graph.allowReflexAngles,!0)}),$(this.angle).on("move",(()=>{var e=Tk.extend({},this.props.graph,{coords:this.angle.getClockwiseCoords()});this.onChange({graph:e})}))},removeAngleControls:function(){Tk.invoke(this.points,"remove"),this.angle.remove()},toggleShowAngles:function(){var e=Tk.extend({},this.props.graph,{showAngles:!this.props.graph.showAngles});this.onChange({graph:e})},toggleShowSides:function(){var e=Tk.extend({},this.props.graph,{showSides:!this.props.graph.showSides});this.onChange({graph:e})},getUserInput:function(){return this.props.graph},simpleValidate:function(e){return o_.validate(this.getUserInput(),e,this)},focus:$.noop});Tk.extend(o_,{getQuadraticCoefficients:function(e){var t=e[0],n=e[1],s=e[2],i=(t[0]-n[0])*(t[0]-s[0])*(n[0]-s[0]);if(0!==i)return[(s[0]*(n[1]-t[1])+n[0]*(t[1]-s[1])+t[0]*(s[1]-n[1]))/i,(s[0]*s[0]*(t[1]-n[1])+n[0]*n[0]*(s[1]-t[1])+t[0]*t[0]*(n[1]-s[1]))/i,(n[0]*s[0]*(n[0]-s[0])*t[1]+s[0]*t[0]*(s[0]-t[0])*n[1]+t[0]*n[0]*(t[0]-n[0])*s[1])/i]},getSinusoidCoefficients:function(e){var t=e[0],n=e[1],s=n[1]-t[1],i=Math.PI/(2*(n[0]-t[0]));return[s,i,t[0]*i,t[1]]},getLineCoords:function(e,t){return e.coords||o_.pointsFromNormalized(t,[[.25,.75],[.75,.75]])},getPointCoords:function(e,t){var n=e.numPoints||1;if(s=e.coords)return s;switch(n){case 1:s=[e.coord||[0,0]];break;case 2:s=[[-5,0],[5,0]];break;case 3:s=[[-5,0],[0,0],[5,0]];break;case 4:s=[[-6,0],[-2,0],[2,0],[6,0]];break;case 5:s=[[-6,0],[-3,0],[0,0],[3,0],[6,0]];break;case 6:s=[[-5,0],[-3,0],[-1,0],[1,0],[3,0],[5,0]];break;case Vk:s=[]}var s;return s=o_.normalizeCoords(s,[[-10,10],[-10,10]]),s=o_.pointsFromNormalized(t,s)},getLinearSystemCoords:function(e,t){return e.coords||Tk.map([[[.25,.75],[.75,.75]],[[.25,.25],[.75,.25]]],(e=>o_.pointsFromNormalized(t,e)))},getPolygonCoords:function(e,t){var n=e.coords;if(n)return n;var s=e.numSides||3;if(s===Vk)n=[];else{var i=2*Math.PI/s,r=(1/s-.5)*Math.PI,o="sides"===e.snapTo?Math.sqrt(3)/3*7:4;n=Tk.times(s,(function(e){return[o*Math.cos(e*i+r),o*Math.sin(e*i+r)]}))}n=o_.normalizeCoords(n,[[-10,10],[-10,10]]);var a=!Tk.contains(["angles","sides"],e.snapTo);return n=o_.pointsFromNormalized(t,n,!a)},getSegmentCoords:function(e,t){var n=e.coords;if(n)return n;var s={1:[5],2:[5,-5],3:[5,0,-5],4:[6,2,-2,-6],5:[6,3,0,-3,-6],6:[5,3,1,-1,-3,-5]}[e.numSegments||1],i=[[-10,10],[-10,10]];return Tk.map(s,(function(e){var n=[[-5,e],[5,e]];return n=o_.normalizeCoords(n,i),n=o_.pointsFromNormalized(t,n)}))},getAngleCoords:function(e,t){var n=e.coords;if(n)return n;for(var s=e.snapDegrees||1,i=s;i<20;)i+=s;i=i*Math.PI/180;var r=(e.angleOffsetDeg||0)*Math.PI/180;n=o_.pointsFromNormalized(t,[[.85,.5],[.5,.5]]);var o=Zk(Xk.apply(null,n));return n[0]=[n[1][0]+o*Math.cos(r),n[1][1]+o*Math.sin(r)],n[2]=[n[1][0]+o*Math.cos(i+r),n[1][1]+o*Math.sin(i+r)],n},normalizeCoords:function(e,t){return Tk.map(e,(function(e){return Tk.map(e,(function(e,n){var s=t[n][1]-t[n][0];return(e+t[n][1])/s}))}))},getEquationString:function(e){var t="get"+i_(e.graph.type)+"EquationString";return o_[t](e)},pointsFromNormalized:function(e,t,n){return Tk.map(t,(function(t){return Tk.map(t,(function(t,s){var i=e.range[s];if(n)return i[0]+(i[1]-i[0])*t;var r=e.step[s],o=function(e,t){return Math.floor((e[1]-e[0])/t)}(i,r),a=Math.round(t*o);return i[0]+r*a}))}))},getLinearEquationString:function(e){var t=o_.getLineCoords(e.graph,e);if(Wk(t[0][0],t[1][0]))return"x = "+t[0][0].toFixed(3);var n=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]),s=t[0][1]-n*t[0][0];return Wk(n,0)?"y = "+s.toFixed(3):"y = "+n.toFixed(3)+"x + "+s.toFixed(3)},getCurrentQuadraticCoefficients:function(e){var t=e.graph.coords||o_.defaultQuadraticCoords(e);return o_.getQuadraticCoefficients(t)},defaultQuadraticCoords:function(e){return o_.pointsFromNormalized(e,[[.25,.75],[.5,.25],[.75,.75]])},getQuadraticEquationString:function(e){var t=o_.getCurrentQuadraticCoefficients(e);return"y = "+t[0].toFixed(3)+"x^2 + "+t[1].toFixed(3)+"x + "+t[2].toFixed(3)},getCurrentSinusoidCoefficients:function(e){var t=e.graph.coords||o_.defaultSinusoidCoords(e);return o_.getSinusoidCoefficients(t)},defaultSinusoidCoords:function(e){return o_.pointsFromNormalized(e,[[.5,.5],[.65,.6]])},getSinusoidEquationString:function(e){var t=o_.getCurrentSinusoidCoefficients(e);return"y = "+t[0].toFixed(3)+"sin("+t[1].toFixed(3)+"x - "+t[2].toFixed(3)+") + "+t[3].toFixed(3)},getCircleEquationString:function(e){var t=e.graph,n=t.center||[0,0],s=t.radius||2;return"center ("+n[0]+", "+n[1]+"), radius "+s},getLinearSystemEquationString:function(e){var t=o_.getLinearSystemCoords(e.graph,e);return"\n"+r_(t[0][0],t[0][1])+"\n"+r_(t[1][0],t[1][1])+"\n"+function(e,t){var n=e[0][0],s=e[0][1],i=e[1][0],r=e[1][1],o=t[0][0],a=t[0][1],l=t[1][0],c=t[1][1],h=(n-i)*(a-c)-(s-r)*(o-l);if(Math.abs(h)<1e-9)return"Lines are parallel";var p=((n*r-s*i)*(a-c)-(s-r)*(o*c-a*l))/h;return"Intersection: ("+(((n*r-s*i)*(o-l)-(n-i)*(o*c-a*l))/h).toFixed(3)+", "+p.toFixed(3)+")"}(t[0],t[1])},getPointEquationString:function(e){return o_.getPointCoords(e.graph,e).map((function(e){return"("+e[0]+", "+e[1]+")"})).join(", ")},getSegmentEquationString:function(e){var t=o_.getSegmentCoords(e.graph,e);return Tk.map(t,(function(e){return"["+Tk.map(e,(function(e){return"("+e.join(", ")+")"})).join(" ")+"]"})).join(" ")},getRayEquationString:function(e){var t=o_.getLineCoords(e.graph,e),n=t[0],s=t[1],i=o_.getLinearEquationString(e);return n[0]>s[0]?i+=" (for x <= "+n[0].toFixed(3)+")":n[0]<s[0]?i+=" (for x >= "+n[0].toFixed(3)+")":n[1]>s[1]?i+=" (for y <= "+n[1].toFixed(3)+")":i+=" (for y >= "+n[1].toFixed(3)+")",i},getPolygonEquationString:function(e){var t=o_.getPolygonCoords(e.graph,e);return Tk.map(t,(function(e){return"("+e.join(", ")+")"})).join(" ")},getAngleEquationString:function(e){var t=o_.getAngleCoords(e.graph,e);return Fk.findAngle(t[2],t[0],t[1]).toFixed(0)+"\xb0 angle at ("+t[1].join(", ")+")"},validate:function(e,t,n){var s=!!(e.coords||e.center&&e.radius);if(e.type===t.correct.type&&s)if("linear"===e.type){var i=e.coords;if(Uk((c=t.correct.coords)[0],c[1],i[0])&&Uk(c[0],c[1],i[1]))return{type:"points",earned:1,total:1,message:null}}else if("linear-system"===e.type){i=e.coords;if(Uk((c=t.correct.coords)[0][0],c[0][1],i[0][0])&&Uk(c[0][0],c[0][1],i[0][1])&&Uk(c[1][0],c[1][1],i[1][0])&&Uk(c[1][0],c[1][1],i[1][1])||Uk(c[0][0],c[0][1],i[1][0])&&Uk(c[0][0],c[0][1],i[1][1])&&Uk(c[1][0],c[1][1],i[0][0])&&Uk(c[1][0],c[1][1],i[0][1]))return{type:"points",earned:1,total:1,message:null}}else if("quadratic"===e.type){var r=this.getQuadraticCoefficients(e.coords),o=this.getQuadraticCoefficients(t.correct.coords);if(Bk(r,o))return{type:"points",earned:1,total:1,message:null}}else if("sinusoid"===e.type){r=this.getSinusoidCoefficients(e.coords),o=this.getSinusoidCoefficients(t.correct.coords);var a=n_(r),l=n_(o);if(Bk(a,l))return{type:"points",earned:1,total:1,message:null}}else if("circle"===e.type){if(Bk(e.center,t.correct.center)&&Wk(e.radius,t.correct.radius))return{type:"points",earned:1,total:1,message:null}}else if("point"===e.type){i=e.coords;var c=o_.getPointCoords(t.correct,n);if(i=i.slice(),c=c.slice(),i.sort(),c.sort(),Bk(i,c))return{type:"points",earned:1,total:1,message:null}}else if("polygon"===e.type){i=e.coords.slice(),c=t.correct.coords.slice();if("similar"===t.correct.match?h=e_(i,c,Number.POSITIVE_INFINITY):"congruent"===t.correct.match?h=e_(i,c,Ak.DEFAULT_TOLERANCE):"approx"===t.correct.match?h=e_(i,c,.1):(i.sort(),c.sort(),h=Bk(i,c)),h)return{type:"points",earned:1,total:1,message:null}}else if("segment"===e.type){i=e.coords.slice(),c=t.correct.coords.slice();if(i=Tk.invoke(i,"sort").sort(),c=Tk.invoke(c,"sort").sort(),Bk(i,c))return{type:"points",earned:1,total:1,message:null}}else if("ray"===e.type){i=e.coords,c=t.correct.coords;if(Bk(i[0],c[0])&&Uk(c[0],c[1],i[1]))return{type:"points",earned:1,total:1,message:null}}else if("angle"===e.type){var h;i=e.coords,c=t.correct.coords;if("congruent"===t.correct.match){var p=Tk.map([i,c],(function(e){return(Fk.findAngle(e[2],e[0],e[1])+360)%360}));h=Wk.apply(null,p)}else h=Bk(i[1],c[1])&&Uk(c[1],c[0],i[0])&&Uk(c[1],c[2],i[2]);if(h)return{type:"points",earned:1,total:1,message:null}}return!s||Tk.isEqual(e,t.graph)?{type:"invalid",message:null}:{type:"points",earned:0,total:1,message:null}}}),_k.exports={name:"interactive-graph",displayName:"Interactive graph",widget:o_};var a_=_k.exports,l_={exports:{}};l_.exports;h.a;const c_=x.b,h_=ce,p_=h_.DeprecationMixin,u_=Zf,d_=sd,g_=a_.widget,f_={url:null};const m_=createReactClass({displayName:"InteractiveGraphEditor",className:"perseus-widget-interactive-graph",getDefaultProps:function(){return{labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],valid:!0,backgroundImage:f_,markings:"graph",showProtractor:!1,showRuler:!1,showTooltips:!1,rulerLabel:"",rulerTicks:10,correct:{type:"linear",coords:null}}},deprecatedProps:{showGraph:function(e){return{markings:e.showGraph?"graph":"none"}}},componentWillMount(){p_.componentWillMount.call(this)},render:function(){var e,t,n=this.props.gridStep||h_.getGridStep(this.props.range,this.props.step,vn),s=this.props.snapStep||h_.snapStepFromGridStep(n);const i=Ls.SMALL;if(!0===this.props.valid){var r={ref:"graph",box:this.props.box,range:this.props.range,labels:this.props.labels,step:this.props.step,gridStep:n,snapStep:s,graph:this.props.correct,backgroundImage:this.props.backgroundImage,markings:this.props.markings,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,trackInteraction:function(){},flexibleType:!0,onChange:e=>{var t=this.props.correct;t=t.type===e.graph.type?c_.extend({},t,e.graph):e.graph,this.props.onChange({correct:t})}};e=Object($t.jsx)(g_,{...r,containerSizeClass:i,apiOptions:{...this.props.apiOptions,isMobile:!1}}),t=g_.getEquationString(r)}else e=Object($t.jsx)("div",{className:"perseus-error",children:this.props.valid});return Object($t.jsxs)("div",{className:"perseus-widget-interactive-graph",children:[Object($t.jsxs)("div",{children:["Correct answer"," ",Object($t.jsx)(d_,{children:Object($t.jsx)("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",t]}),Object($t.jsx)(u_,{box:zs(i),range:this.props.range,labels:this.props.labels,step:this.props.step,gridStep:n,snapStep:s,valid:this.props.valid,backgroundImage:this.props.backgroundImage,markings:this.props.markings,showProtractor:this.props.showProtractor,showRuler:this.props.showRuler,showTooltips:this.props.showTooltips,rulerLabel:this.props.rulerLabel,rulerTicks:this.props.rulerTicks,onChange:this.props.onChange}),"polygon"===this.props.correct.type&&Object($t.jsxs)("div",{className:"type-settings",children:[Object($t.jsxs)("label",{children:[" ","Student answer must"," ",Object($t.jsxs)("select",{value:this.props.correct.match,onChange:this.changeMatchType,children:[Object($t.jsx)("option",{value:"exact",children:"match exactly"}),Object($t.jsx)("option",{value:"congruent",children:"be congruent"}),Object($t.jsx)("option",{value:"approx",children:"be approximately congruent"}),Object($t.jsx)("option",{value:"similar",children:"be similar"})]})]}),Object($t.jsx)(d_,{children:Object($t.jsxs)("ul",{children:[Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Match Exactly:"})," Match exactly in size, orientation, and location on the grid even if it is not shown in the background."]})}),Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Be Congruent:"})," Be congruent in size and shape, but can be located anywhere on the grid."]})}),Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Be Approximately Congruent:"})," Be exactly similar, and congruent in size and shape to within 0.1 units, but can be located anywhere on the grid."," ",Object($t.jsx)("em",{children:"Use this with snapping to angle measure."})]})}),Object($t.jsx)("li",{children:Object($t.jsxs)("p",{children:[Object($t.jsx)("b",{children:"Be Similar:"})," Be similar with matching interior angles, and side measures that are matching or a multiple of the correct side measures. The figure can be located anywhere on the grid."]})})]})})]}),"angle"===this.props.correct.type&&Object($t.jsx)("div",{className:"type-settings",children:Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[" ","Student answer must"," ",Object($t.jsxs)("select",{value:this.props.correct.match,onChange:this.changeMatchType,children:[Object($t.jsx)("option",{value:"exact",children:"match exactly"}),Object($t.jsx)("option",{value:"congruent",children:"be congruent"})]})]}),Object($t.jsx)(d_,{children:Object($t.jsx)("p",{children:"Congruency requires only that the angle measures are the same. An exact match implies congruency, but also requires that the angles have the same orientation and that the vertices are in the same position."})})]})}),e]})},changeMatchType:function(e){var t=c_.extend({},this.props.correct,{match:e.target.value});this.props.onChange({correct:t})},serialize:function(){var e=c_.pick(this.props,"step","backgroundImage","markings","labels","showProtractor","showRuler","showTooltips","rulerLabel","rulerTicks","range","gridStep","snapStep"),t=this.refs.graph;if(t){var n=t&&t.getUserInput();c_.extend(e,{graph:{type:n.type},correct:n}),c_.each(["allowReflexAngles","angleOffsetDeg","numPoints","numSides","numSegments","showAngles","showSides","snapTo","snapDegrees"],(function(t){c_.has(n,t)&&(e.graph[t]=n[t])}))}return e}});l_.exports=m_;var b_=l_.exports,v_={exports:{}};v_.exports;h.a;const x_=x.b,y_=Nn.a,j_={fontSize:"150%"},w_={fontSize:"120%"},O_={fontSize:"130%"},C_=[()=>[Object($t.jsx)("span",{style:w_,children:"+"},"plus"),"+"],()=>[Object($t.jsx)("span",{style:j_,children:"-"},"minus"),"-"],e=>e.convertDotToTimes?[Object($t.jsx)(y_,{style:j_,children:"\\times"},"times"),"\\times"]:[Object($t.jsx)(y_,{style:j_,children:"\\cdot"},"times"),"\\cdot"],()=>[Object($t.jsx)(y_,{style:j_,children:"\\frac{\u25a1}{\u25a1}"},"frac"),e=>{const t=e.latex();e.typedText("/"),e.latex()===t&&e.cmd("\\frac")}]],S_={basic:C_,"basic+div":C_.concat([()=>[Object($t.jsx)(y_,{children:"\\div"},"div"),"\\div"]]),trig:[()=>[Object($t.jsx)(y_,{children:"\\sin"},"sin"),"\\sin"],()=>[Object($t.jsx)(y_,{children:"\\cos"},"cos"),"\\cos"],()=>[Object($t.jsx)(y_,{children:"\\tan"},"tan"),"\\tan"],()=>[Object($t.jsx)(y_,{style:O_,children:"\\theta"},"theta"),"\\theta"],()=>[Object($t.jsx)(y_,{style:O_,children:"\\phi"},"pi"),"\\phi"]],prealgebra:[()=>[Object($t.jsx)(y_,{children:"\\sqrt{x}"},"sqrt"),"\\sqrt"],()=>[Object($t.jsx)(y_,{children:"\\sqrt[3]{x}"},"nthroot"),e=>{e.typedText("nthroot3"),e.keystroke("Right")}],()=>[Object($t.jsx)(y_,{style:w_,children:"\u25a1^a"},"pow"),e=>{const t=e.latex();e.typedText("^"),e.latex()===t&&e.typedText("a^b")}],()=>[Object($t.jsx)(y_,{style:w_,children:"\\pi"},"pi"),"\\pi"]],logarithms:[()=>[Object($t.jsx)(y_,{children:"\\log"},"log"),"\\log"],()=>[Object($t.jsx)(y_,{children:"\\ln"},"ln"),"\\ln"],()=>[Object($t.jsx)(y_,{children:"\\log_b"},"log_b"),e=>{e.typedText("log_"),e.keystroke("Right"),e.typedText("("),e.keystroke("Left"),e.keystroke("Left")}]],"basic relations":[()=>[Object($t.jsx)(y_,{children:"="},"eq"),"="],()=>[Object($t.jsx)(y_,{children:"\\lt"},"lt"),"\\lt"],()=>[Object($t.jsx)(y_,{children:"\\gt"},"gt"),"\\gt"]],"advanced relations":[()=>[Object($t.jsx)(y_,{children:"\\neq"},"neq"),"\\neq"],()=>[Object($t.jsx)(y_,{children:"\\leq"},"leq"),"\\leq"],()=>[Object($t.jsx)(y_,{children:"\\geq"},"geq"),"\\geq"]]},k_=PropTypes.arrayOf(PropTypes.oneOf(Object.keys(S_))),__=createReactClass({displayName:"TexButtons",render:function(){const e=x_.sortBy(this.props.sets,(e=>x_.keys(S_).indexOf(e))).map((e=>S_[e])).map((e=>e.map((e=>{const t=e(this.props);return Object($t.jsx)("button",{onClick:()=>this.props.onInsert(t[1]),className:"tex-button",tabIndex:-1,type:"button",children:t[0]},t[0].key)})))).map(((e,t)=>Object($t.jsx)("div",{className:"clearfix tex-button-row",children:e},this.props.sets[t])));return Object($t.jsx)("div",{className:`${this.props.className} preview-measure`,children:e})},statics:{buttonSets:S_,buttonSetsType:k_}});v_.exports=__;var T_=v_.exports,M_={exports:{}};M_.exports;const N_=v.a,P_=(h.a,i.a),I_=x.b,E_=T_,A_=window.MathQuill,R_=createReactClass({displayName:"MathInput",render:function(){let e=N_({"perseus-math-input":!0,"mq-editable-field":!0,"mq-math-mode":!0});this.props.className&&(e=e+" "+this.props.className);let t=null;return this._shouldShowButtons()&&(t=Object($t.jsx)(E_,{sets:this.props.buttonSets,className:"math-input-buttons absolute",convertDotToTimes:this.props.convertDotToTimes,onInsert:this.insert})),Object($t.jsxs)("div",{style:{display:"inline-block"},children:[Object($t.jsx)("div",{style:{display:"inline-block"},children:Object($t.jsx)("span",{className:e,ref:"mathinput","aria-label":this.props.labelText,onFocus:this.handleFocus,onBlur:this.handleBlur})}),Object($t.jsx)("div",{style:{position:"relative"},children:t})]})},handleFocus:function(){this.setState({focused:!0})},handleMouseDown:function(e){const t=P_.findDOMNode(this).contains(e.target);this.mouseDown=t,t||this.setState({focused:!1})},handleMouseUp:function(){this.mouseDown&&this.focus(),this.mouseDown=!1},handleBlur:function(){this.mouseDown||this.setState({focused:!1})},_shouldShowButtons:function(){return"always"===this.props.buttonsVisible||"never"!==this.props.buttonsVisible&&this.state.focused},getDefaultProps:function(){return{value:"",convertDotToTimes:!1,buttonsVisible:"focused"}},getInitialState:function(){return{focused:!1}},insert:function(e){const t=this.mathField();I_.isFunction(e)?e(t):"\\"===e[0]?t.cmd(e).focus():t.write(e).focus(),t.focus()},mathField:function(e){return A_.getInterface(2).MathField(P_.findDOMNode(this.refs.mathinput),e)},componentWillUnmount:function(){window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)},componentDidMount:function(){window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp);let e=!1;this.mathField({autoCommands:"pi theta phi sqrt nthroot",charsThatBreakOutOfSupSub:"+-*/=<>\u2260\u2264\u2265",supSubsRequireOperand:!0,spaceBehavesLikeTab:!0,handlers:{edited:t=>{let n=t.latex();if(n=n.replace(/<>/g,"\\ne"),this.props.convertDotToTimes){n=n.replace(/\\cdot/g,"\\times");const e=t.__controller.cursor[A_.L];e&&"\\cdot "===e.ctrlSeq&&(t.__controller.backspace(),t.cmd("\\times"))}else n=n.replace(/\\times/g,"\\cdot");e&&this.props.value!==n&&this.props.onChange(n)},enter:()=>{l()(P_.findDOMNode(this.refs.mathinput)).submit()},upOutOf:e=>{e.typedText("^")}}}),this.mathField().latex(this.props.value),e=!0},componentDidUpdate:function(){I_.isEqual(this.mathField().latex(),this.props.value)||this.mathField().latex(this.props.value)},focus:function(){this.mathField().focus(),this.setState({focused:!0})},blur:function(){this.mathField().blur(),this.setState({focused:!1})}});M_.exports=R_;var D_=M_.exports,F_={exports:{}};F_.exports;const L_=h.a,z_=Kt;class q_ extends L_.Component{constructor(e){super(e),this.toggle=e=>{e.preventDefault(),this.setState({show:!this.state.show})},this.state={show:e.initiallyVisible}}render(){return Object($t.jsxs)("div",{className:"perseus-interaction-element",children:[Object($t.jsxs)("a",{href:"#",className:"perseus-interaction-element-title "+(this.state.show?"open":"closed"),onClick:this.toggle,children:[this.state.show?Object($t.jsx)(z_,{...sa}):Object($t.jsx)(z_,{...ia}),this.props.title]}),Object($t.jsxs)("div",{className:"perseus-interaction-element-content "+(this.state.show?"enter":"leave"),children:[this.props.children,(null!=this.props.onUp||null!=this.props.onDown||null!=this.props.onDelete)&&Object($t.jsxs)("div",{className:"edit-controls",children:[null!=this.props.onUp&&Object($t.jsx)("button",{onClick:this.props.onUp,children:Object($t.jsx)(z_,{...aa})}),null!=this.props.onDown&&Object($t.jsx)("button",{onClick:this.props.onDown,children:Object($t.jsx)(z_,{...oa})}),null!=this.props.onDelete&&Object($t.jsx)("button",{onClick:this.props.onDelete,children:Object($t.jsx)(z_,{...ya})})]})]})]})}}q_.defaultProps={initiallyVisible:!1,title:"More"},F_.exports=q_;var W_=F_.exports,B_={exports:{}};B_.exports;const V_=Ff.a,H_=h.a;class U_ extends H_.Component{render(){return Object($t.jsx)(V_,{value:this.props.value,allowEmpty:!1,buttons:[{value:"",content:Object($t.jsx)("span",{children:"\u2014"})},{value:"-",content:Object($t.jsx)("span",{children:"\u2013\u2013\u2013"})},{value:"- ",content:Object($t.jsx)("span",{children:"\u2013\xa0\xa0\u2013"})},{value:".",content:Object($t.jsx)("span",{children:"\xb7\xb7\xb7\xb7"})},{value:". ",content:Object($t.jsx)("span",{children:"\xb7 \xb7 \xb7"})}],onChange:this.props.onChange})}}U_.defaultProps={value:""},B_.exports=U_;var G_=B_.exports,Y_={exports:{}};Y_.exports;const K_=h.a,X_=Nn.a,Z_=Ff.a,J_=D_,Q_=qd;class eT extends K_.Component{constructor(){var e;super(...arguments),e=this,this.change=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return lu.apply(e,n)}}render(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Constraint:"," ",Object($t.jsx)(Z_,{value:this.props.constraint,allowEmpty:!1,buttons:[{value:"none",content:"None"},{value:"snap",content:"Snap"},{value:"x",content:"x="},{value:"y",content:"y="}],onChange:this.change("constraint")})]}),"snap"===this.props.constraint&&Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Snap:"," ",Object($t.jsx)(Q_,{value:this.props.snap,placeholder:0,onChange:this.change("snap")})]}),"x"===this.props.constraint&&Object($t.jsx)("div",{className:"graph-settings",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(X_,{children:"x="})," ",Object($t.jsx)(J_,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintFn,onChange:this.change("constraintFn")})]})}),"y"===this.props.constraint&&Object($t.jsx)("div",{className:"graph-settings",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(X_,{children:"y="})," ",Object($t.jsx)(J_,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintFn,onChange:this.change("constraintFn")})]})}),"Ensure these are set so nothing can be dragged off the canvas:",Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(X_,{children:"x \\in \\Large["})," ",Object($t.jsx)(J_,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintXMin,onChange:this.change("constraintXMin")}),Object($t.jsx)(X_,{children:", "})," ",Object($t.jsx)(J_,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintXMax,onChange:this.change("constraintXMax")})," ",Object($t.jsx)(X_,{children:"\\Large]"})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(X_,{children:"y \\in \\Large["})," ",Object($t.jsx)(J_,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintYMin,onChange:this.change("constraintYMin")}),Object($t.jsx)(X_,{children:", "})," ",Object($t.jsx)(J_,{buttonSets:[],buttonsVisible:"never",value:this.props.constraintYMax,onChange:this.change("constraintYMax")})," ",Object($t.jsx)(X_,{children:"\\Large]"})]})})]})}}eT.defaultProps={constraint:"none",snap:.5,constraintFn:"0",constraintXMin:"-10",constraintXMax:"10",constraintYMin:"-10",constraintYMax:"10"},Y_.exports=eT;var tT=Y_.exports,nT={exports:{}};nT.exports;const sT=Ff.a,iT=h.a,rT=x.b,oT=Mi,aT=[oT.BLACK,oT.BLUE,oT.GREEN,oT.PINK,oT.PURPLE,oT.RED,oT.GRAY],lT=[oT.LIGHT_BLUE,oT.LIGHT_ORANGE,oT.LIGHT_PINK,oT.LIGHT_GREEN,oT.LIGHT_PURPLE,oT.LIGHT_RED,"#fff"];class cT extends iT.Component{render(){const e=this.props.lightColors?lT:aT;return Object($t.jsx)(sT,{value:this.props.value,allowEmpty:!1,buttons:rT.map(e,(e=>({value:e,content:Object($t.jsxs)("span",{children:[Object($t.jsx)("span",{className:"colorpicker-circle",style:{background:e}}),"\xa0"]})}))),onChange:this.props.onChange})}}cT.defaultProps={value:oT.BLACK,lightColors:!1},nT.exports=cT;var hT=nT.exports,pT={exports:{}};pT.exports;const uT=Ff.a,dT=h.a;class gT extends dT.Component{render(){return Object($t.jsx)(uT,{value:this.props.value,allowEmpty:!1,buttons:[{value:"",content:Object($t.jsx)("span",{children:"\u2014"})},{value:"->",content:Object($t.jsx)("span",{children:"\u2192"})}],onChange:this.props.onChange})}}gT.defaultProps={value:""},pT.exports=gT;var fT=pT.exports,mT={exports:{}};mT.exports;h.a;const bT=x.b,vT=hu,xT=iu,yT=fT,jT=hT,wT=tT,OT=G_,CT=W_,ST=Zf,kT=D_,_T=qd,TT=Nn.a,MT=Bx,NT=Mi;var PT={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]};const IT=createReactClass({displayName:"PointEditor",getDefaultProps:function(){return{coordX:"0",coordY:"0",color:NT.BLACK}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Coordinate: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordX,onChange:this.change("coordX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordY,onChange:this.change("coordY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(jT,{value:this.props.color,onChange:this.change("color")})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}});var ET=createReactClass({displayName:"LineEditor",getDefaultProps:function(){return{startX:"-5",startY:"5",endX:"5",endY:"5",color:NT.BLACK,strokeDasharray:"",arrows:"",strokeWidth:2}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.startX,onChange:this.change("startX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.startY,onChange:this.change("startY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["End: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.endX,onChange:this.change("endX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.endY,onChange:this.change("endY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(jT,{value:this.props.color,onChange:this.change("color")})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(OT,{value:this.props.strokeDasharray,onChange:this.change("strokeDasharray")}),"\xa0 \xa0",Object($t.jsx)(yT,{value:this.props.arrows,onChange:this.change("arrows")})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Width:"," ",Object($t.jsx)(_T,{value:this.props.strokeWidth,placeholder:2,onChange:this.change("strokeWidth")})]})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),AT=createReactClass({displayName:"MovablePointEditor",getDefaultProps:function(){return{startX:"0",startY:"0",constraint:"none",snap:.5,constraintFn:"0",constraintXMin:"-10",constraintXMax:"10",constraintYMin:"-10",constraintYMax:"10"}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.startX,onChange:this.change("startX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.startY,onChange:this.change("startY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Update ",Object($t.jsx)(TT,{children:"(x_n, y_n)"})," for ",Object($t.jsx)(TT,{children:"n ="})," ",Object($t.jsx)(_T,{value:this.props.varSubscript,placeholder:0,onChange:this.change("varSubscript")})]}),Object($t.jsx)(wT,{...this.props})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),RT=createReactClass({displayName:"MovableLineEditor",getDefaultProps:function(){return{startX:"-5",startY:"5",endX:"5",endY:"5",constraint:"none",snap:.5,constraintFn:"0",constraintXMin:"-10",constraintXMax:"10",constraintYMin:"-10",constraintYMax:"10"}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:["Initial position:",Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.startX,onChange:this.change("startX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.startY,onChange:this.change("startY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["End: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.endX,onChange:this.change("endX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.endY,onChange:this.change("endY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Start updates ",Object($t.jsx)(TT,{children:"(x_n, y_n)"})," for ",Object($t.jsx)(TT,{children:"n ="}),Object($t.jsx)(_T,{value:this.props.startSubscript,placeholder:0,onChange:this.change("startSubscript")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["End updates ",Object($t.jsx)(TT,{children:"(x_m, y_m)"})," for ",Object($t.jsx)(TT,{children:"m ="}),Object($t.jsx)(_T,{value:this.props.endSubscript,placeholder:0,onChange:this.change("endSubscript")})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:"All constraints are applied to the start point."}),Object($t.jsx)(wT,{...this.props})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),DT=createReactClass({displayName:"FunctionEditor",getDefaultProps:function(){return{value:"x",rangeMin:"-10",rangeMax:"10",color:NT.BLUE,strokeDasharray:"",strokeWidth:2}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(TT,{children:this.props.funcName+"(x)="})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.value,onChange:this.change("value")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Range: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMin,onChange:this.change("rangeMin")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMax,onChange:this.change("rangeMax")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(jT,{value:this.props.color,onChange:this.change("color")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(OT,{value:this.props.strokeDasharray,onChange:this.change("strokeDasharray")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Width:"," ",Object($t.jsx)(_T,{value:this.props.strokeWidth,placeholder:2,onChange:this.change("strokeWidth")})]})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),FT=createReactClass({displayName:"ParametricEditor",getDefaultProps:function(){return{x:"cos(t)",y:"sin(t)",rangeMin:"0",rangeMax:"2\\pi",color:NT.BLUE,strokeDasharray:"",strokeWidth:2}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(TT,{children:"X(t) ="})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.x,onChange:this.change("x")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(TT,{children:"Y(t) ="})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.y,onChange:this.change("y")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Range: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMin,onChange:this.change("rangeMin")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.rangeMax,onChange:this.change("rangeMax")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(jT,{value:this.props.color,onChange:this.change("color")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(OT,{value:this.props.strokeDasharray,onChange:this.change("strokeDasharray")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("div",{className:"perseus-widget-left-col",children:["Width:"," ",Object($t.jsx)(_T,{value:this.props.strokeWidth,placeholder:2,onChange:this.change("strokeWidth")})]})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),LT=createReactClass({displayName:"LabelEditor",getDefaultProps:function(){return{coordX:"0",coordY:"0",color:NT.BLACK,label:"\\phi"}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(MT,{value:this.props.label,onChange:this.change("label"),style:{width:"100%"}})}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Location: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordX,onChange:this.change("coordX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordY,onChange:this.change("coordY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(jT,{value:this.props.color,onChange:this.change("color")})})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),zT=createReactClass({displayName:"RectangleEditor",getDefaultProps:function(){return{coordX:"-5",coordY:"5",width:"2",height:"3",color:NT.LIGHT_BLUE}},render:function(){return Object($t.jsxs)("div",{className:"graph-settings",children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Bottom left: ",Object($t.jsx)(TT,{children:"\\Large("}),Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordX,onChange:this.change("coordX")}),Object($t.jsx)(TT,{children:","})," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.coordY,onChange:this.change("coordY")}),Object($t.jsx)(TT,{children:"\\Large)"})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Width:"," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.width,onChange:this.change("width")})]}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:["Height:"," ",Object($t.jsx)(kT,{buttonSets:[],buttonsVisible:"never",value:this.props.height,onChange:this.change("height")})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(jT,{value:this.props.color,lightColors:!0,onChange:this.change("color")})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:"You want a border? Sorry, draw your own."})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},serialize(){return xT.serialize.call(this)}}),qT=createReactClass({displayName:"InteractionEditor",getDefaultProps:function(){return PT},getInitialState:function(){return{usedVarSubscripts:this._getAllVarSubscripts(this.props.elements),usedFunctionNames:this._getAllFunctionNames(this.props.elements)}},componentWillReceiveProps:function(e){this.setState({usedVarSubscripts:this._getAllVarSubscripts(e.elements),usedFunctionNames:this._getAllFunctionNames(e.elements)})},_getAllVarSubscripts:function(e){return bT.map(bT.where(e,{type:"movable-point"}),(e=>e.options.varSubscript)).concat(bT.map(bT.where(e,{type:"movable-line"}),(e=>e.options.startSubscript))).concat(bT.map(bT.where(e,{type:"movable-line"}),(e=>e.options.endSubscript)))},_getAllFunctionNames:function(e){return bT.map(bT.where(e,{type:"function"}),(e=>e.options.funcName))},_updateGraphProps:function(e){this.change({graph:bT.extend(bT.omit(e,"step"),{tickStep:e.step})})},_addNewElement:function(e){var t=e.target.value;if(""!==t){e.target.value="";var n,s={type:t,key:t+"-"+(16777215*Math.random()<<0).toString(16),options:"point"===t?bT.clone(IT.defaultProps):"line"===t?bT.clone(ET.defaultProps):"movable-point"===t?bT.clone(AT.defaultProps):"movable-line"===t?bT.clone(RT.defaultProps):"function"===t?bT.clone(DT.defaultProps):"parametric"===t?bT.clone(FT.defaultProps):"label"===t?bT.clone(LT.defaultProps):"rectangle"===t?bT.clone(zT.defaultProps):{}};if("movable-point"===t)n=bT.max([bT.max(this.state.usedVarSubscripts),-1])+1,s.options.varSubscript=n;else if("movable-line"===t)n=bT.max([bT.max(this.state.usedVarSubscripts),-1])+1,s.options.startSubscript=n,s.options.endSubscript=n+1;else if("function"===t){var i=String.fromCharCode(bT.max([bT.max(bT.map(this.state.usedFunctionNames,(function(e){return e.charCodeAt(0)}))),"e".charCodeAt(0)])+1);s.options.funcName=i}this.change({elements:this.props.elements.concat(s)})}},_deleteElement:function(e){var t=this.props.elements[e];this.change({elements:bT.without(this.props.elements,t)})},_moveElementUp:function(e){var t=this.props.elements[e],n=bT.without(this.props.elements,t);n.splice(e-1,0,t),this.change({elements:n})},_moveElementDown:function(e){var t=this.props.elements[e],n=bT.without(this.props.elements,t);n.splice(e+1,0,t),this.change({elements:n})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return vT.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-interaction-editor",children:[Object($t.jsxs)(CT,{title:"Grid settings",children:[Object($t.jsx)(ST,{editableSettings:["canvas","graph"],box:this.props.graph.box,labels:this.props.graph.labels,range:this.props.graph.range,step:this.props.graph.tickStep,gridStep:this.props.graph.gridStep,markings:this.props.graph.markings,onChange:this._updateGraphProps}),!0!==this.props.graph.valid&&Object($t.jsx)("div",{children:this.props.graph.valid})]}),bT.map(this.props.elements,(function(e,t){return"movable-point"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Movable point"," ",Object($t.jsx)(TT,{children:"(x_{"+e.options.varSubscript+"}, y_{"+e.options.varSubscript+"})"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(AT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"movable-line"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Movable line"," ",Object($t.jsx)(TT,{children:"(x_{"+e.options.startSubscript+"}, y_{"+e.options.startSubscript+"})"})," ","to"," ",Object($t.jsx)(TT,{children:"(x_{"+e.options.endSubscript+"}, y_{"+e.options.endSubscript+"})"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(RT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"point"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Point"," ",Object($t.jsx)(TT,{children:"("+e.options.coordX+", "+e.options.coordY+")"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(IT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"line"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Line"," ",Object($t.jsx)(TT,{children:"("+e.options.startX+", "+e.options.startY+")"})," ","to"," ",Object($t.jsx)(TT,{children:"("+e.options.endX+", "+e.options.endY+")"})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement.bind(this,t),children:Object($t.jsx)(ET,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"function"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Function"," ",Object($t.jsx)(TT,{children:e.options.funcName+"(x) = "+e.options.value})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(DT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"parametric"===e.type?Object($t.jsx)(CT,{title:Object($t.jsx)("span",{children:"Parametric"}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(FT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"label"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Label"," ",Object($t.jsx)(TT,{children:e.options.label})," "]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(LT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):"rectangle"===e.type?Object($t.jsx)(CT,{title:Object($t.jsxs)("span",{children:["Rectangle"," ",Object($t.jsx)(TT,{children:"("+e.options.coordX+", "+e.options.coordY+")"}),"\xa0\u2014\xa0",Object($t.jsx)(TT,{children:e.options.width+" \\times "+e.options.height})]}),onUp:0===t?null:this._moveElementUp.bind(this,t),onDown:t===this.props.elements.length-1?null:this._moveElementDown.bind(this,t),onDelete:this._deleteElement,children:Object($t.jsx)(zT,{...e.options,onChange:e=>{var n=JSON.parse(JSON.stringify(this.props.elements));bT.extend(n[t].options,e),this.change({elements:n})}})},e.key):void 0}),this),Object($t.jsx)("div",{className:"perseus-widget-interaction-editor-select-element",children:Object($t.jsxs)("select",{onChange:this._addNewElement,children:[Object($t.jsxs)("option",{value:"",children:["Add an element","\u2026"]}),Object($t.jsx)("option",{disabled:!0,children:"--"}),Object($t.jsx)("option",{value:"point",children:"Point"}),Object($t.jsx)("option",{value:"line",children:"Line segment"}),Object($t.jsx)("option",{value:"function",children:"Function plot"}),Object($t.jsx)("option",{value:"parametric",children:"Parametric plot"}),Object($t.jsx)("option",{value:"label",children:"Label"}),Object($t.jsx)("option",{value:"rectangle",children:"Rectangle"}),Object($t.jsx)("option",{value:"movable-point",children:"\u2605 Movable point"}),Object($t.jsx)("option",{value:"movable-line",children:"\u2605 Movable line segment"})]})})]})},serialize(){return xT.serialize.call(this)}});mT.exports=qT;var WT=mT.exports,BT={exports:{}},VT=(BT.exports,h.a,x.b),HT=hu,UT=sc,GT=UT.Label,$T=UT.Line,YT=UT.MovablePoint,KT=UT.MovableLine,XT=UT.Plot,ZT=UT.PlotParametric,JT=UT.Point,QT=UT.Rect,eM=G.a.vector,tM=(e,t)=>{for(var n=e+"||"+(t=t||{}).decimal_separatpr+"||",s=t.functions,i=s?s.length:0,r=0;r<i;r++)n+=s[r]+"|";return n},nM=Object.create(null),sM=(e,t)=>{var n=tM(e,t),s=nM[n];return s||(s=U.parse(e,t),nM[n]=s,s)},iM=Object.create(null),rM=(e,t)=>{var n=tM(e,t),s=iM[n];if(s)return s;var i=U.parse(e,t).expr;return s=i?i.compile():function(){return 0},iM[n]=s,s},oM={graph:{box:[400,400],labels:["x","y"],range:[[-10,10],[-10,10]],tickStep:[1,1],gridStep:[1,1],markings:"graph"},elements:[]},aM=createReactClass({displayName:"Interaction",getDefaultProps:function(){return oM},getInitialState:function(){return{variables:this._getInitialVariables(this.props.elements),functions:this._getInitialFunctions(this.props.elements)}},_getInitialVariables:function(e){var t={};return VT.each(VT.where(e,{type:"movable-point"}),(function(e){var n=e.options.varSubscript,s=sM(e.options.startX||"0").expr,i=sM(e.options.startY||"0").expr,r=0,o=0;s&&(r=s.eval({})||0),i&&(o=i.eval({})||0),t["x_"+n]=r,t["y_"+n]=o}),this),VT.each(VT.where(e,{type:"movable-line"}),(function(e){var n=e.options.startSubscript,s=e.options.endSubscript,i=sM(e.options.startX||"0").expr,r=sM(e.options.startY||"0").expr,o=sM(e.options.endX||"0").expr,a=sM(e.options.endY||"0").expr,l=0,c=0,h=0,p=0;i&&(l=i.eval({})||0),r&&(c=r.eval({})||0),o&&(h=o.eval({})||0),a&&(p=a.eval({})||0),t["x_"+n]=l,t["y_"+n]=c,t["x_"+s]=h,t["y_"+s]=p}),this),VT.each(VT.where(e,{type:"function"}),(function(e){t[e.options.funcName]=e.options.value})),t},_getInitialFunctions:function(e){return VT.map(VT.where(e,{type:"function"}),(e=>e.options.funcName))},componentWillReceiveProps:function(e){this.setState({variables:this._getInitialVariables(e.elements),functions:this._getInitialFunctions(e.elements)})},_setupGraphie:function(e,t){if(e.graphInit(VT.extend({},t,{grid:VT.contains(["graph","grid"],this.props.graph.markings),axes:VT.contains(["graph"],this.props.graph.markings),ticks:VT.contains(["graph"],this.props.graph.markings),labels:VT.contains(["graph"],this.props.graph.markings),labelFormat:function(e){return"\\small{"+e+"}"},axisArrows:"<->",unityLabels:!1})),"graph"===this.props.graph.markings){var n=this.props.graph.labels,s=this.props.graph.range;e.label([0,s[1][1]],n[1],"above"),e.label([s[0][1],0],n[0],"right")}},_updatePointLocation:function(e,t){var n=VT.clone(this.state.variables);n["x_"+e]=t[0],n["y_"+e]=t[1],this.setState({variables:n}),this.props.trackInteraction()},_updateLineLocation:function(e,t){var n=this._eval("("+e.endX+")-("+e.startX+")"),s=this._eval("("+e.endY+")-("+e.startY+")"),i=eM.add(t,[n,s]),r=VT.clone(this.state.variables);r["x_"+e.startSubscript]=t[0],r["y_"+e.startSubscript]=t[1],r["x_"+e.endSubscript]=i[0],r["y_"+e.endSubscript]=i[1],this.setState({variables:r}),this.props.trackInteraction()},_eval:function(e,t){var n=rM(e,{functions:this.state.functions}),s=VT.extend({},this.state.variables,t);return VT.each(VT.keys(s),(e=>{if(VT.isString(s[e])){var t=rM(s[e],{functions:this.state.functions});s[e]=function(e){return t(VT.extend({},s,{x:e}))}}})),n(s)||0},_extractVars:function(e){if(null==e)return[];var t=[];return VT.each(e.args(),(function(e){e&&"Expr"===e.constructor.name&&(t=t.concat(this._extractVars(e)))}),this),"Var"===e.name()&&t.push(e.prettyPrint()),t},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return HT.change.apply(this,t)},render:function(){return Object($t.jsx)(UT,{box:this.props.graph.box,range:this.props.graph.range,options:this.props.graph,setup:this._setupGraphie,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,children:VT.map(this.props.elements,(function(e,t){if("point"===e.type)return Object($t.jsx)(JT,{coord:[this._eval(e.options.coordX),this._eval(e.options.coordY)],color:e.options.color},e.key);if("line"===e.type){var n=[this._eval(e.options.startX),this._eval(e.options.startY)],s=[this._eval(e.options.endX),this._eval(e.options.endY)];return Object($t.jsx)($T,{start:n,end:s,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,arrows:e.options.arrows}},e.key)}if("movable-point"===e.type){var i=[t=>[Math.max(this._eval(e.options.constraintXMin),Math.min(this._eval(e.options.constraintXMax),t[0])),Math.max(this._eval(e.options.constraintYMin),Math.min(this._eval(e.options.constraintYMax),t[1]))]];return"snap"===e.options.constraint?i.push(YT.constraints.snap(e.options.snap)):"x"===e.options.constraint?i.push((t=>[this._eval(e.options.constraintFn,{y:t[1]}),t[1]])):"y"===e.options.constraint&&i.push((t=>[t[0],this._eval(e.options.constraintFn,{x:t[0]})])),Object($t.jsx)(YT,{coord:[this.state.variables["x_"+e.options.varSubscript],this.state.variables["y_"+e.options.varSubscript]],constraints:i,foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap,onMove:VT.partial(this._updatePointLocation,e.options.varSubscript)},e.key)}if("movable-line"===e.type){i=[t=>[Math.max(this._eval(e.options.constraintXMin),Math.min(this._eval(e.options.constraintXMax),t[0])),Math.max(this._eval(e.options.constraintYMin),Math.min(this._eval(e.options.constraintYMax),t[1]))]];"snap"===e.options.constraint?i.push(YT.constraints.snap(e.options.snap)):"x"===e.options.constraint?i.push((t=>[this._eval(e.options.constraintFn,{y:t[1]}),t[1]])):"y"===e.options.constraint&&i.push((t=>[t[0],this._eval(e.options.constraintFn,{x:t[0]})]));n=[this.state.variables["x_"+e.options.startSubscript],this.state.variables["y_"+e.options.startSubscript]],s=[this.state.variables["x_"+e.options.endSubscript],this.state.variables["y_"+e.options.endSubscript]];return Object($t.jsxs)(KT,{constraints:i,onMove:VT.bind(this._updateLineLocation,this,e.options),foo_x:e.options.constraint,foo_y:e.options.constraintFn,foo_z:e.options.snap,children:[Object($t.jsx)(YT,{coord:n,static:!0,normalStyle:{stroke:"none",fill:"none"}}),Object($t.jsx)(YT,{coord:s,static:!0,normalStyle:{stroke:"none",fill:"none"}})]},e.key)}if("function"===e.type){var r=t=>this._eval(e.options.value,{x:t}),o=VT.without(this._extractVars(sM(e.options.value).expr),"x"),a=VT.object(o,VT.map(o,(e=>this.state.variables[e]))),l=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return Object($t.jsx)(XT,{fn:r,foo_fn:e.options.value,foo_varvalues:a,range:l,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}},e.key)}if("parametric"===e.type){r=t=>[this._eval(e.options.x,{t:t}),this._eval(e.options.y,{t:t})],o=VT.without(this._extractVars(sM(e.options.x).expr).concat(this._extractVars(sM(e.options.y).expr)),"t"),a=VT.object(o,VT.map(o,(e=>this.state.variables[e]))),l=[this._eval(e.options.rangeMin,this.state.variables),this._eval(e.options.rangeMax,this.state.variables)];return Object($t.jsx)(ZT,{fn:r,foo_fnx:e.options.x,foo_fny:e.options.y,foo_varvalues:a,range:l,style:{stroke:e.options.color,strokeWidth:e.options.strokeWidth,strokeDasharray:e.options.strokeDasharray,plotPoints:100}},e.key)}if("label"===e.type){var c=[this._eval(e.options.coordX),this._eval(e.options.coordY)];return Object($t.jsx)(GT,{coord:c,text:e.options.label,style:{color:e.options.color}},t+1)}return"rectangle"===e.type?Object($t.jsx)(QT,{x:this._eval(e.options.coordX),y:this._eval(e.options.coordY),width:VT.max([this._eval(e.options.width),0]),height:VT.max([this._eval(e.options.height),0]),style:{stroke:"none",fill:e.options.color}},t+1):void 0}),this)})},getUserInput:function(){return{}},simpleValidate:function(e){return aM.validate(this.getUserInput(),e)}});VT.extend(aM,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),BT.exports={name:"interaction",displayName:"Interaction",widget:aM,transform:VT.identity,hidden:!0};var lM=BT.exports,cM={exports:{}};cM.exports;h.a;const hM=x.b,pM=ce,uM=hu,dM=iu,gM=Ju.a,fM=sv,mM=sd,bM=Kt,vM=Df,xM=[0,10],yM={url:null,width:0,height:0},jM=new RegExp("^(https?|web\\+graphie)://[^/]*(ka-.*.s3.amazonaws.com|(fastly|cdn).kastatic.org|khanacademy.org|kasandbox.org)");var wM=["center","above","above right","right","below right","below","below left","left","above left"];const OM=createReactClass({displayName:"ImageEditor",componentDidMount:function(){hM.defer((()=>{var e=this.props.backgroundImage.url;this.onUrlChange(e,!0)}))},getDefaultProps:function(){return{title:"",range:[xM,xM],box:[400,400],backgroundImage:yM,labels:[],alt:"",caption:""}},getInitialState:function(){return{backgroundImageError:""}},render:function(){var e=this.props.backgroundImage,t=Object($t.jsxs)("div",{className:"image-settings",children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[Object($t.jsxs)("div",{children:["Alt text:",Object($t.jsx)(mM,{children:"This is important for screenreaders. The content of this alt text will be formatted as markdown (tables, emphasis, etc. are supported)."})]}),Object($t.jsx)(fM,{apiOptions:this.props.apiOptions,content:this.props.alt,onChange:e=>{null!=e.content&&this.change("alt",e.content)},widgetEnabled:!1})]})}),Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:[Object($t.jsx)("div",{children:"Caption:"}),Object($t.jsx)(fM,{apiOptions:this.props.apiOptions,content:this.props.caption,onChange:e=>{null!=e.content&&this.change("caption",e.content)},widgetEnabled:!1})]})})]}),n=Object($t.jsx)("div",{className:"renderer-widget-error",children:this.state.backgroundImageError});return Object($t.jsxs)("div",{className:"perseus-image-editor",children:[Object($t.jsxs)("label",{children:["Image url:",Object($t.jsx)(mM,{children:"Paste an image or graphie image URL."}),this.state.backgroundImageError&&n,Object($t.jsx)(gM,{value:e.url||"",style:{width:332},onChange:e=>this.onUrlChange(e,!1)})]}),e.url&&t]})},_renderRowForLabel:function(e,t){return Object($t.jsxs)("tr",{children:[Object($t.jsx)("td",{children:Object($t.jsx)(vM,{value:e.coordinates,onChange:this.onCoordinateChange.bind(this,t)})}),Object($t.jsx)("td",{style:{verticalAlign:"bottom",width:"5px"},children:Object($t.jsx)("input",{type:"text",className:"graph-settings-axis-label",value:e.content,onChange:this.onContentChange.bind(this,t)})}),Object($t.jsx)("td",{children:Object($t.jsx)("select",{className:"perseus-widget-dropdown",value:e.alignment,onChange:this.onAlignmentChange.bind(this,t),children:wM.map((function(e,t){return Object($t.jsx)("option",{value:e,children:e},""+t)}),this)})}),Object($t.jsx)("td",{children:Object($t.jsx)("a",{href:"#",className:"simple-button orange delete-label",title:"Remove this label",onClick:this.removeLabel.bind(this,t),children:Object($t.jsx)(bM,{...ya})})})]},t)},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return uM.change.apply(this,t)},removeLabel:function(e,t){t.preventDefault();var n=hM.clone(this.props.labels);n.splice(e,1),this.props.onChange({labels:n})},onCoordinateChange:function(e,t){var n=this.props.labels.slice();n[e]=hM.extend({},n[e],{coordinates:t}),this.props.onChange({labels:n})},onContentChange:function(e,t){var n=t.target.value,s=this.props.labels.slice();s[e]=hM.extend({},s[e],{content:n}),this.props.onChange({labels:s})},onAlignmentChange:function(e,t){var n=t.target.value,s=this.props.labels.slice();s[e]=hM.extend({},s[e],{alignment:n}),this.props.onChange({labels:s})},setUrl:function(e,t,n,s){if(this.isMounted()){var i=hM.clone(this.props.backgroundImage);i.url=e,i.width=t,i.height=n;var r=[i.width,i.height];this.props.onChange({backgroundImage:i,box:r},null,s)}},onUrlChange:function(e,t){jM.test(e)?(this.setState({backgroundImageError:""}),this._leadingUrl=e,e?pM.getImageSize(e,((t,n)=>{this._leadingUrl===e&&this.setUrl(e,t,n,!0)})):this.setUrl(e,0,0,t)):this.setState({backgroundImageError:"Images must be from sites hosted by Khan Academy. Please input a Khan Academy-owned address, or use the Add Image tool to rehost an existing image"})},onRangeChange:function(e,t){var n=this.props.range.slice();n[e]=t,this.props.onChange({range:n})},serialize(){return dM.serialize.call(this)}});cM.exports=OM;var CM=cM.exports,SM={exports:{}},kM=(SM.exports,v.a),_M=(h.a,x.b),TM=hu;const MM=ch;var NM=ah,PM=Sc,IM=[0,10],EM={url:null,width:0,height:0};const AM="block";var RM=createReactClass({displayName:"ImageWidget",statics:{styles:On.StyleSheet.create({caption:{display:"inline-block",marginTop:bn,maxWidth:640,[MM.lgOrSmaller]:{maxWidth:540},[MM.smOrSmaller]:{maxWidth:450}}})},getDefaultProps:function(){return{alignment:AM,title:"",range:[IM,IM],box:[400,400],backgroundImage:EM,labels:[],alt:"",caption:"",linterContext:je}},render:function(){var e,t,n,s,{apiOptions:i}=this.props,r=this.props.backgroundImage;if(r.url&&(e=Object($t.jsx)(PM,{src:r.url,alt:this.props.alt?"":void 0,width:r.width,height:r.height,preloader:i.imagePreloader,extraGraphie:{box:this.props.box,range:this.props.range,labels:this.props.labels},trackInteraction:this.props.trackInteraction,zoomToFullSizeOnMobile:i.isMobile,constrainHeight:i.isMobile,allowFullBleed:i.isMobile})),this.props.alt&&(t=Object($t.jsx)("span",{className:"perseus-sr-only",children:Object($t.jsx)(NM,{content:this.props.alt,apiOptions:i,linterContext:this.props.linterContext})})),i.isMobile){var o;if(this.props.title||this.props.caption){let e=this.props.title;e&&(this.props.caption&&!/[.?!"']\s*$/.test(e)&&(e+="."),e=`**${e}** `);const t=kM({"perseus-image-caption":!0,"has-title":!!e}),n=this.props.alignment,s="block"===n||"full-width"===n?null:"0 !important";o=Object($t.jsx)("div",{className:t,children:Object($t.jsx)("div",{className:Object(On.css)(RM.styles.caption),style:{minWidth:s},children:Object($t.jsx)(NM,{content:e+this.props.caption,apiOptions:i,linterContext:this.props.linterContext})})})}return Object($t.jsxs)("div",{className:"perseus-image-widget",children:[e,t,o]})}return this.props.title&&(n=Object($t.jsx)("div",{className:"perseus-image-title",children:Object($t.jsx)(NM,{content:this.props.title,apiOptions:i,linterContext:this.props.linterContext})})),this.props.caption&&(s=Object($t.jsx)("div",{className:"perseus-image-caption",children:Object($t.jsx)(NM,{content:this.props.caption,apiOptions:i,linterContext:this.props.linterContext})})),Object($t.jsxs)("div",{className:"perseus-image-widget",children:[n,e,t,s]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return TM.change.apply(this,t)},getUserInput:function(){return null},simpleValidate:function(e){return RM.validate(this.getUserInput(),e)},focus:$.noop});_M.extend(RM,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),SM.exports={name:"image",accessible:e=>{var t=e.backgroundImage;return!(t&&t.url&&!e.alt)},defaultAlignment:AM,supportedAlignments:["block","full-width"],displayName:"Image",widget:RM,isLintable:!0};var DM=SM.exports,FM={exports:{}};FM.exports;h.a;const LM=x.b,zM=hu,qM=iu,WM=Ju.a,BM=Pf,VM=createReactClass({displayName:"PairEditor",getDefaultProps:function(){return{name:"",value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return zM.change.apply(this,t)},render:function(){return Object($t.jsxs)("fieldset",{children:[Object($t.jsxs)("label",{children:["Name:",Object($t.jsx)(WM,{value:this.props.name,onChange:this.change("name")})]}),Object($t.jsxs)("label",{children:["Value:",Object($t.jsx)(WM,{value:this.props.value,onChange:this.change("value")})]})]})},serialize(){return qM.serialize.call(this)}});var HM=createReactClass({displayName:"PairsEditor",render:function(){var e=LM.map(this.props.pairs,((e,t)=>Object($t.jsx)(VM,{name:e.name,value:e.value,onChange:this.handlePairChange.bind(this,t)},t)));return Object($t.jsx)("div",{children:e})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return zM.change.apply(this,t)},handlePairChange:function(e,t){var n=this.props.pairs.slice();n[e]=t;var s=n[n.length-1];s.name&&s.value&&n.push({name:"",value:""}),this.change("pairs",n)},serialize(){return qM.serialize.call(this)}}),UM=createReactClass({displayName:"IframeEditor",getDefaultProps:function(){return{url:"",settings:[{name:"",value:""}],width:"400",height:"400",allowFullScreen:!1,allowTopNavigation:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return zM.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{style:{fontWeight:"bold",textAlign:"center"},children:["This widget is deprecated! ",Object($t.jsx)("br",{}),"Try using the Video or CS Program widgets instead."]}),Object($t.jsxs)("label",{children:["Url or Program ID:",Object($t.jsx)(WM,{name:"url",value:this.props.url,onChange:this.change("url")})]}),Object($t.jsx)("br",{}),Object($t.jsxs)("label",{children:["Settings:",Object($t.jsx)(HM,{name:"settings",pairs:this.props.settings,onChange:this.handleSettingsChange})]}),Object($t.jsx)("br",{}),Object($t.jsxs)("label",{children:["Width:",Object($t.jsx)(WM,{name:"width",value:this.props.width,onChange:this.change("width")})]}),Object($t.jsxs)("label",{children:["Height:",Object($t.jsx)(WM,{name:"height",value:this.props.height,onChange:this.change("height")})]}),Object($t.jsx)(BM,{label:"Allow full screen",allowFullScreen:this.props.allowFullScreen,onChange:this.props.onChange}),Object($t.jsx)("br",{}),Object($t.jsx)(BM,{label:"Allow iframe content to redirect the page",allowTopNavigation:this.props.allowTopNavigation,onChange:this.props.onChange})]})},handleSettingsChange:function(e){this.change({settings:e.pairs})},serialize(){return qM.serialize.call(this)}});FM.exports=UM;var GM=FM.exports,$M={exports:{}},YM=($M.exports,h.a,x.b),KM=hu,XM=Du,ZM=ce.updateQueryString,JM=createReactClass({displayName:"Iframe",getDefaultProps:function(){return{status:"incomplete",message:null,allowFullScreen:!1,allowTopNavigation:!1}},getUserInput:function(){return XM.getUserInput.call(this)},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(s){return}if(!YM.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){$(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){$(window).off("message",this.handleMessageEvent)},render:function(){var e={width:this.props.width,height:this.props.height},t=this.props.url;if(t&&t.length&&0!==t.indexOf("http")&&(t=ZM(t="https://www.khanacademy.org/computer-programming/program/"+t+"/embedded?buttons=no&embed=yes&editor=no&author=no","width",this.props.width),t=ZM(t,"height",this.props.height),t=ZM(t,"origin",window.location.origin)),"undefined"!==typeof KA&&KA.isZeroRated&&(t.match(/https?:\/\/[^\/]*khanacademy.org/)?t.match(/zero.khanacademy.org/)||(t=t.replace("khanacademy.org","zero.khanacademy.org")):t="/zero/external-link?context=iframe&url="+encodeURIComponent(t)),this.props.settings){var n={};YM.each(this.props.settings,(function(e){e.name&&e.value&&(n[e.name]=e.value)})),t=ZM(t,"settings",JSON.stringify(n))}let s="allow-same-origin allow-scripts";return s+=" allow-top-navigation",Object($t.jsx)("iframe",{sandbox:"allow-same-origin allow-scripts allow-top-navigation",style:e,src:t,allowFullScreen:this.props.allowFullScreen})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return KM.change.apply(this,t)},simpleValidate:function(e){return JM.validate(this.getUserInput(),e)}});YM.extend(JM,{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}),$M.exports={name:"iframe",displayName:"Iframe",widget:JM,hidden:!0};var QM=$M.exports,eN={exports:{}};eN.exports;h.a;const tN=x.b,nN=hu,sN=sv,iN=createReactClass({displayName:"GroupEditor",getDefaultProps:function(){return{content:"",widgets:{},images:{},metadata:void 0}},render:function(){return Object($t.jsxs)("div",{className:"perseus-group-editor",children:[Object($t.jsx)("div",{children:this._renderMetadataEditor()}),Object($t.jsx)(sN,{ref:"editor",content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange})]})},_renderMetadataEditor:function(){var e=this.props.apiOptions.GroupMetadataEditor;return Object($t.jsx)(e,{value:this.props.metadata,onChange:this.change("metadata")})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return nN.change.apply(this,t)},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return tN.extend({},this.refs.editor.serialize(),{metadata:this.props.metadata})}});eN.exports=iN;var rN=eN.exports,oN={exports:{}},aN=(oN.exports,v.a),lN=(h.a,x.b),cN=Ss.Options,hN=hu,pN=ah,uN=createReactClass({displayName:"Group",getDefaultProps:function(){return{content:"",widgets:{},images:{},icon:null,linterContext:je}},componentDidMount:function(){this.forceUpdate()},render:function(){var e=lN.extend({},cN.defaults,this.props.apiOptions,{onFocusChange:(e,t)=>{t&&this.props.onBlur(t),e&&this.props.onFocus(e)}}),t=lN.indexOf(this.props.findWidgets("group"),this),n=this.props.apiOptions.groupAnnotator(t,this.props.widgetId),s=this.refs.renderer&&this.refs.renderer.score(),i=s&&"invalid"!==s.type,r=s&&"invalid"===s.type;return Object($t.jsxs)("div",{className:aN({"perseus-group":!0,"perseus-group-valid-answer":i,"perseus-group-invalid-answer":r}),children:[n,Object($t.jsx)(pN,{...this.props,ref:"renderer",apiOptions:e,findExternalWidgets:this.props.findWidgets,reviewMode:!!this.props.reviewModeRubric,onInteractWithWidget:e=>{this.refs.renderer&&this.change("widgets",this.refs.renderer.props.widgets)},linterContext:this.props.linterContext}),this.props.icon&&Object($t.jsx)("div",{className:"group-icon",children:this.props.icon})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hN.change.apply(this,t)},getUserInput:function(){return this.refs.renderer.getUserInput()},getSerializedState:function(){return this.refs.renderer.getSerializedState()},restoreSerializedState:function(e,t){return this.refs.renderer.restoreSerializedState(e,t),null},simpleValidate:function(e){return this.refs.renderer.score()},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},getRenderer:function(){return this.refs.renderer},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},showRationalesForCurrentlySelectedChoices(){this.refs.renderer.showRationalesForCurrentlySelectedChoices()}});oN.exports={name:"group",displayName:"Group (SAT only)",widget:uN,traverseChildWidgets:function(e,t){return lN.extend({},e,t(e))},hidden:!1,isLintable:!0};var dN=oN.exports,gN={exports:{}};gN.exports;h.a,x.b;const fN=hu,mN=sv,bN=Bx,vN=Kt,xN=createReactClass({displayName:"GradedGroupEditor",getDefaultProps:function(){return{title:"",content:"",widgets:{},images:{},hint:null}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return fN.change.apply(this,t)},handleAddHint:function(){this.props.onChange({hint:{content:""}},(()=>{this.refs["hint-editor"].focus()}))},handleRemoveHint:function(e){this.props.onChange({hint:null})},render:function(){return Object($t.jsxs)("div",{className:"perseus-group-editor",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{className:Object(On.css)(yN.title),children:["Title:"," ",Object($t.jsx)(bN,{value:this.props.title,className:Object(On.css)(yN.input),onChange:this.change("title")})]})}),Object($t.jsx)(mN,{ref:"editor",content:this.props.content,widgets:this.props.widgets,apiOptions:this.props.apiOptions,images:this.props.images,widgetEnabled:!0,immutableWidgets:!1,onChange:this.props.onChange,warnNoPrompt:!0,warnNoWidgets:!0}),!this.props.hint&&Object($t.jsxs)("button",{type:"button",style:{marginTop:10},className:"add-hint simple-button orange",onClick:this.handleAddHint,children:[Object($t.jsx)(vN,{...fa})," Add a hint"]}),this.props.hint&&Object($t.jsxs)("div",{className:"perseus-hint-editor",children:[Object($t.jsx)("div",{className:Object(On.css)(yN.hintsTitle),children:"Hint"}),Object($t.jsx)(mN,{ref:"hint-editor",content:this.props.hint?this.props.hint.content:"",widgets:this.props.hint?this.props.hint.widgets:{},apiOptions:this.props.apiOptions,images:this.props.hint&&this.props.hint.images,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{this.change("hint",Object.assign({},this.props.hint,e))}}),Object($t.jsxs)("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.handleRemoveHint,children:[Object($t.jsx)(vN,{...ya})," Remove this hint"]})]})]})},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return{title:this.props.title,...this.refs.editor.serialize(),hint:this.refs["hint-editor"]&&this.refs["hint-editor"].serialize()}}}),yN=On.StyleSheet.create({title:{fontSize:18,fontWeight:"bold"},input:{fontSize:18},hintsTitle:{marginTop:10,fontSize:"110%",fontWeight:"bold"}});gN.exports=xN;var jN=gN.exports,wN={exports:{}};wN.exports;h.a,x.b;const ON=hu,CN=jN,SN=createReactClass({displayName:"GradedGroupSetEditor",getDefaultProps:()=>({gradedGroups:[]}),componentWillMount(){this._editors=[]},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ON.change.apply(this,t)},getSaveWarnings(){return[].concat(...this._editors.map((e=>e.getSaveWarnings())))},serialize(){return{gradedGroups:this.props.gradedGroups}},renderGroups(){return this.props.gradedGroups?this.props.gradedGroups.map(((e,t)=>Object($t.jsx)(CN,{ref:e=>this._editors[t]=e,...e,apiOptions:this.props.apiOptions,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>this.change("gradedGroups",kN(this.props.gradedGroups,t,{...this.props.gradedGroups[t],...e}))},t))):null},addGroup(){const e=this.props.gradedGroups||[];this.change("gradedGroups",e.concat([CN.getDefaultProps()]))},render(){return Object($t.jsxs)("div",{className:"perseus-group-editor",children:[this.renderGroups(),Object($t.jsx)("button",{onClick:this.addGroup,children:"Add group"})]})}}),kN=(e,t,n)=>[...e.slice(0,t),n,...e.slice(t+1)];wN.exports=SN;var _N=wN.exports,TN={exports:{}};TN.exports;h.a;const MN=Kt,NN={HIDDEN:Symbol("HIDDEN"),ACTIVE:Symbol("ACTIVE"),INACTIVE:Symbol("INACTIVE"),INCORRECT:Symbol("INCORRECT"),CORRECT:Symbol("CORRECT")},PN=createReactClass({displayName:"GradedGroupAnswerBar",render(){const{apiOptions:e,answerBarState:t,onCheckAnswer:n,onNextQuestion:s}=this.props,i={...IN.answerBar,backgroundColor:t===NN.CORRECT?nn:"white",justifyContent:t!==NN.CORRECT||s?"space-between":"center"},r={...IN.button,backgroundColor:t===NN.ACTIVE||t===NN.CORRECT?Jt:sn},o={...IN.text,color:t===NN.CORRECT?Jt:on},a=t===NN.INCORRECT?Object($t.jsxs)("span",{style:o,children:[Object($t.jsx)("span",{style:IN.tryAgainIcon,children:Object($t.jsx)(MN,{...va})}),Object($t.jsx)("span",{style:{marginLeft:8},children:i18n._("Keep trying")})]}):Object($t.jsx)("span",{});if(t!==NN.CORRECT){const s=t===NN.INCORRECT?i18n._("Try again"):i18n._("Check");return Object($t.jsxs)("div",{style:i,children:[a,Object($t.jsx)("button",{style:r,disabled:e.readOnly||t!==NN.ACTIVE,onClick:n,children:s})]})}return Object($t.jsxs)("div",{style:i,children:[Object($t.jsxs)("span",{style:o,children:[Object($t.jsx)("span",{style:{fontSize:28,color:"#FFB300"},children:Object($t.jsx)(MN,{...ba,style:{marginBottom:5}})}),Object($t.jsx)("span",{style:{marginLeft:8},children:i18n._("Correct!")})]}),s&&Object($t.jsx)("button",{style:r,onClick:s,children:i18n._("Next question")})]})}}),IN={answerBar:{display:"flex",alignItems:"center",height:68,marginLeft:mn,marginRight:mn,marginBottom:mn,marginTop:fn,paddingLeft:fn,paddingRight:10,borderTop:"1px solid #BABEC2"},button:{height:48,width:143,borderRadius:4,color:"white",fontFamily:Zt,fontSize:17,border:"none"},tryAgainIcon:{fontSize:28,color:"#63D9EA",transform:"scale(-1,1) rotate(-268deg)"},text:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:Zt,fontSize:17}};PN.ANSWER_BAR_STATES=NN,TN.exports=PN;var EN=TN.exports,AN={exports:{}};AN.exports;const RN=v.a,DN=(h.a,x.b),FN=Ss.Options,LN=hu,zN=Kt,qN=ah,WN=EN,BN="ungraded",VN="correct",HN="incorrect",UN="invalid",GN=WN.ANSWER_BAR_STATES,$N=(e,t)=>{switch(e){case GN.HIDDEN:return t?GN.ACTIVE:e;case GN.ACTIVE:return t?e:GN.INACTIVE;case GN.INACTIVE:return t?GN.ACTIVE:e;case GN.INCORRECT:return t?GN.ACTIVE:GN.INACTIVE;default:return e}},YN="We couldn't grade your answer.",KN=createReactClass({displayName:"GradedGroup",getDefaultProps:function(){return{title:"",content:"",widgets:{},images:{},hint:null,hasHint:!1,linterContext:je}},getInitialState:function(){return{status:BN,showHint:!1,message:"",answerBarState:GN.HIDDEN}},shouldComponentUpdate:function(e,t){return e!==this.props||t!==this.state},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return LN.change.apply(this,t)},_onInteractWithWidget:function(e){if(this.setState({status:BN,message:""}),this.refs.renderer){this.change("widgets",this.props.widgets);const e=0===this.refs.renderer.emptyWidgets().length,t=this.state.answerBarState;this.setState({answerBarState:$N(t,e)})}},_checkAnswer:function(){this.refs.renderer.showRationalesForCurrentlySelectedChoices();const e=this.refs.renderer.score();let t,n;"points"===e.type?(t=e.total===e.earned?VN:HN,n=e.message||""):(t=UN,n=e.message?`${YN} ${e.message}`:`${YN} It looks like you left something blank or entered in an invalid answer.`),this.setState({status:t,message:n,answerBarState:"correct"===t?GN.CORRECT:GN.INCORRECT}),this.props.trackInteraction({status:t})},getInputPaths:function(){return this.refs.renderer.getInputPaths()},setInputValue:function(e,t,n){return this.refs.renderer.setInputValue(e,t,n)},getAcceptableFormatsForInputPath:function(e){return this.refs.renderer.getAcceptableFormatsForInputPath(e)},focus:function(){return this.refs.renderer.focus()},focusInputPath:function(e){this.refs.renderer.focusPath(e)},blurInputPath:function(e){this.refs.renderer.blurPath(e)},render:function(){const e=DN.extend({},FN.defaults,this.props.apiOptions,{onFocusChange:(e,t)=>{t&&this.props.onBlur(t),e&&this.props.onFocus(e)}});let t=null;this.state.status===VN?t=Object($t.jsx)(zN,{...ga,style:{color:"#526f03"}}):this.state.status===HN&&(t=Object($t.jsx)(zN,{...ma,style:{color:"#ff5454"}}));const n=this.props.inGradedGroupSet?Object(On.css)(XN.gradedGroupInSet):Object(On.css)(XN.gradedGroup),s=RN({[n]:e.isMobile,"perseus-graded-group":!0,"answer-correct":!e.isMobile&&this.state.status===VN,"answer-incorrect":!e.isMobile&&this.state.status===HN}),{answerBarState:i}=this.state,r=i===GN.CORRECT,o=e.readOnly||e.isMobile&&r;return Object($t.jsxs)("div",{className:s,children:[!!this.props.title&&Object($t.jsx)("div",{className:Object(On.css)(XN.title),children:this.props.title}),Object($t.jsx)(qN,{...this.props,ref:"renderer",apiOptions:{...e,readOnly:o},onInteractWithWidget:this._onInteractWithWidget,linterContext:this.props.linterContext}),!e.isMobile&&t&&Object($t.jsx)("div",{className:"group-icon",children:t}),!e.isMobile&&Object($t.jsx)("p",{children:this.state.message}),!e.isMobile&&Object($t.jsx)("input",{type:"button",value:i18n._("Check"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this._checkAnswer}),!e.isMobile&&r&&this.props.onNextQuestion&&Object($t.jsx)("input",{type:"button",value:i18n._("Next question"),className:"simple-button",disabled:this.props.apiOptions.readOnly,onClick:this.props.onNextQuestion,style:{marginLeft:5}}),this.props.hint&&this.props.hint.content&&(this.state.showHint?Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:Object(On.css)(XN.explanationTitle),onClick:()=>this.setState({showHint:!1}),children:i18n._("Hide explanation")}),Object($t.jsx)(qN,{...this.props.hint,ref:"hints-renderer",apiOptions:e,linterContext:this.props.linterContext})]}):Object($t.jsx)("div",{onClick:()=>this.setState({showHint:!0}),className:Object(On.css)(XN.showHintLink),children:i18n._("Explain")})),e.isMobile&&i!==GN.HIDDEN&&Object($t.jsx)(WN,{apiOptions:e,answerBarState:i,onCheckAnswer:this._checkAnswer,onNextQuestion:this.props.onNextQuestion})]})}});AN.exports={name:"graded-group",displayName:"Graded group (articles only)",widget:KN,traverseChildWidgets:function(e,t){return DN.extend({},e,t(e))},hidden:!1,tracking:"all",isLintable:!0};const XN=On.StyleSheet.create({gradedGroupInSet:{marginLeft:0,paddingLeft:0},gradedGroup:{borderTop:"1px solid #BABEC2",borderBottom:"1px solid #BABEC2",backgroundColor:cn,marginLeft:mn,marginRight:mn,paddingBottom:fn,paddingLeft:fn,paddingRight:fn,paddingTop:10,width:"auto"},showHintLink:{marginTop:20,color:Jt,cursor:"pointer"},explanationTitle:{marginTop:20,color:Jt,marginBottom:10,cursor:"pointer"},title:{fontSize:12,color:rn,textTransform:"uppercase",marginBottom:11,letterSpacing:.8}});var ZN=AN.exports,JN={exports:{}};JN.exports;h.a,x.b;const QN=hu,eP=ZN.widget,tP=createReactClass({displayName:"Indicators",render(){const e=[];for(let t=0;t<this.props.numGroups;t++)e.push(Object($t.jsx)("div",{className:Object(On.css)(sP.indicator,t===this.props.currentGroup&&sP.selectedIndicator),onClick:()=>this.props.onChangeCurrentGroup(t)},t));return Object($t.jsx)("div",{className:Object(On.css)(sP.indicatorContainer),children:e})}}),nP=createReactClass({displayName:"GradedGroupSet",getDefaultProps:()=>({gradedGroups:[],linterContext:je}),getInitialState:()=>({currentGroup:0}),shouldComponentUpdate(e,t){return e!==this.props||t!==this.state},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return QN.change.apply(this,t)},getInputPaths(){return this._childGroup.getInputPaths()},setInputValue(e,t,n){return this._childGroup.setInputValue(e,t,n)},getAcceptableFormatsForInputPath(e){return this._childGroup.getAcceptableFormatsForInputPath(e)},focus(){return this._childGroup.focus()},focusInputPath(e){this._childGroup.focusInputPath(e)},blurInputPath(e){this._childGroup.blurInputPath(e)},handleNextQuestion(){const{currentGroup:e}=this.state;e<this.props.gradedGroups.length-1&&this.setState({currentGroup:e+1})},render(){const e=this.props.gradedGroups[this.state.currentGroup];if(!e)return Object($t.jsx)("span",{children:"No current group..."});const t=this.props.gradedGroups.length,n=this.state.currentGroup<t-1?this.handleNextQuestion:null;return Object($t.jsxs)("div",{className:Object(On.css)(sP.container),children:[Object($t.jsxs)("div",{className:Object(On.css)(sP.top),children:[Object($t.jsx)("div",{className:Object(On.css)(sP.title),children:e.title}),Object($t.jsx)("div",{className:Object(On.css)(sP.spacer)}),Object($t.jsx)(tP,{numGroups:t,currentGroup:this.state.currentGroup,onChangeCurrentGroup:e=>this.setState({currentGroup:e})})]}),Object($t.jsx)(eP,{ref:e=>this._childGroup=e,...this.props,...e,inGradedGroupSet:!0,title:null,onNextQuestion:n,linterContext:this.props.linterContext},this.state.currentGroup)]})}});JN.exports={name:"graded-group-set",displayName:"Graded group set (articles only)",widget:nP,traverseChildWidgets:function(e,t){return{groups:e.gradedGroups.map(t)}},hidden:!1,tracking:"all",isLintable:!0};const sP=On.StyleSheet.create({top:{display:"flex",flexDirection:"row"},spacer:{flex:1},title:{fontSize:12,color:rn,textTransform:"uppercase",marginBottom:11,letterSpacing:.8},indicatorContainer:{display:"flex",flexDirection:"row"},indicator:{width:10,height:10,borderRadius:5,backgroundColor:"#AAAAAA",marginLeft:5,cursor:"pointer"},selectedIndicator:{backgroundColor:Jt},container:{borderTop:"1px solid #BABEC2",borderBottom:"1px solid #BABEC2",backgroundColor:cn,marginLeft:mn,marginRight:mn,paddingBottom:fn,paddingLeft:fn,paddingRight:fn,paddingTop:10,width:"auto"}});var iP=JN.exports;const rP=x.b,oP=ce,aP=sc,lP=aP.Plot,cP=G.a.point,hP={url:null};function pP(e){var t=e[0],n=e[1],s=e[2],i=e[3];t<0&&(t*=-1,n*=-1,s*=-1);var r=2*Math.PI;for(n<0&&(n*=-1,s*=-1,s+=r/2);s>0;)s-=r;for(;s<0;)s+=r;return[t,n,s,i]}function uP(e){var t=e[0],n=e[1],s=e[2],i=e[3];t<0&&(t*=-1,n*=-1,s*=-1);var r=Math.PI;for(n<0&&(n*=-1,s*=-1,s+=r/2);s>0;)s-=r;for(;s<0;)s+=r;return[t,n,s,i]}var dP={areEqual:function(e,t){return oP.deepEq(e,t)},Movable:lP,getPropsForCoeffs:function(e){return{fn:rP.partial(this.getFunctionForCoeffs,e)}}},gP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/67aaf581e6d9ef9038c10558a1f70ac21c11c9f8.png",defaultCoords:[[.25,.75],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],s=n[0]-t[0],i=n[1]-t[1];if(0!==s){var r=i/s;return[r,n[1]-r*n[0]]}},getFunctionForCoeffs:function(e,t){return e[0]*t+e[1]},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1];return"y = "+n.toFixed(3)+"x + "+s.toFixed(3)}}),fP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/e23d36e6fc29ee37174e92c9daba2a66677128ab.png",defaultCoords:[[.5,.5],[.75,.75]],Movable:aP.Parabola,getCoefficients:function(e){var t=e[0],n=e[1],s=t[0],i=t[1],r=(n[1]-i)/((n[0]-s)*(n[0]-s));return[r,-2*s*r,r*s*s+i]},getFunctionForCoeffs:function(e,t){return(e[0]*t+e[1])*t+e[2]},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2];return"y = "+n.toFixed(3)+"x^2 + "+s.toFixed(3)+"x + "+i.toFixed(3)}}),mP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/3d68e7718498475f53b206c2ab285626baf8857e.png",defaultCoords:[[.5,.5],[.6,.6]],Movable:aP.Sinusoid,getCoefficients:function(e){var t=e[0],n=e[1],s=n[1]-t[1],i=Math.PI/(2*(n[0]-t[0]));return[s,i,t[0]*i,t[1]]},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2],r=e[3];return n*Math.sin(s*t-i)+r},getPropsForCoeffs:function(e){return{a:e[0],b:e[1],c:e[2],d:e[3]}},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2],r=t[3];return"y = "+n.toFixed(3)+" sin("+s.toFixed(3)+"x - "+i.toFixed(3)+") + "+r.toFixed(3)},areEqual:function(e,t){return oP.deepEq(pP(e),pP(t))}}),bP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/7db80d23c35214f98659fe1cf0765811c1bbfbba.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],s=n[1]-t[1],i=Math.PI/(4*(n[0]-t[0]));return[s,i,t[0]*i,t[1]]},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2],r=e[3];return n*Math.tan(s*t-i)+r},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2],r=t[3];return"y = "+n.toFixed(3)+" sin("+s.toFixed(3)+"x - "+i.toFixed(3)+") + "+r.toFixed(3)},areEqual:function(e,t){return oP.deepEq(uP(e),uP(t))}}),vP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/9cbfad55525e3ce755a31a631b074670a5dad611.png",defaultCoords:[[.5,.55],[.75,.75]],defaultAsymptote:[[0,.5],[1,.5]],extraCoordConstraint:function(e,t,n,s,i){var r=rP.head(s)[1];return rP.all(n,(e=>e[1]!==r))},extraAsymptoteConstraint:function(e,t,n,s,i){var r=e[1];if(rP.all(n,(e=>e[1]>r))||rP.all(n,(e=>e[1]<r)))return[t[0],r];var o=t[1];if(rP.all(n,(e=>e[1]>o))){var a=rP.min(rP.map(n,(e=>e[1])));return[t[0],a-i.snapStep[1]]}var l=rP.max(rP.map(n,(e=>e[1])));return[t[0],l+i.snapStep[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=e[0],s=e[1],i=rP.head(t)[1],r=Math.log((n[1]-i)/(s[1]-i))/(n[0]-s[0]);return[(n[1]-i)/Math.exp(r*n[0]),r,i]},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2];return n*Math.exp(s*t)+i},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),s=n[0],i=n[1],r=n[2];return"y = "+s.toFixed(3)+"e^("+i.toFixed(3)+"x) + "+r.toFixed(3)}}),xP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/f6491e99d34af34d924bfe0231728ad912068dc3.png",defaultCoords:[[.55,.5],[.75,.75]],defaultAsymptote:[[.5,0],[.5,1]],extraCoordConstraint:function(e,t,n,s,i){var r=rP.head(s)[0];return rP.all(n,(e=>e[0]!==r))&&n[0][1]!==n[1][1]},extraAsymptoteConstraint:function(e,t,n,s,i){var r=e[0];if(rP.all(n,(e=>e[0]>r))||rP.all(n,(e=>e[0]<r)))return[r,t[1]];var o=t[0];return rP.all(n,(e=>e[0]>o))?[rP.min(rP.map(n,(e=>e[0])))-i.snapStep[0],t[1]]:[rP.max(rP.map(n,(e=>e[0])))+i.snapStep[0],t[1]]},allowReflectOverAsymptote:!0,getCoefficients:function(e,t){var n=e=>[e[1],e[0]],s=vP.getCoefficients(rP.map(e,n),rP.map(t,n)),i=-s[2]/s[0],r=1/s[0];return[1/s[1],r,i]},getFunctionForCoeffs:function(e,t,n){var s=e[0],i=e[1],r=e[2];return s*Math.log(i*t+r)},getEquationString:function(e,t){if(!t)return null;var n=this.getCoefficients(e,t),s=n[0],i=n[1],r=n[2];return"y = ln("+s.toFixed(3)+"x + "+i.toFixed(3)+") + "+r.toFixed(3)}}),yP=rP.extend({},dP,{url:"https://ka-perseus-graphie.s3.amazonaws.com/8256a630175a0cb1d11de223d6de0266daf98721.png",defaultCoords:[[.5,.5],[.75,.75]],getCoefficients:function(e){var t=e[0],n=e[1],s=n[0]-t[0],i=n[1]-t[1];if(0!==s){var r=Math.abs(i/s);return n[1]<t[1]&&(r*=-1),[r,t[0],t[1]]}},getFunctionForCoeffs:function(e,t){var n=e[0],s=e[1],i=e[2];return n*Math.abs(t-s)+i},getEquationString:function(e){var t=this.getCoefficients(e),n=t[0],s=t[1],i=t[2];return"y = "+n.toFixed(3)+"| x - "+s.toFixed(3)+"| + "+i.toFixed(3)}}),jP={linear:gP,quadratic:fP,sinusoid:mP,tangent:bP,exponential:vP,logarithm:xP,absolute_value:yP},wP=rP.keys(jP);function OP(e){return jP[e]}var CP={validate:function(e,t){if(e.type!==t.correct.type)return{type:"points",earned:0,total:1,message:null};if(null==e.coords)return{type:"invalid",message:null};var n=OP(e.type),s=n.getCoefficients(e.coords,e.asymptote),i=n.getCoefficients(t.correct.coords,t.correct.asymptote);return null==s||null==i?{type:"invalid",message:null}:n.areEqual(s,i)?{type:"points",earned:1,total:1,message:null}:{type:"points",earned:0,total:1,message:null}},getEquationString:function(e){var t=e.plot;return t.type&&t.coords&&OP(t.type).getEquationString(t.coords,t.asymptote)||""},pointsFromNormalized:function(e,t,n,s){return rP.map(e,(function(e){var i=rP.map(e,(function(e,s){var i=t[s],r=n[s],o=function(e,t){return Math.floor((e[1]-e[0])/t)}(i,r),a=Math.round(e*o);return i[0]+r*a}));return cP.roundTo(i,s)}))},maybePointsFromNormalized:function(e,t,n,s){return e?this.pointsFromNormalized(e,t,n,s):e},defaultPlotProps:function(e,t){var n=OP(e),s=oP.snapStepFromGridStep([1,1]);return{type:e,asymptote:this.maybePointsFromNormalized(n.defaultAsymptote,t.range,t.step,s),coords:null}},chooseType:rP.first,getGridAndSnapSteps:function(e,t){var n=e.gridStep||oP.getGridStep(e.range,e.step,t);return{gridStep:n,snapStep:e.snapStep||oP.snapStepFromGridStep(n)}}},SP={};function kP(e){var t=e.charAt(0).toUpperCase()+e.substring(1);return{value:e,title:t,content:Object($t.jsx)("img",{src:OP(e).url,alt:t})}}SP.graph={labels:["x","y"],range:[[-10,10],[-10,10]],step:[1,1],backgroundImage:hP,markings:"graph",rulerLabel:"",rulerTicks:10,valid:!0,showTooltips:!1},SP.plot=CP.defaultPlotProps("linear",SP.graph),SP.availableTypes=[SP.plot.type];var _P={exports:{}},TP=(_P.exports,h.a,x.b),MP=bl,NP=Sc,PP=ce,IP=Ff.a,EP=sc,AP=EP.MovablePoint,RP=EP.MovableLine;const DP=Ji;var FP=G.a.number,LP=G.a.vector,zP=G.a.point;const qP=Mi;var WP=hu;var BP={padding:"5px 5px"},VP=createReactClass({displayName:"FunctionGrapher",_coords:function(e){var t=(e=e||this.props).graph,n=e.model&&CP.maybePointsFromNormalized(e.model.defaultCoords,t.range,t.step,t.snapStep);return e.coords||n||null},_asymptote:function(e){return(e=e||this.props).asymptote},getDefaultProps:function(){return{graph:{range:[[-10,10],[-10,10]],step:[1,1]},coords:null,asymptote:null,isMobile:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return WP.change.apply(this,t)},render:function(){var e=TP.map(this._coords(),((e,t)=>Object($t.jsx)(AP,{coord:e,static:this.props.static,constraints:[MP.MovablePoint.constraints.bound(),MP.MovablePoint.constraints.snap(),e=>{var n=TP.all(this._coords(),((n,s)=>t===s||!n||!FP.equal(e[0],n[0])));if(!n)return!1;if(this.props.model&&this.props.model.extraCoordConstraint){var s=this.props.model.extraCoordConstraint,i=TP.clone(this._coords()),r=TP.clone(i[t]);return i[t]=e,s(e,r,i,this._asymptote(),this.props.graph)}return n}],onMove:(e,n)=>{var s,i=this._asymptote();s=i&&this.props.model.allowReflectOverAsymptote&&function(e,t,n){var s=(e,t,n)=>(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1]);return s(n[0],n[1],t)>0!==s(n[0],n[1],e)>0}(e,n,i)?TP.map(this._coords(),(e=>zP.reflectOverLine(e,i))):TP.clone(this._coords()),s[t]=e,this.props.onChange({coords:s})},showHairlines:this.props.showHairlines,hideHairlines:this.props.hideHairlines,showTooltips:this.props.showTooltips,isMobile:this.props.isMobile},t))),t=this.props.graph.box,n=this.props.graph.backgroundImage,s=null;if(n.url){var i=t[0]/vn;s=Object($t.jsx)(NP,{src:n.url,width:n.width,height:n.height,scale:i})}return Object($t.jsx)("div",{className:"perseus-widget perseus-widget-grapher",style:{width:t[0],height:this.props.flexibleType?"auto":t[1],boxSizing:"initial"},children:Object($t.jsxs)("div",{className:"graphie-container above-scratchpad",style:{width:t[0],height:t[1]},children:[s,Object($t.jsxs)(EP,{...this.props.graph,setDrawingAreaAvailable:this.props.setDrawingAreaAvailable,children:[this.props.model&&this.renderPlot(),this.props.model&&this.renderAsymptote(),this.props.model&&e]})]})})},renderPlot:function(){var e=this.props.model,t=this.props.graph.range[0],n={stroke:this.props.isMobile?qP.BLUE_C:qP.DYNAMIC,...this.props.isMobile?{"stroke-width":3}:{}},s=e.getCoefficients(this._coords(),this._asymptote());if(s){var i=e.getPropsForCoeffs(s,t);return Object(c.createElement)(e.Movable,{...i,key:this.props.model.url,range:t,style:n})}},renderAsymptote:function(){var e=this.props.model,t=this.props.graph,n=this._asymptote(),s={strokeDasharray:"- "};return n&&Object($t.jsx)(RP,{onMove:(e,t)=>{var n=LP.subtract(e,t),s=TP.map(this._asymptote(),(e=>LP.add(e,n)));this.props.onChange({asymptote:s})},constraints:[MP.MovableLine.constraints.bound(),MP.MovableLine.constraints.snap(),(n,s)=>{var i=LP.subtract(n,s),r=TP.map(this._asymptote(),(e=>LP.add(e,i)));return!e.extraAsymptoteConstraint||e.extraAsymptoteConstraint(n,s,this._coords(),r,t)}],normalStyle:s,highlightStyle:s,children:TP.map(n,((e,t)=>Object($t.jsx)(AP,{coord:e,static:!0,draw:null,extendLine:!0,showHairlines:this.props.showHairlines,hideHairlines:this.props.hideHairlines,showTooltips:this.props.showTooltips,isMobile:this.props.isMobile},`asymptoteCoord-${t}`)))})}}),HP=createReactClass({displayName:"Grapher",getDefaultProps:function(){return SP},render:function(){var e=this.props.plot.type,t=this.props.plot.coords,n=this.props.plot.asymptote,s=Object($t.jsx)("div",{style:BP,className:"above-scratchpad",children:Object($t.jsx)(IP,{value:e,allowEmpty:!0,buttons:TP.map(this.props.availableTypes,kP),onChange:this.handleActiveTypeChange})});const i=zs(this.props.containerSizeClass),r={...this.props.graph,...CP.getGridAndSnapSteps(this.props.graph,i[0]),gridConfig:this._getGridConfig({...this.props.graph,box:i,...CP.getGridAndSnapSteps(this.props.graph,i[0])})};var o={graph:{box:i,range:r.range,step:r.step,snapStep:r.snapStep,backgroundImage:r.backgroundImage,options:r,setup:this._setupGraphie},onChange:this.handlePlotChanges,model:e&&OP(e),coords:t,asymptote:n,static:this.props.static,setDrawingAreaAvailable:this.props.apiOptions.setDrawingAreaAvailable,isMobile:this.props.apiOptions.isMobile,showTooltips:this.props.graph.showTooltips,showHairlines:this.showHairlines,hideHairlines:this.hideHairlines};return Object($t.jsxs)("div",{children:[Object($t.jsx)(VP,{...o}),this.props.availableTypes.length>1&&s]})},handlePlotChanges:function(e){var t=TP.extend({},this.props.plot,e);this.props.onChange({plot:t}),this.props.trackInteraction()},handleActiveTypeChange:function(e){var t=this.props.graph,n=TP.extend({},this.props.plot,CP.defaultPlotProps(e,t));this.props.onChange({plot:n})},_getGridConfig:function(e){return TP.map(e.step,(function(t,n){return PP.gridDimensionConfig(t,e.range[n],e.box[n],e.gridStep[n])}))},_calculateMobileTickStep(e,t,n){const s=PP.constrainedTickStepsFromTickSteps(t,n);return s[0]=s[0]/e[0],s[1]=s[1]/e[1],s},_setupGraphie:function(e,t){const n=this.props.apiOptions.isMobile;if("graph"===t.markings?(e.graphInit({range:t.range,scale:TP.pluck(t.gridConfig,"scale"),axisArrows:"<->",labelFormat:function(e){return"\\small{"+e+"}"},gridStep:t.gridStep,snapStep:t.snapStep,tickStep:n?this._calculateMobileTickStep(t.gridStep,t.step,t.range):TP.pluck(t.gridConfig,"tickStep"),labelStep:1,unityLabels:TP.pluck(t.gridConfig,"unityLabel"),isMobile:n}),e.label([0,t.range[1][1]],t.labels[1],n?"below right":"above"),e.label([t.range[0][1],0],t.labels[0],n?"above left":"right")):"grid"===t.markings?e.graphInit({range:t.range,scale:TP.pluck(t.gridConfig,"scale"),gridStep:t.gridStep,axes:!1,ticks:!1,labels:!1,isMobile:n}):"none"===t.markings&&e.init({range:t.range,scale:TP.pluck(t.gridConfig,"scale")}),this.props.apiOptions.isMobile){const t={normalStyle:{strokeWidth:1}};this.horizHairline=new DP(e,[0,0],[0,0],t),this.horizHairline.attr({stroke:qP.INTERACTIVE}),this.horizHairline.hide(),this.vertHairline=new DP(e,[0,0],[0,0],t),this.vertHairline.attr({stroke:qP.INTERACTIVE}),this.vertHairline.hide()}},showHairlines:function(e){this.props.apiOptions.isMobile&&"none"!==this.props.markings&&(this.horizHairline.moveTo([this.props.graph.range[0][0],e[1]],[this.props.graph.range[0][1],e[1]]),this.horizHairline.show(),this.vertHairline.moveTo([e[0],this.props.graph.range[1][0]],[e[0],this.props.graph.range[1][1]]),this.vertHairline.show())},hideHairlines:function(){this.props.apiOptions.isMobile&&(this.horizHairline.hide(),this.vertHairline.hide())},simpleValidate:function(e){return CP.validate(this.getUserInput(),e)},getUserInput:function(){return this.props.plot},focus:$.noop}),UP=e=>{var t={availableTypes:e.availableTypes,graph:e.graph};if(1===t.availableTypes.length){var n=t.graph,s=CP.chooseType(t.availableTypes);t.plot=CP.defaultPlotProps(s,n)}return t};_P.exports={name:"grapher",displayName:"Grapher",widget:HP,transform:UP,staticTransform:e=>TP.extend({},UP(e),{availableTypes:[e.correct.type],plot:e.correct})};var GP=_P.exports,$P=n(60),YP={exports:{}};YP.exports;h.a;const KP=x.b,XP=hu,ZP=Zf,JP=sd,QP=$P.a,eI=GP.widget,tI=createReactClass({displayName:"GrapherEditor",getDefaultProps:function(){return{correct:SP.plot,graph:SP.graph,availableTypes:SP.availableTypes}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return XP.change.apply(this,t)},render:function(){const e=Ls.SMALL;let t,n;if(!0===this.props.graph.valid){var s={graph:this.props.graph,plot:this.props.correct,availableTypes:this.props.availableTypes,onChange:(e,t)=>{var n=this.props.correct;n=n.type===e.plot.type?KP.extend({},n,e.plot):e.plot,this.props.onChange({correct:n},t)},trackInteraction:function(){}};n=Object($t.jsx)(eI,{...s,apiOptions:this.props.apiOptions,containerSizeClass:e}),t=CP.getEquationString(s)}else n=Object($t.jsx)("div",{className:"perseus-error",children:this.props.graph.valid});return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{children:["Correct answer"," ",Object($t.jsx)(JP,{children:Object($t.jsx)("p",{children:"Graph the correct answer in the graph below and ensure the equation or point coordinates displayed represent the correct answer."})})," ",": ",t]}),Object($t.jsx)(ZP,{editableSettings:["graph","snap","image"],box:zs(e),range:this.props.graph.range,labels:this.props.graph.labels,step:this.props.graph.step,gridStep:this.props.graph.gridStep,snapStep:this.props.graph.snapStep,valid:this.props.graph.valid,backgroundImage:this.props.graph.backgroundImage,markings:this.props.graph.markings,rulerLabel:this.props.graph.rulerLabel,rulerTicks:this.props.graph.rulerTicks,showTooltips:this.props.graph.showTooltips,onChange:this.change("graph")}),Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Available functions:  "}),Object($t.jsx)(QP,{allowEmpty:!1,values:this.props.availableTypes,buttons:KP.map(wP,kP),onChange:this.handleAvailableTypesChange})]}),n]})},handleAvailableTypesChange:function(e){var t=this.props.correct;if(!KP.contains(e,this.props.correct.type)){var n=this.props.graph,s=CP.chooseType(e);t=CP.defaultPlotProps(s,n)}this.props.onChange({availableTypes:e,correct:t})},serialize:function(){return KP.chain(this.props).pick("correct","availableTypes").extend({graph:KP.omit(this.props.graph,"box")}).value()}});YP.exports=tI;var nI=YP.exports,sI={exports:{}};sI.exports;h.a;const iI=x.b,rI=hu,oI=iu,aI=sv,lI=Bx,cI=createReactClass({displayName:"DefinitionEditor",getDefaultProps:function(){return{togglePrompt:"",definition:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return rI.change.apply(this,t)},serialize(){return oI.serialize.call(this)},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-definition-editor",children:[Object($t.jsx)("a",{href:"https://docs.google.com/document/d/1udaPef4imOfTMhmLDlWq4SM0mxL0r3YHFZE-5J1uGfo",target:"_blank",children:"Definition style guide"}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Word to be defined:"," ",Object($t.jsx)(lI,{value:this.props.togglePrompt,onChange:this.change("togglePrompt"),placeholder:"define me"})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(aI,{apiOptions:this.props.apiOptions,content:this.props.definition,widgetEnabled:!1,placeholder:"definition goes here",onChange:e=>{const t={};iI.has(e,"content")&&(t.definition=e.content),this.change(t)}})})]})}});sI.exports=cI;var hI=sI.exports,pI={exports:{}};pI.exports;h.a;const uI=x.b,dI=hu,gI=ah,fI=ch,mI=createReactClass({displayName:"Definition",getDefaultProps:function(){return{togglePrompt:"define me",definition:"definition goes here"}},getInitialState:function(){return{expanded:!1,belowScreen:!1,contentOffsetLeft:0,contentOffsetLeftMobile:0,contentWidth:0,contentWidthMobile:0,contentMarginTop:wI}},componentDidMount:function(){document.addEventListener("click",this.handleClick)},componentWillUnmount:function(){document.removeEventListener("click",this.handleClick)},handleClick:function(e){let t=e.target,n=!0;for(;t;){if(t===this.content||t===this.container){n=!1;break}t=t.parentNode}n&&this.close()},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return dI.change.apply(this,t)},close:function(){this.setState({expanded:!1})},getUserInput:function(){return{}},simpleValidate:function(e){return mI.validate(this.getUserInput(),e)},_definitionBelowScreen:function(){const e=window.innerHeight;return this.container.getBoundingClientRect().bottom>e-this.content.offsetHeight},_checkDefinitionPosition:function(){setTimeout((()=>{this._positionContentHorizontally(),this._definitionBelowScreen()?this.setState({belowScreen:!0},this._positionContentVertically):this.setState({belowScreen:!1},this._positionContentVertically)}),0)},_positionContentVertically:function(){if(this.state.belowScreen){const e=-this.content.offsetHeight-2*wI-4;this.setState({contentMarginTop:e})}else this.setState({contentMarginTop:wI})},_onClick:function(){if(!this.state.expanded){const e=this.props.findWidgets("definition");for(const t of e)t!==this&&t.close()}this.setState({expanded:!this.state.expanded},this._checkDefinitionPosition),this.props.trackInteraction()},_onMouseOver:function(){this.setState({expanded:!0},this._checkDefinitionPosition),this.props.trackInteraction()},_onMouseOut:function(){this.setState({expanded:!1}),this.props.trackInteraction()},_positionContentHorizontally:function(){const e=document.body.clientWidth,t=this.container.parentElement.parentElement.offsetLeft,n=e-2*t,s=e-t,i=this.container.offsetLeft-t,r=this.container.offsetLeft;this.setState({contentWidth:n,contentWidthMobile:s,contentOffsetLeft:-i,contentOffsetLeftMobile:-r})},render:function(){const{readOnly:e,isMobile:t}=this.props.apiOptions,n=this.props.togglePrompt;let s;const i=e?null:"javascript:void(0)",r=e?null:this._onClick,o=this._onMouseOver,a=this._onMouseOut;s=t?Object($t.jsx)("a",{className:Object(On.css)(OI.mobileDefinitionLink),href:i,onClick:r,children:n}):Object($t.jsx)("a",{className:Object(On.css)(OI.definitionLink),href:i,onMouseOver:o,onMouseOut:a,children:n});const l=t?OI.contentExpandedMobile:OI.contentExpanded,c=this.state.belowScreen?"scale(1, -1)":"scale(1, 1)";return Object($t.jsxs)("div",{className:Object(On.css)(OI.container),ref:e=>this.container=e,children:[Object($t.jsxs)("div",{className:Object(On.css)(OI.linkContainer),children:[s,this.state.expanded&&Object($t.jsxs)("svg",{className:Object(On.css)(OI.disclosureArrow),ref:e=>this.arrow=e,transform:c,style:{bottom:this.state.expanded&&this.state.belowScreen?"18px":"-18px"},children:[Object($t.jsxs)("filter",{id:"definition-widget-dropshadow",height:"150%",children:[Object($t.jsx)("feOffset",{dx:bI,dy:vI,result:"offsetblur"}),Object($t.jsx)("feGaussianBlur",{in:"SourceAlpha",stdDeviation:yI/2}),Object($t.jsx)("feComponentTransfer",{children:Object($t.jsx)("feFuncA",{type:"linear",slope:xI})}),Object($t.jsxs)("feMerge",{children:[Object($t.jsx)("feMergeNode",{}),Object($t.jsx)("feMergeNode",{in:"SourceGraphic"})]})]}),Object($t.jsx)("polyline",{fill:"white",filter:"url(#definition-widget-dropshadow)",points:`0,${wI} ${jI},${wI} `+jI/2+",0"})]})]}),Object($t.jsx)("div",{className:Object(On.css)(OI.content,t&&OI.contentMobile,this.state.expanded&&l),style:{height:this.state.expanded?"auto":0,overflow:this.state.expanded?"visible":"hidden",left:t?this.state.contentOffsetLeftMobile:this.state.contentOffsetLeft,width:t?this.state.contentWidthMobile:this.state.contentWidth,marginTop:this.state.contentMarginTop},ref:e=>this.content=e,children:Object($t.jsx)(gI,{apiOptions:this.props.apiOptions,content:this.props.definition,widgets:this.props.widgets})})]})}}),bI=0,vI=1,xI=.35,yI=4,jI=20,wI=14,OI=On.StyleSheet.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},definitionLink:{color:Qt,borderBottom:"dashed 1px #1C758A",textDecoration:"none"},mobileDefinitionLink:{color:Jt,borderBottom:"dashed 1px #71B307",textDecoration:"none",[fI.xl]:{fontSize:22,lineHeight:1.4},[fI.lgOrSmaller]:{fontSize:20,lineHeight:1.5},[fI.smOrSmaller]:{fontSize:18,lineHeight:1.2}},content:{background:"#FFFFFF",opacity:.95,borderRadius:1,position:"absolute",transition:"margin-top 0.1s",paddingLeft:fn,paddingRight:fn,zIndex:2},contentExpanded:{boxShadow:"0px 0px 4px #D6D8DA",border:"solid 0.5px #D6D8DA"},contentExpandedMobile:{paddingTop:32,paddingBottom:32,boxShadow:"0px 0px 4px #D6D8DA",border:"solid 0.5px #D6D8DA"},disclosureArrow:{height:wI,left:"50%",marginLeft:-jI/2,position:"absolute",width:jI,zIndex:4}});uI.extend(mI,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),pI.exports={name:"definition",displayName:"Definition",defaultAlignment:"inline",widget:mI,transform:uI.identity};var CI=pI.exports,SI={exports:{}},kI=(SI.exports,h.a,x.b),_I=hu,TI=iu,MI=sv,NI=Bx,PI={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:"explanation goes here\n\nmore explanation",widgets:{}},II=createReactClass({displayName:"ExplanationEditor",getDefaultProps:function(){return PI},getInitialState:function(){return{}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _I.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{className:"perseus-widget-explanation-editor",children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Prompt to show explanation:"," ",Object($t.jsx)(NI,{value:this.props.showPrompt,onChange:this.change("showPrompt")})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Prompt to hide explanation:"," ",Object($t.jsx)(NI,{value:this.props.hidePrompt,onChange:this.change("hidePrompt")})]})}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(MI,{apiOptions:this.props.apiOptions,content:this.props.explanation,widgets:this.props.widgets,widgetEnabled:!0,immutableWidgets:!1,onChange:e=>{var t={};kI.has(e,"content")&&(t.explanation=e.content),kI.has(e,"widgets")&&(t.widgets=e.widgets),this.change(t)}})})]})},serialize(){return TI.serialize.call(this)}});SI.exports=II;var EI=SI.exports,AI={exports:{}};AI.exports;h.a;const RI=x.b,DI=hu,FI=ah,LI=ch,zI={showPrompt:"Explain",hidePrompt:"Hide explanation",explanation:"explanation goes here\n\nmore explanation",widgets:{},linterContext:je},qI=createReactClass({displayName:"Explanation",getDefaultProps:function(){return zI},getInitialState:function(){return{expanded:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return DI.change.apply(this,t)},_onClick:function(){this.setState({expanded:!this.state.expanded}),this.props.trackInteraction()},render:function(){const{Link:e}=this.props.apiOptions.baseElements,{readOnly:t,isMobile:n}=this.props.apiOptions,s=this.state.expanded?this.props.hidePrompt:this.props.showPrompt;let i;const r=t?null:"javascript:void(0)",o=t?null:this._onClick;i=n?Object($t.jsxs)("div",{className:Object(On.css)(HI.linkContainer),children:[Object($t.jsx)("a",{className:Object(On.css)(HI.mobileExplanationLink),href:r,onClick:o,children:s}),this.state.expanded&&Object($t.jsx)("svg",{className:Object(On.css)(HI.disclosureArrow),children:Object($t.jsx)("polygon",{style:{fill:VI},points:`0,${BI} ${WI},${BI} `+WI/2+",0"})})]}):Object($t.jsx)("div",{className:Object(On.css)(HI.linkContainer),children:Object($t.jsx)(e,{className:Object(On.css)(HI.explanationLink),href:r,onClick:o,children:`[${s}]`})});const a=n?HI.contentExpandedMobile:HI.contentExpanded;return Object($t.jsxs)("div",{className:Object(On.css)(HI.container),children:[i,Object($t.jsx)("div",{className:Object(On.css)(HI.content,n&&HI.contentMobile,this.state.expanded&&a),style:{height:this.state.expanded?"auto":0,overflow:this.state.expanded?"visible":"hidden"},ref:"content",children:Object($t.jsx)(FI,{apiOptions:this.props.apiOptions,content:this.props.explanation,widgets:this.props.widgets,linterContext:this.props.linterContext})})]})},getUserInput:function(){return{}},simpleValidate:function(e){return qI.validate(this.getUserInput(),e)}}),WI=30,BI=14,VI=nn,HI=On.StyleSheet.create({container:{display:"inline",position:"relative"},linkContainer:{display:"inline-block"},explanationLink:{fontStyle:"italic",color:"#007d96",[LI.xl]:{fontSize:20,lineHeight:1.1},[LI.lgOrSmaller]:{fontSize:17,lineHeight:1.4},[LI.smOrSmaller]:{fontSize:14,lineHeight:1.3}},mobileExplanationLink:{color:Jt,borderBottom:"dashed 1px #71B307",textDecoration:"none",[LI.xl]:{fontSize:22,lineHeight:1.4},[LI.lgOrSmaller]:{fontSize:20,lineHeight:1.5},[LI.smOrSmaller]:{fontSize:18,lineHeight:1.2}},content:{position:"relative",transition:"margin-top 0.1s"},contentExpanded:{borderLeft:"5px solid #ccc",marginLeft:-23,paddingLeft:23,paddingBottom:10,marginBottom:BI,marginTop:BI},contentExpandedMobile:{boxSizing:"content-box",paddingTop:32,paddingBottom:32,marginTop:BI},contentMobile:{background:VI,marginLeft:mn,marginRight:mn,paddingLeft:fn,paddingRight:fn},disclosureArrow:{bottom:-(BI+5),height:BI,left:"50%",marginLeft:-WI/2,position:"absolute",width:WI}});RI.extend(qI,{validate:function(e,t){return{type:"points",earned:0,total:0,message:null}}}),AI.exports={name:"explanation",displayName:"Explanation",defaultAlignment:"inline",widget:qI,transform:RI.identity,isLintable:!0};var UI=AI.exports,GI={exports:{}},$I=(GI.exports,h.a,i.a),YI=x.b,KI=sd,XI=Kt,ZI=iu,JI=createReactClass({displayName:"DropdownEditor",getDefaultProps:function(){return{placeholder:"",choices:[{content:"",correct:!1}]}},render:function(){var e=YI.uniqueId("perseus_dropdown_");return Object($t.jsxs)("div",{className:"perseus-widget-dropdown",children:[Object($t.jsxs)("div",{className:"dropdown-info",children:["Dropdown",Object($t.jsx)(KI,{children:Object($t.jsxs)("p",{children:["The drop down is useful for making inequalities in a custom format. We normally use the symbols ","<",","," ",">",', \u2264, \u2265 (in that order) which you can copy into the choices. When possible, use the "multiple choice" answer type instead.']})})]}),Object($t.jsxs)("div",{className:"dropdown-placeholder",children:[Object($t.jsx)("input",{type:"text",placeholder:"Placeholder value",value:this.props.placeholder,onChange:this.onPlaceholderChange}),Object($t.jsx)(KI,{children:Object($t.jsx)("p",{children:"This value will appear as the drop down default. It should give the user some indication of the values available in the drop down itself, e.g., Yes/No/Maybe."})})]}),Object($t.jsx)("div",{className:"clearfix"}),Object($t.jsx)("ul",{className:"dropdown-choices",children:this.props.choices.map((function(t,n){var s=t.correct?"correct":"incorrect";return Object($t.jsx)("li",{children:Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{ref:"radio"+n,type:"radio",name:e,checked:t.correct?"checked":"",onChange:this.onCorrectChange.bind(this,n),value:n}),Object($t.jsx)("input",{type:"text",ref:"editor"+n,onChange:this.onContentChange.bind(this,n),className:s,value:t.content}),Object($t.jsx)("a",{href:"#",className:"simple-button orange",onClick:this.removeChoice.bind(this,n),children:Object($t.jsx)("span",{className:"remove-choice",children:Object($t.jsx)(XI,{...ya})})})]})},""+n)}),this)}),Object($t.jsx)("div",{className:"add-choice-container",children:Object($t.jsxs)("a",{href:"#",className:"simple-button orange",onClick:this.addChoice,children:[Object($t.jsx)(XI,{...fa})," Add a choice"," "]})})]})},onPlaceholderChange:function(e){var t=e.target.value;this.props.onChange({placeholder:t})},onCorrectChange:function(e){var t=YI.map(this.props.choices,(function(t,n){return YI.extend({},t,{correct:n===e})}));this.props.onChange({choices:t})},onContentChange:function(e,t){var n=this.props.choices.slice(),s=YI.clone(n[e]);s.content=t.target.value,n[e]=s,this.props.onChange({choices:n})},addChoice:function(e){e.preventDefault();var t=this.props.choices;this.props.onChange({choices:t.concat([{content:"",correct:!1}])},this.focus.bind(this,t.length))},removeChoice:function(e,t){t.preventDefault();var n=YI.clone(this.props.choices);n.splice(e,1),this.props.onChange({choices:n})},focus:function(e){return $I.findDOMNode(this.refs["editor"+e]).focus(),!0},serialize(){return ZI.serialize.call(this)}});GI.exports=JI;var QI=GI.exports,eE={exports:{}};eE.exports;const tE=v.a,nE=(h.a,i.a),sE=x.b,iE=Ss.ClassNames,rE=Ss.Options,oE=Kt,aE=createReactClass({displayName:"Dropdown",getDefaultProps:function(){return{choices:[],selected:0,placeholder:"",apiOptions:rE.defaults}},render:function(){var e=this.props.choices.slice(),t=tE({"perseus-widget-dropdown":!0});return Object($t.jsxs)("div",{children:[Object($t.jsxs)("select",{onChange:this._handleChangeEvent,onClick:e=>{e.stopPropagation(),e.target.focus()},onTouchStart:e=>{e.stopPropagation(),e.target.focus()},className:t+" nofastclick "+Object(On.css)(lE.dropdown)+" "+iE.INTERACTIVE,disabled:this.props.apiOptions.readOnly,value:this.props.selected,children:[Object($t.jsx)("option",{value:0,disabled:!0,children:this.props.placeholder}),e.map(((e,t)=>Object($t.jsx)("option",{value:t+1,children:e},""+(t+1))))]}),Object($t.jsx)(oE,{...ha,style:{marginLeft:"-24px",height:24,width:24}})]})},focus:function(){return nE.findDOMNode(this).focus(),!0},_handleChangeEvent:function(e){this._handleChange(parseInt(e.target.value))},_handleChange:function(e){this.props.trackInteraction(),this.props.onChange({selected:e})},getUserInput:function(){return{value:this.props.selected}},simpleValidate:function(e){return aE.validate(this.getUserInput(),e)}});sE.extend(aE,{validate:function(e,t){var n=e.value;return 0===n?{type:"invalid",message:null}:{type:"points",earned:t.choices[n-1].correct?1:0,total:1,message:null}}});const lE=On.StyleSheet.create({dropdown:{appearance:"none",backgroundColor:"transparent",border:"1px solid #BABEC2",borderRadius:4,boxShadow:"none",fontFamily:Xt,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:"2px solid #71B307",padding:"8px 24px 8px 8px"},":focus + svg":{color:"#71B307"},":disabled":{color:on},":disabled + svg":{color:on}}});eE.exports={name:"dropdown",displayName:"Drop down",defaultAlignment:"inline-block",accessible:!0,widget:aE,transform:e=>({placeholder:e.placeholder,choices:sE.map(e.choices,(e=>e.content))})};var cE=eE.exports,hE={exports:{}},pE=(hE.exports,h.a,x.b),uE=hu,dE=iu,gE=Ju.a,fE=sd,mE=Pf,bE=createReactClass({displayName:"PairEditor",getDefaultProps:function(){return{name:"",value:""}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return uE.change.apply(this,t)},render:function(){return Object($t.jsxs)("fieldset",{className:"pair-editor",children:[Object($t.jsxs)("label",{children:["Name:"," ",Object($t.jsx)(gE,{value:this.props.name,onChange:this.change("name")})]}),Object($t.jsxs)("label",{children:[" ","Value:"," ",Object($t.jsx)(gE,{value:this.props.value,onChange:this.change("value")})]})]})},serialize(){return dE.serialize.call(this)}}),vE=createReactClass({displayName:"PairsEditor",render:function(){var e=pE.map(this.props.pairs,((e,t)=>Object($t.jsx)(bE,{name:e.name,value:e.value,onChange:this.handlePairChange.bind(this,t)},t)));return Object($t.jsx)("div",{children:e})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return uE.change.apply(this,t)},handlePairChange:function(e,t){var n=this.props.pairs.slice();n[e]=t;var s=n[n.length-1];s.name&&s.value&&n.push({name:"",value:""}),this.change("pairs",n)},serialize(){return dE.serialize.call(this)}}),xE=/khanacademy\.org\/computer-programming\/[^\/]+\/(\d+)/;var yE=createReactClass({displayName:"CSProgramEditor",getDefaultProps:function(){return{programID:"",settings:[{name:"",value:""}],showEditor:!1,showButtons:!1,width:400,height:400}},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Url or Program ID:"," ",Object($t.jsx)(gE,{name:"programID",value:this.props.programID,onChange:this._handleProgramIDChange})]}),Object($t.jsx)("br",{}),Object($t.jsx)(mE,{label:"Show Editor",showEditor:this.props.showEditor,onChange:this.props.onChange}),Object($t.jsx)(fE,{children:'If you show the editor, you should use the "full-width" alignment to make room for the width of the editor.'}),Object($t.jsx)("br",{}),Object($t.jsx)(mE,{label:"Show Buttons",showButtons:this.props.showButtons,onChange:this.props.onChange}),Object($t.jsx)("br",{}),Object($t.jsxs)("label",{children:["Settings:",Object($t.jsx)(vE,{name:"settings",pairs:this.props.settings,onChange:this._handleSettingsChange}),Object($t.jsxs)(fE,{children:["Settings that you add here are available to the program as an object returned by ",Object($t.jsx)("code",{children:"Program.settings()"})]})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return uE.change.apply(this,t)},_handleSettingsChange:function(e){this.change({settings:e.pairs})},_handleProgramIDChange:function(e){e=function(e){var t=xE.exec(e);return t&&(e=t[1]),e}(e),$.getJSON("https://www.khanacademy.org/api/internal/scratchpads/"+e).done((t=>{this.change({width:t.width,height:t.height,programID:e})})).fail(((t,n,s)=>{console.error("Error retrieving scratchpad info for program ID ",e),console.error(n+", "+s),this.change({width:400,height:400,programID:e})}))},serialize(){return dE.serialize.call(this)}});hE.exports=yE;var jE=hE.exports,wE={exports:{}},OE=(wE.exports,h.a,x.b),CE=hu,SE=ce.updateQueryString,kE=/khanacademy\.org/,_E="https://{hostname}/computer-programming/program/{programID}/embedded?embed=yes&author=no";var TE=createReactClass({displayName:"CSProgram",getDefaultProps:function(){return{showEditor:!1,showButtons:!1,status:"incomplete",message:null}},handleMessageEvent:function(e){var t={};try{t=JSON.parse(e.originalEvent.data)}catch(s){return}if(!OE.isUndefined(t.testsPassed)){var n=t.testsPassed?"correct":"incorrect";this.change({status:n,message:t.message})}},componentDidMount:function(){$(window).on("message",this.handleMessageEvent)},componentWillUnmount:function(){$(window).off("message",this.handleMessageEvent)},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return CE.change.apply(this,t)},render:function(){if(!this.props.programID)return Object($t.jsx)("div",{});var e,t=function(e){var t=_E.replace("{programID}",e),n=document.location.hostname,s="www.khanacademy.org";return kE.test(n)&&(s=n),t.replace("{hostname}",s)}(this.props.programID),n={height:this.props.height};if(this.props.showEditor?(t+="&editor=yes",n.width="100%",e="perseus-scratchpad-editor"):(t+="&editor=no",n.width=this.props.width+2,e="perseus-scratchpad"),this.props.showButtons?(t+="&buttons=yes",n.height+=50):t+="&buttons=no",this.props.settings){var s={};OE.each(this.props.settings,(function(e){e.name&&e.value&&(s[e.name]=e.value)})),t=SE(t,"settings",JSON.stringify(s))}var i=["allow-popups","allow-same-origin","allow-scripts","allow-top-navigation"].join(" ");return Object($t.jsx)("iframe",{sandbox:i,src:t,style:n,className:e,allowFullScreen:!0})},simpleValidate:function(e){return TE.validate({status:this.props.status,message:this.props.message},e)},statics:{validate:function(e,t){return"correct"===e.status?{type:"points",earned:1,total:1,message:e.message||null}:"incorrect"===e.status?{type:"points",earned:0,total:1,message:e.message||null}:{type:"invalid",message:"Keep going, you're not there yet!"}}}});wE.exports={name:"cs-program",displayName:"CS Program",supportedAlignments:["block","full-width"],widget:TE,hidden:!0};var ME=wE.exports,NE={exports:{}};NE.exports;h.a;const PE=v.a,IE=hu,EE=Du,AE=x.b,RE=Ss.ClassNames,DE=Kt,FE=ah,LE=ce,zE=ch,qE=uh,WE=createReactClass({displayName:"Categorizer",getDefaultProps:function(){return{items:[],categories:[],values:[],linterContext:je}},getInitialState:function(){return{uniqueId:AE.uniqueId("perseus_radio_")}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return IE.change.apply(this,t)},getUserInput:function(){return EE.getUserInput.call(this)},render:function(){const e=this,t=this.props.apiOptions.isMobile;let n=this.props.items.map(((e,t)=>[e,t]));this.props.randomizeItems&&(n=LE.shuffle(n,this.props.problemNum));const s=Object($t.jsxs)("table",{className:"categorizer-table",children:[Object($t.jsx)("thead",{children:Object($t.jsxs)("tr",{children:[Object($t.jsx)("th",{children:"\xa0"}),this.props.categories.map(((e,t)=>Object($t.jsx)("th",{className:Object(On.css)(BE.header),children:Object($t.jsx)(FE,{content:e,linterContext:this.props.linterContext})},t)))]})}),Object($t.jsx)("tbody",{children:n.map((n=>{var s=n[0],i=n[1],r=e.state.uniqueId+"_"+i;return Object($t.jsxs)("tr",{children:[Object($t.jsx)("td",{children:Object($t.jsx)(FE,{content:s,linterContext:this.props.linterContext})}),AE.range(e.props.categories.length).map((n=>{const s=e.props.values[i]===n;return Object($t.jsx)("td",{className:"category "+Object(On.css)(BE.cell,BE.responsiveCell),children:Object($t.jsxs)("div",{className:RE.INTERACTIVE,onClick:this.onChange.bind(this,i,n),children:[t&&Object($t.jsx)("input",{type:"radio",name:r,className:Object(On.css)(qE.responsiveInput,qE.responsiveRadioInput),checked:s,onChange:this.onChange.bind(this,i,n),onClick:e=>e.stopPropagation()}),!t&&Object($t.jsx)("span",{className:Object(On.css)(BE.responsiveSpan,BE.radioSpan,s&&BE.checkedRadioSpan,this.props.static&&s&&BE.staticCheckedRadioSpan),children:s?Object($t.jsx)(DE,{...ra}):Object($t.jsx)(DE,{...la})})]})},n)}))]},i)}))})]}),i=PE({"categorizer-container":!0,"static-mode":this.props.static}),r=this.props.apiOptions.isMobile?[BE.fullBleedContainer]:[];return Object($t.jsx)("div",{className:i+" "+Object(On.css)(...r),children:s})},onChange:function(e,t){var n=AE.clone(this.props.values);n[e]=t,this.change("values",n),this.props.trackInteraction()},simpleValidate:function(e){return WE.validate(this.getUserInput(),e)}});AE.extend(WE,{validate:function(e,t){var n=!0,s=!0;return AE.each(t.values,(function(t,i){null==e.values[i]&&(n=!1),e.values[i]!==t&&(s=!1)})),n?{type:"points",earned:s?1:0,total:1,message:null}:{type:"invalid",message:i18n._("Make sure you select something for every row.")}}});const BE=On.StyleSheet.create({fullBleedContainer:{[zE.mdOrSmaller]:{marginLeft:-16,marginRight:-16,overflowX:"auto"}},header:{textAlign:"center",verticalAlign:"bottom"},cell:{textAlign:"center",padding:0,color:"#ccc",verticalAlign:"middle"},radioSpan:{fontSize:30,paddingRight:3,":hover":{color:"#999"}},checkedRadioSpan:{color:"#333"},staticCheckedRadioSpan:{color:"#888"}});NE.exports={name:"categorizer",displayName:"Categorizer",widget:WE,transform:e=>AE.pick(e,"items","categories","randomizeItems"),staticTransform:e=>AE.pick(e,"items","categories","values","randomizeItems"),isLintable:!0};var VE=NE.exports,HE={exports:{}};HE.exports;h.a;const UE=hu,GE=x.b,$E=iu,YE=Pf,KE=bs,XE=VE.widget,ZE=createReactClass({displayName:"CategorizerEditor",getDefaultProps:function(){return{items:[],categories:[],values:[],randomizeItems:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return UE.change.apply(this,t)},render:function(){return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(YE,{label:"Randomize item order",labelAlignment:"right",randomizeItems:this.props.randomizeItems,onChange:this.props.onChange})}),"Categories:",Object($t.jsx)(KE,{options:this.props.categories,onChange:e=>{this.change("categories",e)},layout:"horizontal"}),"Items:",Object($t.jsx)(KE,{options:this.props.items,onChange:e=>{this.change({items:e,values:GE.first(this.props.values,e.length)})},layout:"vertical"}),Object($t.jsx)(XE,{apiOptions:this.props.apiOptions,items:this.props.items,categories:this.props.categories,values:this.props.values,onChange:e=>{this.props.onChange(e)},trackInteraction:function(){}})]})},serialize(){return $E.serialize.call(this)}});HE.exports=ZE;var JE=HE.exports;const QE=[n.p+"static/media/likert-face-1.e2a4a672.svg",n.p+"static/media/likert-face-2.3b5ea4d5.svg",n.p+"static/media/likert-face-3.d234c14a.svg",n.p+"static/media/likert-face-4.59b6a841.svg",n.p+"static/media/likert-face-5.a3c5de77.svg"],eA=On.StyleSheet.create({container:{position:"relative",zIndex:3,userSelect:"none",display:"flex",flexDirection:"row",alignItems:"stretch"},choice:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",zIndex:0,borderWidth:1,borderRadius:0,marginRight:-1,borderColor:"gray",backgroundColor:"#eee",padding:15,":hover":{zIndex:1,outline:"2px solid aqua"},":focus-visible":{zIndex:1,outline:"2px solid aqua"},":active":{backgroundColor:"deepskyblue"}},first:{borderTopLeftRadius:5,borderBottomLeftRadius:5},last:{borderTopRightRadius:5,borderBottomRightRadius:5,marginRight:0},selectedChoice:{backgroundColor:"deepskyblue"},face:{display:"block",height:50,width:50,marginBottom:5}});class tA extends c.PureComponent{constructor(){super(...arguments),this.render=()=>{const e=this.props.selected===this.props.value;return Object($t.jsxs)("button",{type:"button",role:"radio","aria-checked":e,className:Object(On.css)(eA.choice,1===this.props.value&&eA.first,5===this.props.value&&eA.last,e&&eA.selectedChoice),onClick:this._handleSelect,children:[Object($t.jsx)("img",{className:Object(On.css)(eA.face),src:this.props.image,alt:this.props.alt,title:this.props.alt}),this.props.label]})},this._handleSelect=()=>{this.props.onSelect(this.props.value)}}}class nA extends c.PureComponent{constructor(e){super(e),this.render=()=>Object($t.jsx)("div",{role:"radiogroup",className:Object(On.css)(eA.container),children:this.props.labels.map(((e,t)=>Object($t.jsx)(tA,{value:t+1,image:QE[t],label:e,selected:this.props.selected,onSelect:this._handleChoice})))}),this._handleChoice=e=>{this.props.onChange({selected:e})},this.getUserInput=()=>({selected:this.props.selected,label:null==this.props.selected?null:this.props.labels[this.props.selected-1]}),this.simpleValidate=(e,t)=>null==this.props.selected?{type:"invalid",message:null}:{type:"points",earned:1,total:1}}}nA.defaultProps={selected:null};var sA={name:"likert-scale",displayName:"Likert Scale",defaultAlignment:"block",widget:nA,transform:e=>({labels:e.labels})};const iA=On.StyleSheet.create({face:{display:"inline-block",width:30,height:30,margin:5,verticalAlign:"middle"}});class rA extends c.Component{constructor(e){super(e),this._changeLabel=(e,t)=>{this.props.onChange({labels:this.props.labels.map(((n,s)=>s===e?t:n))})}}render(){return Object($t.jsxs)("div",{children:["Choice Labels:",this.props.labels.map(((e,t)=>Object($t.jsxs)("div",{children:[Object($t.jsx)("img",{className:Object(On.css)(iA.face),src:QE[t],alt:""}),Object($t.jsx)("input",{type:"text",className:Object(On.css)(iA.labelInput),value:e,onChange:e=>this._changeLabel(t,e.target.value)})]})))]})}serialize(){return{labels:this.props.labels}}}rA.defaultProps={labels:["","","","",""]};var oA=[[VE,JE],[ME,jE],[cE,QI],[UI,EI],[CI,hI],[GP,nI],[ZN,jN],[iP,_N],[dN,rN],[QM,GM],[DM,CM],[lM,WT],[a_,b_],[kk,ck],[FS,GS],[uS,nS],[KC,WC],[Ty,NC],[OC,QO],[BO,NO],[wO,Jj],[Hj,Fj],[Mj,wj],[Zy,bj],[Ey,Kx],[Lx,Nx],[Ox,Qv],[Uv,jv],[zm,dv],[_f,wm],[Cg,Jd],[jd,ud],[sA,rA]],aA={exports:{}};aA.exports;aA.exports=function(e){const t=e.skipMathJax,n=$.Deferred();n.resolve();const s=$.Deferred();return t?s.resolve():(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:"none","HTML-CSS":{availableFonts:["TeX"],imageFont:null,scale:100,showMathMenu:!1}}),MathJax.Hub.Configured(),MathJax.Hub.Queue(s.resolve)),n.then((()=>s))};var lA=aA.exports,cA=n(61),hA={exports:{}};hA.exports;h.a;const pA=cA.a,uA=x.b,dA=Ss.ClassNames,gA=D_,fA=ah,mA=Bx,bA=pg,vA=ts,xA=ce.captureScratchpadTouchStart,yA="math",jA="text",wA="tex",OA=createReactClass({displayName:"InputWithExamples",getDefaultProps:function(){return{type:jA,shouldShowExamples:!0,onFocus:function(){},onBlur:function(){},disabled:!1,linterContext:je}},getInitialState:function(){return{focused:!1,showExamples:!1}},_getUniqueId:function(){return`input-with-examples-${btoa(this.props.id).replace(/=/g,"")}`},_getInputClassName:function(){if(this.props.type===wA)return this.props.className;let e=dA.INPUT+" "+dA.INTERACTIVE;return this.state.focused&&(e+=" "+dA.FOCUSED),this.props.className&&(e+=" "+this.props.className),e},_getPropsForInputType:function(){const e={"aria-describedby":this._getUniqueId(),ref:"input",className:this._getInputClassName(),labelText:this.props.labelText,value:this.props.value,onFocus:this._handleFocus,onBlur:this._handleBlur,disabled:this.props.disabled};return this.props.type===wA?e:(uA.extend(e,{onChange:this.props.onChange,onTouchStart:xA}),this.props.type===yA?uA.extend({buttonSet:this.props.buttonSet,buttonsVisible:this.props.buttonsVisible,convertDotToTimes:this.props.convertDotToTimes},e):this.props.type===jA?uA.extend({autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:"false"},e):void 0)},_getComponentForInputType:function(){switch(this.props.type){case wA:return bA;case yA:return gA;case jA:return mA;default:return null}},_renderInput:function(){const e=this._getPropsForInputType(),t=this._getComponentForInputType();return Object($t.jsx)(t,{...e})},render:function(){const e=this._renderInput();if(this.props.type===wA)return e;const t=uA.map(this.props.examples,(e=>"- "+e)).join("\n"),n=this.props.shouldShowExamples&&this.state.showExamples;return Object($t.jsxs)(pA,{ref:"tooltip",className:"perseus-formats-tooltip preview-measure",horizontalPosition:"left",horizontalAlign:"left",verticalPosition:"bottom",arrowSize:10,borderColor:"#ccc",show:n,children:[e,Object($t.jsx)("div",{id:this._getUniqueId(),children:Object($t.jsx)(fA,{content:t,linterContext:vA.pushContextStack(this.props.linterContext,"input-with-examples")})})]})},_handleFocus:function(){this.props.onFocus(),this.setState({focused:!0,showExamples:!0})},show:function(){this.setState({showExamples:!0})},hide:function(){this.setState({showExamples:!1})},_handleBlur:function(){this.props.onBlur(),this.setState({focused:!1,showExamples:!1})},focus:function(){this.refs.input.focus()},blur:function(){this.refs.input.blur()},handleChange:function(e){this.props.onChange(e.target.value)}});hA.exports=OA;var CA=hA.exports,SA={exports:{}},kA=(SA.exports,v.a),_A=(h.a,i.a,cA.a),TA=x.b,MA=hu,NA=Ss.Options,PA=Ss.ClassNames;const IA=ie,EA=Kt;var AA=CA,RA=D_;const{KeypadInput:DA}=ye.a.components,{keypadConfigurationPropType:FA,keypadElementPropType:LA}=ye.a.propTypes,{KeypadTypes:zA}=ye.a.consts;var qA=i18n._("Sorry, I don't understand that!"),WA=(["An expression without an answer","is no expression to me.","Who can learn from an input","like the one that I see?","Put something in there","won't you please?","A few digits will do -","might I suggest some threes?"].join("\n"),e=>e.replace(/([_^])([^{])/g,"$1{$2}")),BA=createReactClass({displayName:"Expression",getDefaultProps:function(){return{value:"",times:!1,functions:[],buttonSets:["basic","trig","prealgebra","logarithms"],onFocus:function(){},onBlur:function(){},apiOptions:NA.defaults,linterContext:je}},getInitialState:function(){return{showErrorTooltip:!1,showErrorText:!1}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return MA.change.apply(this,t)},parse:function(e,t){var n=TA.pick(t||this.props,"functions");return window.icu&&window.icu.getDecimalFormatSymbols&&TA.extend(n,window.icu.getDecimalFormatSymbols()),U.parse(WA(e),n)},render:function(){if(this.props.apiOptions.customKeypad)return Object($t.jsx)(DA,{ref:"input",value:this.props.value,keypadElement:this.props.keypadElement,onChange:this.changeAndTrack,onFocus:()=>{this.props.keypadElement.configure(this.props.keypadConfiguration,(()=>{this.isMounted()&&this._handleFocus()}))},onBlur:this._handleBlur});if(this.props.apiOptions.staticRender)return Object($t.jsx)(AA,{ref:"input",value:this.props.value,type:"tex",examples:[],shouldShowExamples:!1,onChange:this.changeAndTrack,onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,linterContext:this.props.linterContext});var e=Object($t.jsx)("span",{className:"error-tooltip",children:Object($t.jsxs)(_A,{className:"error-text-container",horizontalPosition:"right",horizontalAlign:"left",verticalPosition:"top",arrowSize:10,borderColor:"#fcc335",show:this.state.showErrorText,children:[Object($t.jsx)("span",{className:"error-icon",onMouseEnter:()=>{this.setState({showErrorText:!0})},onMouseLeave:()=>{this.setState({showErrorText:!1})},onClick:()=>{this.setState({showErrorText:!this.state.showErrorText})},children:Object($t.jsx)(EA,{...pa})}),Object($t.jsx)("div",{className:"error-text",children:qA})]})}),t=kA({"perseus-widget-expression":!0,"show-error-tooltip":this.state.showErrorTooltip});return Object($t.jsxs)("span",{className:t,children:[Object($t.jsx)(RA,{ref:"input",className:PA.INTERACTIVE,value:this.props.value,onChange:this.changeAndTrack,convertDotToTimes:this.props.times,buttonsVisible:this.props.buttonsVisible||"focused",buttonSets:this.props.buttonSets,onFocus:this._handleFocus,onBlur:this._handleBlur}),this.state.showErrorTooltip&&e]})},changeAndTrack:function(e,t){this.change("value",e,t),this.props.trackInteraction()},_handleFocus:function(){this.props.onFocus([])},_handleBlur:function(){this.props.onBlur([])},errorTimeout:null,componentWillReceiveProps:function(e){TA.isEqual(this.props.value,e.value)&&TA.isEqual(this.props.functions,e.functions)||(clearTimeout(this.errorTimeout),this.parse(e.value,e).parsed?this.setState({showErrorTooltip:!1}):this.errorTimeout=setTimeout((()=>{!1!==this.props.apiOptions.onInputError(null,this.props.value,qA)&&this.setState({showErrorTooltip:!0})}),2e3))},componentWillUnmount:function(){clearTimeout(this.errorTimeout)},focus:function(){return this.props.apiOptions.customKeypad&&this.refs.input.focus(),!0},focusInputPath:function(e){this.refs.input.focus()},blurInputPath:function(e){this.refs.input.blur()},insert:function(e){this.props.apiOptions.staticRender||this.refs.input.insert(e)},getInputPaths:function(){return[[]]},getGrammarTypeForPath:function(e){return"expression"},setInputValue:function(e,t,n){this.props.onChange({value:t},n)},getAcceptableFormatsForInputPath:function(){return null},getUserInput:function(){return WA(this.props.value)},simpleValidate:function(e,t){return t=t||function(){},BA.validate(this.getUserInput(),e,t)}});TA.extend(BA,{validate:function(e,t,n){var s=TA.clone(t);window.icu&&window.icu.getDecimalFormatSymbols&&TA.extend(s,window.icu.getDecimalFormatSymbols());var i,r,o=!0,a=!!t.answerForms.find((n=>{var a=(e=>IA.expression.createValidatorFunctional(U.parse(e.value,t).expr,TA.extend({},s,{simplify:e.simplify,form:e.form})))(n);return i=a(e),r=n,o=o&&i.empty,i.correct})),l=i&&i.message;return a?"ungraded"===r.considered?{type:"invalid",message:!1===n(null,e,l)?null:l}:{type:"points",earned:"correct"===r.considered?1:0,total:1,message:l}:o?{type:"invalid",message:null}:{type:"points",earned:0,total:1}}});const VA=e=>{const t=zA.EXPRESSION,n={},s={};for(const a of e.answerForms){const t=U.parse(a.value,e);if(t.parsed){const e=t.expr,i=e=>"pi"===e||"theta"===e,r=e=>i(e)?e.toUpperCase():e;for(const t of e.getVars())n[r(t)]=!0;for(const t of e.getConsts())s[r(t)]=!0}}const i=Object.keys(n);i.sort();const r=Object.keys(s);r.sort();const o=[...i,...r];return o.length||o.push("PI"),{keypadType:t,extraKeys:o}};SA.exports={name:"expression",displayName:"Expression / Equation",defaultAlignment:"inline-block",widget:BA,transform:e=>{const{times:t,functions:n,buttonSets:s,buttonsVisible:i}=e;return{keypadConfiguration:VA(e),times:t,functions:n,buttonSets:s,buttonsVisible:i}},version:{major:1,minor:0},propUpgrades:{1:e=>({times:e.times,buttonSets:e.buttonSets,functions:e.functions,buttonsVisible:e.buttonsVisible,answerForms:[{considered:"correct",form:e.form,simplify:e.simplify,value:e.value,key:0}]})},Expression:BA,isLintable:!0};var HA=SA.exports,UA=n(122),GA={exports:{}},$A=(GA.exports,h.a,x.b),YA=Qh,XA=hu,ZA=sd,JA=Pf,QA=UA.a,eR=Nn.a,tR=T_,nR=HA.Expression,sR=["correct","wrong","ungraded"],iR=e=>{var t=[];e.forEach((e=>{t[e.key]=!0}));for(var n=0;n<t.length;n++)if(!t[n])return n;return t.length},rR=createReactClass({displayName:"ExpressionEditor",getDefaultProps:function(){return{answerForms:[],times:!1,buttonSets:["basic"],functions:["f","g","h"]}},getInitialState:function(){return{isTex:0===this.props.answerForms.length||this.props.answerForms.some((e=>{var{value:t}=e;return-1!==$A.indexOf(t,"\\")||-1!==$A.indexOf(t,"{")}))}},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return XA.change.apply(this,t)},render:function(){var e=this.props.answerForms.map(((e,t)=>{var n={times:this.props.times,functions:this.props.functions,buttonSets:this.props.buttonSets,buttonsVisible:"focused",form:e.form,simplify:e.simplify,value:e.value,onChange:e=>this.updateForm(t,e),trackInteraction:()=>{},widgetId:this.props.widgetId+"-"+t};return YA(e).merge([],{draggable:!0,onChange:e=>this.updateForm(t,e),onDelete:()=>this.handleRemoveForm(t),expressionProps:n}).freeze()})).map((e=>Object($t.jsx)(oR,{...e}))),t=Object($t.jsx)(QA,{components:e,onReorder:this.handleReorder,className:"answer-options-list"}),n=tR.buttonSets.map(((e,t)=>{var n="basic"===t,s=$A.contains(this.props.buttonSets,t)||n,i=n?"button-set-label-float":"button-set-label";return Object($t.jsxs)("label",{className:i,children:[Object($t.jsx)("input",{type:"checkbox",checked:s,disabled:n,onChange:()=>this.handleButtonSet(t)}),t]},t)}));return n.splice(1,1,Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"checkbox",onChange:this.handleToggleDiv}),Object($t.jsxs)("span",{className:"show-div-button",children:["show ",Object($t.jsx)(eR,{children:"\\div"})," button"]})]},"show-div")),Object($t.jsxs)("div",{className:"perseus-widget-expression-editor",children:[Object($t.jsx)("h3",{className:"expression-editor-h3",children:"Global Options"}),Object($t.jsxs)("div",{children:[Object($t.jsx)(JA,{times:this.props.times,onChange:this.props.onChange,labelAlignment:"right",label:"Use \xd7 for rendering multiplication instead of a center dot."}),Object($t.jsx)(ZA,{children:Object($t.jsx)("p",{children:"For pre-algebra problems this option displays multiplication as \\times instead of \\cdot in both the rendered output and the acceptable formats examples."})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Function variables: ",Object($t.jsx)("input",{type:"text",defaultValue:this.props.functions.join(" "),onChange:this.handleFunctions})]}),Object($t.jsx)(ZA,{children:Object($t.jsx)("p",{children:'Single-letter variables listed here will be interpreted as functions. This let us know that f(x) means "f of x" and not "f times x".'})})]}),Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:"Button sets:"}),n]}),this.state.isTex&&Object($t.jsx)(tR,{className:"math-input-buttons",sets:this.props.buttonSets,convertDotToTimes:this.props.times,onInsert:this.handleTexInsert}),Object($t.jsx)("h3",{className:"expression-editor-h3",children:"Answers"}),Object($t.jsx)("p",{style:{margin:"4px 0"},children:"student responses area matched against these from top to bottom"}),t,Object($t.jsx)("div",{children:Object($t.jsx)("button",{className:"simple-button orange",style:{fontSize:13},onClick:this.newAnswer,type:"button",children:"Add new answer"})})]})},serialize:function(){var e=["value","form","simplify","considered","key"],t=["answerForms","buttonSets","functions","times"],n=this.props.answerForms.map((t=>$A.pick(t,e)));return YA(this.props).set(["answerForms"],n).mod([],(e=>$A.pick(e,t))).freeze()},getSaveWarnings:function(){var e=[];0===this.props.answerForms.length?e.push("No answers specified"):(!!this.props.answerForms.find((e=>"correct"===e.considered))||e.push("No correct answer specified"),this.props.answerForms.forEach(((t,n)=>{if(""===this.props.value)e.push(`Answer ${n+1} is empty`);else{var s=U.parse(t.value);s.parsed?t.simplify&&!s.expr.isSimplified()&&e.push(`${t.value} isn't simplified, but is required" +\n                            " to be`):e.push(`Couldn't parse ${t.value}`)}})));return e},_newEmptyAnswerForm:function(){return{considered:"correct",form:!1,key:iR(this.props.answerForms),simplify:!1,value:""}},newAnswer:function(){var e=this.props.answerForms.slice();e.push(this._newEmptyAnswerForm()),this.change({answerForms:e})},handleRemoveForm:function(e){var t=this.props.answerForms.slice();t.splice(e,1),this.change({answerForms:t})},updateForm:function(e,t){var n=YA(this.props.answerForms).merge([e],t).freeze();this.change({answerForms:n})},handleReorder:function(e){var t=e.map((e=>{var t=$A.pick(e.props,"considered","form","simplify","value");return t.key=e.key,t}));this.change({answerForms:t})},handleButtonSet:function(e){var t=Object.keys(tR.buttonSets).filter((t=>$A.contains(this.props.buttonSets,t)!==(t===e)));this.props.onChange({buttonSets:t})},handleToggleDiv:function(){var e,t;$A.contains(this.props.buttonSets,"basic+div")?(e="basic",t="basic+div"):(e="basic+div",t="basic");var n=$A.reject(this.props.buttonSets,(e=>e===t)).concat(e);this.change("buttonSets",n)},handleTexInsert:function(e){this.refs.expression.insert(e)},handleFunctions:function(e){var t={};t.functions=$A.compact(e.target.value.split(/[ ,]+/)),this.props.onChange(t)}}),oR=createReactClass({displayName:"AnswerOption",getInitialState:function(){return{deleteFocused:!1}},handleDeleteBlur:function(){this.setState({deleteFocused:!1})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return XA.change.apply(this,t)},render:function(){var e=null;return e=this.state.deleteFocused?Object($t.jsx)("button",{type:"button",className:"simple-button orange",onClick:this.handleImSure,onBlur:this.handleDeleteBlur,children:"I'm sure!"}):Object($t.jsx)("button",{type:"button",className:"simple-button orange",onClick:this.handleDelete,children:"Delete"}),Object($t.jsxs)("div",{className:"expression-answer-option",children:[Object($t.jsx)("div",{className:"answer-handle"}),Object($t.jsxs)("div",{className:"answer-body",children:[Object($t.jsxs)("div",{className:"answer-considered",children:[Object($t.jsx)("div",{onClick:this.toggleConsidered,className:"answer-status "+this.props.considered,children:this.props.considered}),Object($t.jsx)("div",{className:"answer-expression",children:Object($t.jsx)(nR,{...this.props.expressionProps})})]}),Object($t.jsxs)("div",{className:"answer-option",children:[Object($t.jsx)(JA,{form:this.props.form,onChange:this.props.onChange,labelAlignment:"right",label:"Answer expression must have the same form."}),Object($t.jsx)(ZA,{children:Object($t.jsx)("p",{children:"The student's answer must be in the same form. Commutativity and excess negative signs are ignored."})})]}),Object($t.jsxs)("div",{className:"answer-option",children:[Object($t.jsx)(JA,{simplify:this.props.simplify,onChange:this.props.onChange,labelAlignment:"right",label:"Answer expression must be fully expanded and simplified."}),Object($t.jsx)(ZA,{children:Object($t.jsx)("p",{children:'The student\'s answer must be fully expanded and simplified. Answering this equation (x^2+2x+1) with this factored equation (x+1)^2 will render this response "Your answer is not fully expanded and simplified."'})})]}),Object($t.jsx)("div",{className:"remove-container",children:e})]})]})},handleImSure:function(){this.props.onDelete()},handleDelete:function(){this.setState({deleteFocused:!0})},toggleConsidered:function(){var e=function(e,t){var n=e.indexOf(t);return e[n=(n+1)%e.length]}(sR,this.props.considered);this.change({considered:e})}});GA.exports=rR;var aR=GA.exports,lR={exports:{}};lR.exports;h.a;const cR=x.b,hR=hu,pR=iu,uR=Ff.a,dR=sv,gR=sd,fR=Kt,mR=$P.a,bR=qd,vR=Pf,xR=Bx,yR=ce.firstNumericalParse,jR=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"\u2157"},{title:"Improper fractions",value:"improper",content:"\u2077\u2044\u2084"},{title:"Mixed numbers",value:"mixed",content:"1\xbe"},{title:"Numbers with \u03c0",value:"pi",content:"\u03c0"}],wR=e=>({value:null,status:e,message:"",simplify:"required",answerForms:[],strict:!1,maxError:null}),OR=createReactClass({displayName:"NumericInputEditor",getDefaultProps:function(){return{answers:[wR("correct")],size:"normal",coefficient:!1,labelText:"",multipleNumberInput:!1}},getInitialState:function(){return{lastStatus:"wrong",showOptions:cR.map(this.props.answers,(()=>!1))}},render:function(){var e=this.props.answers,t=t=>Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Unsimplified answers are"}),Object($t.jsx)(uR,{value:e[t].simplify,allowEmpty:!1,buttons:[{value:"required",content:"ungraded"},{value:"optional",content:"accepted"},{value:"enforced",content:"wrong"}],onChange:this.updateAnswer(t,"simplify")}),Object($t.jsxs)(gR,{children:[Object($t.jsx)("p",{children:'Normally select "ungraded". This will give the user a message saying the answer is correct but not simplified. The user will then have to simplify it and re-enter, but will not be penalized. (5th grade and after)'}),Object($t.jsx)("p",{children:'Select "accepted" only if the user is not expected to know how to simplify fractions yet. (Anything prior to 5th grade)'}),Object($t.jsxs)("p",{children:['Select "wrong" ',Object($t.jsx)("em",{children:"only"})," if we are specifically assessing the ability to simplify."]})]})]}),n=t=>Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Choose the suggested answer formats"}),Object($t.jsx)(mR,{buttons:jR,values:e[t].answerForms,onChange:this.updateAnswer(t,"answerForms")}),Object($t.jsxs)(gR,{children:[Object($t.jsx)("p",{children:'Formats will be autoselected for you based on the given answer; to show no suggested formats and accept all types, simply have a decimal/integer be the answer. Values with \u03c0 will have format "pi", and values that are fractions will have some subset (mixed will be "mixed" and "proper"; improper/proper will both be "improper" and "proper"). If you would like to specify that it is only a proper fraction (or only a mixed/improper fraction), deselect the other format. Except for specific cases, you should not need to change the autoselected formats.'}),Object($t.jsxs)("p",{children:["To restrict the answer to ",Object($t.jsx)("em",{children:"only"}),' an improper fraction (i.e. 7/4), select the improper fraction and toggle "strict" to true. This ',Object($t.jsx)("b",{children:"will not"})," "," accept 1.75 as an answer."," "]}),Object($t.jsx)("p",{children:"Unless you are testing that specific skill, please do not restrict the answer format."})]})]}),Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsx)(vR,{label:"Strictly match only these formats",strict:e[t].strict,onChange:this.updateAnswer.bind(this,t)})})]}),s=t=>Object($t.jsx)("div",{className:"perseus-widget-row",children:Object($t.jsxs)("label",{children:["Max error"," ",Object($t.jsx)(bR,{className:"max-error",value:e[t].maxError,onChange:this.updateAnswer(t,"maxError"),placeholder:"0"})]})}),i=Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("label",{children:"Width:  "}),Object($t.jsx)(uR,{value:this.props.size,allowEmpty:!1,buttons:[{value:"normal",content:"Normal (80px)"},{value:"small",content:"Small (40px)"}],onChange:this.change("size")}),Object($t.jsx)(gR,{children:Object($t.jsx)("p",{children:'Use size "Normal" for all text boxes, unless there are multiple text boxes in one line and the answer area is too narrow to fit them.'})})]}),r=Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("label",{children:["Label text:"," ",Object($t.jsx)(xR,{value:this.props.labelText,onChange:this.change("labelText")})]}),Object($t.jsx)(gR,{children:Object($t.jsx)("p",{children:"Text to describe this input. This will be shown to users using screenreaders."})})]}),o=Object($t.jsx)("div",{children:Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)(vR,{label:"Coefficient",coefficient:this.props.coefficient,onChange:this.props.onChange}),Object($t.jsx)(gR,{children:Object($t.jsx)("p",{children:"A coefficient style number allows the student to use - for -1 and an empty string to mean 1."})})]})}),a=Object($t.jsx)("div",{children:Object($t.jsx)("a",{href:"javascript:void(0)",className:"simple-button orange",onClick:()=>this.addAnswer(),onKeyDown:e=>this.onSpace(e,this.addAnswer),children:Object($t.jsx)("span",{children:"Add new answer"})})}),l={wrong:"(address the mistake/misconception)",ungraded:"(explain in detail to avoid confusion)",correct:"(reinforce the user's understanding)"};return Object($t.jsxs)("div",{className:"perseus-input-number-editor",children:[Object($t.jsx)("div",{ref:e=>this.multInputOption=e,children:Object($t.jsxs)("select",{onChange:this.onMultipleInputChange,children:[Object($t.jsx)("option",{value:"simple-numeric-input",children:"Ask for one correct solution"}),Object($t.jsx)("option",{value:"multiple-numeric-input",children:"Ask for all correct solutions"})]})}),Object($t.jsx)("div",{className:"ui-title",children:"User input"}),Object($t.jsx)("div",{className:"msg-title",children:"Message shown to user on attempt"}),(()=>e.map(((i,r)=>{var o=Object($t.jsx)(dR,{apiOptions:this.props.apiOptions,content:i.message||"",placeholder:"Why is this answer "+i.status+"?\t"+l[i.status],widgetEnabled:!1,onChange:e=>{"content"in e&&this.updateAnswer(r,{message:e.content})}});return Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsxs)("div",{className:"input-answer-editor-value-container"+(i.maxError?" with-max-error":""),children:[Object($t.jsx)(bR,{value:i.value,className:"numeric-input-value",placeholder:"answer",format:cR.last(i.answerForms),onFormatChange:(e,t)=>{var n;"pi"===t?n=["pi"]:"mixed"===t?n=["proper","mixed"]:"proper"!==t&&"improper"!==t||(n=["proper","improper"]),this.updateAnswer(r,{value:yR(e),answerForms:n})},onChange:e=>{this.updateAnswer(r,{value:yR(e)})}}),i.strict&&Object($t.jsx)("div",{className:"is-strict-indicator",title:"strictly equivalent to",children:"\u2261"}),"required"!==i.simplify&&"correct"===i.status&&Object($t.jsx)("div",{className:"simplify-indicator "+i.simplify,title:"accepts unsimplified answers",children:"\u2030"}),i.maxError?Object($t.jsxs)("div",{className:"max-error-container",children:[Object($t.jsx)("div",{className:"max-error-plusmn",children:"\xb1"}),Object($t.jsx)(bR,{placeholder:0,value:e[r].maxError,format:cR.last(i.answerForms),onChange:this.updateAnswer(r,"maxError")})]}):null,Object($t.jsx)("div",{className:"value-divider"}),Object($t.jsx)("a",{href:"javascript:void(0)",className:"answer-status "+i.status,onClick:()=>this.onStatusChange(r),onKeyDown:e=>this.onSpace(e,this.onStatusChange,r),children:i.status}),Object($t.jsx)("a",{href:"javascript:void(0)",className:"answer-trash",onClick:()=>this.onTrashAnswer(r),onKeyDown:e=>this.onSpace(e,this.onTrashAnswer,r),children:Object($t.jsx)(fR,{...ya})}),Object($t.jsx)("a",{href:"javascript:void(0)",className:"options-toggle",onClick:()=>this.onToggleOptions(r),onKeyDown:e=>this.onSpace(e,this.onToggleOptions,r),children:Object($t.jsx)(fR,{...ua})})]}),Object($t.jsx)("div",{className:"input-answer-editor-message",children:o}),this.state.showOptions[r]&&Object($t.jsxs)("div",{className:"options-container",children:[s(r),"correct"===i.status&&t(r),n(r)]})]},r)})))(),a,i,o,r]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return hR.change.apply(this,t)},onToggleOptions:function(e){var t=this.state.showOptions.slice();t[e]=!t[e],this.setState({showOptions:t})},onTrashAnswer:function(e){if(e>=0&&e<this.props.answers.length){var t=this.props.answers.slice(0);t.splice(e,1),this.props.onChange({answers:t})}},onSpace:function(e,t){if(" "===e.key){e.preventDefault();var n=cR.toArray(arguments).slice(2);t.apply(this,n)}},onStatusChange:function(e){var t=["wrong","ungraded","correct"],n=this.props.answers,s=t[(cR.indexOf(t,n[e].status)+1)%t.length];this.updateAnswer(e,{status:s,simplify:"correct"===s?"required":"accepted"})},onMultipleInputChange:function(e){"multiple-numeric-input"===e.target.value?this.props.onChange({multipleNumberInput:!0}):this.props.onChange({multipleNumberInput:!1})},updateAnswer:function(e,t){if(!cR.isObject(t))return cR.partial(((e,t,n)=>{var s={};s[t]=n,this.updateAnswer(e,s)}),e,t);if(e===(s=cR.clone(this.props.answers)).length)var n=wR(this.state.lastStatus),s=s.concat(n);s[e]=cR.extend({},s[e],t),this.props.onChange({answers:s})},addAnswer:function(){var e=wR(this.state.lastStatus),t=this.props.answers.concat(e);this.props.onChange({answers:t})},getSaveWarnings:function(){var e=[];return cR.contains(cR.pluck(this.props.answers,"value"),"")&&e.push("One or more answers is empty"),this.props.answers.forEach(((t,n)=>{t.strict&&(!t.answerForms||0===t.answerForms.length)&&e.push(`Answer ${n+1} is set to string format matching, but no format was selected`)})),e},serialize(){return pR.serialize.call(this)}});lR.exports=OR;var CR=lR.exports,SR={exports:{}};SR.exports;h.a;const kR=x.b,_R=createReactClass({displayName:"PossibleAnswers",render:function(){const e=kR.uniq(this.props.answers),t=kR.map(e,(e=>Object($t.jsx)("dd",{children:e},e)));return Object($t.jsxs)("dl",{className:"perseus-possible-answers",children:[Object($t.jsx)("dt",{children:"Correct Answer"}),t]})}});SR.exports=_R;var TR=SR.exports,MR={exports:{}},NR=(MR.exports,v.a),PR=(h.a,x.b),IR=CA;const ER=Ng;var AR=sg.parseTex,RR=TR,DR=Ss.ClassNames,FR=Ss.Options;const LR=ie,zR=Z,{keypadElementPropType:qR}=ye.a.propTypes,WR=Kt;var BR=[{title:"Integers",value:"integer",content:"6"},{title:"Decimals",value:"decimal",content:"0.75"},{title:"Proper fractions",value:"proper",content:"\u2157"},{title:"Improper fractions",value:"improper",content:"\u2077\u2044\u2084"},{title:"Mixed numbers",value:"mixed",content:"1\xbe"},{title:"Numbers with \u03c0",value:"pi",content:"\u03c0"}],VR={integer:()=>i18n._("an integer, like $6$"),proper:e=>"optional"===e.simplify?i18n._("a *proper* fraction, like $1/2$ or $6/10$"):i18n._("a *simplified proper* fraction, like $3/5$"),improper:e=>"optional"===e.simplify?i18n._("an *improper* fraction, like $10/7$ or $14/8$"):i18n._("a *simplified improper* fraction, like $7/4$"),mixed:()=>i18n._("a mixed number, like $1\\ 3/4$"),decimal:()=>i18n._("an *exact* decimal, like $0.75$"),pi:()=>i18n._("a multiple of pi, like $12\\ \\text{pi}$ or $2/3\\ \\text{pi}$")},HR=createReactClass({displayName:"NumericInput",getDefaultProps:function(){return{currentValue:"",currentMultipleValues:[""],size:"normal",apiOptions:FR.defaults,coefficient:!1,answerForms:[],labelText:"",linterContext:je,multipleNumberInput:!1}},getInitialState:function(){return{numSolutions:"no-solutions",previousValues:[""]}},getAnswerBlurb:function(e){var t,n;if(this.props.apiOptions.satStyling&&e){var s=this.simpleValidate(e);if(!(t="points"===s.type&&s.earned===s.total)){var i=PR.filter(e.answers,(e=>"correct"===e.status)),r=PR.map(i,(e=>{var t="decimal";e.answerForms&&e.answerForms[0]&&(t=e.answerForms[0]);var n=zR.toNumericString(e.value,t);return e.maxError&&(n+=" \xb1 "+zR.toNumericString(e.maxError,t)),n}));n=Object($t.jsx)(RR,{answers:r})}}return[n,t]},getClasses:function(e,t){const n={};return n["perseus-input-size-"+this.props.size]=!0,n[DR.CORRECT]=t&&e&&this.props.currentValue,n[DR.INCORRECT]=t&&!e&&this.props.currentValue,n[DR.UNANSWERED]=t&&!this.props.currentValue,n},render:function(){const e=this.props.reviewModeRubric,t=this.getAnswerBlurb(e),n=t[0],s=t[1],i=this.getClasses(s,e);var r=this.props.labelText;null!=r&&""!==r||(r=i18n._("Your answer:"));var o=NR({"perseus-widget-dropdown":!0});const a=Object($t.jsxs)("div",{children:[Object($t.jsxs)("select",{onChange:this.handleNumSolutionsChange,className:o+" "+Object(On.css)(GR.dropdown)+" "+DR.INTERACTIVE,value:this.state.numSolutions,children:[Object($t.jsx)("option",{value:"no-solutions",children:i18n._("0 solutions")}),Object($t.jsx)("option",{value:"finite-solutions",children:i18n._("Finite solutions")})]}),Object($t.jsx)(WR,{...ha,style:{marginLeft:-24,height:24,width:24}})]});var l;if(this.props.multipleNumberInput){if("no-solutions"===this.state.numSolutions)return a;{const e=Object($t.jsx)("div",{className:Object(On.css)(GR.addInputButton),onClick:this._addInput,children:"+"});l=Object($t.jsxs)("div",{children:[this.props.currentMultipleValues.map(((e,t)=>Object($t.jsxs)("div",{className:Object(On.css)(GR.numberInputContainer),children:[t>0&&Object($t.jsx)("div",{className:Object(On.css)(GR.removeInputButton),onClick:e=>this._removeInput(t,e),"aria-label":"Remove this answer",children:"-"}),this.props.apiOptions.customKeypad?Object($t.jsx)(ER,{ref:"input",value:this.props.currentMultipleValues[t],keypadElement:this.props.keypadElement,onChange:e=>this.handleMultipleInputChange(t,e),onFocus:this._handleFocus,onBlur:this._handleBlur}):Object($t.jsx)(IR,{ref:"input",value:this.props.currentMultipleValues[t],onChange:e=>this.handleMultipleInputChange(t,e),className:NR(i,Object(On.css)(GR.numberInput)),labelText:r,type:this._getInputType(),examples:this.examples(),shouldShowExamples:this.shouldShowExamples(),onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,disabled:this.props.apiOptions.readOnly,highlightLint:this.props.highlightLint})]},t))),e,"Add answer"]})}}else{if(this.props.apiOptions.customKeypad)return Object($t.jsx)(ER,{ref:"input",value:this.props.currentValue,keypadElement:this.props.keypadElement,onChange:this.handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur});l=Object($t.jsx)(IR,{ref:"input",value:this.props.currentValue,onChange:this.handleChange,className:NR(i),labelText:r,type:this._getInputType(),examples:this.examples(),shouldShowExamples:this.shouldShowExamples(),onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,disabled:this.props.apiOptions.readOnly,highlightLint:this.props.highlightLint})}return n?Object($t.jsxs)("span",{className:"perseus-input-with-answer-blurb",children:[this.props.multipleNumberInput&&a,l,n]}):this.props.apiOptions.satStyling?Object($t.jsxs)("label",{className:"perseus-input-with-label","aria-hidden":"true",children:[Object($t.jsx)("span",{className:"perseus-input-label",children:i18n.i18nDoNotTranslate("Answer:")}),this.props.multipleNumberInput&&a,l]}):Object($t.jsxs)("div",{children:[this.props.multipleNumberInput&&a,l]})},handleChange:function(e,t){this.props.onChange({currentValue:e},t),this.props.trackInteraction()},handleMultipleInputChange:function(e,t){const n=this.props.currentMultipleValues.slice();n[e]=t,this.props.onChange({currentMultipleValues:n}),this.props.trackInteraction()},handleNumSolutionsChange:function(e){const t=e.target.value;this.setState({numSolutions:t}),"no-solutions"===t?(this.setState({previousValues:this.props.currentMultipleValues}),this.props.onChange({currentMultipleValues:[]})):(this.props.onChange({currentMultipleValues:this.state.previousValues}),this.setState({previousValues:[]}))},_getInputType:function(){return this.props.apiOptions.staticRender?"tex":"text"},_handleFocus:function(){this.props.onFocus([]);const{interactionCallback:e}=this.props.apiOptions;e&&e()},_handleBlur:function(){this.props.onBlur([])},_addInput:function(){this.props.onChange({currentMultipleValues:this.props.currentMultipleValues.concat([""])})},_removeInput:function(e,t){const n=this.props.currentMultipleValues.length,s=this.props.currentMultipleValues.slice(0,e).concat(this.props.currentMultipleValues.slice(e+1,n));this.props.onChange({currentMultipleValues:s})},focus:function(){return this.refs.input.focus(),!0},focusInputPath:function(e){this.refs.input.focus()},blurInputPath:function(e){this.refs.input.blur()},getInputPaths:function(){return[[]]},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){this.props.onChange({currentValue:t},n)},getUserInput:function(){const e=this.props.multipleNumberInput;return{multInput:e,currentValue:e?this.props.currentMultipleValues:this.props.currentValue}},simpleValidate:function(e){return HR.validate(this.getUserInput(),e)},shouldShowExamples:function(){var e=0===this.props.answerForms.length,t=PR.uniq(this.props.answerForms.map((e=>e.name))).length>=PR.size(VR);return!e&&!t},examples:function(){var e=0!==this.props.answerForms.length?this.props.answerForms:PR.map(PR.keys(VR),(e=>({name:e,simplify:"required"}))),t=PR.map(e,(e=>VR[e.name](e)));return t=PR.uniq(t),[i18n._("**Your answer should be** ")].concat(t)}});PR.extend(HR,{validate:function(e,t){var n=PR.pluck(BR,"value"),s=e=>LR.number.createValidatorFunctional(e.value,{message:e.message,simplify:"correct"===e.status?e.simplify:"optional",inexact:!0,maxError:e.maxError,forms:e.strict&&e.answerForms&&0!==e.answerForms.length?e.answerForms:n}),i=AR(e.currentValue),r=PR.where(t.answers,{status:"correct"});if(e.multInput){var o=i.split(",").sort();if(r.sort(((e,t)=>e.value>t.value?1:-1)),o.length!==r.length)return{type:"points",earned:0,total:1,message:"Incorrect number of answers"};var a,l=!0;return r.forEach((function(e,n){var i=o[n];t.coefficient&&(i?"-"===i&&(i=-1):i=1);const r=s(e)(i);l=l&&r.correct,r.message&&(a=r.message)})),{type:"points",earned:l?1:0,total:1,message:a}}var c=PR.find(PR.map(r,(e=>{var n=i;return t.coefficient&&(n?"-"===n&&(n=-1):n=1),s(e)(n)})),(e=>e.correct||e.empty));if(!c){var h=[].concat(PR.where(t.answers,{status:"ungraded"}),PR.where(t.answers,{status:"wrong"}));const e=PR.find(h,(e=>s(e)(i).correct));c={empty:!!e&&"ungraded"===e.status,correct:!!e&&"correct"===e.status,message:e?e.message:null,guess:i}}return c.empty?{type:"invalid",message:c.message}:{type:"points",earned:c.correct?1:0,total:1,message:c.message}}});var UR=function(e){var t,n,s=PR.flatten(e),i=(t=s,n=PR.isEqual,PR.reduce(t,((e,t)=>PR.find(e,n.bind(null,t))?e:e.concat([t])),[]));return PR.sortBy(i,(e=>PR.keys(VR).indexOf(e.name)))};const GR=On.StyleSheet.create({addInputButton:{cursor:"pointer",display:"inline-block",border:"2px solid #71B307",backgroundColor:Jt,color:tn,fontSize:20,borderRadius:15,width:18,height:18,marginBottom:7,marginRight:8,marginTop:3,textAlign:"center",paddingTop:1},removeInputButton:{cursor:"pointer",display:"inline-block",border:`2px solid ${en}`,backgroundColor:en,color:tn,fontSize:20,borderRadius:15,width:18,height:18,marginBottom:7,marginRight:8,marginTop:4,textAlign:"center"},dropdown:{width:250,marginBottom:10,appearance:"none",backgroundColor:"transparent",border:"1px solid #BABEC2",borderRadius:4,boxShadow:"none",fontFamily:Xt,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:"2px solid #71B307",padding:"8px 25px 8px 8px"},":focus + svg":{color:"#71B307"},":disabled":{color:on},":disabled + svg":{color:on}},numberInput:{float:"right",width:170,marginBottom:10,border:"1px solid #BABEC2",borderRadius:4,padding:"9px 25px 9px 9px",":focus":{outline:"none",border:"2px solid #71B307",padding:"8px 25px 8px 8px"}},numberInputContainer:{display:"flex"}});MR.exports={name:"numeric-input",displayName:"Number text box",defaultAlignment:"inline-block",accessible:!0,widget:HR,transform:function(e){return PR.extend(PR.omit(e,"answers"),{answerForms:UR(PR.map(e.answers,(e=>PR.map(e.answerForms,(t=>({simplify:e.simplify,name:t}))))))})},isLintable:!0};var $R=MR.exports,YR={exports:{}};YR.exports;h.a;const KR=i.a,XR=x.b,ZR=ce,JR=Ju.a,QR=sd;var eD={number:{name:"Numbers",forms:"integer, decimal, proper, improper, mixed"},decimal:{name:"Decimals",forms:"decimal"},integer:{name:"Integers",forms:"integer"},rational:{name:"Fractions and mixed numbers",forms:"integer, proper, improper, mixed"},improper:{name:"Improper numbers (no mixed)",forms:"integer, proper, improper"},mixed:{name:"Mixed numbers (no improper)",forms:"integer, proper, mixed"},percent:{name:"Numbers or percents",forms:"integer, decimal, proper, improper, mixed, percent"},pi:{name:"Numbers with pi",forms:"pi"}};const tD=createReactClass({displayName:"InputNumberEditor",getDefaultProps:function(){return{value:0,simplify:"required",size:"normal",inexact:!1,maxError:.1,answerType:"number"}},handleAnswerChange:function(e){var t=ZR.firstNumericalParse(e)||0;this.props.onChange({value:t})},render:function(){var e=XR.map(eD,(function(e,t){return Object($t.jsx)("option",{value:t,children:e.name},t)}),this);return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{children:Object($t.jsxs)("label",{children:["Correct answer:"," ",Object($t.jsx)(JR,{value:""+this.props.value,onChange:this.handleAnswerChange,ref:"input"})]})}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Unsimplified answers"," ",Object($t.jsxs)("select",{value:this.props.simplify,onChange:e=>{this.props.onChange({simplify:e.target.value})},children:[Object($t.jsx)("option",{value:"required",children:"will not be graded"}),Object($t.jsx)("option",{value:"optional",children:"will be accepted"}),Object($t.jsx)("option",{value:"enforced",children:"will be marked wrong"})]})]}),Object($t.jsxs)(QR,{children:[Object($t.jsx)("p",{children:'Normally select "will not be graded". This will give the user a message saying the answer is correct but not simplified. The user will then have to simplify it and re-enter, but will not be penalized. (5th grade and anything after)'}),Object($t.jsx)("p",{children:'Select "will be accepted" only if the user is not expected to know how to simplify fractions yet. (Anything prior to 5th grade)'}),Object($t.jsx)("p",{children:'Select "will be marked wrong" only if we are specifically assessing the ability to simplify.'})]})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"checkbox",checked:this.props.inexact,onChange:e=>{this.props.onChange({inexact:e.target.checked})}})," ","Allow inexact answers"]}),Object($t.jsxs)("label",{children:[Object($t.jsx)("input",{type:"checkbox",style:{visibility:"hidden"}}),"Max error:"," ",Object($t.jsx)("input",{type:"text",disabled:!this.props.inexact,defaultValue:this.props.maxError,onBlur:e=>{var t=""+(ZR.firstNumericalParse(e.target.value)||0);e.target.value=t,this.props.onChange({maxError:t})}})]})]}),Object($t.jsxs)("div",{children:["Answer type:"," ",Object($t.jsx)("select",{value:this.props.answerType,onChange:e=>{this.props.onChange({answerType:e.target.value})},children:e}),Object($t.jsx)(QR,{children:Object($t.jsx)("p",{children:'Use the default "Numbers" unless the answer must be in a specific form (e.g., question is about converting decimals to fractions).'})})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Width"," ",Object($t.jsxs)("select",{value:this.props.size,onChange:e=>{this.props.onChange({size:e.target.value})},children:[Object($t.jsx)("option",{value:"normal",children:"Normal (80px)"}),Object($t.jsx)("option",{value:"small",children:"Small (40px)"})]})]}),Object($t.jsx)(QR,{children:Object($t.jsx)("p",{children:'Use size "Normal" for all text boxes, unless there are multiple text boxes in one line and the answer area is too narrow to fit them.'})})]})]})},focus:function(){return KR.findDOMNode(this.refs.input).focus(),!0},serialize:function(){return XR.pick(this.props,"value","simplify","size","inexact","maxError","answerType")}});YR.exports=tD;var nD=YR.exports,sD={exports:{}},iD=(sD.exports,v.a),rD=(h.a,x.b),oD=CA;const aD=Ng;var lD=sg.parseTex,cD=TR;const hD=ie,{keypadElementPropType:pD}=ye.a.propTypes;var uD=Ss.ClassNames,dD=Ss.Options,gD={number:{name:"Numbers",forms:"integer, decimal, proper, improper, mixed"},decimal:{name:"Decimals",forms:"decimal"},integer:{name:"Integers",forms:"integer"},rational:{name:"Fractions and mixed numbers",forms:"integer, proper, improper, mixed"},improper:{name:"Improper numbers (no mixed)",forms:"integer, proper, improper"},mixed:{name:"Mixed numbers (no improper)",forms:"integer, proper, mixed"},percent:{name:"Numbers or percents",forms:"integer, decimal, proper, improper, mixed, percent"},pi:{name:"Numbers with pi",forms:"pi"}},fD={integer:function(e){return i18n._("an integer, like $6$")},proper:function(e){return"optional"===e.simplify?i18n._("a *proper* fraction, like $1/2$ or $6/10$"):i18n._("a *simplified proper* fraction, like $3/5$")},improper:function(e){return"optional"===e.simplify?i18n._("an *improper* fraction, like $10/7$ or $14/8$"):i18n._("a *simplified improper* fraction, like $7/4$")},mixed:function(e){return i18n._("a mixed number, like $1\\ 3/4$")},decimal:function(e){return i18n._("an *exact* decimal, like $0.75$")},percent:function(e){return i18n._("a percent, like $12.34\\%$")},pi:function(e){return i18n._("a multiple of pi, like $12\\ \\text{pi}$ or $2/3\\ \\text{pi}$")}},mD=createReactClass({displayName:"InputNumber",getDefaultProps:function(){return{currentValue:"",size:"normal",answerType:"number",apiOptions:dD.defaults,linterContext:je}},shouldShowExamples:function(){return"number"!==this.props.answerType&&!this.props.apiOptions.staticRender},render:function(){if(this.props.apiOptions.customKeypad)return Object($t.jsx)(aD,{ref:"input",value:this.props.currentValue,keypadElement:this.props.keypadElement,onChange:this.handleChange,onFocus:this._handleFocus,onBlur:this._handleBlur});var e=this.props.reviewModeRubric,t=null,n=null;if(this.props.apiOptions.satStyling&&e){var s=this.simpleValidate(e);if(!(t="points"===s.type&&s.earned===s.total)){var i=String(e.value);e.inexact&&e.maxError&&(i+=" \xb1 "+e.maxError);var r=[i];n=Object($t.jsx)(cD,{answers:r})}}var o={};o["perseus-input-size-"+this.props.size]=!0,o[uD.CORRECT]=e&&t&&this.props.currentValue,o[uD.INCORRECT]=e&&!t&&this.props.currentValue,o[uD.UNANSWERED]=e&&!this.props.currentValue;var a=Object($t.jsx)(oD,{ref:"input",value:this.props.currentValue,onChange:this.handleChange,className:iD(o),type:this._getInputType(),examples:this.examples(),shouldShowExamples:this.shouldShowExamples(),onFocus:this._handleFocus,onBlur:this._handleBlur,id:this.props.widgetId,disabled:this.props.apiOptions.readOnly,linterContext:this.props.linterContext});return n?Object($t.jsxs)("span",{className:"perseus-input-with-answer-blurb",children:[a,n]}):a},handleChange:function(e,t){this.props.onChange({currentValue:e},t)},_getInputType:function(){return this.props.apiOptions.staticRender?"tex":"text"},_handleFocus:function(){this.props.onFocus([]);const{interactionCallback:e}=this.props.apiOptions;e&&e()},_handleBlur:function(){this.props.onBlur([])},focus:function(){return this.refs.input.focus(),!0},focusInputPath:function(e){this.refs.input.focus()},blurInputPath:function(e){this.refs.input.blur()},getInputPaths:function(){return[[]]},getGrammarTypeForPath:function(e){return"number"},setInputValue:function(e,t,n){this.props.onChange({currentValue:t},n)},getUserInput:function(){return{currentValue:this.props.currentValue}},simpleValidate:function(e,t){return t=t||function(){},mD.validate(this.getUserInput(),e,t)},examples:function(){var e=this.props.answerType,t=gD[e].forms.split(/\s*,\s*/),n=rD.map(t,(function(e){return fD[e](this.props)}),this);return[i18n._("**Your answer should be** ")].concat(n)}});rD.extend(mD,{validate:function(e,t,n){null==t.answerType&&(t.answerType="number");var s=hD.number.createValidatorFunctional(t.value,{simplify:t.simplify,inexact:t.inexact||void 0,maxError:t.maxError,forms:gD[t.answerType].forms})(lD(e.currentValue));return s.empty?{type:"invalid",message:!1===n(null,e.currentValue,s.message)?null:s.message}:{type:"points",earned:s.correct?1:0,total:1,message:s.message}}});sD.exports={name:"input-number",displayName:"Number text box (old)",defaultAlignment:"inline-block",hidden:!0,widget:mD,transform:e=>{const{simplify:t,size:n,answerType:s}=e;return{simplify:t,size:n,answerType:s}},isLintable:!0};var bD=sD.exports,vD={exports:{}};vD.exports;const xD=h.a;class yD extends xD.Component{render(){const{checked:e,correct:t}=this.props,n=`${t?i18n._("correct"):i18n._("incorrect")} ${e?i18n._("(selected)"):""}`,s=t?jD.correct:jD.incorrect;return Object($t.jsx)("div",{className:Object(On.css)(jD.text,s),children:n})}}const jD=On.StyleSheet.create({text:{alignItems:"center",display:"flex",fontSize:12,height:32,textTransform:"uppercase"},correct:{color:Jt},incorrect:{color:ln}});vD.exports=yD;var wD=vD.exports,OD={exports:{}};OD.exports;const CD=h.a;class SD extends CD.Component{render(){const e={borderColor:this.props.visible?this.props.color:"transparent"};return Object($t.jsx)("span",{className:Object(On.css)(kD.ring),style:e,children:this.props.children})}}SD.defaultProps={visible:!0,color:Jt};const kD=On.StyleSheet.create({ring:{margin:"auto",display:"inline-block",borderRadius:"50%",borderWidth:2,padding:2,borderStyle:"solid"}});OD.exports=SD;var _D=OD.exports,TD={exports:{}};TD.exports;const MD=h.a,ND=Kt,PD=_D;class ID extends MD.Component{constructStyles(e,t,n){let s,i=hn,r=hn;return e?t?(i=pn,r=n?tn:pn,s=n?pn:tn):n&&(i=dn,r=tn,s=dn):n&&(r=tn,s=hn),{color:r,backgroundColor:s,borderColor:i}}render(){const{letter:e,a11yText:t,reviewMode:n,checked:s,correct:i}=this.props,{color:r,backgroundColor:o,borderColor:a}=this.constructStyles(n,i,s);return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:Object(On.css)(RD.satCircle),style:{backgroundColor:o,borderColor:a}}),Object($t.jsxs)("div",{style:{color:r},className:Object(On.css)(RD.letter),children:[Object($t.jsx)("span",{className:"perseus-sr-only",children:t}),Object($t.jsx)("span",{"aria-hidden":"true",children:e})]})]})}}class ED extends MD.Component{getChoiceInner(){const{letter:e,showCorrectness:t,correct:n}=this.props;return t?n?Object($t.jsx)(ND,{...na,style:{position:"relative",top:-1}}):Object($t.jsx)(ND,{...wa}):e}getDynamicStyles(){const{checked:e,showCorrectness:t,pressed:n,primaryProductColor:s,correct:i}=this.props;if(!t&&n)return{borderColor:s,color:s,backgroundColor:tn};if(e){const e=t&&i?Jt:s;return{color:tn,backgroundColor:e,borderColor:e}}return{borderColor:on,color:on}}render(){const{checked:e,showCorrectness:t,correct:n,focused:s,primaryProductColor:i}=this.props;return Object($t.jsx)(PD,{color:i,visible:s,children:Object($t.jsx)("div",{style:this.getDynamicStyles(),className:Object(On.css)(RD.libraryCircle,t&&n&&RD.libraryCircleCorrect,t&&!n&&RD.libraryCircleIncorrect,t&&!n&&e&&RD.libraryCircleIncorrectSelected),"data-is-radio-icon":!0,children:this.getChoiceInner()})})}}class AD extends MD.Component{a11yText(e){return this.props.checked?this.props.showCorrectness?this.props.correct?i18n._("(Choice %(letter)s, Checked, Correct)",{letter:e}):i18n._("(Choice %(letter)s, Checked, Incorrect)",{letter:e}):i18n._("(Choice %(letter)s, Checked)",{letter:e}):this.props.showCorrectness&&this.props.correct?i18n._("(Choice %(letter)s, Correct Answer)",{letter:e}):i18n._("(Choice %(letter)s)",{letter:e})}getLetter(){const e=i18n._("A B C D E F G H I J K L M N O P Q R S T U V W X Y Z").split(" "),t=this.props.pos;return t<e.length?e[t]:" "}render(){const{reviewMode:e,checked:t,correct:n,product:s,showCorrectness:i,pressed:r,focused:o,primaryProductColor:a}=this.props,l=this.getLetter();return"sat"===s?Object($t.jsx)(ID,{letter:l,a11yText:this.a11yText(l),reviewMode:e,checked:t,correct:n}):Object($t.jsx)(ED,{letter:l,a11yText:this.a11yText(l),reviewMode:e,checked:t,pressed:r,focused:o,correct:n,showCorrectness:i,primaryProductColor:a})}}AD.defaultProps={primaryProductColor:Jt};const RD=On.StyleSheet.create({satCircle:{display:"block",borderRadius:25,borderStyle:"solid",borderWidth:2,content:"''",height:25,width:25,position:"absolute",top:1,left:1},libraryCircle:{width:24,height:24,boxSizing:"border-box",borderRadius:24,borderStyle:"solid",borderWidth:2,fontFamily:Xt,fontWeight:"bold",fontSize:12,display:"flex",alignItems:"center",justifyContent:"center",lineHeight:"1px"},libraryCircleCorrect:{fontSize:24},libraryCircleIncorrect:{fontSize:24,borderColor:ln,color:ln},libraryCircleIncorrectSelected:{backgroundColor:ln,color:tn},letter:{border:"2px solid transparent",width:25,height:25,position:"absolute",left:1,top:1,display:"flex",alignItems:"center",justifyContent:"center",fontFamily:Zt,fontSize:13}});TD.exports=AD;var DD=TD.exports,FD={exports:{}};FD.exports;h.a,x.b;const LD=createReactClass({displayName:"ToggleableRadioButton",handleClick:function(e){this.props.onChecked(!this.props.checked)},handleKeyUp:function(e){" "===e.key&&(this.props.onChecked(!this.props.checked),e.preventDefault())},handleChange:function(e){!this.props.checked&&e.target.checked&&this.props.onChecked(!0)},handleKeyDown:function(e){" "===e.key&&e.preventDefault()},render:function(){const{inputRef:e,onChecked:t,...n}=this.props;return Object($t.jsx)("input",{...n,type:"radio",onChange:this.handleChange,onClick:this.handleClick,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,ref:this.props.inputRef})}});FD.exports=LD;var zD=FD.exports,qD={exports:{}};qD.exports;x.b,h.a;const WD=v.a,BD=uh,VD=ch,HD=zD,UD=DD,GD=wD,$D={backgroundColor:"#E4F3F9",outline:"2px solid #0084CE",zIndex:1},YD="16px 16px",KD="12px 16px",XD=createReactClass({displayName:"Choice",statics:{styles:On.StyleSheet.create({pos:{display:"none"},description:{display:"inline-block",width:"100%"},satDescription:{display:"block",position:"relative",boxSizing:"border-box",cursor:"pointer",marginLeft:0,padding:"17px 14px"},satDescriptionInputFocused:{...$D},satDescriptionInputActive:{...$D,backgroundColor:"#D0EDF4"},satDescriptionCorrect:{color:pn},satDescriptionCorrectChecked:{backgroundColor:"#E4F7E4"},satDescriptionIncorrectChecked:{color:dn,backgroundColor:"#F2EBEB"},input:{display:"inline-block",width:20,margin:3,marginLeft:-20,marginRight:0,float:"none"},satReviewInput:{pointerEvents:"none"},satRadioOptionContent:{userSelect:"text",display:"block",marginLeft:45,cursor:"inherit"},satReviewRadioOptionContent:{fontWeight:"bold"},satCheckboxOptionContent:{position:"absolute",display:"block",top:"50%",margin:"-16px 0 0 0",width:"auto"},choiceIconWrapper:{display:"flex",marginRight:12,flexShrink:0},optionStatusContainer:{display:"block"},rationale:{display:"block"},nonSatRationale:{padding:YD,paddingTop:0,marginLeft:44,[VD.smOrSmaller]:{padding:KD,paddingTop:0}},satReviewRationale:{marginTop:13,marginLeft:45},label:{display:"block"},responsiveLabel:{WebkitTapHighlightColor:"transparent",display:"flex"},satLabel:{cursor:"pointer"},intermediateResponsiveCheckbox:{display:"flex",alignItems:"center",padding:YD,[VD.smOrSmaller]:{padding:KD}},intermediateResponsiveCheckboxReview:{alignItems:"flex-start"},crossOutLink:{textAlign:"right",alignSelf:"center",width:100}})},getDefaultProps:function(){return{checked:!1,classSet:{},disabled:!1,editMode:!1,showRationale:!1,type:"radio",pos:0}},getInitialState:function(){return{isInputFocused:!1,isInputActive:!1}},componentWillUpdate(e){this.state.isInputFocused&&e.disabled&&this.setState({isInputFocused:!1})},onInputFocus:function(){this.setState({isInputFocused:!0})},onInputBlur:function(){this.setState({isInputFocused:!1})},onInputMouseDown:function(e){"mousedown"===e.type&&this.justFinishedTouch||(this.setState({isInputActive:!0}),this.props.apiOptions.satStyling&&this._input&&this._input.focus())},onInputMouseUp:function(e){if("mouseup"!==e.type||!this.justFinishedTouch){if("touchend"===e.type)return this.justFinishedTouch=!0,void setTimeout((()=>{this.setState({isInputActive:!1}),this.justFinishedTouch=!1}),10);this.setState({isInputActive:!1}),this.props.apiOptions.satStyling&&this._input&&this._input.focus()}},onInputMouseOut:function(){this.setState({isInputActive:!1})},inputRef:function(e){this._input=e},renderOptionStatus(){const{correct:e,checked:t,reviewMode:n}=this.props;if(n&&!this.props.apiOptions.satStyling)return Object($t.jsx)(GD,{checked:t,correct:e})},renderChoiceIcon(){const{radioStyleVersion:e,primaryProductColor:t}=this.props.apiOptions.styling;return"undefined"!==typeof e&&"final"===e||this.props.apiOptions.satStyling?Object($t.jsx)(UD,{pos:this.props.pos,correct:this.props.correct,pressed:this.state.isInputActive,focused:this.state.isInputFocused,checked:this.props.checked,showCorrectness:this.props.showCorrectness,reviewMode:this.props.reviewMode,product:this.props.apiOptions.satStyling?"sat":"library",primaryProductColor:t}):null},_toggleCrossOut:function(){!this.props.crossedOut?this._sendChange({checked:!1,crossedOut:!0}):this._sendChange({crossedOut:!1})},_sendChange:function(e){const t=null!=e.checked?e.checked:this.props.checked,n=null!=e.crossedOut?e.crossedOut:this.props.crossedOut;this.props.onChange({checked:t,crossedOut:n})},render:function(){const e=XD.styles,t=this.props.apiOptions.satStyling,n=this.props.apiOptions.isMobile,{radioStyleVersion:s}=this.props.apiOptions.styling,i="undefined"!==typeof s&&"final"===s,r=WD(this.props.className,"checkbox-label",Object(On.css)(e.label,n&&BD.disableTextSelection,!t&&e.responsiveLabel,t&&e.satLabel)),o={type:this.props.type,name:this.props.groupName,id:`${this.props.groupName}-choice-${this.props.pos}`,checked:this.props.checked,disabled:this.props.disabled,onFocus:this.onInputFocus,onBlur:this.onInputBlur,className:Object(On.css)(!i&&BD.perseusInteractive,!i&&e.input,!i&&BD.responsiveInput,!i&&!t&&BD.responsiveRadioInput,!i&&!t&&this.state.isInputActive&&BD.responsiveRadioInputActive,i&&BD.perseusSrOnly,t&&BD.perseusSrOnly,t&&this.props.reviewMode&&e.satReviewInput)};let a=null;a="radio"===this.props.type?Object($t.jsx)(HD,{onChecked:e=>{this._sendChange({checked:e})},inputRef:this.inputRef,...o}):Object($t.jsx)("input",{onChange:e=>{this._sendChange({checked:e.target.checked})},ref:this.inputRef,...o});const{reviewMode:l,correct:c,checked:h,isLastChoice:p}=this.props,u=t&&l&&c,d=t&&l&&!c&&h,g=WD("description",u&&"sat-correct",d&&"sat-incorrect",Object(On.css)(!t&&e.description,t&&this.state.isInputFocused&&e.satDescriptionInputFocused,t&&this.state.isInputActive&&e.satDescriptionInputActive,t&&e.satDescription,u&&e.satDescriptionCorrect,u&&h&&e.satDescriptionCorrectChecked,d&&e.satDescriptionIncorrectChecked,t&&p&&e.satDescriptionLastChoice)),f=WD("checkbox",Object(On.css)(BD.perseusInteractive,!t&&e.choiceIconWrapper,t&&e.satCheckboxOptionContent)),m=WD("checkbox-and-option",Object(On.css)(!t&&e.intermediateResponsiveCheckbox,!t&&l&&e.intermediateResponsiveCheckboxReview)),b=WD("perseus-radio-rationale-content",Object(On.css)(e.rationale,!t&&e.nonSatRationale,t&&e.satReviewRationale)),v=this.props.editMode?"div":"label",x=!this.props.showCorrectness&&!t&&document.location.href.indexOf("PERSEUS-HACK-SHOW-CROSS-OUT")>=0,y=!t&&!l&&this.props.apiOptions.readOnly||x&&this.props.crossedOut;return Object($t.jsxs)(v,{htmlFor:!this.props.editMode&&o.id,className:r,style:{opacity:y?.5:1},children:[Object($t.jsxs)("div",{className:g,onMouseDown:this.onInputMouseDown,onMouseUp:this.onInputMouseUp,onMouseOut:this.onInputMouseOut,onTouchStart:this.onInputMouseDown,onTouchEnd:this.onInputMouseUp,children:[Object($t.jsxs)("div",{className:m,children:[Object($t.jsxs)("span",{className:f,children:[a,this.renderChoiceIcon()]}),Object($t.jsxs)("span",{className:WD(Cs.RADIO.OPTION_CONTENT,Cs.INTERACTIVE,Object(On.css)(t&&e.satRadioOptionContent,t&&l&&e.satReviewRadioOptionContent)),style:{cursor:"default"},children:[Object($t.jsx)("div",{className:Object(On.css)(e.optionStatusContainer),children:this.renderOptionStatus()}),Object($t.jsx)("div",{children:this.props.content})]})]}),this.props.showRationale&&Object($t.jsx)("div",{className:b,children:this.props.rationale})]}),x&&Object($t.jsx)("a",{href:"javascript:void 0",onClick:this._toggleCrossOut,className:Object(On.css)(e.crossOutLink),children:this.props.crossedOut?i18n.i18nDoNotTranslate("Uncross out"):i18n.i18nDoNotTranslate("Cross out")})]})}});qD.exports=XD;var ZD=qD.exports,JD={exports:{}};JD.exports;const QD=v.a,eF=(h.a,i.a),tF=x.b,nF=Ss.ClassNames,sF=ah,iF=uh,rF=ch,oF=ce.captureScratchpadTouchStart,aF=ZD,lF=createReactClass({displayName:"ChoiceNoneAbove",getDefaultProps:function(){return{showContent:!0}},render:function(){const e=tF.extend({},this.props,{className:QD(this.props.className,"none-of-above"),content:this.props.showContent?this.props.content:Object($t.jsx)(sF,{content:i18n._("None of the above")},"noneOfTheAboveRenderer")});return Object($t.jsx)(aF,{...e})}}),cF=createReactClass({displayName:"BaseRadio",statics:{styles:On.StyleSheet.create({instructions:{display:"block",color:an,fontSize:14,lineHeight:1.25,fontStyle:"normal",fontWeight:"bold",marginBottom:16},instructionsMobile:{fontSize:18,[rF.smOrSmaller]:{fontSize:16},[rF.xl]:{fontSize:20}},radio:{width:"100%"},responsiveRadioContainer:{borderBottom:"1px solid #BABEC2",borderTop:"1px solid #BABEC2",width:"auto",[rF.smOrSmaller]:{marginLeft:mn,marginRight:mn}},radioContainerFirstHighlighted:{borderTop:"1px solid rgba(0, 0, 0, 0)"},radioContainerLastHighlighted:{borderBottom:"1px solid rgba(0, 0, 0, 0)"},satRadio:{background:"none",marginLeft:0,userSelect:"none"},satRadioOption:{margin:0,padding:0,borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc"}},satRadioOptionCorrect:{borderBottomColor:un,":first-child":{borderTopColor:un}},satRadioOptionIncorrect:{borderBottomColor:gn,":first-child":{borderTopColor:gn}},satRadioOptionNextCorrect:{borderBottomColor:un},satRadioOptionNextIncorrect:{borderBottomColor:gn},satReviewRadioOption:{pointerEvents:"none"},item:{marginLeft:20},inlineItem:{display:"inline-block",paddingLeft:20,verticalAlign:"middle"},responsiveItem:{marginLeft:0,padding:0,":not(:last-child)":{borderBottom:"1px solid #BABEC2"}},selectedItem:{background:"white"},aboveBackdrop:{position:"relative",zIndex:1062},aboveBackdropMobile:{boxShadow:"0 0 4px 0 rgba(0, 0, 0, 0.2),0 0 2px 0 rgba(0, 0, 0, 0.1)",":not(:last-child)":{borderBottom:"1px solid rgba(0, 0, 0, 0)"}},nextHighlighted:{":not(:last-child)":{borderBottom:"1px solid rgba(0, 0, 0, 0)"}},responsiveContainer:{overflow:"auto",marginLeft:mn,marginRight:mn,paddingLeft:fn},responsiveFieldset:{paddingRight:fn}})},getDefaultProps:function(){return{editMode:!1}},getInitialState:function(){return{radioGroupName:tF.uniqueId("perseus_radio_")}},updateChoice:function(e,t){let n;n=t.checked&&!this.props.multipleSelect?this.props.choices.map((e=>!1)):this.props.choices.map((e=>e.checked));const s=this.props.choices.map((e=>e.crossedOut));n[e]=t.checked,s[e]=t.crossedOut,this.props.onChange({checked:n,crossedOut:s})},focus:function(e){return eF.findDOMNode(this.refs["radio"+(e||0)]).focus(),!0},getInstructionsText:function(){return this.props.multipleSelect?this.props.countChoices?i18n._("Choose %(numCorrect)s answers:",{numCorrect:this.props.numCorrect}):i18n._("Choose all answers that apply:"):i18n._("Choose 1 answer:")},deselectEnabled:function(){return this.props.apiOptions.isMobile||this.props.deselectEnabled},render:function(){const e=this.props.multipleSelect?"checkbox":"radio",t=this.props.reviewModeRubric,n=!!t,s=cF.styles,i=this.props.apiOptions.satStyling,r=this.props.apiOptions.isMobile,o=this.props.choices,a=o[0].highlighted,l=o[o.length-1].highlighted,c=QD("perseus-widget-radio",!this.props.editMode&&"perseus-rendered-radio",Object(On.css)(s.radio,!i&&s.responsiveRadioContainer,!i&&a&&r&&s.radioContainerFirstHighlighted,!i&&l&&r&&s.radioContainerLastHighlighted,i&&s.satRadio)),h=QD("instructions",Object(On.css)(s.instructions,r&&s.instructionsMobile)),p=this.getInstructionsText(),u=!i,d=Object(On.css)(s.responsiveFieldset),g=Object($t.jsxs)("fieldset",{className:`perseus-widget-radio-fieldset ${d}`,children:[Object($t.jsx)("legend",{className:"perseus-sr-only",children:p}),u&&Object($t.jsx)("div",{className:h,children:p}),Object($t.jsx)("ul",{className:c,children:this.props.choices.map((function(r,o){let a=aF;const l={ref:`radio${o}`,apiOptions:this.props.apiOptions,checked:r.checked,crossedOut:r.crossedOut,reviewMode:n,correct:r.correct,rationale:r.rationale,content:r.content,disabled:this.props.apiOptions.readOnly||r.disabled,editMode:this.props.editMode,groupName:this.state.radioGroupName,isLastChoice:o===this.props.choices.length-1,showCorrectness:n||!!r.showCorrectness,showRationale:r.hasRationale&&(n||r.showRationale),type:e,pos:o,deselectEnabled:this.deselectEnabled(),onChange:e=>{this.updateChoice(o,e)}};r.isNoneOfTheAbove&&(a=lF,tF.extend(l,{showContent:r.revealNoneOfTheAbove}));const c=this.props.choices[o+1],h=!!c&&c.highlighted,p=e=>{const o=i&&n&&e,a=i&&n&&c&&c.checked;return Object(On.css)(iF.aboveScratchpad,s.item,!i&&s.responsiveItem,!i&&e&&s.selectedItem,!i&&e&&r.highlighted&&s.aboveBackdrop,!i&&e&&r.highlighted&&this.props.apiOptions.isMobile&&s.aboveBackdropMobile,!i&&h&&this.props.apiOptions.isMobile&&s.nextHighlighted,i&&s.satRadioOption,o&&!r.correct&&s.satRadioOptionIncorrect,o&&r.correct&&s.satRadioOptionCorrect,a&&!c.correct&&s.satRadioOptionNextIncorrect,a&&c.correct&&s.satRadioOptionNextCorrect,i&&t&&s.satReviewRadioOption)};p(!0);const u=QD(p(r.checked),nF.RADIO.OPTION,r.checked&&nF.RADIO.SELECTED,n&&t.choices[o].correct&&nF.CORRECT,n&&!t.choices[o].correct&&nF.INCORRECT);let d=null,g=null;return this.props.editMode&&(g=e=>{let t=e.target;for(;t&&t!==d;){if(t.getAttribute("data-is-radio-icon"))return void this.updateChoice(o,{checked:!r.checked});t=t.parentNode}}),Object($t.jsx)("li",{ref:e=>d=e,className:u,onClick:g,onTouchStart:this.props.labelWrap?oF:null,children:Object($t.jsx)(a,{...l})},o)}),this)})]});return Object($t.jsx)("div",{className:Object(On.css)(!i&&s.responsiveContainer),children:g})}});JD.exports=cF;var hF=JD.exports,pF={exports:{}},uF=(pF.exports,h.a,x.b),dF=hF,gF=hu,fF=sv,mF=Kt,bF=Pf,vF=createReactClass({displayName:"ChoiceEditor",render:function(){var e=this.props.choice.correct?"correct":"incorrect",t="Type a choice here...";this.props.choice.isNoneOfTheAbove&&(t=this.props.choice.correct?"Type the answer to reveal to the user...":"None of the above");var n=Object($t.jsx)(fF,{ref:"content-editor",apiOptions:this.props.apiOptions,content:this.props.choice.content||"",widgetEnabled:!1,placeholder:t,disabled:this.props.choice.isNoneOfTheAbove&&!this.props.choice.correct,onChange:this.props.onContentChange}),s=Object($t.jsx)(fF,{ref:"clue-editor",apiOptions:this.props.apiOptions,content:this.props.choice.clue||"",widgetEnabled:!1,placeholder:i18n._(`Why is this choice ${e}?`),onChange:this.props.onClueChange}),i=Object($t.jsx)("a",{className:"simple-button orange delete-choice",href:"#",onClick:this.props.onDelete,title:"Remove this choice",children:Object($t.jsx)(mF,{...ya})});return Object($t.jsxs)("div",{className:"choice-clue-editors",children:[Object($t.jsx)("div",{className:`choice-editor ${e}`,children:n}),Object($t.jsx)("div",{className:"clue-editor",children:s}),this.props.showDelete&&i]})}}),xF=createReactClass({displayName:"RadioEditor",getDefaultProps:function(){return{choices:[{},{}],displayCount:null,randomize:!1,hasNoneOfTheAbove:!1,multipleSelect:!1,countChoices:!1,deselectEnabled:!1}},render:function(){var e=uF.reduce(this.props.choices,(function(e,t){return t.correct?e+1:e}),0);return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{className:"perseus-widget-row",children:[Object($t.jsx)("a",{href:"https://docs.google.com/document/d/1frZf7yrWVWb1n4tVjqlzqVUiv1pn4cZXbxgP62-JDBY/edit#heading=h.8ng1isya19nu",target:"_blank",children:"Multiple choice style guide"}),Object($t.jsx)("br",{}),Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(bF,{label:"Multiple selections",labelAlignment:"right",multipleSelect:this.props.multipleSelect,onChange:this.onMultipleSelectChange})}),Object($t.jsx)("div",{className:"perseus-widget-right-col",children:Object($t.jsx)(bF,{label:"Randomize order",labelAlignment:"right",randomize:this.props.randomize,onChange:this.props.onChange})}),this.props.multipleSelect&&Object($t.jsx)("div",{className:"perseus-widget-left-col",children:Object($t.jsx)(bF,{label:"Specify number correct",labelAlignment:"right",countChoices:this.props.countChoices,onChange:this.onCountChoicesChange})})]}),Object($t.jsx)(dF,{ref:"baseRadio",multipleSelect:this.props.multipleSelect,countChoices:this.props.countChoices,numCorrect:e,editMode:!0,labelWrap:!1,apiOptions:this.props.apiOptions,choices:this.props.choices.map((function(e,t){return{content:Object($t.jsx)(vF,{ref:`choice-editor${t}`,apiOptions:this.props.apiOptions,choice:e,onContentChange:e=>{"content"in e&&this.onContentChange(t,e.content)},onClueChange:e=>{"content"in e&&this.onClueChange(t,e.content)},onDelete:this.onDelete.bind(this,t),showDelete:this.props.choices.length>=2}),isNoneOfTheAbove:e.isNoneOfTheAbove,checked:e.correct}}),this),onChange:this.onChange}),Object($t.jsxs)("div",{className:"add-choice-container",children:[Object($t.jsxs)("a",{className:"simple-button orange",href:"#",onClick:this.addChoice.bind(this,!1),children:[Object($t.jsx)(mF,{...fa})," Add a choice"," "]}),!this.props.hasNoneOfTheAbove&&Object($t.jsxs)("a",{className:"simple-button",href:"#",onClick:this.addChoice.bind(this,!0),children:[Object($t.jsx)(mF,{...fa})," None of the above"," "]})]})]})},change(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return gF.change.apply(this,t)},onMultipleSelectChange:function(e){e=e.multipleSelect;var t=uF.reduce(this.props.choices,(function(e,t){return t.correct?e+1:e}),0);if(!e&&t>1){var n=uF.map(this.props.choices,(function(e){return uF.defaults({correct:!1},e)}));this.props.onChange({multipleSelect:e,choices:n})}else this.props.onChange({multipleSelect:e})},onCountChoicesChange:function(e){e=e.countChoices,this.props.onChange({countChoices:e})},onChange:function(e){let{checked:t}=e;var n=uF.map(this.props.choices,((e,n)=>uF.extend({},e,{correct:t[n],content:e.isNoneOfTheAbove&&!t[n]?"":e.content})));this.props.onChange({choices:n})},onContentChange:function(e,t){var n=this.props.choices.slice();n[e]=uF.extend({},n[e],{content:t}),this.props.onChange({choices:n})},onClueChange:function(e,t){var n=this.props.choices.slice();n[e]=uF.extend({},n[e],{clue:t}),""===t&&delete n[e].clue,this.props.onChange({choices:n})},onDelete:function(e,t){t.preventDefault();var n=this.props.choices.slice(),s=n[e];n.splice(e,1),this.props.onChange({choices:n,hasNoneOfTheAbove:this.props.hasNoneOfTheAbove&&!s.isNoneOfTheAbove})},addChoice:function(e,t){t.preventDefault();var n=this.props.choices.slice(),s={isNoneOfTheAbove:e},i=n.length-(this.props.hasNoneOfTheAbove?1:0);n.splice(i,0,s),this.props.onChange({choices:n,hasNoneOfTheAbove:e||this.props.hasNoneOfTheAbove},(()=>{this.refs[`choice-editor${i}`].refs["content-editor"].focus()}))},setDisplayCount:function(e){this.props.onChange({displayCount:e})},focus:function(){return this.refs["choice-editor0"].refs["content-editor"].focus(),!0},getSaveWarnings:function(){return uF.some(uF.pluck(this.props.choices,"correct"))?[]:["No choice is marked as correct."]},serialize:function(){return uF.pick(this.props,"choices","randomize","multipleSelect","countChoices","displayCount","hasNoneOfTheAbove","deselectEnabled")}});pF.exports=xF;var yF=pF.exports,jF={exports:{}};jF.exports;h.a;const wF=x.b,OF=ah,CF=Hj,SF=ce,kF=hF,_F=createReactClass({displayName:"Radio",getDefaultProps:function(){return{choices:[{}],displayCount:null,multipleSelect:!1,countChoices:!1,deselectEnabled:!1,linterContext:je}},_renderRenderer:function(e){let t=1;const n={},s=(e=e||"").replace(/\{\{passage-ref (\d+) (\d+)(?: "([^"]*)")?\}\}/g,((e,s,i,r)=>{const o="passage-ref "+t;return t++,n[o]={type:"passage-ref",graded:!1,options:{passageNumber:parseInt(s),referenceNumber:parseInt(i),summaryText:r},version:CF.version},"[["+SF.snowman+" "+o+"]]"}));return Object($t.jsx)(OF,{content:s,widgets:n,findExternalWidgets:this.props.findWidgets,alwaysUpdate:!0,linterContext:this.props.linterContext},"choiceContentRenderer")},focus:function(e){return this.refs.baseRadio.focus(e)},updateChoices:function(e){const{choiceStates:t,choices:n}=this.props;let s;s=t?t.map((e=>({...e}))):n.map((()=>({selected:!1,crossedOut:!1,highlighted:!1,rationaleShown:!1,correctnessShown:!1,readOnly:!1}))),s.forEach(((t,n)=>{t.selected=e.checked[n],t.crossedOut=e.crossedOut[n]})),this.props.onChange({choiceStates:s}),this.props.trackInteraction()},getUserInput:function(){if(this.props.choiceStates){let e=null,t=!1;const n=this.props.choiceStates,s=n.map((()=>!1)),i=this.props.countChoices,r=this.props.numCorrect;for(let o=0;o<s.length;o++){const i=this.props.choices[o].originalIndex;s[i]=n[o].selected,this.props.choices[o].isNoneOfTheAbove&&(e=i,s[o]&&(t=!0))}return{countChoices:i,choicesSelected:s,numCorrect:r,noneOfTheAboveIndex:e,noneOfTheAboveSelected:t}}if(this.props.values){let e=null,t=!1;const n=this.props.values.slice(),s=this.props.countChoices,i=this.props.numCorrect;for(let r=0;r<this.props.values.length;r++){const s=this.props.choices[r].originalIndex;n[s]=this.props.values[r],this.props.choices[r].isNoneOfTheAbove&&(e=s,n[r]&&(t=!0))}return{choicesSelected:n,noneOfTheAboveIndex:e,noneOfTheAboveSelected:t,countChoices:s,numCorrect:i}}return{choicesSelected:wF.map(this.props.choices,(()=>!1))}},simpleValidate:function(e){return _F.validate(this.getUserInput(),e)},enforceOrdering:function(e){const t=wF.pluck(e,"content");return wF.isEqual(t,[i18n._("False"),i18n._("True")])||wF.isEqual(t,[i18n._("No"),i18n._("Yes")])?[e[1]].concat([e[0]]):e},showRationalesForCurrentlySelectedChoices(e){if(this.props.choiceStates){const t=this.simpleValidate(e),n="points"===t.type&&t.total===t.earned,s=this.props.choiceStates.map((e=>({...e,highlighted:e.selected,rationaleShown:e.selected||e.rationaleShown||n,readOnly:e.selected||e.readOnly||n,correctnessShown:e.selected||e.correctnessShown})));this.props.onChange({choiceStates:s},null,!0)}},deselectIncorrectSelectedChoices(){if(this.props.choiceStates){const e=this.props.choiceStates.map(((e,t)=>({...e,selected:e.selected&&!!this.props.choices[t].correct,highlighted:!1})));this.props.onChange({choiceStates:e},null,!1)}},render:function(){let e,t=this.props.choices;return e=this.props.static?wF.map(t,(e=>({selected:e.correct,crossedOut:e.crossedOut,readOnly:!0,highlighted:!1,rationaleShown:!0,correctnessShown:!0}))):this.props.choiceStates?this.props.choiceStates:this.props.values?wF.map(this.props.values,(e=>({selected:e,crossedOut:!1,readOnly:!1,highlighted:!1,rationaleShown:!1,correctnessShown:!1}))):wF.map(t,(()=>({selected:!1,crossedOut:!1,readOnly:!1,highlighted:!1,rationaleShown:!1,correctnessShown:!1}))),t=wF.map(t,((t,n)=>{const s=t.isNoneOfTheAbove&&!t.content?i18n._("None of the above"):t.content,{selected:i,crossedOut:r,rationaleShown:o,correctnessShown:a,readOnly:l,highlighted:c}=e[n],h=this.props.reviewModeRubric&&this.props.reviewModeRubric.choices[n];return{content:this._renderRenderer(s),checked:i,correct:"undefined"===typeof t.correct?!!h&&h.correct:t.correct,disabled:l,hasRationale:!!t.clue,rationale:this._renderRenderer(t.clue),showRationale:o,showCorrectness:a,isNoneOfTheAbove:t.isNoneOfTheAbove,revealNoneOfTheAbove:this.props.questionCompleted&&i,crossedOut:r,highlighted:c}})),t=this.enforceOrdering(t),Object($t.jsx)(kF,{ref:"baseRadio",labelWrap:!0,multipleSelect:this.props.multipleSelect,countChoices:this.props.countChoices,numCorrect:this.props.numCorrect,choices:t,onChange:this.updateChoices,reviewModeRubric:this.props.reviewModeRubric,deselectEnabled:this.props.deselectEnabled,apiOptions:this.props.apiOptions})}});wF.extend(_F,{validate:function(e,t){const n=wF.reduce(e.choicesSelected,((e,t)=>e+(t?1:0)),0);if(0===n)return{type:"invalid",message:null};if(e.countChoices&&n!==e.numCorrect)return{type:"invalid",message:i18n._("Please choose the correct number of answers.")};if(e.noneOfTheAboveSelected&&n>1)return{type:"invalid",message:i18n._("'None of the above' may not be selected when other answers are selected.")};return{type:"points",earned:wF.all(e.choicesSelected,(function(n,s){let i;return i=e.noneOfTheAboveIndex===s?wF.all(t.choices,(function(e,t){return s===t||!e.correct})):!!t.choices[s].correct,i===n}))?1:0,total:1,message:null}}}),jF.exports=_F;var TF=jF.exports,MF={exports:{}},NF=(MF.exports,x.b),PF=ce.shuffle,IF=TF,EF=(e,t)=>{const n=((e,t)=>{var n,s=e.choices.slice();return s=NF.map(s,((e,t)=>NF.extend({},e,{originalIndex:t,correct:Boolean(e.correct)}))),function(e){var t=null,n=NF.reject(e,(function(e,n){if(e.isNoneOfTheAbove)return t=e,!0}));return t&&n.push(t),n}((n=s,e.randomize?PF(n,t):n))})(e,t),s=NF.reduce(e.choices,(function(e,t){return t.correct?e+1:e}),0),{hasNoneOfTheAbove:i,multipleSelect:r,countChoices:o,correctAnswer:a,deselectEnabled:l}=e;return{numCorrect:s,hasNoneOfTheAbove:i,multipleSelect:r,countChoices:o,correctAnswer:a,deselectEnabled:l,choices:n,selectedChoices:NF.pluck(n,"correct")}},AF={1:e=>{var t,n;if(e.noneOfTheAbove){t=NF.clone(e.choices);var s=NF.random(0,e.choices.length-1),i=NF.extend({},e.choices[s],{isNoneOfTheAbove:!0});t.splice(s,1),t.push(i),n=!0}else t=e.choices,n=!1;return NF.extend(NF.omit(e,"noneOfTheAbove"),{choices:t,hasNoneOfTheAbove:n})}};MF.exports={name:"radio",displayName:"Multiple choice",accessible:!0,widget:IF,transform:EF,staticTransform:EF,version:{major:1,minor:0},propUpgrades:AF,isLintable:!0};var RF=[[MF.exports,yF],[bD,nD],[$R,CR],[HA,aR]],DF={exports:{}};DF.exports;const FF=RF,LF=oA;DF.exports=FF.concat(LF);var zF=DF.exports,qF=n(41);const WF=qF;Fs.registerMany(zF);WF.apiVersion,WF.itemDataVersion;const BF=lA;var VF={apiVersion:WF.apiVersion,itemDataVersion:WF.itemDataVersion,init:lA,ArticleRenderer:Zp,QuestionRenderer:qp,ItemRenderer:Fp,ServerItemRenderer:kp,HintsRenderer:Rh,Renderer:ah,MultiItems:hp},HF={exports:{}};HF.exports;const UF=x.b,GF="unchanged",$F="changed",YF="added",KF="removed",XF=function(e,t,n){return"object"===typeof e||"object"===typeof t?function(e,t,n){const s=UF.isObject(e)?Object.keys(e):[],i=UF.isObject(t)?Object.keys(t):[],r=UF.union(s,i),o=UF.map(r,(function(n){return XF((e||{})[n],(t||{})[n],n)}));let a;a=void 0===e?YF:void 0===t?KF:UF.any(o,(function(e){return e.status!==GF}))?$F:GF;return{after:"",before:"",children:o,key:n,status:a}}(e,t,n):function(e,t,n){let s;return s=e===t?GF:void 0===e?YF:void 0===t?KF:$F,{after:JSON.stringify(t),before:JSON.stringify(e),children:[],key:n,status:s}}(e,t,n)};HF.exports=XF;var ZF=HF.exports,JF={exports:{}};JF.exports;const QF=v.a,eL=(h.a,x.b),tL=ZF,nL=Sc,sL=function(e){return 20*(e-1)},iL="before",rL="after",oL=createReactClass({displayName:"DiffSide",render:function(){const e=QF(this.props.className,{"diff-row":!0,before:this.props.side===iL,after:this.props.side===rL});return Object($t.jsx)("div",{className:e,children:Object($t.jsxs)("div",{style:{paddingLeft:sL(this.props.depth)},children:[this.props.showKey&&this.props.propKey+": ",Object($t.jsx)("span",{className:"inner-value dark "+this.props.className,children:this.props.value})]})})}}),aL=createReactClass({displayName:"CollapsedRow",getDefaultProps:function(){return{depth:0}},render:function(){const e=this;return Object($t.jsx)("div",{onClick:e.props.onClick,style:{clear:"both"},children:eL.map([iL,rL],(function(t){return Object($t.jsx)("div",{className:"diff-row collapsed "+t,children:Object($t.jsx)("div",{style:{paddingLeft:sL(e.props.depth)},children:Object($t.jsx)("span",{children:" [ show unmodified ] "})})},t)}))})}}),lL=createReactClass({displayName:"DiffEntry",getDefaultProps:function(){return{depth:0}},getInitialState:function(){return{expanded:this.props.expanded}},expand:function(){this.setState({expanded:!0})},render:function(){const e=this.props.entry,t="removed"===e.status,n="added"===e.status,s="changed"===e.status,i=e.children.length>0,r=QF({removed:t||s&&!i,dark:t,"blank-space":n}),o=QF({added:n||s&&!i,dark:n,"blank-space":t});let a;a=this.state.expanded?e.children:eL.select(e.children,(function(e){return"unchanged"!==e.status}));let l=a.length<e.children.length;e.children.length===a.length+1&&(a=e.children,l=!1);const c=this;return Object($t.jsxs)("div",{children:[e.key&&Object($t.jsxs)("div",{style:{clear:"both"},children:[Object($t.jsx)(oL,{side:iL,className:r,depth:this.props.depth,propKey:e.key,showKey:!n,value:e.before}),Object($t.jsx)(oL,{side:rL,className:o,depth:this.props.depth,propKey:e.key,showKey:!t,value:e.after})]}),eL.map(a,(function(e){return Object($t.jsx)(lL,{depth:c.props.depth+1,entry:e,expanded:c.state.expanded},e.key)})),l&&Object($t.jsx)(aL,{depth:this.props.depth+1,onClick:this.expand})]})}}),cL=createReactClass({displayName:"ImageWidgetDiff",render:function(){const{before:e,after:t}=this.props,n=e.options&&e.options.backgroundImage?e.options.backgroundImage.url:"",s=t.options&&t.options.backgroundImage?t.options.backgroundImage.url:"";return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"diff-row before",children:n&&Object($t.jsx)("div",{className:QF({image:!0,"image-unchanged":n===s,"image-removed":n!==s}),children:Object($t.jsx)(nL,{src:n,title:n})})}),Object($t.jsx)("div",{className:"diff-row after",children:s&&Object($t.jsx)("div",{className:QF({image:!0,"image-unchanged":n===s,"image-added":n!==s}),children:Object($t.jsx)(nL,{src:s,title:s})})})]})}}),hL=createReactClass({displayName:"WidgetDiff",getDefaultProps:function(){return{after:{},before:{},type:""}},render:function(){const{after:e,before:t,title:n,type:s}=this.props,i=tL(t,e);return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"diff-header",children:n}),Object($t.jsx)("div",{className:"diff-header",children:n}),Object($t.jsxs)("div",{className:"diff-body ui-helper-clearfix",children:["image"===s&&Object($t.jsx)(cL,{before:t,after:e}),Object($t.jsx)(lL,{entry:i})]})]})}});JF.exports=hL;var pL=JF.exports,uL=function(){function e(e){return{newPos:e.newPos,components:e.components.slice(0)}}function t(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t}function n(e){var t=e;return t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")}var s=function(e){this.ignoreWhitespace=e};s.prototype={diff:function(t,n){if(n===t)return[{value:n}];if(!n)return[{value:t,removed:!0}];if(!t)return[{value:n,added:!0}];n=this.tokenize(n),t=this.tokenize(t);var s=n.length,i=t.length,r=s+i,o=[{newPos:-1,components:[]}],a=this.extractCommon(o[0],n,t,0);if(o[0].newPos+1>=s&&a+1>=i)return o[0].components;for(var l=1;l<=r;l++)for(var c=-1*l;c<=l;c+=2){var h,p=o[c-1],u=o[c+1];a=(u?u.newPos:0)-c,p&&(o[c-1]=void 0);var d=p&&p.newPos+1<s,g=u&&0<=a&&a<i;if(d||g){!d||g&&p.newPos<u.newPos?(h=e(u),this.pushComponent(h.components,t[a],void 0,!0)):((h=e(p)).newPos++,this.pushComponent(h.components,n[h.newPos],!0,void 0));a=this.extractCommon(h,n,t,c);if(h.newPos+1>=s&&a+1>=i)return h.components;o[c]=h}else o[c]=void 0}},pushComponent:function(e,t,n,s){var i=e[e.length-1];i&&i.added===n&&i.removed===s?e[e.length-1]={value:this.join(i.value,t),added:n,removed:s}:e.push({value:t,added:n,removed:s})},extractCommon:function(e,t,n,s){for(var i=t.length,r=n.length,o=e.newPos,a=o-s;o+1<i&&a+1<r&&this.equals(t[o+1],n[a+1]);)o++,a++,this.pushComponent(e.components,t[o],void 0,void 0);return e.newPos=o,a},equals:function(e,t){var n=/\S/;return!(!this.ignoreWhitespace||n.test(e)||n.test(t))||e===t},join:function(e,t){return e+t},tokenize:function(e){return e}};var i=new s,r=new s(!0),o=new s;r.tokenize=o.tokenize=function(e){return t(e.split(/(\s+|\b)/))};var a=new s(!0);a.tokenize=function(e){return t(e.split(/([{}:;,]|\s+)/))};var l=new s;return l.tokenize=function(e){for(var t=[],n=e.split(/^/m),s=0;s<n.length;s++){var i=n[s],r=n[s-1];"\n"==i&&r&&"\r"===r[r.length-1]?t[t.length-1]+="\n":i&&t.push(i)}return t},{Diff:s,diffChars:function(e,t){return i.diff(e,t)},diffWords:function(e,t){return r.diff(e,t)},diffWordsWithSpace:function(e,t){return o.diff(e,t)},diffLines:function(e,t){return l.diff(e,t)},diffCss:function(e,t){return a.diff(e,t)},createPatch:function(e,t,n,s,i){var r=[];r.push("Index: "+e),r.push("==================================================================="),r.push("--- "+e+("undefined"===typeof s?"":"\t"+s)),r.push("+++ "+e+("undefined"===typeof i?"":"\t"+i));var o=l.diff(t,n);function a(e){return e.map((function(e){return" "+e}))}function c(e,t,n){var s=o[o.length-2],i=t===o.length-2,r=t===o.length-3&&(n.added!==s.added||n.removed!==s.removed);/\n$/.test(n.value)||!i&&!r||e.push("\\ No newline at end of file")}o[o.length-1].value||o.pop(),o.push({value:"",lines:[]});for(var h=0,p=0,u=[],d=1,g=1,f=0;f<o.length;f++){var m=o[f],b=m.lines||m.value.replace(/\n$/,"").split("\n");if(m.lines=b,m.added||m.removed){if(!h){var v=o[f-1];h=d,p=g,v&&(h-=(u=a(v.lines.slice(-4))).length,p-=u.length)}u.push.apply(u,b.map((function(e){return(m.added?"+":"-")+e}))),c(u,f,m),m.added?g+=b.length:d+=b.length}else{if(h)if(b.length<=8&&f<o.length-2)u.push.apply(u,a(b));else{var x=Math.min(b.length,4);r.push("@@ -"+h+","+(d-h+x)+" +"+p+","+(g-p+x)+" @@"),r.push.apply(r,u),r.push.apply(r,a(b.slice(0,x))),b.length<=4&&c(r,f,m),h=0,p=0,u=[]}d+=b.length,g+=b.length}}return r.join("\n")+"\n"},applyPatch:function(e,t){for(var n=t.split("\n"),s=[],i=!1,r=!1,o="I"===n[0][0]?4:0;o<n.length;o++)if("@"===n[o][0]){var a=n[o].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);s.unshift({start:a[3],oldlength:a[2],oldlines:[],newlength:a[4],newlines:[]})}else"+"===n[o][0]?s[0].newlines.push(n[o].substr(1)):"-"===n[o][0]?s[0].oldlines.push(n[o].substr(1)):" "===n[o][0]?(s[0].newlines.push(n[o].substr(1)),s[0].oldlines.push(n[o].substr(1))):"\\"===n[o][0]&&("+"===n[o-1][0]?i=!0:"-"===n[o-1][0]&&(r=!0));var l=e.split("\n");for(o=s.length-1;o>=0;o--){for(var c=s[o],h=0;h<c.oldlength;h++)if(l[c.start-1+h]!==c.oldlines[h])return!1;Array.prototype.splice.apply(l,[c.start-1,+c.oldlength].concat(c.newlines))}if(i)for(;!l[l.length-1];)l.pop();else r&&l.push("");return l.join("\n")},convertChangesToXML:function(e){for(var t=[],s=0;s<e.length;s++){var i=e[s];i.added?t.push("<ins>"):i.removed&&t.push("<del>"),t.push(n(i.value)),i.added?t.push("</ins>"):i.removed&&t.push("</del>")}return t.join("")},convertChangesToDMP:function(e){for(var t,n=[],s=0;s<e.length;s++)t=e[s],n.push([t.added?1:t.removed?-1:0,t.value]);return n}}}(),dL=uL,gL={exports:{}};gL.exports;const fL=dL,mL=x.b,bL=function(e){return e.added?"added":e.removed?"removed":"unchanged"},vL=e=>mL.map(e.value,(t=>({value:t,status:bL(e)}))),xL=new fL.Diff;xL.tokenize=e=>mL.map(e,(e=>[e])),xL.join=(e,t)=>e.concat(t),xL.equals=mL.isEqual;const yL=e=>{return t=e,n=vL,mL.flatten(mL.map(t,n),!0);var t,n};gL.exports=function(e,t){const n=xL.diff(e,t),s=yL(n);return{before:mL.filter(s,(e=>"added"!==e.status)),after:mL.filter(s,(e=>"removed"!==e.status))}};var jL=gL.exports,wL={exports:{}};wL.exports;const OL=x.b;wL.exports=function(e){const t=[];let n=[];return OL.each(e,(e=>{const s=e.value.split("\n");OL.each(s,((s,i)=>{i>0&&(t.push(n),n=[]);const r=OL.extend({},e,{value:s});n.push(r)}))})),n.length&&t.push(n),t};var CL=wL.exports,SL={exports:{}};SL.exports;const kL=v.a,_L=(h.a,x.b),TL=dL,ML=CL,NL=jL,PL=Sc,IL="before",EL="after",AL=/http.*?\.png|web\+graphie[^)]*/g,RL=function(e){return e.match(AL)||[]},DL=function(e,t,n){return e.added?t:e.removed?n:""},FL=createReactClass({displayName:"ImageDiffSide",render:function(){return Object($t.jsx)("div",{children:_L.map(this.props.images,((e,t)=>{const n=kL({image:!0,"image-unchanged":"unchanged"===e.status,"image-added":"added"===e.status,"image-removed":"removed"===e.status});return Object($t.jsx)("div",{children:Object($t.jsx)("div",{className:n,children:Object($t.jsx)(PL,{src:e.value,title:e.value})})},t)}))})}}),LL=createReactClass({displayName:"TextDiff",getDefaultProps:function(){return{after:"",before:""}},getInitialState:function(){return{collapsed:this.props.before===this.props.after}},componentWillReceiveProps:function(e){this.setState({collapsed:e.before===e.after})},handleExpand:function(){this.setState({collapsed:!1})},render:function(){const e=TL.diffWords(this.props.before,this.props.after),t=ML(e),n=RL(this.props.before),s=RL(this.props.after),i=NL(n,s),r=_L.map(t,(e=>{const t={};return t.before=_L.map(e,(function(e,t){return Object($t.jsx)("span",{className:DL(e,"not-present","removed dark"),children:e.value},t)})),t.after=_L.map(e,(function(e,t){return Object($t.jsx)("span",{className:DL(e,"added dark","not-present"),children:e.value},t)})),t})),o=kL({"diff-row":!0,collapsed:this.state.collapsed});return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:"diff-header",children:this.props.title}),Object($t.jsx)("div",{className:"diff-header",children:this.props.title}),Object($t.jsx)("div",{className:"diff-body ui-helper-clearfix",children:_L.map([IL,EL],((e,t)=>Object($t.jsxs)("div",{className:"diff-row "+e,children:[!this.state.collapsed&&_L.map(r,((t,n)=>{const s=t[e].length>1,i=kL({"diff-line":!0,added:e===EL&&s,removed:e===IL&&s});return Object($t.jsx)("div",{className:i,children:t[e]},n)})),!this.state.collapsed&&Object($t.jsx)(FL,{images:i[e]})]},t)))}),_L.map([IL,EL],((e,t)=>Object($t.jsx)("div",{className:o+" "+e,onClick:this.handleExpand,children:this.state.collapsed&&Object($t.jsx)("span",{children:Object($t.jsxs)("span",{className:"expand-button",children:[" ","[ show unmodified ]"]})})},t)))]})}});SL.exports=LL;var zL=SL.exports,qL={exports:{}};qL.exports;h.a;const WL=x.b,BL=zL,VL=pL,HL=Fs,UL=function(e,t){const{alignment:n,graded:s,options:i,type:r}=e||{},o={options:i};return t&&HL.getSupportedAlignments(r).length>1&&(o.alignment=n),"transformer"===r&&(o.graded=s),HL.supportsStaticMode(r)&&(o.static=e.static||void 0),o},GL=createReactClass({displayName:"RendererDiff",getDefaultProps:function(){return{after:{content:"",images:{},widgets:{}},before:{content:"",images:{},widgets:{}},showAlignmentOptions:!1,showSeparator:!1}},render:function(){const{after:e,before:t,showAlignmentOptions:n,showSeparator:s,title:i}=this.props;let r,o;(t.content||e.content)&&(r=Object($t.jsx)(BL,{before:t.content,after:e.content,title:i}));const a=Object.keys(t.widgets).filter((e=>t.content.includes(e))),l=Object.keys(e.widgets).filter((t=>e.content.includes(t)));if(a.length||l.length){o=WL.union(a,l).map((s=>Object($t.jsx)(VL,{before:UL(t.widgets[s],n),after:UL(e.widgets[s],n),title:s,type:(t.widgets[s]||{}).type||(e.widgets[s]||{}).type},s)))}return Object($t.jsxs)("div",{children:[r,o,s&&Object($t.jsx)("div",{className:"diff-separator"})]})}});qL.exports=GL;var $L=qL.exports,YL={exports:{}};YL.exports;h.a;const KL=x.b,XL=$L,ZL=createReactClass({displayName:"ArticleDiff",getInitialState:function(){return this._stateFromProps(this.props)},componentWillReceiveProps:function(e){this.setState(this._stateFromProps(e))},_stateFromProps:function(e){const{before:t,after:n}=e;return{before:Array.isArray(t)?t:[t],after:Array.isArray(n)?n:[n]}},render:function(){const{before:e,after:t}=this.state,n=Math.max(e.length,t.length),s=KL.times(n,(s=>Object($t.jsx)(XL,{before:s<e.length?e[s]:void 0,after:s<t.length?t[s]:void 0,title:`Section ${s+1}`,showAlignmentOptions:!0,showSeparator:s<n-1},s)));return Object($t.jsx)("div",{className:"framework-perseus",children:s})}});YL.exports=ZL;var JL=YL.exports,QL={exports:{}};QL.exports;const ez=JL;class tz extends c.Component{constructor(){super(...arguments),this.state={swapped:!1},this.swap=()=>this.setState({swapped:!this.state.swapped})}render(){const{swapped:e}=this.state;return Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"button",value:"Swap it!",onClick:this.swap}),Object($t.jsx)("div",{className:"perseus-diff",children:Object($t.jsx)(ez,{before:e?sz:nz,after:e?nz:sz})})]})}}const nz=[{content:"**What kind of structure is highlighted in green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)![](https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png)\n\nHow  many apples? [[\u2603 numeric-input 1]]\n\n[[\u2603 image 1]]\n\nWhat's the structure? [[\u2603 dropdown 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png":{width:397,height:397}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!0,maxError:1}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"image 1":{type:"image",alignment:"float-right",static:!1,graded:!0,options:{static:!1,title:"",range:[[0,10],[0,10]],box:[4288,2848],backgroundImage:{url:"https://ka-perseus-images.s3.amazonaws.com/f17ea8bfb4944b18ef2a3f61cc5a378a9d0b4900.jpg",width:4288,height:2848},labels:[],alt:"Freshly baked chocolate chip cookies on a cooling rack. ",caption:"*You might use stoichiometry skills to double a cookie recipe! Image credit: [Chocolate Chip Cookies](https://commons.wikimedia.org/wiki/File%3AChocolate_Chip_Cookies_-_kimberlykv.jpg) by Kimberley Vardeman on Wikimedia Commons, [CC-BY 2.0](https://creativecommons.org/licenses/by/2.0/deed.en)*"},version:{major:0,minor:0}},"dropdown 1":{type:"dropdown",alignment:"default",static:!1,graded:!0,options:{static:!1,placeholder:"",choices:[{content:"line segment",correct:!1},{content:"line",correct:!0},{content:"ray",correct:!1}]},version:{major:0,minor:0}}}}],sz=[{content:"**What kind of structure is highlighted in dashed green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)\n![](web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73)\n\nHow  many apples? [[\u2603 numeric-input 1]]\n\n[[\u2603 image 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73":{width:300,height:300}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!1,errorBounds:{minError:.1,maxError:1}}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"image 1":{type:"image",alignment:"float-right",static:!1,graded:!0,options:{static:!1,title:"",range:[[0,10],[0,10]],box:[4288,2848],backgroundImage:{url:"https://ka-perseus-images.s3.amazonaws.com/07d9e88e1dfccf69ec79f2eec619b886d81cd949.jpg",width:1536,height:2048},labels:[],alt:"Strawberry ice cream in a cone. ",caption:"*You might use stoichiometry skills to double an ice cream recipe! Image credit: [Ice Cream](https://commons.wikimedia.org/wiki/File%3ASoft_Ice_cream.jpg) by Kimberley Vardeman on Wikimedia Commons, [CC-BY 2.0](https://creativecommons.org/licenses/by/2.0/deed.en)*"},version:{major:0,minor:0}}}},{content:"A second section",images:{},widgets:{}}];QL.exports=tz;var iz=QL.exports,rz={exports:{}};rz.exports;h.a;const oz=x.b,az=$L,lz=pL,cz=createReactClass({displayName:"ItemDiff",render:function(){const{before:e,after:t}=this.props,n=Math.max(e.hints.length,t.hints.length),s=Object($t.jsx)(az,{before:e.question,after:t.question,title:"Question",showAlignmentOptions:!1,showSeparator:!0}),i=Object($t.jsx)(lz,{before:e.answerArea,after:t.answerArea,title:"Question extras"}),r=oz.times(n,(function(s){return Object($t.jsx)(az,{before:s<e.hints.length?e.hints[s]:void 0,after:s<t.hints.length?t.hints[s]:void 0,title:`Hint ${s+1}`,showAlignmentOptions:!1,showSeparator:s<n-1},s)}));return Object($t.jsxs)("div",{className:"framework-perseus",children:[s,i,r&&Object($t.jsx)("div",{className:"diff-separator"}),r]})}});rz.exports=cz;var hz=rz.exports,pz={exports:{}};pz.exports;const uz=hz;class dz extends c.Component{constructor(){super(...arguments),this.state={swapped:!1},this.swap=()=>this.setState({swapped:!this.state.swapped})}render(){const{swapped:e}=this.state;return Object($t.jsxs)("div",{children:[Object($t.jsx)("input",{type:"button",value:"Swap it!",onClick:this.swap}),Object($t.jsx)("div",{className:"perseus-diff",children:Object($t.jsx)(uz,{before:e?fz:gz,after:e?gz:fz})})]})}}const gz={question:{content:"**What kind of structure is highlighted in green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)![](https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png)\n\nHow  many apples? [[\u2603 numeric-input 1]]\nWhat's the structure? [[\u2603 dropdown 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"https://ka-perseus-graphie.s3.amazonaws.com/a10ab9f9b66982637bd1cf1e3cfe493562144e15.png":{width:397,height:397}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!0,maxError:null}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"dropdown 1":{type:"dropdown",alignment:"default",static:!1,graded:!0,options:{static:!1,placeholder:"",choices:[{content:"line segment",correct:!1},{content:"line",correct:!0},{content:"ray",correct:!1}]},version:{major:0,minor:0}}}},answerArea:{calculator:!0},hints:[{content:"The highlighted part of the diagram has no starting point and no ending point; it continues forever in both directions, like this: \n\n![](https://ka-perseus-graphie.s3.amazonaws.com/2b6f0a4700f9fd840e5049de8c1f88206134fde1.png)",widgets:{}},{content:"A straight, one-dimensional structure continuing forever in both directions is called a *line*.",widgets:{}},{content:"The structure highlighted in green is a line.",widgets:{}}]},fz={question:{content:"**What kind of structure is highlighted in dashed green in the diagram shown?**\n \n![](https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png)\n![](web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73)\n\nHow  many apples? [[\u2603 numeric-input 1]]\nWhat's the structure? [[\u2603 dropdown 1]]",images:{"https://ka-perseus-graphie.s3.amazonaws.com/07dace481175322baa244b35d112968977d19da3.png":{width:250,height:150},"web+graphie://ka-perseus-graphie.s3.amazonaws.com/70b65362dbffa72a371b2829549015149caaba73":{width:300,height:300}},widgets:{"numeric-input 1":{type:"numeric-input",alignment:"default",static:!1,graded:!0,options:{static:!1,answers:[{value:8,status:"correct",message:"",simplify:"required",answerForms:["integer"],strict:!1,maxError:null}],size:"normal",coefficient:!1,labelText:""},version:{major:0,minor:0}},"dropdown 1":{type:"dropdown",alignment:"default",static:!1,graded:!0,options:{static:!1,placeholder:"",choices:[{content:"line segment",correct:!0},{content:"line",correct:!1},{content:"ray",correct:!1}]},version:{major:0,minor:0}}}},answerArea:{calculator:!1},hints:[{content:"The highlighted part _of the diagram_ has *no* starting point and *no* ending point; it continues forever in both directions, like this: \n\n![](https://ka-perseus-graphie.s3.amazonaws.com/2b6f0a4700f9fd840e5049de8c1f88206134fde1.png)",widgets:{}},{content:"A straight, one-dimensional structure continuing forever in both directions is called a *line*.",widgets:{}},{content:"The structure highlighted in green is a line.",widgets:{}}]};pz.exports=dz;var mz=pz.exports,bz={exports:{}};bz.exports;h.a;const vz=createReactClass({displayName:"SimpleButton",getDefaultProps:function(){return{children:null,color:"green",onClick:()=>{}}},render:function(){const{children:e,color:t,onClick:n,...s}=this.props;return Object($t.jsx)("div",{className:Object(On.css)(xz.baseButton,xz[t]),onClick:n,...s,children:e})}}),xz=On.StyleSheet.create({baseButton:{top:"0",fontSize:"11px",padding:"3px 10px",backgroundRepeat:"repeat-x",borderColor:"\n            rgba(0, 0, 0, 0.1)\n            rgba(0, 0, 0, 0.1)\n            rgba(0, 0, 0, 0.25)\n        ",color:"#ffffff",borderRadius:"3px",lineHeight:"15px",cursor:"pointer",transition:"box-shadow ease-in-out 0.15s",appearance:"none",textDecoration:"none",textAlign:"center",":hover":{boxShadow:"0 1px 1px rgba(0, 0, 0, 0.35),\n                inset 0 0 50px 5px rgba(255, 255, 255, 0.2)"}},green:{border:"1px solid #7fab07",backgroundColor:"#80ac07",backgroundImage:"linear-gradient(to bottom, #8aba08, #719807)",":hover":{borderBottomColor:"#547105",backgroundColor:"#719807"}},orange:{border:"1px solid #d45704",backgroundColor:"#d55704",backgroundImage:"linear-gradient(to bottom, #e35d04, #c04f03)",":hover":{borderBottomColor:"#983e03",bakgroundColor:"#c04f03"}}});bz.exports=vz;var yz=bz.exports,jz={exports:{}};jz.exports,h.a;const wz=x.b;var Oz=createReactClass({displayName:"JsonEditor",getInitialState:function(){return{currentValue:JSON.stringify(this.props.value,null,4),valid:!0}},componentWillReceiveProps:function(e){(!this.state.valid||!wz.isEqual(e.value,JSON.parse(this.state.currentValue)))&&this.setState(this.getInitialState())},render:function(){var e="perseus-json-editor "+(this.state.valid?"valid":"invalid");return Object($t.jsx)("textarea",{className:e,value:this.state.currentValue,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur})},handleKeyDown:function(e){if("Tab"===e.key){var t=e.target.selectionStart,n=e.target.value,s=n.substring(0,t),i=n.substring(t,n.length);e.target.value=s+"    "+i,e.target.selectionStart=s.length+4,e.target.selectionEnd=s.length+4,e.preventDefault(),this.handleChange(e)}},handleChange:function(e){var t=e.target.value;try{var n=JSON.parse(t);wz.isString(n)&&(n=JSON.parse(n)),this.setState({currentValue:t,valid:!0},(function(){this.props.onChange(n)}))}catch(s){this.setState({currentValue:t,valid:!1})}},handleBlur:function(e){var t=e.target.value;try{var n=JSON.parse(t);wz.isString(n)&&(n=JSON.parse(n)),this.setState({currentValue:JSON.stringify(n,null,4),valid:!0},(function(){this.props.onChange(n)}))}catch(s){this.setState({currentValue:JSON.stringify(this.props.value,null,4),valid:!0})}}});jz.exports=Oz;var Cz=jz.exports,Sz={exports:{}};Sz.exports;h.a;let kz=0;const _z={},Tz={};window.iframeDataStore={},window.addEventListener("message",(e=>{if("string"===typeof e.data){const t=_z[e.data];t&&t()}else e.data.id&&(void 0!==e.data.height?Tz[e.data.id](e.data.height):e.data.lintWarnings&&console.log("LINTER REPORT",e.data.lintWarnings))}));const Mz=createReactClass({displayName:"IframeContentRenderer",componentDidMount:function(){this.iframeID=kz,kz++,this._prepareFrame(),_z[this.iframeID]=()=>{this.sendNewData(this._lastData)},Tz[this.iframeID]=e=>{this._lastHeight=e,this.isMounted()&&this.props.seamless&&(this.refs.container.style.height=e+"px")}},shouldComponentUpdate:function(e){return e.content!==this.props.content||e.datasetValue!==this.props.datasetValue||e.seamless!==this.props.seamless},componentDidUpdate:function(e){this.props.seamless?this.refs.container.style.height=this._lastHeight+"px":this.refs.container.style.height="100%",e.content===this.props.content&&e.datasetValue===this.props.datasetValue||this._prepareFrame()},componentWillUnmount:function(){_z[this.iframeID]=null,Tz[this.iframeID]=null},_prepareFrame:function(){this._frame&&this.refs.container.removeChild(this._frame),this._frame=document.createElement("iframe"),this._frame.style.width="100%",this._frame.style.height="100%",this.props.datasetKey&&(this._frame.dataset[this.props.datasetKey]=this.props.datasetValue),this._frame.dataset.id=this.iframeID,this.props.seamless&&(this._frame.dataset.lintGutter=!0),this._frame.onload=()=>{this._frame.onload=null,setTimeout((()=>{this._frame.contentWindow.document.open(),this._frame.contentWindow.document.write(this.props.content),this._frame.contentWindow.document.close()}))},this.refs.container.appendChild(this._frame)},sendNewData:function(e){this.isMounted()&&e&&(this._lastData=e,window.iframeDataStore[this.iframeID]=e,this._frame.contentWindow.postMessage(this.iframeID,"*"))},render:function(){return Object($t.jsx)("div",{ref:"container",style:{width:"100%",height:"100%"}})}});Sz.exports=Mz;var Nz=Sz.exports;const Pz={PHONE:"phone",TABLET:"tablet",DESKTOP:"desktop"};var Iz={devices:Pz,lintGutterWidth:36,perseusFrameBorderWidth:1},Ez={exports:{}};Ez.exports;h.a;const Az=Iz,Rz={phone:{width:320,height:480,framedWidth:320},tablet:{width:750,height:920,framedWidth:525},desktop:{width:688,height:600,framedWidth:688}},Dz=createReactClass({displayName:"DeviceFramer",render:function(){const e=this.props.deviceType;if(this.props.nochrome)return Object($t.jsx)("div",{children:Object($t.jsx)("div",{style:{width:Rz[e].framedWidth+2*Az.perseusFrameBorderWidth+Az.lintGutterWidth},children:Object($t.jsx)("div",{children:this.props.children})},"screen")});{const t=Rz[e].framedWidth/Rz[e].width,n={backgroundColor:"white",color:"black",textAlign:"left",width:Rz[e].width,height:Rz[e].height,border:"solid 1px #CCC",margin:8,zoom:t};return Object($t.jsx)("div",{className:"screen",style:n,children:this.props.children},"screen")}}});Ez.exports=Dz;var Fz=Ez.exports,Lz=(h.a,x.b),zz=sd;const qz=Kt,Wz=createReactClass({displayName:"HintEditor",getDefaultProps:function(){return{content:"",replace:!1,showMoveButtons:!0,showTitle:!0,showRemoveButton:!0}},handleChange:function(e){this.props.onChange({replace:e.target.checked})},render:function(){return Object($t.jsxs)("div",{className:"perseus-hint-editor "+this.props.className,children:[this.props.showTitle&&Object($t.jsx)("div",{className:"pod-title",children:"Hint"}),Object($t.jsx)(sv,{ref:"editor",apiOptions:this.props.apiOptions,widgets:this.props.widgets,content:this.props.content,images:this.props.images,replace:this.props.replace,placeholder:"Type your hint here...",imageUploader:this.props.imageUploader,onChange:this.props.onChange}),Object($t.jsxs)("div",{className:"hint-controls-container clearfix",children:[this.props.showMoveButtons&&Object($t.jsxs)("span",{className:"reorder-hints",children:[Object($t.jsx)("button",{type:"button",className:this.props.isLast?"hidden":"",onClick:Lz.partial(this.props.onMove,1),children:Object($t.jsx)(qz,{...oa})})," ",Object($t.jsx)("button",{type:"button",className:this.props.isFirst?"hidden":"",onClick:Lz.partial(this.props.onMove,-1),children:Object($t.jsx)(qz,{...aa})})," ",this.props.isLast&&Object($t.jsx)(zz,{children:Object($t.jsx)("p",{children:"The last hint is automatically bolded."})})]}),Object($t.jsx)("input",{type:"checkbox",checked:this.props.replace,onChange:this.handleChange}),"Replace previous hint",this.props.showRemoveButton&&Object($t.jsxs)("button",{type:"button",className:"remove-hint simple-button orange",onClick:this.props.onRemove,children:[Object($t.jsx)(qz,{...ya}),"Remove this hint"," "]})]})]})},focus:function(){this.refs.editor.focus()},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(e){return this.refs.editor.serialize(e)}}),Bz=createReactClass({displayName:"CombinedHintEditor",getDefaultProps:function(){return{highlightLint:!1}},updatePreview:function(){},componentDidMount:function(){this.updatePreview()},componentDidUpdate:function(){this.updatePreview()},render:function(){"phone"===this.props.deviceType||this.props.deviceType;return Object($t.jsxs)("div",{className:"perseus-combined-hint-editor perseus-editor-row",children:[Object($t.jsx)("div",{className:"perseus-editor-left-cell",children:Object($t.jsx)(Wz,{ref:"editor",isFirst:this.props.isFirst,isLast:this.props.isLast,widgets:this.props.hint.widgets,content:this.props.hint.content,images:this.props.hint.images,replace:this.props.hint.replace,imageUploader:this.props.imageUploader,onChange:this.props.onChange,onRemove:this.props.onRemove,onMove:this.props.onMove,apiOptions:this.props.apiOptions})}),Object($t.jsx)("div",{className:"perseus-editor-right-cell",children:Object($t.jsx)(ah,{apiOptions:this.props.apiOptions,...this.props.hint})})]})},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(e){return this.refs.editor.serialize(e)},focus:function(){this.refs.editor.focus()}});var Vz=createReactClass({displayName:"CombinedHintsEditor",statics:{HintEditor:Wz},getDefaultProps:function(){return{onChange:()=>{},hints:[],highlightLint:!1}},render:function(){var e=this.props.hints,t=Lz.map(e,(function(t,n){return Object($t.jsx)(Bz,{ref:"hintEditor"+n,isFirst:0===n,isLast:n+1===e.length,hint:t,pos:n,imageUploader:this.props.imageUploader,onChange:this.handleHintChange.bind(this,n),onRemove:this.handleHintRemove.bind(this,n),onMove:this.handleHintMove.bind(this,n),deviceType:this.props.deviceType,apiOptions:this.props.apiOptions,frameSource:this.props.frameSource,highlightLint:this.props.highlightLint},"hintEditor"+n)}),this);return Object($t.jsxs)("div",{className:"perseus-hints-editor perseus-editor-table",children:[t,Object($t.jsx)("div",{className:"perseus-editor-row",children:Object($t.jsx)("div",{className:"add-hint-container perseus-editor-left-cell",children:Object($t.jsxs)("button",{type:"button",className:"add-hint simple-button orange",onClick:this.addHint,children:[Object($t.jsx)(qz,{...fa})," Add a hint"]})})})]})},handleHintChange:function(e,t,n,s){var i=Lz.clone(this.props.hints);i[e]=Lz.extend({},this.serializeHint(e,{keepDeletedWidgets:!0}),t),this.props.onChange({hints:i},n,s)},handleHintRemove:function(e){var t=Lz.clone(this.props.hints);t.splice(e,1),this.props.onChange({hints:t})},handleHintMove:function(e,t){var n=Lz.clone(this.props.hints),s=n.splice(e,1)[0];n.splice(e+t,0,s),this.props.onChange({hints:n},(()=>{this.refs["hintEditor"+(e+t)].focus()}))},addHint:function(){var e=Lz.clone(this.props.hints).concat([{content:""}]);this.props.onChange({hints:e},(()=>{var t=e.length-1;this.refs["hintEditor"+t].focus()}))},getSaveWarnings:function(){return Lz.chain(this.props.hints).map(((e,t)=>Lz.map(this.refs["hintEditor"+t].getSaveWarnings(),(e=>"Hint "+(t+1)+": "+e)))).flatten(!0).value()},serialize:function(e){return this.props.hints.map(((t,n)=>this.serializeHint(n,e)))},serializeHint:function(e,t){return this.refs["hintEditor"+e].serialize(t)}}),Hz={exports:{}};Hz.exports;const Uz=h.a,Gz=i.a,$z=Qh,Yz=Ss.Options,Kz=sv,Xz=Kt,Zz=Cz,Jz=yz,Qz=createReactClass({displayName:"ModeDropdown",_handleSelectMode:function(e){this.props.onChange&&this.props.onChange(e.target.value)},render:function(){return Object($t.jsxs)("label",{children:["Mode:"," ",Object($t.jsxs)("select",{value:this.props.currentMode,onChange:this._handleSelectMode,children:[Object($t.jsx)("option",{value:"edit",children:"Edit"}),Object($t.jsx)("option",{value:"preview",children:"Preview"}),Object($t.jsx)("option",{value:"json",children:"Dev-only JSON"})]})]})}});function eq(e){return e.replace(/[A-Z]/g,(e=>" "+e.toLowerCase()))}function tq(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function nq(e){return"s"===e.charAt(e.length-1)?e.slice(0,-1):e}function sq(e){return["_multi",...e]}function iq(e){let{depth:t,...n}=e;const s=`h${Math.min(t,5)+1}`;return Object($t.jsx)(s,{...n})}const rq=e=>{const{shape:t,data:n,path:s,actions:i,name:r,controls:o,...a}=e,l=r||eq(s[s.length-1]||"");let c;return c="array"===t.type?aq:"object"===t.type?lq:oq,Object($t.jsx)(c,{name:l,controls:o,path:s,shape:t,actions:i,children:Object($t.jsx)(cq,{...a,shape:t,data:n,path:s,actions:i})},s.join("."))},oq=e=>{let{name:t,controls:n,children:s,path:i,shape:r}=e;const o=("content"===r.type||"hint"===r.type)&&Object($t.jsx)("div",{className:Object(On.css)(vq.containerHeader),children:Object($t.jsx)(iq,{depth:i.length,className:Object(On.css)(vq.containerTitle),children:tq(t)})});return Object($t.jsxs)("div",{className:Object(On.css)(vq.container),children:[Object($t.jsxs)("span",{className:Object(On.css)(vq.row,vq.rowHeading),children:[Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft),children:Object($t.jsxs)("div",{className:"pod-title "+Object(On.css)(vq.containerHeader),children:[Object($t.jsx)("div",{className:Object(On.css)(vq.containerTitle),children:tq(t)}),n]})}),Object($t.jsx)("div",{className:Object(On.css)(vq.columnRight),children:o})]}),s]})},aq=e=>{const{name:t,controls:n,children:s,path:i,shape:r,actions:o}=e;return Object($t.jsxs)("div",{className:Object(On.css)(vq.container),children:[n&&Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft,vq.containerHeader),children:n}),Object($t.jsx)("div",{children:s}),Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft),children:Object($t.jsxs)("a",{href:"javascript:void 0",onClick:()=>o.addArrayElement(i,r.elementShape),children:["Add a ",nq(t)]})})]})},lq=e=>{let{name:t,controls:n,children:s,path:i}=e;const r=Object($t.jsxs)("div",{className:Object(On.css)(vq.containerHeader),children:[Object($t.jsx)(iq,{depth:i.length,className:Object(On.css)(vq.containerTitle),children:tq(t)}),n]}),o=(t||n)&&Object($t.jsx)("div",{className:Object(On.css)(vq.containerHeader,vq.previewCollectionHeader),children:Object($t.jsx)(iq,{depth:i.length,className:Object(On.css)(vq.containerTitle),children:tq(t)})}),a=r&&o;return Object($t.jsxs)("div",{className:Object(On.css)(vq.container),children:[a&&Object($t.jsxs)("span",{className:Object(On.css)(vq.row),children:[Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft),children:r}),Object($t.jsx)("div",{className:Object(On.css)(vq.columnRight),children:o})]}),Object($t.jsx)("div",{className:Object(On.css)(i.length>0&&vq.contentIndent),children:s})]})},cq=e=>{const{shape:t}=e;return"content"===t.type?Object($t.jsx)(uq,{...e}):"hint"===t.type?Object($t.jsx)(dq,{...e}):"tags"===t.type?Object($t.jsx)(gq,{...e}):"array"===t.type?Object($t.jsx)(fq,{...e}):"object"===t.type?Object($t.jsx)(mq,{...e}):void 0};function hq(e){return class extends Uz.Component{constructor(){super(...arguments),this.state={sticky:!1},this.updateStickiness=()=>{const e=Gz.findDOMNode(this).offsetHeight>window.innerHeight;e!==this.state.sticky&&this.setState({sticky:e})}}componentDidMount(){this.stickynessTimer=setInterval(this.updateStickiness,1e3),this.updateStickiness()}componentWillUnmount(){clearInterval(this.stickynessTimer)}render(){return Object($t.jsx)(e,{sticky:this.state.sticky,...this.props})}}}function pq(e){return class extends Uz.Component{constructor(){super(...arguments),this._detached=!1,this._reattachTimer=null,this.getTextAreas=()=>Gz.findDOMNode(this).querySelectorAll("textarea"),this.detach=()=>{this.getTextAreas().forEach((e=>{if(e===document.activeElement&&!this._detached){const t=e.getBoundingClientRect(),n=e.style;n.setProperty("position","fixed","important"),n.setProperty("top",`${t.y}px`,"important"),n.setProperty("left",`${t.x}px`,"important"),n.setProperty("width",`${t.width}px`,"important"),n.setProperty("height",`${t.height}px`,"important"),n.setProperty("z-index","1","important"),n.setProperty("height",`${t.height}px`,"important"),this._reattachTimer&&clearTimeout(this._reattachTimer)}})),this._detached=!0,this._reattachTimer=setTimeout(this.reattach,1e3)},this.reattach=()=>{this.getTextAreas().forEach((e=>{const t=e.style;t.removeProperty("position"),t.removeProperty("top"),t.removeProperty("left"),t.removeProperty("width"),t.removeProperty("z-index"),t.removeProperty("height")})),this._detached=!1}}render(){var t=this;const n=function(){const e=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return e?parseInt(e[2],10):null}(),s=n&&n<62,i=this.props.sticky;if(!s||!i)return Object($t.jsx)(e,{...this.props});const r={...this.props.actions};return r.mergeValueAtPath=function(){t.props.actions.mergeValueAtPath(...arguments),t.detach()},Object($t.jsx)(e,{...this.props,actions:r})}}}const uq=hq(pq((e=>{const{data:t,path:n,actions:s,apiOptions:i,renderers:r,sticky:o}=e,a=Object($t.jsx)("div",{className:"framework-perseus",children:$z(r).get(n)});return Object($t.jsx)("span",{children:Object($t.jsxs)("div",{className:Object(On.css)(vq.row),children:[Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft),children:Object($t.jsx)("div",{className:Object(On.css)(o&&vq.sticky),children:Object($t.jsx)(Kz,{...t,onChange:e=>s.mergeValueAtPath(n,e),apiOptions:i})})}),Object($t.jsx)("div",{className:Object(On.css)(vq.columnRight),children:Object($t.jsx)("div",{className:Object(On.css)(o&&vq.sticky),children:a})})]})})}))),dq=hq(pq((e=>{const{data:t,path:n,actions:s,apiOptions:i,renderers:r,sticky:o}=e,a=Object($t.jsx)("div",{className:"framework-perseus",children:$z(r).get(n)});return Object($t.jsxs)("div",{className:Object(On.css)(vq.row),children:[Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft),children:Object($t.jsx)("div",{className:Object(On.css)(o&&vq.sticky),children:Object($t.jsx)(Wz,{...t,className:Object(On.css)(vq.hintEditor),onChange:e=>s.mergeValueAtPath(n,e),apiOptions:i,showTitle:!1,showRemoveButton:!1,showMoveButtons:!1})})}),Object($t.jsx)("div",{className:Object(On.css)(vq.columnRight),children:Object($t.jsx)("div",{className:Object(On.css)(o&&vq.sticky),children:a})})]})}))),gq=e=>{const{data:t,path:n,actions:s,apiOptions:i}=e,{GroupMetadataEditor:r}=i;return Object($t.jsx)("div",{className:Object(On.css)(vq.columnLeft),children:Object($t.jsx)("div",{className:Object(On.css)(vq.tagsEditor),children:Object($t.jsx)(r,{value:t,onChange:e=>s.setValueAtPath(n,e),showTitle:!1})})})},fq=e=>{const{shape:t,data:n,path:s,actions:i,...r}=e,o=nq(eq(s[s.length-1])),a=t.elementShape.type,l="content"===a||"hint"===a,h=n.map(((e,a)=>{const h=s.concat(a),p=[a>0&&Object($t.jsx)("div",{className:Object(On.css)(vq.control),children:Object($t.jsx)(Jz,{color:"orange",title:"Move up",onClick:()=>i.moveArrayElementUp(h),children:Object($t.jsx)("div",{className:Object(On.css)(vq.verticalFlip),children:Object($t.jsx)(Xz,{...sa})})})},"moveArrayElementUp"),a<n.length-1&&Object($t.jsx)("div",{className:Object(On.css)(vq.control),children:Object($t.jsx)(Jz,{color:"orange",title:"Move down",onClick:()=>i.moveArrayElementDown(h),children:Object($t.jsx)(Xz,{...sa})})},"moveArrayElementDown"),Object($t.jsx)("div",{className:Object(On.css)(vq.control),children:Object($t.jsx)(Jz,{color:"orange",title:"Delete",onClick:()=>i.removeArrayElement(h),children:Object($t.jsx)(Xz,{...ya})})},"removeArrayElement")];return Object($t.jsx)("div",{className:Object(On.css)(vq.arrayElement,!l&&vq.arrayElementAndNotLeaf),children:Object(c.createElement)(rq,{...r,key:a,shape:t.elementShape,data:e,path:h,actions:i,name:`${o} ${a+1}`,controls:p})},a)}));return Object($t.jsx)("div",{children:h})},mq=e=>{const{shape:t,data:n,path:s,...i}=e,r=Object.keys(t.shape).map((e=>Object($t.jsx)("div",{className:Object(On.css)(vq.objectElement),children:Object($t.jsx)(rq,{...i,shape:t.shape[e],data:n[e],path:s.concat(e)})},e)));return Object($t.jsx)("div",{children:r})},bq=createReactClass({displayName:"MultiRendererEditor",_renderLayout(){const{Layout:e,apiOptions:t,item:n}=this.props;return Object($t.jsx)(e,{ref:e=>this.layout=e,item:n,apiOptions:t})},_renderJson(){return Object($t.jsxs)("div",{children:[Object($t.jsx)(Qz,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),Object($t.jsx)(Zz,{multiLine:!0,value:this.props.item,onChange:e=>this.props.onChange({item:e})})]})},_renderPreview(){return Object($t.jsxs)("div",{children:[Object($t.jsx)(Qz,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),this._renderLayout()]})},mergeValueAtPath(e,t){this.props.onChange({item:$z(this.props.item).merge(sq(e),t).freeze()})},setValueAtPath(e,t){this.props.onChange({item:$z(this.props.item).set(sq(e),t).freeze()})},addArrayElement(e,t){const n=$z(this.props.item).get(sq(e)).length,s=e.concat(n),i=Fh(t);this.props.onChange({item:$z(this.props.item).set(sq(s),i).freeze()})},removeArrayElement(e){this.props.onChange({item:$z(this.props.item).del(sq(e)).freeze()})},moveArrayElementDown(e){const t=e[e.length-1]+1,n=e.slice(0,-1).concat(t),s=$z(this.props.item).get(sq(e)),i=$z(this.props.item).get(sq(n));this.props.onChange({item:$z(this.props.item).set(sq(e),i).set(sq(n),s).freeze()})},moveArrayElementUp(e){const t=e[e.length-1],n=e.slice(0,-1).concat(t-1);this.moveArrayElementDown(n)},_renderEdit(){const e={...Yz.defaults,...this.props.apiOptions},t=this.props.item,n=this.props.Layout.shape;return Object($t.jsxs)("div",{className:"perseus-multirenderer-editor",children:[Object($t.jsx)(Qz,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})}),Object($t.jsx)(lp,{item:t,shape:n,apiOptions:e,children:s=>{let{renderers:i}=s;return Object($t.jsx)(rq,{mode:"edit",shape:n,data:Vh(t),path:[],actions:this,apiOptions:e,renderers:i})}})]})},score(){if(this.layout)return this.layout.score()},getSerializedState(){if(this.layout)return this.layout.getSerializedState()},restoreSerializedState(e){this.layout&&this.layout.restoreSerializedState(e)},_renderContent(){switch(this.props.editorMode){case"json":return this._renderJson();case"preview":return this._renderPreview();case"edit":return this._renderEdit();default:return Object($t.jsx)(Qz,{currentMode:this.props.editorMode,onChange:e=>this.props.onChange({editorMode:e})})}},render(){return Object($t.jsx)("div",{id:"perseus",children:this._renderContent()})}}),vq=On.StyleSheet.create({editor:{width:"100%"},treePreview:{position:"relative"},verticalFlip:{transform:"scaleY(-1)"},control:{marginLeft:12},containerHeader:{alignItems:"flex-end",display:"flex",flexDirection:"row"},previewCollectionHeader:{marginBottom:16},containerTitle:{flexGrow:1,margin:0},contentIndent:{marginLeft:8},hintEditor:{paddingBottom:0},arrayElement:{marginBottom:16},arrayElementAndNotLeaf:{borderBottom:"1px solid #ccc",":first-child":{borderTop:"1px solid #ccc",paddingTop:16}},objectElement:{marginBottom:16},tagsEditor:{border:"1px solid #ddd",padding:"5px 10px"},row:{display:"flex",position:"relative"},columnLeft:{width:360,marginRight:30,position:"relative"},columnRight:{flex:1,marginLeft:30,position:"relative"},sticky:{position:"sticky",top:33},rowHeading:{position:"sticky",backgroundColor:"white",width:"100%",zIndex:101,top:-1}});Hz.exports=bq;var xq=Hz.exports,yq={exports:{}};yq.exports;h.a;const jq=xq,wq=ce,Oq=createReactClass({displayName:"DemoLayout",statics:{shape:cp.shape({sharedContext:cp.content,questions:cp.arrayOf(cp.shape({tags:cp.tags,question:cp.content})),hints:cp.hints})},getInitialState:()=>({numHints:0}),score(){return this.multirenderer.score()},getSerializedState(){return this.multirenderer.getSerializedState()},restoreSerializedState(e){this.multirenderer.restoreSerializedState(e)},addHint(){this.setState((e=>{let{numHints:t}=e;return{numHints:t+1}}))},clearHints(){this.setState({numHints:0})},render(){return Object($t.jsx)(lp,{ref:e=>this.multirenderer=e,item:this.props.item,shape:Oq.shape,children:e=>{let{renderers:t}=e;return Object($t.jsxs)("div",{children:[Object($t.jsx)("div",{className:Object(On.css)(Cq.left),children:t.sharedContext}),Object($t.jsxs)("div",{className:Object(On.css)(Cq.right),children:[Object($t.jsx)("h2",{children:"Questions"}),Object($t.jsx)("ul",{children:t.questions.map(((e,t)=>Object($t.jsx)("li",{children:e.question},t)))}),t.hints.length>0&&Object($t.jsxs)("div",{children:[Object($t.jsx)("h2",{children:"Hints"}),t.hints.firstN(this.state.numHints),this.state.numHints<t.hints.length&&Object($t.jsx)("div",{children:Object($t.jsx)("button",{onClick:this.addHint,children:"Get a hint"})}),this.state.numHints>0&&Object($t.jsx)("div",{children:Object($t.jsx)("button",{onClick:this.clearHints,children:"Clear hints"})})]})]})]})}})}}),Cq=On.StyleSheet.create({left:{float:"left"},right:{float:"right"}}),Sq=createReactClass({displayName:"MultiRendererDemo",getDefaultProps:()=>({item:Lh(Oq.shape)}),getInitialState(){return{item:this.props.item,editorMode:"edit"}},getEditorProps(){return{Layout:Oq,apiOptions:{onFocusChange:function(e,t){console.log("onFocusChange",e,t)},trackInteraction:function(e){console.log("Interaction with",e.type,e)}},item:this.state.item,editorMode:this.state.editorMode}},handleChange(e){this.setState(e)},_getContentHash:function(){return wq.strongEncodeURIComponent(JSON.stringify(this.state.item))},handlePermalink(e){window.location.hash=`content=${this._getContentHash()}`,e.preventDefault()},handleScore(){console.log(this.editor.score())},handleSerializeState(){this._state=this.editor.getSerializedState()},handleRestoreState(){this.editor.restoreSerializedState(this._state)},render(){const e="edit"===this.state.editorMode||"preview"===this.state.editorMode;return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{id:"extras",children:[Object($t.jsx)("button",{onClick:this.handlePermalink,children:"Permalink"})," ",Object($t.jsx)("button",{onClick:this.handleScore,disabled:!e,children:"Score"})," ",Object($t.jsx)("button",{onClick:this.handleSerializeState,disabled:!e,children:"Store state"})," ",Object($t.jsx)("button",{onClick:this.handleRestoreState,disabled:!e,children:"Restore state"})]}),Object($t.jsx)("div",{className:"framework-perseus",children:Object($t.jsx)(jq,{...this.getEditorProps(),onChange:this.handleChange,ref:e=>this.editor=e})})]})}});yq.exports=Sq;var kq=yq.exports,_q={exports:{}};_q.exports;h.a;const Tq=createReactClass({displayName:"HUD",renderVisibleIcon:function(){return Object($t.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:Object(On.css)(Mq.icon),children:[Object($t.jsx)("defs",{children:Object($t.jsx)("path",{id:"a",d:"M7.401 10.035c-1.424.748-2.599 1.905-3.544 3.48a1 1 0 0 1-1.714-1.03C4.325 8.849 7.652 7 12 7c4.348 0 7.675 1.848 9.857 5.486a1 1 0 0 1-1.714 1.028c-.945-1.574-2.12-2.73-3.544-3.48a5 5 0 1 1-9.198 0zM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"})}),Object($t.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object($t.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),Object($t.jsx)("mask",{id:"b",fill:"#fff",children:Object($t.jsx)("use",{href:"#a"})}),Object($t.jsx)("use",{fill:"#fff",fillRule:"nonzero",href:"#a"}),Object($t.jsx)("g",{fill:"#fff",mask:"url(#b)",children:Object($t.jsx)("path",{d:"M0 0h24v24H0z"})})]})]})},renderHiddenIcon:function(){return Object($t.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",className:Object(On.css)(Mq.icon),children:[Object($t.jsx)("defs",{children:Object($t.jsx)("path",{id:"a",d:"M8.794 7.38C9.791 7.127 10.86 7 12 7c4.348 0 7.675 1.848 9.857 5.486a1 1 0 0 1-1.714 1.028c-.945-1.574-2.12-2.73-3.544-3.48.258.604.401 1.268.401 1.966 0 1.02-.305 1.967-.828 2.757l2.535 2.536a1 1 0 0 1-1.414 1.414l-12-12a1 1 0 0 1 1.414-1.414L8.794 7.38zm5.914 5.913a3 3 0 0 0-4.001-4.001l4 4.001zM6.072 8.486l2.976 2.976a3 3 0 0 0 3.49 3.49l1.579 1.58A5 5 0 0 1 7.4 10.035c-1.424.747-2.599 1.904-3.544 3.478a1 1 0 0 1-1.714-1.028c1.049-1.75 2.363-3.085 3.929-4z"})}),Object($t.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[Object($t.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),Object($t.jsx)("mask",{id:"b",fill:"#fff",children:Object($t.jsx)("use",{href:"#a"})}),Object($t.jsx)("use",{fill:"#fff",fillRule:"nonzero",href:"#a"}),Object($t.jsx)("g",{fill:"#fff",mask:"url(#b)",children:Object($t.jsx)("path",{d:"M0 0h24v24H0z"})})]})]})},render:function(){let e,t;return this.props.enabled?(e=Mq.enabled,t=this.renderVisibleIcon()):(e=Mq.disabled,t=this.renderHiddenIcon()),Object($t.jsxs)("button",{className:Object(On.css)(Mq.hud,e),onClick:e=>{this.props.onClick()},children:[t,this.props.message]})}}),Mq=On.StyleSheet.create({hud:{position:"fixed",right:20,bottom:20,boxSizing:"border-box",height:36,padding:"9px 16px",borderRadius:18,fontFamily:Zt,fontSize:"15px",lineHeight:"18px",color:tn,userSelect:"none",borderWidth:0},icon:{width:24,height:24,marginRight:8,marginTop:-3,verticalAlign:"middle"},enabled:{backgroundColor:yn,":hover":{backgroundColor:jn},":active":{backgroundColor:"#c75300"}},disabled:{backgroundColor:rn,":hover":{backgroundColor:"#a1a5a9"},":active":{backgroundColor:on}}});_q.exports=Tq;var Nq=_q.exports,Pq={exports:{}};Pq.exports;h.a;const Iq=x.b,Eq=Ss.Options,Aq=sv,Rq=Kt,Dq=Cz,Fq=Fz,Lq=Nz,zq=Nq,qq=createReactClass({displayName:"SectionControlButton",render:function(){const{icon:e,onClick:t,title:n}=this.props;return Object($t.jsx)("a",{href:"#",className:"section-control-button simple-button simple-button--small orange",onClick:e=>{e.preventDefault(),t()},title:n,children:Object($t.jsx)(Rq,{...e})})}}),Wq=createReactClass({displayName:"ArticleEditor",getDefaultProps:function(){return{contentPaths:[],json:[{}],mode:"edit",screen:"desktop",sectionImageUploadGenerator:()=>Object($t.jsx)("span",{}),useNewStyles:!1}},getInitialState:function(){return{highlightLint:!0}},componentDidMount:function(){this._updatePreviewFrames()},componentDidUpdate:function(){this._updatePreviewFrames()},_updatePreviewFrames:function(){"preview"===this.props.mode?this.refs["frame-all"].sendNewData({type:"article-all",data:this._sections().map(((e,t)=>this._apiOptionsForSection(e,t)))}):"edit"===this.props.mode&&this._sections().forEach(((e,t)=>{this.refs["frame-"+t].sendNewData({type:"article",data:this._apiOptionsForSection(e,t)})}))},_apiOptionsForSection:function(e,t){const n=this.refs[`editor${t}`];return{apiOptions:{...Eq.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},json:e,useNewStyles:this.props.useNewStyles,linterContext:{contentType:"article",highlightLint:this.state.highlightLint,paths:this.props.contentPaths},legacyPerseusLint:n?n.getSaveWarnings():[]}},_sections:function(){return Iq.isArray(this.props.json)?this.props.json:[this.props.json]},_renderEditor:function(){const{imageUploader:e,sectionImageUploadGenerator:t}=this.props,n={...Eq.defaults,...this.props.apiOptions,showAlignmentOptions:!0,isArticle:!0},s=this._sections();return Object($t.jsxs)("div",{className:"perseus-editor-table",children:[s.map(((i,r)=>[Object($t.jsxs)("div",{className:"perseus-editor-row",children:[Object($t.jsxs)("div",{className:"perseus-editor-left-cell",children:[Object($t.jsxs)("div",{className:"pod-title",children:["Section ",r+1,Object($t.jsxs)("div",{style:{display:"inline-block",float:"right"},children:[t(r),Object($t.jsx)(qq,{icon:fa,onClick:()=>{this._handleAddSectionAfter(r)},title:"Add a new section after this one"}),r+1<s.length&&Object($t.jsx)(qq,{icon:oa,onClick:()=>{this._handleMoveSectionLater(r)},title:"Move this section down"}),r>0&&Object($t.jsx)(qq,{icon:aa,onClick:()=>{this._handleMoveSectionEarlier(r)},title:"Move this section up"}),Object($t.jsx)(qq,{icon:ya,onClick:()=>{confirm("Are you sure you want to delete section "+(r+1)+"?")&&this._handleRemoveSection(r)},title:"Delete this section"})]})]}),Object($t.jsx)(Aq,{...i,apiOptions:n,imageUploader:e,onChange:Iq.partial(this._handleEditorChange,r),placeholder:"Type your section text here...",ref:"editor"+r})]}),Object($t.jsx)("div",{className:"editor-preview",children:this._renderIframePreview(r,!0)})]})])),this._renderAddSection(),this._renderLinterHUD()]})},_renderAddSection:function(){return Object($t.jsx)("div",{className:"perseus-editor-row",children:Object($t.jsx)("div",{className:"perseus-editor-left-cell",children:Object($t.jsxs)("a",{href:"#",className:"simple-button orange",onClick:()=>{this._handleAddSectionAfter(this._sections().length-1)},children:[Object($t.jsx)(Rq,{...fa})," Add a section"]})})})},_renderLinterHUD:function(){return Object($t.jsx)(zq,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})},_renderIframePreview:function(e,t){const n="phone"===this.props.screen||"tablet"===this.props.screen;return Object($t.jsx)(Fq,{deviceType:this.props.screen,nochrome:t,children:Object($t.jsx)(Lq,{ref:"frame-"+e,content:this.props.frameSource,datasetKey:"mobile",datasetValue:n,seamless:t},this.props.screen)})},_renderPreviewMode:function(){return Object($t.jsx)("div",{className:"standalone-preview",children:this._renderIframePreview("all",!1)})},_handleJsonChange:function(e){this.props.onChange({json:e})},_handleEditorChange:function(e,t){const n=Iq.clone(this._sections());n[e]=Iq.extend({},n[e],t),this.props.onChange({json:n})},_handleMoveSectionEarlier:function(e){if(0===e)return;const t=Iq.clone(this._sections()),n=t[e];t.splice(e,1),t.splice(e-1,0,n),this.props.onChange({json:t})},_handleMoveSectionLater:function(e){const t=Iq.clone(this._sections());if(e+1===t.length)return;const n=t[e];t.splice(e,1),t.splice(e+1,0,n),this.props.onChange({json:t})},_handleAddSectionAfter:function(e){const t=Iq.clone(this.serialize()),n=e>=0?{widgets:t[e].widgets}:{};t.splice(e+1,0,n),this.props.onChange({json:t})},_handleRemoveSection:function(e){const t=Iq.clone(this._sections());t.splice(e,1),this.props.onChange({json:t})},serialize:function(){if("edit"===this.props.mode)return this._sections().map(((e,t)=>this.refs["editor"+t].serialize()));if("preview"===this.props.mode||"json"===this.props.mode)return this.props.json;throw new Error("Could not serialize; mode "+this.props.mode+" not found")},getSaveWarnings:function(){if("edit"!==this.props.mode)throw new Error("Cannot only get save warnings in edit mode.");return this._sections().map(((e,t)=>this.refs["editor"+t].getSaveWarnings()))},render:function(){return Object($t.jsxs)("div",{className:"framework-perseus perseus-article-editor",children:["edit"===this.props.mode&&this._renderEditor(),"preview"===this.props.mode&&this._renderPreviewMode(),"json"===this.props.mode&&Object($t.jsxs)("div",{className:"json-editor",children:[Object($t.jsx)("div",{className:"json-editor-warning",children:Object($t.jsx)("span",{children:"Warning: Editing in this mode can lead to broken articles!"})}),Object($t.jsx)(Dq,{multiLine:!0,onChange:this._handleJsonChange,value:this.props.json})]})]})}});Pq.exports=Wq;var Bq=Pq.exports,Vq={exports:{}};Vq.exports;h.a;const Hq=x.b,Uq=Bq,Gq=createReactClass({displayName:"StatefulArticleEditor",getInitialState:function(){return Object.assign({},this.props,{mode:"edit",onChange:this.handleChange,ref:"editor",screen:"phone"})},componentWillReceiveProps:function(e){this.setState(Hq.omit(e,"onChange","ref"))},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(e,t){this.isMounted()&&this.setState(e,t)},scorePreview:function(){return this.refs.editor.scorePreview()},render:function(){const{mode:e,screen:t}=this.state;return Object($t.jsxs)("div",{children:[Object($t.jsxs)("div",{style:$q.controlBar,children:[Object($t.jsxs)("span",{style:$q.controls,children:["Mode:"," ",Object($t.jsx)("span",{onClick:()=>this.setState({mode:"edit"}),style:"edit"===e?$q.controlSelected:$q.control,children:"EDIT"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({mode:"preview"}),style:"preview"===e?$q.controlSelected:$q.control,children:"PREVIEW"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({mode:"json"}),style:"json"===e?$q.controlSelected:$q.control,children:"JSON"})]}),Object($t.jsxs)("span",{style:$q.controls,children:["Screen:"," ",Object($t.jsx)("span",{onClick:()=>this.setState({screen:"phone"}),style:"phone"===t?$q.controlSelected:$q.control,children:"PHONE"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({screen:"tablet"}),style:"tablet"===t?$q.controlSelected:$q.control,children:"TABLET"})," | ",Object($t.jsx)("span",{onClick:()=>this.setState({screen:"desktop"}),style:"desktop"===t?$q.controlSelected:$q.control,children:"DESKTOP"})]})]}),Object($t.jsx)("div",{style:$q.editor,children:Object($t.jsx)(Uq,{...this.state})})]})}}),$q={controlBar:{marginBottom:25,marginTop:5},controls:{marginRight:10},controlSelected:{cursor:"default",fontWeight:700},control:{cursor:"pointer"},editor:{marginTop:-20}};Vq.exports=Gq;var Yq=Vq.exports,Kq={exports:{}};Kq.exports;h.a;const Xq=Bq,Zq=Yq,Jq=ce,Qq=[{content:"",images:{},widgets:{}}],eW=createReactClass({displayName:"ArticleDemo",getDefaultProps:()=>({content:Qq}),getInitialState:function(){return{isMobile:-1!==navigator.userAgent.indexOf("Mobile")}},componentDidMount:function(){window.addEventListener("resize",this._handleResize)},componentWillUnmount:function(){window.removeEventListener("resize",this._handleResize)},serialize:function(){console.log(JSON.stringify(this.refs.editor.serialize(),null,4))},scorePreview:function(){console.log(this.refs.editor.scorePreview())},_getContentHash:function(){return Jq.strongEncodeURIComponent(JSON.stringify(this.refs.editor.serialize()))},permalink:function(e){window.location.hash=`content=${this._getContentHash()}`,e.preventDefault()},_handleResize(){const e=-1!==navigator.userAgent.indexOf("Mobile");this.state.isMobile!==e&&this.setState({isMobile:e})},getEditorProps(){const{isMobile:e}=this.state;return{json:this.props.content,imageUploader:function(e,t){setTimeout(t,1e3,"http://fake.image.url")},apiOptions:{customKeypad:e,onFocusChange:function(e,t){console.log("onFocusChange",e,t)},trackInteraction:function(e){console.log("Interaction with",e.type,e)},isMobile:e},useNewStyles:!0,componentClass:Xq,frameSource:'<!DOCTYPE html>\n                <html>\n                <head>\n                    <meta charset="utf-8">\n                    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">\n\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-site.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-exercise.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/katex/katex.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/font-awesome.min.css">\n                    <link rel="stylesheet" type="text/css" href="lib/mathquill/mathquill.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/perseus-admin-package/devices.min.css" />\n\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/exercise-content-package/perseus.less" />\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/perseus-admin-package/editor.less" />\n                    <style>\n                        body {\n                            min-width: 0 !important;\n                            /* overrides body { min-width: 1000px; } in khan-site.css */\n                        }\n                    </style>\n\n                    <script>less = {env: \'development\', logLevel: 1};<\/script>\n                    <script src="lib/less.js"><\/script>\n                </head>\n                <body>\n                    <div id="content-container">\n                    </div>\n                    <script src="lib/babel-polyfills.min.js"><\/script>\n                    <script src="lib/jquery.js"><\/script>\n                    <script src="lib/underscore.js"><\/script>\n                    <script src="lib/react-with-addons.js"><\/script>\n                    <script src="lib/mathjax/2.1/MathJax.js?config=KAthJax-730d56e87e9c926b91584f6030314815&amp;delayStartupUntil=configured"><\/script>\n                    <script src="lib/katex/katex.js"><\/script>\n                    <script src="lib/mathquill/mathquill-basic.js"><\/script>\n                    <script src="lib/kas.js"><\/script>\n                    <script src="lib/i18n.js"><\/script>\n                    <script src="lib/jquery.qtip.js"><\/script>\n                    <script src="build/frame-perseus.js"><\/script>\n                </body>\n            </html>'}},render:function(){return Object($t.jsxs)("div",{id:"perseus-index",children:[Object($t.jsxs)("div",{id:"extras",children:[Object($t.jsx)("button",{onClick:this.serialize,children:"serialize"})," ",Object($t.jsx)("button",{onClick:this.scorePreview,children:"score"})," ",Object($t.jsx)("button",{onClick:this.permalink,children:"permalink"})," "]}),Object($t.jsx)("div",{style:{margin:20},children:Object($t.jsx)(Zq,{ref:"editor",...this.getEditorProps()})})]})}});Kq.exports=eW;var tW=Kq.exports,nW={exports:{}};nW.exports;h.a;const sW=i.a,iW=Ss.ClassNames,rW=Fp,oW=yz,aW={question:{content:"",images:{},widgets:{}},answerArea:{calculator:!1},itemDataVersion:{major:0,minor:1},hints:[]},lW=createReactClass({displayName:"RendererDemo",getDefaultProps:function(){return{question:aW,problemNum:1}},getInitialState:function(){return{answer:{empty:!0,correct:null},scratchpadEnabled:!0,isMobile:-1!==navigator.userAgent.indexOf("Mobile")}},componentDidMount:function(){sW.findDOMNode(this.refs.itemRenderer).focus(),window.addEventListener("resize",this._handleResize)},componentWillUnmount:function(){window.removeEventListener("resize",this._handleResize)},onScore:function(){console.log(this.refs.itemRenderer.scoreInput())},checkAnswer:function(){this.refs.itemRenderer.showRationalesForCurrentlySelectedChoices(),this.setState({answer:this.refs.itemRenderer.scoreInput()},(()=>{this.refs.itemRenderer.deselectIncorrectSelectedChoices()}))},takeHint:function(){this.refs.itemRenderer.showHint()},_handleResize(){const e=-1!==navigator.userAgent.indexOf("Mobile");this.state.isMobile!==e&&this.setState({isMobile:e})},render:function(){const{isMobile:e}=this.state,t={getAnotherHint:()=>{this.refs.itemRenderer.showHint()},isMobile:e,customKeypad:e,setDrawingAreaAvailable:e=>{this.setState({scratchpadEnabled:e})},styling:{radioStyleVersion:"final"}},n=this.state.answer,s=Object($t.jsx)(rW,{item:this.props.question,ref:"itemRenderer",problemNum:this.props.problemNum,initialHintsVisible:0,apiOptions:t,reviewMode:n.correct}),i=!n.empty&&n.correct,r=Object($t.jsxs)("div",{children:[Object($t.jsx)(oW,{color:n.empty||n.correct?"green":"orange",onClick:this.checkAnswer,children:n.empty?"Check Answer":n.correct?"Correct!":"Incorrect, try again."}),Object($t.jsx)("img",{className:Object(On.css)(cW.smiley,!i&&cW.hideSmiley),src:"/images/face-smiley.png"})]}),o=this.state.scratchpadEnabled;if(e){const e="framework-perseus "+iW.MOBILE;return Object($t.jsx)("div",{className:e,children:Object($t.jsxs)("div",{className:Object(On.css)(cW.problemAndAnswer),children:[s,Object($t.jsxs)("div",{id:"problem-area",children:[Object($t.jsx)("div",{id:"workarea",style:{marginLeft:0}}),Object($t.jsx)("div",{id:"hintsarea"})]})]})})}return Object($t.jsxs)("div",{className:"renderer-demo framework-perseus",children:[Object($t.jsxs)("div",{className:Object(On.css)(cW.problemAndAnswer),children:[Object($t.jsxs)("div",{id:"problem-area",children:[Object($t.jsx)("div",{id:"workarea"}),Object($t.jsx)("div",{id:"hintsarea"})]}),Object($t.jsx)("div",{className:Object(On.css)(cW.answerAreaWrap),children:Object($t.jsxs)("div",{id:"answer-area",children:[Object($t.jsxs)("div",{className:Object(On.css)(cW.infoBox),children:[Object($t.jsx)("div",{id:"solutionarea"}),Object($t.jsx)("div",{className:Object(On.css)(cW.answerButtons),children:r})]}),Object($t.jsx)("div",{className:Object(On.css)(cW.infoBox),children:Object($t.jsx)(oW,{color:"orange",onClick:this.takeHint,children:"Hint"})})]})}),Object($t.jsx)("div",{style:{clear:"both"}})]}),Object($t.jsxs)("div",{className:"extras",style:{margin:20},children:[Object($t.jsx)("button",{onClick:this.onScore,children:"Score"}),Object($t.jsxs)("span",{style:{marginLeft:15},children:["Scratchpad",o?"":"not ","available"]})]}),s]})}}),cW=On.StyleSheet.create({problemAndAnswer:{minHeight:180,position:"relative"},smiley:{width:28,position:"absolute",top:7,left:5,cursor:"pointer"},hideSmiley:{display:"none"},answerAreaWrap:{margin:"0px -8px 0 0",position:"absolute",bottom:0,right:0,width:80,zIndex:1e4},answerButtons:{margin:"0 -10px",padding:"10px 10px 0",position:"relative"},infoBox:{background:"#eee",border:"1px solid #aaa",color:"#333",marginBottom:10,padding:10,position:"relative",zIndex:10,boxShadow:"0 1px 2px #ccc",overflow:"visible",":before":{content:'" "',borderRight:"8px solid transparent",borderBottom:"8px solid #cccccc",height:16,position:"absolute",right:-1,top:-24}}});nW.exports=lW;var hW=nW.exports,pW={exports:{}},uW=(pW.exports,x.b),dW=ve,gW=Fs,fW=function(){},mW=function(e,t,n,s){var i=e.content;if(null!=e.content){var r=t(e.content);void 0!==r&&(i=r)}var o=dW.mapObject(e.widgets||{},(function(e,t){return null==e||null==e.type?e:n(e,t)})),a=uW.extend({},e,{content:i,widgets:o}),l=s(a);return void 0!==l?l:a};pW.exports={traverseRendererDeep:function(e,t,n,s){return mW(e,t=t||fW,function(e,t,n){var s=function(i,r){var o,a=gW.upgradeWidgetInfoToLatestVersion(i),l=gW.getVersion(a.type);o=l&&a.version.major===l.major?gW.traverseChildWidgets(a,(t=>mW(t,e,s,n))):a;var c=t(o,r);return void 0!==c?c:o};return s}(t,n=n||fW,s=s||fW),s)}};var bW=pW.exports,vW={exports:{}};vW.exports;x.b;const xW=bW,yW=Fs,jW=function(e,t){let n=!0;return xW.traverseRendererDeep(e,null,(function(e){n=n&&function(e,t){if(null==e||null==e.type)return!0;const n=yW.upgradeWidgetInfoToLatestVersion(e);return function(e,t){if(null==t)return!1;const n=e.version||{major:0,minor:0};return t.major>n.major||!(t.major<n.major)&&t.minor>=n.minor}(n,t[n.type])}(e,t)})),n};vW.exports={isItemRenderableByVersion:function(e,t){if(null==e||null==t)throw new Error("missing parameter to Perseus.isRenderable.item");if(e._multi){const n=Wh(e);let s=!0;return zh(e,n,(e=>{jW(e,t)||(s=!1)})),s}return jW(e.question,t)}};var wW=vW.exports,OW={exports:{}};OW.exports;h.a;const CW=Ff.a,SW=Kt,kW=createReactClass({displayName:"ViewportResizer",handleChange:function(e){this.props.onViewportSizeChanged(e)},render:function(){const e=Object($t.jsxs)("span",{children:[Object($t.jsx)(SW,{...da})," Phone"]}),t=Object($t.jsxs)("span",{children:[Object($t.jsx)(SW,{...xa})," Tablet"]}),n=Object($t.jsxs)("span",{children:[Object($t.jsx)(SW,{...ca})," Desktop"]});return Object($t.jsxs)("span",{className:"viewport-resizer",children:["Viewport:"," ",Object($t.jsx)(CW,{value:this.props.deviceType,allowEmpty:!1,buttons:[{value:Pz.PHONE,content:e},{value:Pz.TABLET,content:t},{value:Pz.DESKTOP,content:n}],onChange:this.handleChange})]})}});OW.exports=kW;var _W=OW.exports,TW=(n(267),{exports:{}}),MW=(TW.exports,h.a,sd),NW=createReactClass({displayName:"ItemExtrasEditor",getDefaultProps:function(){return{calculator:!1,chi2Table:!1,periodicTable:!1,tTable:!1,zTable:!1}},serialize:function(){return{calculator:this.props.calculator,chi2Table:this.props.chi2Table,periodicTable:this.props.periodicTable,tTable:this.props.tTable,zTable:this.props.zTable}},render:function(){return Object($t.jsx)("div",{className:"perseus-answer-editor",children:Object($t.jsxs)("div",{className:"perseus-answer-options",children:[Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show calculator:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.calculator,onChange:e=>{this.props.onChange({calculator:e.target.checked})}})]}),Object($t.jsx)(MW,{children:"Use the calculator when completing difficult calculations is NOT the intent of the question. DON\u2019T use the calculator when testing the student\u2019s ability to complete different types of computations."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show periodic table:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.periodicTable,onChange:e=>{this.props.onChange({periodicTable:e.target.checked})}})]}),Object($t.jsx)(MW,{children:"This provides the student with the ability to view a periodic table of the elements, e.g., for answering chemistry questions."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show z table (statistics):"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.zTable,onChange:e=>{this.props.onChange({zTable:e.target.checked})}})]}),Object($t.jsx)(MW,{children:"This provides the student with the ability to view a table of critical values for the z distribution, e.g. for answering statistics questions."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show t table (statistics):"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.tTable,onChange:e=>{this.props.onChange({tTable:e.target.checked})}})]}),Object($t.jsx)(MW,{children:"This provides the student with the ability to view a table of critical values for the Student's t distribution, e.g. for answering statistics questions."})]}),Object($t.jsxs)("div",{children:[Object($t.jsxs)("label",{children:["Show chi-squared table (statistics):"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.chi2Table,onChange:e=>{this.props.onChange({chi2Table:e.target.checked})}})]}),Object($t.jsx)(MW,{children:"This provides the student with the ability to view a table of critical values for the chi-squared distribution, e.g. for answering statistics questions."})]})]})})}});TW.exports=NW;var PW=TW.exports,IW={exports:{}},EW=(IW.exports,h.a,x.b),AW=PW,RW=qF.itemDataVersion;var DW=createReactClass({displayName:"ItemEditor",getDefaultProps:function(){return{onChange:()=>{},question:{},answerArea:{}}},updateProps:function(e,t,n){var s=EW.pick(this.props,"question","answerArea");this.props.onChange(Object.assign({},s,e),t,n)},render:function(){"phone"===this.props.deviceType||this.props.deviceType;return Object($t.jsxs)("div",{className:"perseus-editor-table",children:[Object($t.jsxs)("div",{className:"perseus-editor-row perseus-question-container",children:[Object($t.jsxs)("div",{className:"perseus-editor-left-cell",children:[Object($t.jsx)("div",{className:"pod-title",children:"Question"}),Object($t.jsx)(sv,{ref:"questionEditor",placeholder:"Type your question here...",className:"perseus-question-editor",imageUploader:this.props.imageUploader,onChange:this.handleEditorChange,apiOptions:this.props.apiOptions,showWordCount:!0,...this.props.question})]}),Object($t.jsx)("div",{className:"perseus-editor-right-cell",children:Object($t.jsxs)("div",{id:"problemarea",children:[Object($t.jsx)(ah,{ref:"questionRenderer",apiOptions:this.props.apiOptions,...this.props.question}),Object($t.jsx)("div",{id:"hintsarea",className:"hintsarea",style:{display:"none"}})]})})]}),Object($t.jsxs)("div",{className:"perseus-editor-row perseus-answer-container",children:[Object($t.jsxs)("div",{className:"perseus-editor-left-cell",children:[Object($t.jsx)("div",{className:"pod-title",children:"Question extras"}),Object($t.jsx)(AW,{ref:"itemExtrasEditor",onChange:this.handleItemExtrasChange,...this.props.answerArea})]}),Object($t.jsx)("div",{className:"perseus-editor-right-cell",children:Object($t.jsx)("div",{id:"answer_area"})})]})]})},triggerPreviewUpdate:function(e){},handleEditorChange:function(e,t,n){var s=EW.extend({},this.props.question,e);this.updateProps({question:s},t,n)},handleItemExtrasChange:function(e,t,n){var s=EW.extend({},this.props.answerArea,e);this.updateProps({answerArea:s},t,n)},getSaveWarnings:function(){return this.refs.questionEditor.getSaveWarnings()},serialize:function(e){return{question:this.refs.questionEditor.serialize(e),answerArea:this.refs.itemExtrasEditor.serialize(e),itemDataVersion:RW}},focus:function(){this.questionEditor.focus()}});IW.exports=DW;var FW=IW.exports,LW={exports:{}},zW=(LW.exports,x.b),qW=bW,WW=new RegExp('(\\[\\[\u2603 (passage-ref [0-9]+)\\]\\])\\s\\(["\u201c]([\\s\\S]*)["\u201d]\\)',"g"),BW=e=>{var t=zW.clone(e.widgets||{}),n=(e.content||"").replace(WW,((e,n,s,i)=>(t[s]=zW.extend({},t[s],{options:zW.extend({},t[s].options,{summaryText:i})}),n)));return zW.extend({},e,{content:n,widgets:t})},VW=new RegExp('\\{\\{(passage-ref \\d+ \\d+)}}\\s+\\(["\\u201C]([^"]*)["\\u201D]\\)',"g"),HW=(e,t,n)=>/\n\n/.test(n)?e:"{{"+t+' "'+n+'"}}',UW=e=>{if("radio"!==e.type||!e.options||!e.options.choices)return e;var t=zW.map(e.options.choices,(e=>{if(!e.content)return e;var t=e.content.replace(VW,HW);return zW.extend({},e,{content:t})}));return zW.extend({},e,{options:zW.extend({},e.options,{choices:t})})},GW=e=>qW.traverseRendererDeep(e,null,UW,BW);LW.exports=e=>{if(e._multi)return e;var t=GW(e.question),n=zW.map(e.hints,(e=>GW(e)));return zW.extend({},e,{question:t,hints:n})};var $W=LW.exports,YW={exports:{}},KW=(YW.exports,h.a,x.b);const XW=Ss.ClassNames,ZW=Ms;var JW=Vz,QW=$W,eB=FW,tB=Cz,nB=_W;const sB=Nq;var iB=createReactClass({displayName:"EditorPage",getDefaultProps:function(){return{developerMode:!1,jsonMode:!1,onChange:()=>{}}},getInitialState:function(){return{json:KW.pick(this.props,"question","answerArea","hints","itemDataVersion"),gradeMessage:"",wasAnswered:!1,highlightLint:!0}},handleCheckAnswer:function(){var e=this.scorePreview();this.setState({gradeMessage:e.message,wasAnswered:e.correct})},toggleJsonMode:function(){this.setState({json:this.serialize({keepDeletedWidgets:!0})},(function(){this.props.onChange({jsonMode:!this.props.jsonMode})}))},componentDidMount:function(){this.rendererMountNode=document.createElement("div"),this.updateRenderer()},componentDidUpdate:function(){this.updateRenderer()},updateRenderer:function(){const e=!this.props.developerMode||!this.props.jsonMode;if(!this.isMounted()||!e)return;const t="phone"===this.props.previewDevice||"tablet"===this.props.previewDevice,n=Object.assign(this.getApiOptions(),{customKeypad:t,isMobile:t});this.refs.itemEditor.triggerPreviewUpdate({type:"question",data:Object.assign({item:this.serialize(),apiOptions:n,initialHintsVisible:0,device:this.props.previewDevice,linterContext:{contentType:"exercise",highlightLint:this.state.highlightLint,paths:this.props.contentPaths},reviewMode:!0,legacyPerseusLint:this.refs.itemEditor.getSaveWarnings()},KW.pick(this.props,"workAreaSelector","solutionAreaSelector","hintsAreaSelector","problemNum"))})},getApiOptions(){return ZW.getApiOptions.call(this)},handleChange:function(e,t,n){var s=KW.pick(this.props,"question","hints","answerArea");KW.extend(s,e),this.props.onChange(s,t,n)},changeJSON:function(e){this.setState({json:e}),this.props.onChange(e)},_fixPassageRefs:function(){var e=this.serialize(),t=QW(e);this.setState({json:t}),this.props.onChange(t)},scorePreview:function(){return this.renderer?this.renderer.scoreInput():null},render:function(){let e="framework-perseus";const t="phone"===this.props.previewDevice||"tablet"===this.props.previewDevice,n=Object.assign(this.getApiOptions(),{customKeypad:t,isMobile:t});return n.isMobile&&(e+=" "+XW.MOBILE),Object($t.jsxs)("div",{id:"perseus",className:e,children:[Object($t.jsxs)("div",{style:{marginBottom:10},children:[this.props.developerMode&&Object($t.jsxs)("span",{children:[Object($t.jsxs)("label",{children:[" ","Developer JSON Mode:"," ",Object($t.jsx)("input",{type:"checkbox",checked:this.props.jsonMode,onChange:this.toggleJsonMode})]})," ",Object($t.jsx)("button",{type:"button",onClick:this._fixPassageRefs,children:"Fix passage-refs"})," "]}),!this.props.jsonMode&&Object($t.jsx)(nB,{deviceType:this.props.previewDevice,onViewportSizeChanged:this.props.onPreviewDeviceChange}),!this.props.jsonMode&&Object($t.jsx)(sB,{message:"Style warnings",enabled:this.state.highlightLint,onClick:()=>{this.setState({highlightLint:!this.state.highlightLint})}})]}),this.props.developerMode&&this.props.jsonMode&&Object($t.jsx)("div",{children:Object($t.jsx)(tB,{multiLine:!0,value:this.state.json,onChange:this.changeJSON})}),(!this.props.developerMode||!this.props.jsonMode)&&Object($t.jsx)(eB,{ref:"itemEditor",rendererOnly:this.props.jsonMode,question:this.props.question,answerArea:this.props.answerArea,imageUploader:this.props.imageUploader,onChange:this.handleChange,wasAnswered:this.state.wasAnswered,gradeMessage:this.state.gradeMessage,onCheckAnswer:this.handleCheckAnswer,deviceType:this.props.previewDevice,apiOptions:n,frameSource:this.props.frameSource}),(!this.props.developerMode||!this.props.jsonMode)&&Object($t.jsx)(JW,{ref:"hintsEditor",hints:this.props.hints,imageUploader:this.props.imageUploader,onChange:this.handleChange,deviceType:this.props.previewDevice,apiOptions:n,frameSource:this.props.frameSource,highlightLint:this.state.highlightLint})]})},getSaveWarnings:function(){var e=this.refs.itemEditor.getSaveWarnings(),t=this.refs.hintsEditor.getSaveWarnings();return e.concat(t)},serialize:function(e){return this.props.jsonMode?this.state.json:KW.extend(this.refs.itemEditor.serialize(e),{hints:this.refs.hintsEditor.serialize(e)})}});YW.exports=iB;var rB=YW.exports,oB={exports:{}},aB=(oB.exports,h.a,x.b),lB=rB,cB=createReactClass({displayName:"StatefulEditorPage",getDefaultProps:function(){return{componentClass:lB}},render:function(){return Object($t.jsx)(this.props.componentClass,{...this.state})},getInitialState:function(){return aB.extend({},aB.omit(this.props,"componentClass"),{onChange:this.handleChange,ref:"editor"})},componentWillReceiveProps:function(e){this.setState(aB.pick(e,"apiOptions","imageUploader","developerMode","problemNum","previewDevice","frameSource"))},getSaveWarnings:function(){return this.refs.editor.getSaveWarnings()},serialize:function(){return this.refs.editor.serialize()},handleChange:function(e,t){this.isMounted()&&this.setState(e,t)},scorePreview:function(){return this.refs.editor.scorePreview()}});oB.exports=cB;var hB=oB.exports,pB={exports:{}};pB.exports;h.a;const uB=hB,dB=rB,gB=ce,fB=wW,mB={question:{content:"",images:{},widgets:{}},answerArea:{calculator:!1},itemDataVersion:{major:0,minor:1},hints:[]},bB=createReactClass({displayName:"EditorDemo",getDefaultProps:function(){return{question:mB,problemNum:1}},getInitialState:function(){return{deviceType:"desktop",scratchpadEnabled:!0}},componentDidMount:function(){window.editorPage=this.refs.editor.refs.editor,window.itemRenderer=window.editorPage.renderer},serialize:function(){console.log(JSON.stringify(this.refs.editor.serialize(),null,4))},scorePreview:function(){console.log(this.refs.editor.scorePreview())},_getContentHash:function(){return gB.strongEncodeURIComponent(JSON.stringify(this.refs.editor.serialize()))},permalink:function(e){window.location.hash=`content=${this._getContentHash()}`,e.preventDefault()},viewRendered:function(e){const t=document.createElement("a");t.href=window.location.pathname+`?renderer#content=${this._getContentHash()}`,t.target="_blank",t.click(),e.preventDefault()},inputVersion:function(e){e.preventDefault(),console.log(fB.isItemRenderableByVersion(this.refs.editor.serialize(),{"::renderer::":{major:100,minor:0},group:{major:100,minor:0},sequence:{major:100,minor:0},"input-number":{major:100,minor:0},"numeric-input":{major:100,minor:0}}))},saveWarnings:function(e){e.preventDefault(),console.log(this.refs.editor.getSaveWarnings())},getEditorProps(){const{deviceType:e}=this.state,t="phone"===e||"tablet"===e;return{...this.props.question,problemNum:this.props.problemNum,developerMode:!0,imageUploader:function(e,t){setTimeout(t,1e3,"https://cdn.kastatic.org/images/khan-logo-vertical-transparent.png")},apiOptions:{onFocusChange:function(e,t){console.log("onFocusChange",e,t)},customKeypad:t,isMobile:t,setDrawingAreaAvailable:e=>{this.setState({scratchpadEnabled:e})}},componentClass:dB,onPreviewDeviceChange:e=>{this.setState({deviceType:e})},previewDevice:e,frameSource:'<!DOCTYPE html>\n                <html>\n                <head>\n                    <meta charset="utf-8">\n                    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">\n\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-site.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/local-only/khan-exercise.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/katex/katex.css" />\n                    <link rel="stylesheet" type="text/css" href="lib/font-awesome.min.css">\n                    <link rel="stylesheet" type="text/css" href="lib/mathquill/mathquill.css" />\n                    <link rel="stylesheet" type="text/css" href="stylesheets/perseus-admin-package/devices.min.css" />\n\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/exercise-content-package/perseus.less" />\n                    <link rel="stylesheet/less" type="text/css" href="stylesheets/perseus-admin-package/editor.less" />\n                    <style>\n                        body {\n                            min-width: 0 !important;\n                            /* overrides body { min-width: 1000px; } in khan-site.css */\n\n                            overflow: hidden;\n                        }\n                    </style>\n\n                    <script>less = {env: \'development\', logLevel: 1};<\/script>\n                    <script src="lib/less.js"><\/script>\n                </head>\n                <body>\n                    <div id="content-container">\n                    </div>\n                    <script src="lib/babel-polyfills.min.js"><\/script>\n                    <script src="lib/jquery.js"><\/script>\n                    <script src="lib/underscore.js"><\/script>\n                    <script src="lib/react-with-addons.js"><\/script>\n                    <script src="lib/mathjax/2.1/MathJax.js?config=KAthJax-730d56e87e9c926b91584f6030314815&amp;delayStartupUntil=configured"><\/script>\n                    <script src="lib/katex/katex.js"><\/script>\n                    <script src="lib/mathquill/mathquill-basic.js"><\/script>\n                    <script src="lib/kas.js"><\/script>\n                    <script src="lib/i18n.js"><\/script>\n                    <script src="lib/jquery.qtip.js"><\/script>\n                    <script src="build/frame-perseus.js"><\/script>\n                </body>\n            </html>'}},render:function(){const e=this.getEditorProps();return Object($t.jsxs)("div",{id:"perseus-index",children:[Object($t.jsxs)("div",{className:"extras",children:[Object($t.jsx)("button",{onClick:this.serialize,children:"serialize"})," ",Object($t.jsx)("button",{onClick:this.scorePreview,children:"score"})," ",Object($t.jsx)("button",{onClick:this.permalink,children:"permalink"})," ",Object($t.jsx)("button",{onClick:this.viewRendered,children:"view rendered"})," ",Object($t.jsx)("button",{onClick:this.inputVersion,children:"contains only inputs?"})," ",Object($t.jsx)("button",{onClick:this.saveWarnings,children:"save warnings"})," ",Object($t.jsxs)("span",{children:["Seed:",this.props.problemNum," "]})," ",Object($t.jsxs)("span",{children:["Scratchpad:",this.state.scratchpadEnabled?"enabled":"disabled"]})]}),Object($t.jsx)(uB,{ref:"editor",...e},this.props.question)]})}});pB.exports=bB;var vB=pB.exports,xB={exports:{}};xB.exports;const yB=x.b,jB=bW,wB=Kn;function OB(e,t){const n=wB.parse(e);wB.traverseContent(n,(function(e){"image"===e.type&&t.push(e.target)}))}function CB(e,t){e&&e.backgroundImage&&e.backgroundImage.url&&t.push(e.backgroundImage.url)}function SB(e){const t=[];return yB.each(e,(e=>{jB.traverseRendererDeep(e,(e=>{OB(e,t)}),(e=>function(e,t){e.options&&("categorizer"===e.type?(yB.each(e.options.items,(function(e){OB(e,t)})),yB.each(e.options.categories,(function(e){OB(e,t)}))):"image"===e.type?(OB(e.options.title,t),OB(e.options.caption,t)):"matcher"===e.type?(yB.each(e.options.left,(function(e){OB(e,t)})),yB.each(e.options.right,(function(e){OB(e,t)})),yB.each(e.options.labels,(function(e){OB(e,t)}))):"matrix"===e.type?(OB(e.options.prefix,t),OB(e.options.suffix,t)):"orderer"===e.type?yB.each(e.options.options,(function(e){OB(e.content,t)})):"passage"===e.type?OB(e.options.passageTitle,t):"radio"===e.type?yB.each(e.options.choices,(function(e){OB(e.content,t)})):"sorter"===e.type?yB.each(e.options.correct,(function(e){OB(e,t)})):"table"===e.type&&yB.each(e.options.headers,(function(e){OB(e,t)})),"grapher"===e.type?CB(e.options.graph,t):"image"===e.type||"interactive-graph"===e.type?CB(e.options,t):"measurer"===e.type&&e.options.image?t.push(e.options.image.url):"plotter"===e.type?t.push(e.options.picUrl):"transformer"===e.type&&CB(e.options.graph,t))}(e,t)))})),t}xB.exports={findImagesInArticles:function(e){return SB(e)},findImagesInItemData:function(e){let t=[];if(e._multi){const n=Wh(e);zh(e,n,(e=>t.push(e))),qh(e,n,(e=>t.push(e)))}else t=[e.question,...e.hints];return SB(t)}};var kB=xB.exports,_B={exports:{}};_B.exports;const TB=x.b,MB=bW,NB=Fs;function PB(e,t){MB.traverseRendererDeep(e,null,(function(e){e.type&&!NB.isAccessible(e)&&t.push(e.type)}))}_B.exports={violatingWidgets:function(e){const t=[];if(e._multi){zh(e,Wh(e),(e=>PB(e,t)))}else PB(e.question,t);return TB.uniq(t)}};var IB=_B.exports,EB={exports:{}};EB.exports;const AB=zF,RB=Fs,DB=qF;RB.registerMany(AB);const FB=RB.getVersionVector();FB["::renderer::"]=DB.itemDataVersion,EB.exports=FB;var LB=EB.exports,zB={exports:{}};zB.exports;const qB=VF;zB.exports={itemVersion:LB,ItemDiff:hz,ArticleDiff:JL,StatefulArticleEditor:Yq,StatefulEditorPage:hB,ClassNames:Ss.ClassNames,Util:ce,ViewportResizer:_W,DeviceFramer:Fz,renderability:wW,accessibility:IB,i18n:kB,ArticleEditor:Bq,Editor:sv,EditorPage:rB,IframeContentRenderer:Nz,MultiRendererEditor:xq,Gorgon:ts,JiptHack:oi,...qB};zB.exports;window.icu={getDecimalFormatSymbols:function(){return{decimal_separator:".",grouping_separator:",",minus:"-"}}},window.KhanUtil={debugLog:function(){},localeToFixed:function(e,t){return e.toFixed(t)}},window.Exercises={localMode:!0,useKatex:!0,khanExercisesUrlBase:"../",getCurrentFramework:function(){return"khan-exercises"},PerseusBridge:{cleanupProblem:function(){return!1}}};window.Khan={Util:KhanUtil,error:function(){},query:{debug:""},imageBase:"/images/"};const WB=vB,BB=hW,VB=tW,HB=kq,UB=mz,GB=iz,$B=ce.parseQueryString(window.location.hash.substring(1)),YB=$B.content&&JSON.parse($B.content),KB=Math.floor(100*Math.random()),XB=window.location.search.substring(1),ZB={renderer:[BB,{question:YB,problemNum:KB}],article:[VB,{content:YB}],multirenderer:[HB,{item:YB}],"item-diff":[UB,{}],"article-diff":[GB,{}],"":[WB,{question:YB,problemNum:KB}]};BF({skipMathJax:!0,loadExtraWidgets:!0}).then((function(){i.a.render(React.createElement(...ZB[XB]||ZB[""]),document.getElementById("root"))})).then((function(){}),(function(e){console.error(e)}))},41:function(e){e.exports=JSON.parse('{"apiVersion":{"major":10,"minor":2},"itemDataVersion":{"major":0,"minor":1}}')}},[[268,1,2]]]);
//# sourceMappingURL=main.5a330a28.chunk.js.map